var ULe=Object.defineProperty,GLe=(kr,I2,Ve)=>I2 in kr?ULe(kr,I2,{enumerable:!0,configurable:!0,writable:!0,value:Ve}):kr[I2]=Ve,e1=(kr,I2,Ve)=>(GLe(kr,"symbol"!=typeof I2?I2+"":I2,Ve),Ve);(self.webpackChunkJenshinSolver=self.webpackChunkJenshinSolver||[]).push([[179],{439:(kr,I2,Ve)=>{"use strict";function t1(t){return"function"==typeof t}function u1(t){const n=t(i=>{Error.call(i),i.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const oa=u1(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function f1(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class Jn{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const s of n)s.remove(this);else n.remove(this);const{initialTeardown:i}=this;if(t1(i))try{i()}catch(s){e=s instanceof oa?s.errors:[s]}const{_teardowns:r}=this;if(r){this._teardowns=null;for(const s of r)try{ca(s)}catch(a){e=null!=e?e:[],a instanceof oa?e=[...e,...a.errors]:e.push(a)}}if(e)throw new oa(e)}}add(e){var n;if(e&&e!==this)if(this.closed)ca(e);else{if(e instanceof Jn){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&f1(n,e)}remove(e){const{_teardowns:n}=this;n&&f1(n,e),e instanceof Jn&&e._removeParent(this)}}Jn.EMPTY=(()=>{const t=new Jn;return t.closed=!0,t})();const i1=Jn.EMPTY;function t6(t){return t instanceof Jn||t&&"closed"in t&&t1(t.remove)&&t1(t.add)&&t1(t.unsubscribe)}function ca(t){t1(t)?t():t.unsubscribe()}const M1={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ai={setTimeout(...t){const{delegate:e}=Ai;return((null==e?void 0:e.setTimeout)||setTimeout)(...t)},clearTimeout(t){const{delegate:e}=Ai;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Z4(t){Ai.setTimeout(()=>{const{onUnhandledError:e}=M1;if(!e)throw t;e(t)})}function nr(){}const R1=$4("C",void 0,void 0);function $4(t,e,n){return{kind:t,value:e,error:n}}let kn=null;function _o(t){if(M1.useDeprecatedSynchronousErrorHandling){const e=!kn;if(e&&(kn={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:i}=kn;if(kn=null,n)throw i}}else t()}class xo extends Jn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,t6(e)&&e.add(this)):this.destination=Fn}static create(e,n,i){return new Y4(e,n,i)}next(e){this.isStopped?Q4(function y9(t){return $4("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Q4(function Q8(t){return $4("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Q4(R1,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class Y4 extends xo{constructor(e,n,i){let r;if(super(),t1(e))r=e;else if(e){let s;({next:r,error:n,complete:i}=e),this&&M1.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe()):s=e,r=null==r?void 0:r.bind(s),n=null==n?void 0:n.bind(s),i=null==i?void 0:i.bind(s)}this.destination={next:r?J4(r):nr,error:J4(null!=n?n:K4),complete:i?J4(i):nr}}}function J4(t,e){return(...n)=>{try{t(...n)}catch(i){M1.useDeprecatedSynchronousErrorHandling?function X4(t){M1.useDeprecatedSynchronousErrorHandling&&kn&&(kn.errorThrown=!0,kn.error=t)}(i):Z4(i)}}}function K4(t){throw t}function Q4(t,e){const{onStoppedNotification:n}=M1;n&&Ai.setTimeout(()=>n(t,e))}const Fn={closed:!0,next:nr,error:K4,complete:nr},Bn="function"==typeof Symbol&&Symbol.observable||"@@observable";function ms(t){return t}let qt=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const i=new t;return i.source=this,i.operator=n,i}subscribe(n,i,r){const s=function t5(t){return t&&t instanceof xo||function At(t){return t&&t1(t.next)&&t1(t.error)&&t1(t.complete)}(t)&&t6(t)}(n)?n:new Y4(n,i,r);return _o(()=>{const{operator:a,source:o}=this;s.add(a?a.call(s,o):o?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(i){n.error(i)}}forEach(n,i){return new(i=la(i))((r,s)=>{let a;a=this.subscribe(o=>{try{n(o)}catch(c){s(c),null==a||a.unsubscribe()}},s,r)})}_subscribe(n){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(n)}[Bn](){return this}pipe(...n){return function e5(t){return 0===t.length?ms:1===t.length?t[0]:function(n){return t.reduce((i,r)=>r(i),n)}}(n)(this)}toPromise(n){return new(n=la(n))((i,r)=>{let s;this.subscribe(a=>s=a,a=>r(a),()=>i(s))})}}return t.create=e=>new t(e),t})();function la(t){var e;return null!==(e=null!=t?t:M1.Promise)&&void 0!==e?e:Promise}const n1=u1(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let r1=(()=>{class t extends qt{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const i=new Wi(this,this);return i.operator=n,i}_throwIfClosed(){if(this.closed)throw new n1}next(n){_o(()=>{if(this._throwIfClosed(),!this.isStopped){const i=this.observers.slice();for(const r of i)r.next(n)}})}error(n){_o(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:i}=this;for(;i.length;)i.shift().error(n)}})}complete(){_o(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:i,isStopped:r,observers:s}=this;return i||r?i1:(s.push(n),new Jn(()=>f1(s,n)))}_checkFinalizedStatuses(n){const{hasError:i,thrownError:r,isStopped:s}=this;i?n.error(r):s&&n.complete()}asObservable(){const n=new qt;return n.source=this,n}}return t.create=(e,n)=>new Wi(e,n),t})();class Wi extends r1{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===i||i.call(n,e)}error(e){var n,i;null===(i=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===i||i.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,i;return null!==(i=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==i?i:i1}}function Kn(t){return t1(null==t?void 0:t.lift)}function Yt(t){return e=>{if(Kn(e))return e.lift(function(n){try{return t(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}class Dt extends xo{constructor(e,n,i,r,s){super(e),this.onFinalize=s,this._next=n?function(a){try{n(a)}catch(o){e.error(o)}}:super._next,this._error=r?function(a){try{r(a)}catch(o){e.error(o)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function Et(t,e){return Yt((n,i)=>{let r=0;n.subscribe(new Dt(i,s=>{i.next(t.call(e,s,r++))}))})}function c2(t){return this instanceof c2?(this.v=t,this):new c2(t)}function M9(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),s=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(d){i[d]&&(r[d]=function(m){return new Promise(function(v,_){s.push([d,m,v,_])>1||o(d,m)})})}function o(d,m){try{!function c(d){d.value instanceof c2?Promise.resolve(d.value.v).then(l,u):f(s[0][2],d)}(i[d](m))}catch(v){f(s[0][3],v)}}function l(d){o("next",d)}function u(d){o("throw",d)}function f(d,m){d(m),s.shift(),s.length&&o(s[0][0],s[0][1])}}function s6(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function Mo(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=t[s]&&function(a){return new Promise(function(o,c){!function r(s,a,o,c){Promise.resolve(c).then(function(l){s({value:l,done:o})},a)}(o,c,(a=t[s](a)).done,a.value)})}}}const bo=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function n3(t){return t1(null==t?void 0:t.then)}function c6(t){return t1(t[Bn])}function Li(t){return Symbol.asyncIterator&&t1(null==t?void 0:t[Symbol.asyncIterator])}function vs(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const c5=function E9(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function ir(t){return t1(null==t?void 0:t[c5])}function l2(t){return M9(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:i,done:r}=yield c2(n.read());if(r)return yield c2(void 0);yield yield c2(i)}}finally{n.releaseLock()}})}function h2(t){return t1(null==t?void 0:t.getReader)}function u2(t){if(t instanceof qt)return t;if(null!=t){if(c6(t))return function z9(t){return new qt(e=>{const n=t[Bn]();if(t1(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(bo(t))return function Br(t){return new qt(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(n3(t))return function ua(t){return new qt(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Z4)})}(t);if(Li(t))return wo(t);if(ir(t))return function l5(t){return new qt(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(h2(t))return function i3(t){return wo(l2(t))}(t)}throw vs(t)}function wo(t){return new qt(e=>{(function V2(t,e){var n,i,r,s;return function _9(t,e,n,i){return new(n||(n=Promise))(function(s,a){function o(u){try{l(i.next(u))}catch(f){a(f)}}function c(u){try{l(i.throw(u))}catch(f){a(f)}}function l(u){u.done?s(u.value):function r(s){return s instanceof n?s:new n(function(a){a(s)})}(u.value).then(o,c)}l((i=i.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(n=s6(t);!(i=yield n.next()).done;)if(e.next(i.value),e.closed)return}catch(a){r={error:a}}finally{try{i&&!i.done&&(s=n.return)&&(yield s.call(n))}finally{if(r)throw r.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function rr(t,e,n,i=0,r=!1){const s=e.schedule(function(){n(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(s),!r)return s}function Z1(t,e,n=1/0){return t1(e)?Z1((i,r)=>Et((s,a)=>e(i,s,r,a))(u2(t(i,r))),n):("number"==typeof e&&(n=e),Yt((i,r)=>function l6(t,e,n,i,r,s,a,o){const c=[];let l=0,u=0,f=!1;const d=()=>{f&&!c.length&&!l&&e.complete()},m=_=>l<i?v(_):c.push(_),v=_=>{s&&e.next(_),l++;let M=!1;u2(n(_,u++)).subscribe(new Dt(e,y=>{null==r||r(y),s?m(y):e.next(y)},()=>{M=!0},void 0,()=>{if(M)try{for(l--;c.length&&l<i;){const y=c.shift();a?rr(e,a,()=>v(y)):v(y)}d()}catch(y){e.error(y)}}))};return t.subscribe(new Dt(e,m,()=>{f=!0,d()})),()=>{null==o||o()}}(i,r,t,n)))}function ys(t=1/0){return Z1(ms,t)}const f2=new qt(t=>t.complete());function h6(t){return t[t.length-1]}function Co(t){return function T9(t){return t&&t1(t.schedule)}(h6(t))?t.pop():void 0}function u6(t,e=0){return Yt((n,i)=>{n.subscribe(new Dt(i,r=>rr(i,t,()=>i.next(r),e),()=>rr(i,t,()=>i.complete(),e),r=>rr(i,t,()=>i.error(r),e)))})}function r3(t,e=0){return Yt((n,i)=>{i.add(t.schedule(()=>n.subscribe(i),e))})}function _s(t,e){if(!t)throw new Error("Iterable cannot be null");return new qt(n=>{rr(n,e,()=>{const i=t[Symbol.asyncIterator]();rr(n,e,()=>{i.next().then(r=>{r.done?n.complete():n.next(r.value)})},0,!0)})})}function cn(t,e){return e?function R9(t,e){if(null!=t){if(c6(t))return function D9(t,e){return u2(t).pipe(r3(e),u6(e))}(t,e);if(bo(t))return function s3(t,e){return new qt(n=>{let i=0;return e.schedule(function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())})})}(t,e);if(n3(t))return function P9(t,e){return u2(t).pipe(r3(e),u6(e))}(t,e);if(Li(t))return _s(t,e);if(ir(t))return function a3(t,e){return new qt(n=>{let i;return rr(n,e,()=>{i=t[c5](),rr(n,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(a){return void n.error(a)}s?n.complete():n.next(r)},0,!0)}),()=>t1(null==i?void 0:i.return)&&i.return()})}(t,e);if(h2(t))return function N9(t,e){return _s(l2(t),e)}(t,e)}throw vs(t)}(t,e):u2(t)}function fa(...t){const e=Co(t),n=function L9(t,e){return"number"==typeof h6(t)?t.pop():e}(t,1/0),i=t;return i.length?1===i.length?u2(i[0]):ys(n)(cn(i,e)):f2}function Eo(t){return t<=0?()=>f2:Yt((e,n)=>{let i=0;e.subscribe(new Dt(n,r=>{++i<=t&&(n.next(r),t<=i&&n.complete())}))})}function xs(t,e,...n){return!0===e?(t(),null):!1===e?null:e(...n).pipe(Eo(1)).subscribe(()=>t())}function dt(t){for(let e in t)if(t[e]===dt)return e;throw Error("Could not find renamed property on target object.")}function s1(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(s1).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function Ur(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const da=dt({__forward_ref__:dt});function zo(t){return t.__forward_ref__=zo,t.toString=function(){return s1(this())},t}function qe(t){return function H1(t){return"function"==typeof t&&t.hasOwnProperty(da)&&t.__forward_ref__===zo}(t)?t():t}class Jt extends Error{constructor(e,n){super(function fi(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}function Lt(t){return"string"==typeof t?t:null==t?"":String(t)}function _n(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Lt(t)}function Gr(t,e){const n=e?` in ${e}`:"";throw new Jt(-201,`No provider for ${_n(t)} found${n}`)}function I1(t,e){null==t&&function Tt(t,e,n,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${n} ${i} ${e} <=Actual]`))}(e,t,null,"!=")}function xt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Qn(t){return{providers:t.providers||[],imports:t.imports||[]}}function ws(t){return Di(t,Ao)||Di(t,o3)}function Di(t,e){return t.hasOwnProperty(e)?t[e]:null}function M5(t){return t&&(t.hasOwnProperty(Lo)||t.hasOwnProperty(m6))?t[Lo]:null}const Ao=dt({\u0275prov:dt}),Lo=dt({\u0275inj:dt}),o3=dt({ngInjectableDef:dt}),m6=dt({ngInjectorDef:dt});var zt=(()=>((zt=zt||{})[zt.Default=0]="Default",zt[zt.Host=1]="Host",zt[zt.Self=2]="Self",zt[zt.SkipSelf=4]="SkipSelf",zt[zt.Optional=8]="Optional",zt))();let g6;function It(t){const e=g6;return g6=t,e}function w5(t,e,n){const i=ws(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&zt.Optional?null:void 0!==e?e:void Gr(s1(t),"Injector")}function ji(t){return{toString:t}.toString()}var qi=(()=>((qi=qi||{})[qi.OnPush=0]="OnPush",qi[qi.Default=1]="Default",qi))(),p2=(()=>{return(t=p2||(p2={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",p2;var t})();const C5="undefined"!=typeof globalThis&&globalThis,V9="undefined"!=typeof window&&window,v6="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ut=C5||"undefined"!=typeof global&&global||V9||v6,Ss={},d1=[],k2=dt({\u0275cmp:dt}),c3=dt({\u0275dir:dt}),l3=dt({\u0275pipe:dt}),E5=dt({\u0275mod:dt}),ar=dt({\u0275fac:dt}),Cs=dt({__NG_ELEMENT_ID__:dt});let k9=0;function O1(t){return ji(()=>{const n={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===qi.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||d1,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||p2.Emulated,id:"c",styles:t.styles||d1,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,s=t.features,a=t.pipes;return i.id+=k9++,i.inputs=y6(t.inputs,n),i.outputs=y6(t.outputs),s&&s.forEach(o=>o(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(Do):null,i.pipeDefs=a?()=>("function"==typeof a?a():a).map(Wr):null,i})}function Do(t){return Gn(t)||function F2(t){return t[c3]||null}(t)}function Wr(t){return function cr(t){return t[l3]||null}(t)}const T5={};function Un(t){return ji(()=>{const e={type:t.type,bootstrap:t.bootstrap||d1,declarations:t.declarations||d1,imports:t.imports||d1,exports:t.exports||d1,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(T5[t.id]=t.type),e})}function y6(t,e){if(null==t)return Ss;const n={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),n[r]=i,e&&(e[r]=s)}return n}const $1=O1;function Gn(t){return t[k2]||null}function Zi(t,e){const n=t[E5]||null;if(!n&&!0===e)throw new Error(`Type ${s1(t)} does not have '\u0275mod' property.`);return n}function ti(t){return Array.isArray(t)&&"object"==typeof t[1]}function gi(t){return Array.isArray(t)&&!0===t[1]}function Ro(t){return 0!=(8&t.flags)}function Ho(t){return 2==(2&t.flags)}function d3(t){return 1==(1&t.flags)}function vi(t){return null!==t.template}function F9(t){return 0!=(512&t[2])}function U2(t,e){return t.hasOwnProperty(ar)?t[ar]:null}class ko{constructor(e,n,i){this.previousValue=e,this.currentValue=n,this.firstChange=i}isFirstChange(){return this.firstChange}}function ni(){return x6}function x6(t){return t.type.prototype.ngOnChanges&&(t.setInput=L5),Z9}function Z9(){const t=b6(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===Ss)t.previous=e;else for(let i in e)n[i]=e[i];t.current=null,this.ngOnChanges(e)}}function L5(t,e,n,i){const r=b6(t)||function D5(t,e){return t[M6]=e}(t,{previous:Ss,current:null}),s=r.current||(r.current={}),a=r.previous,o=this.declaredInputs[n],c=a[o];s[o]=new ko(c&&c.currentValue,e,a===Ss),t[i]=e}ni.ngInherit=!0;const M6="__ngSimpleChanges__";function b6(t){return t[M6]||null}let p;function w(){return void 0!==p?p:"undefined"!=typeof document?document:void 0}function R(t){return!!t.listen}const Q={createRenderer:(t,e)=>w()};function me(t){for(;Array.isArray(t);)t=t[0];return t}function pt(t,e){return me(e[t])}function Pt(t,e){return me(e[t.index])}function hr(t,e){return t.data[e]}function nn(t,e){const n=e[t];return ti(n)?n:n[0]}function y3(t){return 4==(4&t[2])}function w6(t){return 128==(128&t[2])}function $r(t,e){return null==e?null:t[e]}function S6(t){t[18]=0}function C6(t,e){t[5]+=e;let n=t,i=t[3];for(;null!==i&&(1===e&&1===n[5]||-1===e&&0===n[5]);)i[5]+=e,n=i,i=i[3]}const bt={lFrame:Cx(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function R5(){return bt.bindingsEnabled}function Ee(){return bt.lFrame.lView}function a1(){return bt.lFrame.tView}function Ts(t){return bt.lFrame.contextLView=t,t[8]}function An(){let t=_x();for(;null!==t&&64===t.type;)t=t.parent;return t}function _x(){return bt.lFrame.currentTNode}function Xr(t,e){const n=bt.lFrame;n.currentTNode=t,n.isParent=e}function J9(){return bt.lFrame.isParent}function K9(){bt.lFrame.isParent=!1}function I5(){return bt.isInCheckNoChangesMode}function V5(t){bt.isInCheckNoChangesMode=t}function Ri(){const t=bt.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function x3(){return bt.lFrame.bindingIndex++}function eI(t,e){const n=bt.lFrame;n.bindingIndex=n.bindingRootIndex=t,Q9(e)}function Q9(t){bt.lFrame.currentDirectiveIndex=t}function bx(){return bt.lFrame.currentQueryIndex}function td(t){bt.lFrame.currentQueryIndex=t}function nI(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function wx(t,e,n){if(n&zt.SkipSelf){let r=e,s=t;for(;!(r=r.parent,null!==r||n&zt.Host||(r=nI(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,t=s}const i=bt.lFrame=Sx();return i.currentTNode=e,i.lView=t,!0}function O5(t){const e=Sx(),n=t[1];bt.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Sx(){const t=bt.lFrame,e=null===t?null:t.child;return null===e?Cx(t):e}function Cx(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Ex(){const t=bt.lFrame;return bt.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const zx=Ex;function k5(){const t=Ex();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Hi(){return bt.lFrame.selectedIndex}function ya(t){bt.lFrame.selectedIndex=t}function rn(){const t=bt.lFrame;return hr(t.tView,t.selectedIndex)}function F5(t,e){for(let n=e.directiveStart,i=e.directiveEnd;n<i;n++){const s=t.data[n].type.prototype,{ngAfterContentInit:a,ngAfterContentChecked:o,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;a&&(t.contentHooks||(t.contentHooks=[])).push(-n,a),o&&((t.contentHooks||(t.contentHooks=[])).push(n,o),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,o)),c&&(t.viewHooks||(t.viewHooks=[])).push(-n,c),l&&((t.viewHooks||(t.viewHooks=[])).push(n,l),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,l)),null!=u&&(t.destroyHooks||(t.destroyHooks=[])).push(n,u)}}function B5(t,e,n){Tx(t,e,3,n)}function U5(t,e,n,i){(3&t[2])===n&&Tx(t,e,n,i)}function nd(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function Tx(t,e,n,i){const s=null!=i?i:-1,a=e.length-1;let o=0;for(let c=void 0!==i?65535&t[18]:0;c<a;c++)if("number"==typeof e[c+1]){if(o=e[c],null!=i&&o>=i)break}else e[c]<0&&(t[18]+=65536),(o<s||-1==s)&&(uI(t,n,e,c),t[18]=(4294901760&t[18])+c+2),c++}function uI(t,e,n,i){const r=n[i]<0,s=n[i+1],o=t[r?-n[i]:n[i]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{s.call(o)}finally{}}}else try{s.call(o)}finally{}}class T6{constructor(e,n,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i}}function G5(t,e,n){const i=R(t);let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const a=n[r++],o=n[r++],c=n[r++];i?t.setAttribute(e,o,c,a):e.setAttributeNS(a,o,c)}else{const a=s,o=n[++r];rd(a)?i&&t.setProperty(e,a,o):i?t.setAttribute(e,a,o):e.setAttribute(a,o),r++}}return r}function Ax(t){return 3===t||4===t||6===t}function rd(t){return 64===t.charCodeAt(0)}function W5(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?n=r:0===n||Lx(t,n,r,null,-1===n||2===n?e[++i]:null)}}return t}function Lx(t,e,n,i,r){let s=0,a=t.length;if(-1===e)a=-1;else for(;s<t.length;){const o=t[s++];if("number"==typeof o){if(o===e){a=-1;break}if(o>e){a=s-1;break}}}for(;s<t.length;){const o=t[s];if("number"==typeof o)break;if(o===n){if(null===i)return void(null!==r&&(t[s+1]=r));if(i===t[s+1])return void(t[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==a&&(t.splice(a,0,e),s=a+1),t.splice(s++,0,n),null!==i&&t.splice(s++,0,i),null!==r&&t.splice(s++,0,r)}function Dx(t){return-1!==t}function M3(t){return 32767&t}function b3(t,e){let n=function gI(t){return t>>16}(t),i=e;for(;n>0;)i=i[15],n--;return i}let sd=!0;function j5(t){const e=sd;return sd=t,e}let vI=0;function L6(t,e){const n=od(t,e);if(-1!==n)return n;const i=e[1];i.firstCreatePass&&(t.injectorIndex=e.length,ad(i.data,t),ad(e,null),ad(i.blueprint,null));const r=q5(t,e),s=t.injectorIndex;if(Dx(r)){const a=M3(r),o=b3(r,e),c=o[1].data;for(let l=0;l<8;l++)e[s+l]=o[a+l]|c[a+l]}return e[s+8]=r,s}function ad(t,e){t.push(0,0,0,0,0,0,0,0,e)}function od(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function q5(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,i=null,r=e;for(;null!==r;){const s=r[1],a=s.type;if(i=2===a?s.declTNode:1===a?r[6]:null,null===i)return-1;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return-1}function Z5(t,e,n){!function yI(t,e,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(Cs)&&(i=n[Cs]),null==i&&(i=n[Cs]=vI++);const r=255&i;e.data[t+(r>>5)]|=1<<r}(t,e,n)}function Rx(t,e,n){if(n&zt.Optional)return t;Gr(e,"NodeInjector")}function Hx(t,e,n,i){if(n&zt.Optional&&void 0===i&&(i=null),0==(n&(zt.Self|zt.Host))){const r=t[9],s=It(void 0);try{return r?r.get(e,i,n&zt.Optional):w5(e,i,n&zt.Optional)}finally{It(s)}}return Rx(i,e,n)}function Ix(t,e,n,i=zt.Default,r){if(null!==t){const s=function bI(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(Cs)?t[Cs]:void 0;return"number"==typeof e?e>=0?255&e:xI:e}(n);if("function"==typeof s){if(!wx(e,t,i))return i&zt.Host?Rx(r,n,i):Hx(e,n,i,r);try{const a=s(i);if(null!=a||i&zt.Optional)return a;Gr(n)}finally{zx()}}else if("number"==typeof s){let a=null,o=od(t,e),c=-1,l=i&zt.Host?e[16][6]:null;for((-1===o||i&zt.SkipSelf)&&(c=-1===o?q5(t,e):e[o+8],-1!==c&&kx(i,!1)?(a=e[1],o=M3(c),e=b3(c,e)):o=-1);-1!==o;){const u=e[1];if(Ox(s,o,u.data)){const f=MI(o,e,n,a,i,l);if(f!==Vx)return f}c=e[o+8],-1!==c&&kx(i,e[1].data[o+8]===l)&&Ox(s,o,e)?(a=u,o=M3(c),e=b3(c,e)):o=-1}}}return Hx(e,n,i,r)}const Vx={};function xI(){return new w3(An(),Ee())}function MI(t,e,n,i,r,s){const a=e[1],o=a.data[t+8],u=$5(o,a,n,null==i?Ho(o)&&sd:i!=a&&0!=(3&o.type),r&zt.Host&&s===o);return null!==u?D6(e,a,u,o):Vx}function $5(t,e,n,i,r){const s=t.providerIndexes,a=e.data,o=1048575&s,c=t.directiveStart,u=s>>20,d=r?o+u:t.directiveEnd;for(let m=i?o:o+u;m<d;m++){const v=a[m];if(m<c&&n===v||m>=c&&v.type===n)return m}if(r){const m=a[c];if(m&&vi(m)&&m.type===n)return c}return null}function D6(t,e,n,i){let r=t[n];const s=e.data;if(function fI(t){return t instanceof T6}(r)){const a=r;a.resolving&&function Ms(t,e){const n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new Jt(-200,`Circular dependency in DI detected for ${t}${n}`)}(_n(s[n]));const o=j5(a.canSeeViewProviders);a.resolving=!0;const c=a.injectImpl?It(a.injectImpl):null;wx(t,i,zt.Default);try{r=t[n]=a.factory(void 0,s,t,i),e.firstCreatePass&&n>=i.directiveStart&&function hI(t,e,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const a=x6(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,a),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,a)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,r),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==c&&It(c),j5(o),a.resolving=!1,zx()}}return r}function Ox(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function kx(t,e){return!(t&zt.Self||t&zt.Host&&e)}class w3{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,i){return Ix(this._tNode,this._lView,e,i,n)}}function P6(t){return function _I(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const i=n.length;let r=0;for(;r<i;){const s=n[r];if(Ax(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof n[r];)r++;else{if(s===e)return n[r+1];r+=2}}}return null}(An(),t)}const C3="__parameters__";function z3(t,e,n){return ji(()=>{const i=function ld(t){return function(...n){if(t){const i=t(...n);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const a=new r(...s);return o.annotation=a,o;function o(c,l,u){const f=c.hasOwnProperty(C3)?c[C3]:Object.defineProperty(c,C3,{value:[]})[C3];for(;f.length<=u;)f.push(null);return(f[u]=f[u]||[]).push(a),c}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class o1{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=xt({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}toString(){return`InjectionToken ${this._desc}`}}const CI=new o1("AnalyzeForEntryComponents");function G2(t,e){void 0===e&&(e=t);for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)?(e===t&&(e=t.slice(0,n)),G2(i,e)):e!==t&&e.push(i)}return e}function Yr(t,e){t.forEach(n=>Array.isArray(n)?Yr(n,e):e(n))}function Bx(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function X5(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function H6(t,e){const n=[];for(let i=0;i<t;i++)n.push(e);return n}function g2(t,e,n){let i=T3(t,e);return i>=0?t[1|i]=n:(i=~i,function TI(t,e,n,i){let r=t.length;if(r==e)t.push(n,i);else if(1===r)t.push(i,t[0]),t[0]=n;else{for(r--,t.push(t[r-1],t[r]);r>e;)t[r]=t[r-2],r--;t[e]=n,t[e+1]=i}}(t,i,e,n)),i}function ud(t,e){const n=T3(t,e);if(n>=0)return t[1|n]}function T3(t,e){return function Wx(t,e,n){let i=0,r=t.length>>n;for(;r!==i;){const s=i+(r-i>>1),a=t[s<<n];if(e===a)return s<<n;a>e?r=s:i=s+1}return~(r<<n)}(t,e,1)}const I6={},dd="__NG_DI_FLAG__",J5="ngTempTokenPath",HI=/\n/gm,qx="__source",VI=dt({provide:String,useValue:dt});let V6;function Zx(t){const e=V6;return V6=t,e}function OI(t,e=zt.Default){if(void 0===V6)throw new Jt(203,"");return null===V6?w5(t,void 0,e):V6.get(t,e&zt.Optional?null:void 0,e)}function ot(t,e=zt.Default){return(function b5(){return g6}()||OI)(qe(t),e)}function pd(t){const e=[];for(let n=0;n<t.length;n++){const i=qe(t[n]);if(Array.isArray(i)){if(0===i.length)throw new Jt(900,"");let r,s=zt.Default;for(let a=0;a<i.length;a++){const o=i[a],c=kI(o);"number"==typeof c?-1===c?r=o.token:s|=c:r=o}e.push(ot(r,s))}else e.push(ot(i))}return e}function O6(t,e){return t[dd]=e,t.prototype[dd]=e,t}function kI(t){return t[dd]}const k6=O6(z3("Inject",t=>({token:t})),-1),Jr=O6(z3("Optional"),8),A3=O6(z3("SkipSelf"),4);let Q5,eh;function D3(t){var e;return(null===(e=function gd(){if(void 0===Q5&&(Q5=null,Ut.trustedTypes))try{Q5=Ut.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return Q5}())||void 0===e?void 0:e.createHTML(t))||t}function Qx(t){var e;return(null===(e=function vd(){if(void 0===eh&&(eh=null,Ut.trustedTypes))try{eh=Ut.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return eh}())||void 0===e?void 0:e.createHTML(t))||t}class Fo{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class KI extends Fo{getTypeName(){return"HTML"}}class QI extends Fo{getTypeName(){return"Style"}}class eV extends Fo{getTypeName(){return"Script"}}class tV extends Fo{getTypeName(){return"URL"}}class nV extends Fo{getTypeName(){return"ResourceURL"}}function v2(t){return t instanceof Fo?t.changingThisBreaksApplicationSecurity:t}function Kr(t,e){const n=nM(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}function nM(t){return t instanceof Fo&&t.getTypeName()||null}class cV{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const n=(new window.DOMParser).parseFromString(D3(e),"text/html").body;return null===n?this.inertDocumentHelper.getInertBodyElement(e):(n.removeChild(n.firstChild),n)}catch(n){return null}}}class lV{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);const i=this.inertDocument.createElement("body");n.appendChild(i)}}getInertBodyElement(e){const n=this.inertDocument.createElement("template");if("content"in n)return n.innerHTML=D3(e),n;const i=this.inertDocument.createElement("body");return i.innerHTML=D3(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const n=e.attributes;for(let r=n.length-1;0<r;r--){const a=n.item(r).name;("xmlns:ns1"===a||0===a.indexOf("ns1:"))&&e.removeAttribute(a)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const uV=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,fV=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function B6(t){return(t=String(t)).match(uV)||t.match(fV)?t:"unsafe:"+t}function Qr(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function U6(...t){const e={};for(const n of t)for(const i in n)n.hasOwnProperty(i)&&(e[i]=!0);return e}const sM=Qr("area,br,col,hr,img,wbr"),aM=Qr("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),oM=Qr("rp,rt"),yd=U6(sM,U6(aM,Qr("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),U6(oM,Qr("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),U6(oM,aM)),_d=Qr("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),xd=Qr("srcset"),cM=U6(_d,xd,Qr("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Qr("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),dV=Qr("script,style,template");class pV{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let n=e.firstChild,i=!0;for(;n;)if(n.nodeType===Node.ELEMENT_NODE?i=this.startElement(n):n.nodeType===Node.TEXT_NODE?this.chars(n.nodeValue):this.sanitizedSomething=!0,i&&n.firstChild)n=n.firstChild;else for(;n;){n.nodeType===Node.ELEMENT_NODE&&this.endElement(n);let r=this.checkClobberedElement(n,n.nextSibling);if(r){n=r;break}n=this.checkClobberedElement(n,n.parentNode)}return this.buf.join("")}startElement(e){const n=e.nodeName.toLowerCase();if(!yd.hasOwnProperty(n))return this.sanitizedSomething=!0,!dV.hasOwnProperty(n);this.buf.push("<"),this.buf.push(n);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),a=s.name,o=a.toLowerCase();if(!cM.hasOwnProperty(o)){this.sanitizedSomething=!0;continue}let c=s.value;_d[o]&&(c=B6(c)),xd[o]&&(t=c,c=(t=String(t)).split(",").map(e=>B6(e.trim())).join(", ")),this.buf.push(" ",a,'="',lM(c),'"')}var t;return this.buf.push(">"),!0}endElement(e){const n=e.nodeName.toLowerCase();yd.hasOwnProperty(n)&&!sM.hasOwnProperty(n)&&(this.buf.push("</"),this.buf.push(n),this.buf.push(">"))}chars(e){this.buf.push(lM(e))}checkClobberedElement(e,n){if(n&&(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return n}}const mV=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,gV=/([^\#-~ |!])/g;function lM(t){return t.replace(/&/g,"&amp;").replace(mV,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(gV,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let th;function hM(t,e){let n=null;try{th=th||function iM(t){const e=new lV(t);return function hV(){try{return!!(new window.DOMParser).parseFromString(D3(""),"text/html")}catch(t){return!1}}()?new cV(e):e}(t);let i=e?String(e):"";n=th.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=n.innerHTML,n=th.getInertBodyElement(i)}while(i!==s);return D3((new pV).sanitizeChildren(Md(n)||n))}finally{if(n){const i=Md(n)||n;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function Md(t){return"content"in t&&function vV(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var A1=(()=>((A1=A1||{})[A1.NONE=0]="NONE",A1[A1.HTML=1]="HTML",A1[A1.STYLE=2]="STYLE",A1[A1.SCRIPT=3]="SCRIPT",A1[A1.URL=4]="URL",A1[A1.RESOURCE_URL=5]="RESOURCE_URL",A1))();function uM(t){const e=G6();return e?Qx(e.sanitize(A1.HTML,t)||""):Kr(t,"HTML")?Qx(v2(t)):hM(w(),Lt(t))}function nh(t){const e=G6();return e?e.sanitize(A1.URL,t)||"":Kr(t,"URL")?v2(t):B6(Lt(t))}function G6(){const t=Ee();return t&&t[12]}const pM="__ngContext__";function yi(t,e){t[pM]=e}function wd(t){const e=function W6(t){return t[pM]||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Cd(t){return t.ngOriginalError}function NV(t,...e){t.error(...e)}class P3{constructor(){this._console=console}handleError(e){const n=this._findOriginalError(e),i=function PV(t){return t&&t.ngErrorLogger||NV}(e);i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Cd(e);for(;n&&Cd(n);)n=Cd(n);return n||null}}const _M=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Ut))();function xM(t){return t.ownerDocument.defaultView}function es(t){return t instanceof Function?t():t}var y2=(()=>((y2=y2||{})[y2.Important=1]="Important",y2[y2.DashCase=2]="DashCase",y2))();function zd(t,e){return undefined(t,e)}function j6(t){const e=t[3];return gi(e)?e[3]:e}function Td(t){return CM(t[13])}function Ad(t){return CM(t[4])}function CM(t){for(;null!==t&&!gi(t);)t=t[4];return t}function R3(t,e,n,i,r){if(null!=i){let s,a=!1;gi(i)?s=i:ti(i)&&(a=!0,i=i[0]);const o=me(i);0===t&&null!==n?null==r?DM(e,n,o):Bo(e,n,o,r||null,!0):1===t&&null!==n?Bo(e,n,o,r||null,!0):2===t?function OM(t,e,n){const i=ih(t,e);i&&function tO(t,e,n,i){R(t)?t.removeChild(e,n,i):e.removeChild(n)}(t,i,e,n)}(e,o,a):3===t&&e.destroyNode(o),null!=s&&function rO(t,e,n,i,r){const s=n[7];s!==me(n)&&R3(e,t,i,s,r);for(let o=10;o<n.length;o++){const c=n[o];q6(c[1],c,t,e,i,s)}}(e,t,s,n,r)}}function Dd(t,e,n){return R(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function zM(t,e){const n=t[9],i=n.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,C6(r,-1)),n.splice(i,1)}function Pd(t,e){if(t.length<=10)return;const n=10+e,i=t[n];if(i){const r=i[17];null!==r&&r!==t&&zM(r,i),e>0&&(t[n-1][4]=i[4]);const s=X5(t,10+e);!function ZV(t,e){q6(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const a=s[19];null!==a&&a.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function TM(t,e){if(!(256&e[2])){const n=e[11];R(n)&&n.destroyNode&&q6(t,e,n,3,null,null),function YV(t){let e=t[13];if(!e)return Nd(t[1],t);for(;e;){let n=null;if(ti(e))n=e[13];else{const i=e[10];i&&(n=i)}if(!n){for(;e&&!e[4]&&e!==t;)ti(e)&&Nd(e[1],e),e=e[3];null===e&&(e=t),ti(e)&&Nd(e[1],e),n=e&&e[4]}e=n}}(e)}}function Nd(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function eO(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let i=0;i<n.length;i+=2){const r=e[n[i]];if(!(r instanceof T6)){const s=n[i+1];if(Array.isArray(s))for(let a=0;a<s.length;a+=2){const o=r[s[a]],c=s[a+1];try{c.call(o)}finally{}}else try{s.call(r)}finally{}}}}(t,e),function QV(t,e){const n=t.cleanup,i=e[7];let r=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const a=n[s+1],o="function"==typeof a?a(e):me(e[a]),c=i[r=n[s+2]],l=n[s+3];"boolean"==typeof l?o.removeEventListener(n[s],c,l):l>=0?i[r=l]():i[r=-l].unsubscribe(),s+=2}else{const a=i[r=n[s+1]];n[s].call(a)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(t,e),1===e[1].type&&R(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&gi(e[3])){n!==e[3]&&zM(n,e);const i=e[19];null!==i&&i.detachView(t)}}}function AM(t,e,n){return function LM(t,e,n){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return n[0];if(2&i.flags){const r=t.data[i.directiveStart].encapsulation;if(r===p2.None||r===p2.Emulated)return null}return Pt(i,n)}(t,e.parent,n)}function Bo(t,e,n,i,r){R(t)?t.insertBefore(e,n,i,r):e.insertBefore(n,i,r)}function DM(t,e,n){R(t)?t.appendChild(e,n):e.appendChild(n)}function PM(t,e,n,i,r){null!==i?Bo(t,e,n,i,r):DM(t,e,n)}function ih(t,e){return R(t)?t.parentNode(e):e.parentNode}function NM(t,e,n){return HM(t,e,n)}let HM=function RM(t,e,n){return 40&t.type?Pt(t,n):null};function rh(t,e,n,i){const r=AM(t,i,e),s=e[11],o=NM(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(n))for(let c=0;c<n.length;c++)PM(s,r,n[c],o,!1);else PM(s,r,n,o,!1)}function sh(t,e){if(null!==e){const n=e.type;if(3&n)return Pt(e,t);if(4&n)return Hd(-1,t[e.index]);if(8&n){const i=e.child;if(null!==i)return sh(t,i);{const r=t[e.index];return gi(r)?Hd(-1,r):me(r)}}if(32&n)return zd(e,t)()||me(t[e.index]);{const i=VM(t,e);return null!==i?Array.isArray(i)?i[0]:sh(j6(t[16]),i):sh(t,e.next)}}return null}function VM(t,e){return null!==e?t[16][6].projection[e.projection]:null}function Hd(t,e){const n=10+t+1;if(n<e.length){const i=e[n],r=i[1].firstChild;if(null!==r)return sh(i,r)}return e[7]}function Id(t,e,n,i,r,s,a){for(;null!=n;){const o=i[n.index],c=n.type;if(a&&0===e&&(o&&yi(me(o),i),n.flags|=4),64!=(64&n.flags))if(8&c)Id(t,e,n.child,i,r,s,!1),R3(e,t,r,o,s);else if(32&c){const l=zd(n,i);let u;for(;u=l();)R3(e,t,r,u,s);R3(e,t,r,o,s)}else 16&c?kM(t,e,i,n,r,s):R3(e,t,r,o,s);n=a?n.projectionNext:n.next}}function q6(t,e,n,i,r,s){Id(n,i,t.firstChild,e,r,s,!1)}function kM(t,e,n,i,r,s){const a=n[16],c=a[6].projection[i.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)R3(e,t,r,c[l],s);else Id(t,e,c,a[3],r,s,!0)}function FM(t,e,n){R(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function Vd(t,e,n){R(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function BM(t,e,n){let i=t.length;for(;;){const r=t.indexOf(e,n);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||t.charCodeAt(r+s)<=32)return r}n=r+1}}const UM="ng-template";function aO(t,e,n){let i=0;for(;i<t.length;){let r=t[i++];if(n&&"class"===r){if(r=t[i],-1!==BM(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function GM(t){return 4===t.type&&t.value!==UM}function oO(t,e,n){return e===(4!==t.type||n?t.value:UM)}function cO(t,e,n){let i=4;const r=t.attrs||[],s=function uO(t){for(let e=0;e<t.length;e++)if(Ax(t[e]))return e;return t.length}(r);let a=!1;for(let o=0;o<e.length;o++){const c=e[o];if("number"!=typeof c){if(!a)if(4&i){if(i=2|1&i,""!==c&&!oO(t,c,n)||""===c&&1===e.length){if(fr(i))return!1;a=!0}}else{const l=8&i?c:e[++o];if(8&i&&null!==t.attrs){if(!aO(t.attrs,l,n)){if(fr(i))return!1;a=!0}continue}const f=lO(8&i?"class":c,r,GM(t),n);if(-1===f){if(fr(i))return!1;a=!0;continue}if(""!==l){let d;d=f>s?"":r[f+1].toLowerCase();const m=8&i?d:null;if(m&&-1!==BM(m,l,0)||2&i&&l!==d){if(fr(i))return!1;a=!0}}}}else{if(!a&&!fr(i)&&!fr(c))return!1;if(a&&fr(c))continue;a=!1,i=c|1&i}}return fr(i)||a}function fr(t){return 0==(1&t)}function lO(t,e,n,i){if(null===e)return-1;let r=0;if(i||!n){let s=!1;for(;r<e.length;){const a=e[r];if(a===t)return r;if(3===a||6===a)s=!0;else{if(1===a||2===a){let o=e[++r];for(;"string"==typeof o;)o=e[++r];continue}if(4===a)break;if(0===a){r+=4;continue}}r+=s?1:2}return-1}return function fO(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const i=t[n];if("number"==typeof i)return-1;if(i===e)return n;n++}return-1}(e,t)}function WM(t,e,n=!1){for(let i=0;i<e.length;i++)if(cO(t,e[i],n))return!0;return!1}function dO(t,e){e:for(let n=0;n<e.length;n++){const i=e[n];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function jM(t,e){return t?":not("+e.trim()+")":e}function pO(t){let e=t[0],n=1,i=2,r="",s=!1;for(;n<t.length;){let a=t[n];if("string"==typeof a)if(2&i){const o=t[++n];r+="["+a+(o.length>0?'="'+o+'"':"")+"]"}else 8&i?r+="."+a:4&i&&(r+=" "+a);else""!==r&&!fr(a)&&(e+=jM(s,r),r=""),i=a,s=s||!fr(i);n++}return""!==r&&(e+=jM(s,r)),e}const Nt={};function ht(t){qM(a1(),Ee(),Hi()+t,I5())}function qM(t,e,n,i){if(!i)if(3==(3&e[2])){const s=t.preOrderCheckHooks;null!==s&&B5(e,s,n)}else{const s=t.preOrderHooks;null!==s&&U5(e,s,0,n)}ya(n)}function ah(t,e){return t<<17|e<<2}function dr(t){return t>>17&32767}function Od(t){return 2|t}function Ds(t){return(131068&t)>>2}function kd(t,e){return-131069&t|e<<2}function Fd(t){return 1|t}function ib(t,e){const n=t.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],s=n[i+1];if(-1!==s){const a=t.data[s];td(r),a.contentQueries(2,e[s],s)}}}function Z6(t,e,n,i,r,s,a,o,c,l){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,S6(u),u[3]=u[15]=t,u[8]=n,u[10]=a||t&&t[10],u[11]=o||t&&t[11],u[12]=c||t&&t[12]||null,u[9]=l||t&&t[9]||null,u[6]=s,u[16]=2==e.type?t[16]:u,u}function H3(t,e,n,i,r){let s=t.data[e];if(null===s)s=function Xd(t,e,n,i,r){const s=_x(),a=J9(),c=t.data[e]=function PO(t,e,n,i,r,s){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,a?s:s&&s.parent,n,e,i,r);return null===t.firstChild&&(t.firstChild=c),null!==s&&(a?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c)),c}(t,e,n,i,r),function QH(){return bt.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const a=function z6(){const t=bt.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===a?-1:a.injectorIndex}return Xr(s,!0),s}function I3(t,e,n,i){if(0===n)return-1;const r=e.length;for(let s=0;s<n;s++)e.push(i),t.blueprint.push(i),t.data.push(null);return r}function $6(t,e,n){O5(e);try{const i=t.viewQuery;null!==i&&rp(1,i,n);const r=t.template;null!==r&&rb(t,e,r,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&ib(t,e),t.staticViewQueries&&rp(2,t.viewQuery,n);const s=t.components;null!==s&&function AO(t,e){for(let n=0;n<e.length;n++)YO(t,e[n])}(e,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{e[2]&=-5,k5()}}function V3(t,e,n,i){const r=e[2];if(256==(256&r))return;O5(e);const s=I5();try{S6(e),function xx(t){return bt.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&rb(t,e,n,2,i);const a=3==(3&r);if(!s)if(a){const l=t.preOrderCheckHooks;null!==l&&B5(e,l,null)}else{const l=t.preOrderHooks;null!==l&&U5(e,l,0,null),nd(e,0)}if(function $O(t){for(let e=Td(t);null!==e;e=Ad(e)){if(!e[2])continue;const n=e[9];for(let i=0;i<n.length;i++){const r=n[i],s=r[3];0==(1024&r[2])&&C6(s,1),r[2]|=1024}}}(e),function ZO(t){for(let e=Td(t);null!==e;e=Ad(e))for(let n=10;n<e.length;n++){const i=e[n],r=i[1];w6(i)&&V3(r,i,r.template,i[8])}}(e),null!==t.contentQueries&&ib(t,e),!s)if(a){const l=t.contentCheckHooks;null!==l&&B5(e,l)}else{const l=t.contentHooks;null!==l&&U5(e,l,1),nd(e,1)}!function zO(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let i=0;i<n.length;i++){const r=n[i];if(r<0)ya(~r);else{const s=r,a=n[++i],o=n[++i];eI(a,s),o(2,e[s])}}}finally{ya(-1)}}(t,e);const o=t.components;null!==o&&function TO(t,e){for(let n=0;n<e.length;n++)XO(t,e[n])}(e,o);const c=t.viewQuery;if(null!==c&&rp(2,c,i),!s)if(a){const l=t.viewCheckHooks;null!==l&&B5(e,l)}else{const l=t.viewHooks;null!==l&&U5(e,l,2),nd(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,C6(e[3],-1))}finally{k5()}}function LO(t,e,n,i){const r=e[10],s=!I5(),a=y3(e);try{s&&!a&&r.begin&&r.begin(),a&&$6(t,e,i),V3(t,e,n,i)}finally{s&&!a&&r.end&&r.end()}}function rb(t,e,n,i,r){const s=Hi(),a=2&i;try{ya(-1),a&&e.length>20&&qM(t,e,20,I5()),n(i,r)}finally{ya(s)}}function sb(t,e,n){if(Ro(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const a=t.data[s];a.contentQueries&&a.contentQueries(1,n[s],s)}}}function Yd(t,e,n){!R5()||(function kO(t,e,n,i){const r=n.directiveStart,s=n.directiveEnd;t.firstCreatePass||L6(n,e),yi(i,e);const a=n.initialInputs;for(let o=r;o<s;o++){const c=t.data[o],l=vi(c);l&&WO(e,n,c);const u=D6(e,t,o,n);yi(u,e),null!==a&&jO(0,o-r,u,c,0,a),l&&(nn(n.index,e)[8]=u)}}(t,e,n,Pt(n,e)),128==(128&n.flags)&&function FO(t,e,n){const i=n.directiveStart,r=n.directiveEnd,a=n.index,o=function tI(){return bt.lFrame.currentDirectiveIndex}();try{ya(a);for(let c=i;c<r;c++){const l=t.data[c],u=e[c];Q9(c),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&db(l,u)}}finally{ya(-1),Q9(o)}}(t,e,n))}function Jd(t,e,n=Pt){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const a=i[s+1],o=-1===a?n(e,t):t[a];t[r++]=o}}}function ab(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=lh(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function lh(t,e,n,i,r,s,a,o,c,l){const u=20+i,f=u+r,d=function DO(t,e){const n=[];for(let i=0;i<e;i++)n.push(i<t?null:Nt);return n}(u,f),m="function"==typeof l?l():l;return d[1]={type:t,blueprint:d,template:n,queries:null,viewQuery:o,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:c,consts:m,incompleteFirstPass:!1}}function lb(t,e,n,i){const r=_b(e);null===n?r.push(i):(r.push(n),t.firstCreatePass&&xb(t).push(i,r.length-1))}function hb(t,e,n){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(e,r):n[i]=[e,r]}return n}function _2(t,e,n,i,r,s,a,o){const c=Pt(e,n);let u,l=e.inputs;!o&&null!=l&&(u=l[i])?(wb(t,n,u,i,r),Ho(e)&&function HO(t,e){const n=nn(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(i=function RO(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=a?a(r,e.value||"",i):r,R(s)?s.setProperty(c,i,r):rd(i)||(c.setProperty?c.setProperty(i,r):c[i]=r))}function Kd(t,e,n,i){let r=!1;if(R5()){const s=function BO(t,e,n){const i=t.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const a=i[s];WM(n,a.selectors,!1)&&(r||(r=[]),Z5(L6(n,e),t,a.type),vi(a)?(pb(t,n),r.unshift(a)):r.push(a))}return r}(t,e,n),a=null===i?null:{"":-1};if(null!==s){r=!0,mb(n,t.data.length,s.length);for(let u=0;u<s.length;u++){const f=s[u];f.providersResolver&&f.providersResolver(f)}let o=!1,c=!1,l=I3(t,e,s.length,null);for(let u=0;u<s.length;u++){const f=s[u];n.mergedAttrs=W5(n.mergedAttrs,f.hostAttrs),gb(t,n,e,l,f),GO(l,f,a),null!==f.contentQueries&&(n.flags|=8),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(n.flags|=128);const d=f.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),o=!0),!c&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),c=!0),l++}!function NO(t,e){const i=e.directiveEnd,r=t.data,s=e.attrs,a=[];let o=null,c=null;for(let l=e.directiveStart;l<i;l++){const u=r[l],f=u.inputs,d=null===s||GM(e)?null:qO(f,s);a.push(d),o=hb(f,l,o),c=hb(u.outputs,l,c)}null!==o&&(o.hasOwnProperty("class")&&(e.flags|=16),o.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=a,e.inputs=o,e.outputs=c}(t,n)}a&&function UO(t,e,n){if(e){const i=t.localNames=[];for(let r=0;r<e.length;r+=2){const s=n[e[r+1]];if(null==s)throw new Jt(-301,`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(n,i,a)}return n.mergedAttrs=W5(n.mergedAttrs,n.attrs),r}function fb(t,e,n,i,r,s){const a=s.hostBindings;if(a){let o=t.hostBindingOpCodes;null===o&&(o=t.hostBindingOpCodes=[]);const c=~e.index;(function OO(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(o)!=c&&o.push(c),o.push(i,r,a)}}function db(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function pb(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function GO(t,e,n){if(n){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)n[e.exportAs[i]]=t;vi(e)&&(n[""]=t)}}function mb(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function gb(t,e,n,i,r){t.data[i]=r;const s=r.factory||(r.factory=U2(r.type)),a=new T6(s,vi(r),null);t.blueprint[i]=a,n[i]=a,fb(t,e,0,i,I3(t,n,r.hostVars,Nt),r)}function WO(t,e,n){const i=Pt(e,t),r=ab(n),s=t[10],a=hh(t,Z6(t,r,null,n.onPush?64:16,i,e,s,s.createRenderer(i,n),null,null));t[e.index]=a}function ts(t,e,n,i,r,s){const a=Pt(t,e);!function Qd(t,e,n,i,r,s,a){if(null==s)R(t)?t.removeAttribute(e,r,n):e.removeAttribute(r);else{const o=null==a?Lt(s):a(s,i||"",r);R(t)?t.setAttribute(e,r,o,n):n?e.setAttributeNS(n,r,o):e.setAttribute(r,o)}}(e[11],a,s,t.value,n,i,r)}function jO(t,e,n,i,r,s){const a=s[e];if(null!==a){const o=i.setInput;for(let c=0;c<a.length;){const l=a[c++],u=a[c++],f=a[c++];null!==o?i.setInput(n,f,l,u):n[u]=f}}}function qO(t,e){let n=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,t[r],e[i+1])),i+=2}else i+=2;else i+=4}return n}function vb(t,e,n,i){return new Array(t,!0,!1,e,null,0,i,n,null,null)}function XO(t,e){const n=nn(e,t);if(w6(n)){const i=n[1];80&n[2]?V3(i,n,i.template,n[8]):n[5]>0&&ep(n)}}function ep(t){for(let i=Td(t);null!==i;i=Ad(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const a=s[1];V3(a,s,a.template,s[8])}else s[5]>0&&ep(s)}const n=t[1].components;if(null!==n)for(let i=0;i<n.length;i++){const r=nn(n[i],t);w6(r)&&r[5]>0&&ep(r)}}function YO(t,e){const n=nn(e,t),i=n[1];(function JO(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])})(i,n),$6(i,n,n[8])}function hh(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function tp(t){for(;t;){t[2]|=64;const e=j6(t);if(F9(t)&&!e)return t;t=e}return null}function ip(t,e,n){const i=e[10];i.begin&&i.begin();try{V3(t,e,t.template,n)}catch(r){throw bb(e,r),r}finally{i.end&&i.end()}}function yb(t){!function np(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],i=wd(n),r=i[1];LO(r,i,r.template,n)}}(t[8])}function rp(t,e,n){td(0),e(t,n)}const tk=(()=>Promise.resolve(null))();function _b(t){return t[7]||(t[7]=[])}function xb(t){return t.cleanup||(t.cleanup=[])}function bb(t,e){const n=t[9],i=n?n.get(P3,null):null;i&&i.handleError(e)}function wb(t,e,n,i,r){for(let s=0;s<n.length;){const a=n[s++],o=n[s++],c=e[a],l=t.data[a];null!==l.setInput?l.setInput(c,r,i,o):c[o]=r}}function Ps(t,e,n){const i=pt(e,t);!function EM(t,e,n){R(t)?t.setValue(e,n):e.textContent=n}(t[11],i,n)}function uh(t,e,n){let i=n?t.styles:null,r=n?t.classes:null,s=0;if(null!==e)for(let a=0;a<e.length;a++){const o=e[a];"number"==typeof o?s=o:1==s?r=Ur(r,o):2==s&&(i=Ur(i,o+": "+e[++a]+";"))}n?t.styles=i:t.stylesWithoutHost=i,n?t.classes=r:t.classesWithoutHost=r}const sp=new o1("INJECTOR",-1);class Sb{get(e,n=I6){if(n===I6){const i=new Error(`NullInjectorError: No provider for ${s1(e)}!`);throw i.name="NullInjectorError",i}return n}}const ap=new o1("Set Injector scope."),X6={},rk={};let op;function Cb(){return void 0===op&&(op=new Sb),op}function Eb(t,e=null,n=null,i){const r=zb(t,e,n,i);return r._resolveInjectorDefTypes(),r}function zb(t,e=null,n=null,i){return new sk(t,n,e||Cb(),i)}class sk{constructor(e,n,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];n&&Yr(n,o=>this.processProvider(o,e,n)),Yr([e],o=>this.processInjectorType(o,[],s)),this.records.set(sp,O3(void 0,this));const a=this.records.get(ap);this.scope=null!=a?a.value:null,this.source=r||("object"==typeof e?null:s1(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,n=I6,i=zt.Default){this.assertNotDestroyed();const r=Zx(this),s=It(void 0);try{if(!(i&zt.SkipSelf)){let o=this.records.get(e);if(void 0===o){const c=function dk(t){return"function"==typeof t||"object"==typeof t&&t instanceof o1}(e)&&ws(e);o=c&&this.injectableDefInScope(c)?O3(cp(e),X6):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(i&zt.Self?Cb():this.parent).get(e,n=i&zt.Optional&&n===I6?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[J5]=a[J5]||[]).unshift(s1(e)),r)throw a;return function FI(t,e,n,i){const r=t[J5];throw e[qx]&&r.unshift(e[qx]),t.message=function BI(t,e,n,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=s1(e);if(Array.isArray(e))r=e.map(s1).join(" -> ");else if("object"==typeof e){let s=[];for(let a in e)if(e.hasOwnProperty(a)){let o=e[a];s.push(a+":"+("string"==typeof o?JSON.stringify(o):s1(o)))}r=`{${s.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${t.replace(HI,"\n  ")}`}("\n"+t.message,r,n,i),t.ngTokenPath=r,t[J5]=null,t}(a,e,"R3InjectorError",this.source)}throw a}finally{It(s),Zx(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(s1(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Jt(205,"")}processInjectorType(e,n,i){if(!(e=qe(e)))return!1;let r=M5(e);const s=null==r&&e.ngModule||void 0,a=void 0===s?e:s,o=-1!==i.indexOf(a);if(void 0!==s&&(r=M5(s)),null==r)return!1;if(null!=r.imports&&!o){let u;i.push(a);try{Yr(r.imports,f=>{this.processInjectorType(f,n,i)&&(void 0===u&&(u=[]),u.push(f))})}finally{}if(void 0!==u)for(let f=0;f<u.length;f++){const{ngModule:d,providers:m}=u[f];Yr(m,v=>this.processProvider(v,d,m||d1))}}this.injectorDefTypes.add(a);const c=U2(a)||(()=>new a);this.records.set(a,O3(c,X6));const l=r.providers;if(null!=l&&!o){const u=e;Yr(l,f=>this.processProvider(f,u,l))}return void 0!==s&&void 0!==e.providers}processProvider(e,n,i){let r=k3(e=qe(e))?e:qe(e&&e.provide);const s=function ok(t,e,n){return Ab(t)?O3(void 0,t.useValue):O3(Tb(t),X6)}(e);if(k3(e)||!0!==e.multi)this.records.get(r);else{let a=this.records.get(r);a||(a=O3(void 0,X6,!0),a.factory=()=>pd(a.multi),this.records.set(r,a)),r=e,a.multi.push(e)}this.records.set(r,s)}hydrate(e,n){return n.value===X6&&(n.value=rk,n.value=n.factory()),"object"==typeof n.value&&n.value&&function fk(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this.onDestroy.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;const n=qe(e.providedIn);return"string"==typeof n?"any"===n||n===this.scope:this.injectorDefTypes.has(n)}}function cp(t){const e=ws(t),n=null!==e?e.factory:U2(t);if(null!==n)return n;if(t instanceof o1)throw new Jt(204,"");if(t instanceof Function)return function ak(t){const e=t.length;if(e>0)throw H6(e,"?"),new Jt(204,"");const n=function sr(t){const e=t&&(t[Ao]||t[o3]);if(e){const n=function x5(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Jt(204,"")}function Tb(t,e,n){let i;if(k3(t)){const r=qe(t);return U2(r)||cp(r)}if(Ab(t))i=()=>qe(t.useValue);else if(function lk(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...pd(t.deps||[]));else if(function ck(t){return!(!t||!t.useExisting)}(t))i=()=>ot(qe(t.useExisting));else{const r=qe(t&&(t.useClass||t.provide));if(!function uk(t){return!!t.deps}(t))return U2(r)||cp(r);i=()=>new r(...pd(t.deps))}return i}function O3(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function Ab(t){return null!==t&&"object"==typeof t&&VI in t}function k3(t){return"function"==typeof t}let Dn=(()=>{class t{static create(n,i){var r;if(Array.isArray(n))return Eb({name:""},i,n,"");{const s=null!==(r=n.name)&&void 0!==r?r:"";return Eb({name:s},n.parent,n.providers,s)}}}return t.THROW_IF_NOT_FOUND=I6,t.NULL=new Sb,t.\u0275prov=xt({token:t,providedIn:"any",factory:()=>ot(sp)}),t.__NG_ELEMENT_ID__=-1,t})();function Mk(t,e){F5(wd(t)[1],An())}let fh=null;function F3(){if(!fh){const t=Ut.Symbol;if(t&&t.iterator)fh=t.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let n=0;n<e.length;++n){const i=e[n];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(fh=i)}}}return fh}function Y6(t){return!!fp(t)&&(Array.isArray(t)||!(t instanceof Map)&&F3()in t)}function fp(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function ns(t,e,n){return t[e]=n}function _i(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function ba(t,e,n,i){const r=Ee();return _i(r,x3(),e)&&(a1(),ts(rn(),r,t,e,n,i)),ba}function U3(t,e,n,i){return _i(t,x3(),n)?e+Lt(n)+i:Nt}function X1(t,e,n,i,r,s,a,o){const c=Ee(),l=a1(),u=t+20,f=l.firstCreatePass?function Pk(t,e,n,i,r,s,a,o,c){const l=e.consts,u=H3(e,t,4,a||null,$r(l,o));Kd(e,n,u,$r(l,c)),F5(e,u);const f=u.tViews=lh(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l);return null!==e.queries&&(e.queries.template(e,u),f.queries=e.queries.embeddedTView(u)),u}(u,l,c,e,n,i,r,s,a):l.data[u];Xr(f,!1);const d=c[11].createComment("");rh(l,c,d,f),yi(d,c),hh(c,c[u]=vb(d,c,d,f)),d3(f)&&Yd(l,c,f),null!=a&&Jd(c,f,o)}function Y3(t){return function ur(t,e){return t[e]}(function KH(){return bt.lFrame.contextLView}(),20+t)}function He(t,e=zt.Default){const n=Ee();return null===n?ot(t,e):Ix(An(),n,qe(t),e)}function vp(){throw new Error("invalid")}function yt(t,e,n){const i=Ee();return _i(i,x3(),e)&&_2(a1(),rn(),i,t,e,i[11],n,!1),yt}function yp(t,e,n,i,r){const a=r?"class":"style";wb(t,n,e.inputs[a],a,i)}function le(t,e,n,i){const r=Ee(),s=a1(),a=20+t,o=r[11],c=r[a]=Dd(o,e,function lI(){return bt.lFrame.currentNamespace}()),l=s.firstCreatePass?function Qk(t,e,n,i,r,s,a){const o=e.consts,l=H3(e,t,2,r,$r(o,s));return Kd(e,n,l,$r(o,a)),null!==l.attrs&&uh(l,l.attrs,!1),null!==l.mergedAttrs&&uh(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(a,s,r,0,e,n,i):s.data[a];Xr(l,!0);const u=l.mergedAttrs;null!==u&&G5(o,c,u);const f=l.classes;null!==f&&Vd(o,c,f);const d=l.styles;null!==d&&FM(o,c,d),64!=(64&l.flags)&&rh(s,r,c,l),0===function _3(){return bt.lFrame.elementDepthCount}()&&yi(c,r),function X9(){bt.lFrame.elementDepthCount++}(),d3(l)&&(Yd(s,r,l),sb(s,l,r)),null!==i&&Jd(r,l)}function he(){let t=An();J9()?K9():(t=t.parent,Xr(t,!1));const e=t;!function Y9(){bt.lFrame.elementDepthCount--}();const n=a1();n.firstCreatePass&&(F5(n,t),Ro(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function pI(t){return 0!=(16&t.flags)}(e)&&yp(n,e,Ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function mI(t){return 0!=(32&t.flags)}(e)&&yp(n,e,Ee(),e.stylesWithoutHost,!1)}function Vt(t,e,n,i){le(t,e,n,i),he()}function mh(t,e,n){const i=Ee(),r=a1(),s=t+20,a=r.firstCreatePass?function eF(t,e,n,i,r){const s=e.consts,a=$r(s,i),o=H3(e,t,8,"ng-container",a);return null!==a&&uh(o,a,!0),Kd(e,n,o,$r(s,r)),null!==e.queries&&e.queries.elementStart(e,o),o}(s,r,i,e,n):r.data[s];Xr(a,!0);const o=i[s]=i[11].createComment("");rh(r,i,o,a),yi(o,i),d3(a)&&(Yd(r,i,a),sb(r,a,i)),null!=n&&Jd(i,a)}function gh(){let t=An();const e=a1();J9()?K9():(t=t.parent,Xr(t,!1)),e.firstCreatePass&&(F5(e,t),Ro(t)&&e.queries.elementEnd(t))}function Go(){return Ee()}function vh(t){return!!t&&"function"==typeof t.then}const hw=function lw(t){return!!t&&"function"==typeof t.subscribe};function c1(t,e,n,i){const r=Ee(),s=a1(),a=An();return function fw(t,e,n,i,r,s,a,o){const c=d3(i),u=t.firstCreatePass&&xb(t),f=e[8],d=_b(e);let m=!0;if(3&i.type||o){const M=Pt(i,e),y=o?o(M):M,g=d.length,S=o?b=>o(me(b[i.index])):i.index;if(R(n)){let b=null;if(!o&&c&&(b=function tF(t,e,n,i){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const a=r[s];if(a===n&&r[s+1]===i){const o=e[7],c=r[s+2];return o.length>c?o[c]:null}"string"==typeof a&&(s+=2)}return null}(t,e,r,i.index)),null!==b)(b.__ngLastListenerFn__||b).__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,m=!1;else{s=_p(i,e,f,s,!1);const E=n.listen(y,r,s);d.push(s,E),u&&u.push(r,S,g,g+1)}}else s=_p(i,e,f,s,!0),y.addEventListener(r,s,a),d.push(s),u&&u.push(r,S,g,a)}else s=_p(i,e,f,s,!1);const v=i.outputs;let _;if(m&&null!==v&&(_=v[r])){const M=_.length;if(M)for(let y=0;y<M;y+=2){const P=e[_[y]][_[y+1]].subscribe(s),V=d.length;d.push(s,P),u&&u.push(r,i.index,V,-(V+1))}}}(s,r,r[11],a,t,e,!!n,i),c1}function dw(t,e,n,i){try{return!1!==n(i)}catch(r){return bb(t,r),!1}}function _p(t,e,n,i,r){return function s(a){if(a===Function)return i;const o=2&t.flags?nn(t.index,e):e;0==(32&e[2])&&tp(o);let c=dw(e,0,i,a),l=s.__ngNextListenerFn__;for(;l;)c=dw(e,0,l,a)&&c,l=l.__ngNextListenerFn__;return r&&!1===c&&(a.preventDefault(),a.returnValue=!1),c}}function y1(t=1){return function iI(t){return(bt.lFrame.contextLView=function rI(t,e){for(;t>0;)e=e[15],t--;return e}(t,bt.lFrame.contextLView))[8]}(t)}function nF(t,e){let n=null;const i=function hO(t){const e=t.attrs;if(null!=e){const n=e.indexOf(5);if(0==(1&n))return e[n+1]}return null}(t);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?WM(t,s,!0):dO(i,s))return r}else n=r}return n}function K6(t){const e=Ee()[16][6];if(!e.projection){const i=e.projection=H6(t?t.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const a=t?nF(s,t):0;null!==a&&(r[a]?r[a].projectionNext=s:i[a]=s,r[a]=s),s=s.next}}}function Q6(t,e=0,n){const i=Ee(),r=a1(),s=H3(r,20+t,16,null,n||null);null===s.projection&&(s.projection=e),K9(),64!=(64&s.flags)&&function iO(t,e,n){kM(e[11],0,e,n,AM(t,n,e),NM(n.parent||e[6],n,e))}(r,i,s)}function Wo(t,e,n,i,r){const s=Ee(),a=U3(s,e,n,i);return a!==Nt&&_2(a1(),rn(),s,t,a,s[11],r,!1),Wo}function ww(t,e,n,i,r){const s=t[n+1],a=null===e;let o=i?dr(s):Ds(s),c=!1;for(;0!==o&&(!1===c||a);){const u=t[o+1];sF(t[o],e)&&(c=!0,t[o+1]=i?Fd(u):Od(u)),o=i?dr(u):Ds(u)}c&&(t[n+1]=i?Od(s):Fd(s))}function sF(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&T3(t,e)>=0}function xp(t,e,n){return mr(t,e,n,!1),xp}function jo(t,e){return mr(t,e,null,!0),jo}function mr(t,e,n,i){const r=Ee(),s=a1(),a=function Ls(t){const e=bt.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}(2);s.firstUpdatePass&&function Dw(t,e,n,i){const r=t.data;if(null===r[n+1]){const s=r[Hi()],a=function Lw(t,e){return e>=t.expandoStartIndex}(t,n);(function Hw(t,e){return 0!=(t.flags&(e?16:32))})(s,i)&&null===e&&!a&&(e=!1),e=function pF(t,e,n,i){const r=function ed(t){const e=bt.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(n=el(n=Mp(null,t,e,n,i),e.attrs,i),s=null);else{const a=e.directiveStylingLast;if(-1===a||t[a]!==r)if(n=Mp(r,t,e,n,i),null===s){let c=function mF(t,e,n){const i=n?e.classBindings:e.styleBindings;if(0!==Ds(i))return t[dr(i)]}(t,e,i);void 0!==c&&Array.isArray(c)&&(c=Mp(null,t,e,c[1],i),c=el(c,e.attrs,i),function gF(t,e,n,i){t[dr(n?e.classBindings:e.styleBindings)]=i}(t,e,i,c))}else s=function vF(t,e,n){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=el(i,t[s].hostAttrs,n);return el(i,e.attrs,n)}(t,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),n}(r,s,e,i),function iF(t,e,n,i,r,s){let a=s?e.classBindings:e.styleBindings,o=dr(a),c=Ds(a);t[i]=n;let u,l=!1;if(Array.isArray(n)){const f=n;u=f[1],(null===u||T3(f,u)>0)&&(l=!0)}else u=n;if(r)if(0!==c){const d=dr(t[o+1]);t[i+1]=ah(d,o),0!==d&&(t[d+1]=kd(t[d+1],i)),t[o+1]=function vO(t,e){return 131071&t|e<<17}(t[o+1],i)}else t[i+1]=ah(o,0),0!==o&&(t[o+1]=kd(t[o+1],i)),o=i;else t[i+1]=ah(c,0),0===o?o=i:t[c+1]=kd(t[c+1],i),c=i;l&&(t[i+1]=Od(t[i+1])),ww(t,u,i,!0),ww(t,u,i,!1),function rF(t,e,n,i,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof e&&T3(s,e)>=0&&(n[i+1]=Fd(n[i+1]))}(e,u,t,i,s),a=ah(o,c),s?e.classBindings=a:e.styleBindings=a}(r,s,e,n,a,i)}}(s,t,a,i),e!==Nt&&_i(r,a,e)&&function Nw(t,e,n,i,r,s,a,o){if(!(3&e.type))return;const c=t.data,l=c[o+1];yh(function XM(t){return 1==(1&t)}(l)?Rw(c,e,n,r,Ds(l),a):void 0)||(yh(s)||function $M(t){return 2==(2&t)}(l)&&(s=Rw(c,null,n,r,o,a)),function sO(t,e,n,i,r){const s=R(t);if(e)r?s?t.addClass(n,i):n.classList.add(i):s?t.removeClass(n,i):n.classList.remove(i);else{let a=-1===i.indexOf("-")?void 0:y2.DashCase;if(null==r)s?t.removeStyle(n,i,a):n.style.removeProperty(i);else{const o="string"==typeof r&&r.endsWith("!important");o&&(r=r.slice(0,-10),a|=y2.Important),s?t.setStyle(n,i,r,a):n.style.setProperty(i,r,o?"important":"")}}}(i,a,pt(Hi(),n),r,s))}(s,s.data[Hi()],r,r[11],t,r[a+1]=function xF(t,e){return null==t||("string"==typeof e?t+=e:"object"==typeof t&&(t=s1(v2(t)))),t}(e,n),i,a)}function Mp(t,e,n,i,r){let s=null;const a=n.directiveEnd;let o=n.directiveStylingLast;for(-1===o?o=n.directiveStart:o++;o<a&&(s=e[o],i=el(i,s.hostAttrs,r),s!==t);)o++;return null!==t&&(n.directiveStylingLast=o),i}function el(t,e,n){const i=n?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?r=a:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),g2(t,a,!!n||e[++s]))}return void 0===t?null:t}function Rw(t,e,n,i,r,s){const a=null===e;let o;for(;r>0;){const c=t[r],l=Array.isArray(c),u=l?c[1]:c,f=null===u;let d=n[r+1];d===Nt&&(d=f?d1:void 0);let m=f?ud(d,i):u===i?d:void 0;if(l&&!yh(m)&&(m=ud(c,i)),yh(m)&&(o=m,a))return o;const v=t[r+1];r=a?dr(v):Ds(v)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(o=ud(c,i))}return o}function yh(t){return void 0!==t}function Ge(t,e=""){const n=Ee(),i=a1(),r=t+20,s=i.firstCreatePass?H3(i,r,1,e,null):i.data[r],a=n[r]=function Ld(t,e){return R(t)?t.createText(e):t.createTextNode(e)}(n[11],e);rh(i,n,a,s),Xr(s,!1)}function wa(t){return x2("",t,""),wa}function x2(t,e,n){const i=Ee(),r=U3(i,t,e,n);return r!==Nt&&Ps(i,Hi(),r),x2}function bp(t,e,n){const i=Ee();return _i(i,x3(),e)&&_2(a1(),rn(),i,t,e,i[11],n,!0),bp}const qo=void 0;var FF=["en",[["a","p"],["AM","PM"],qo],[["AM","PM"],qo,qo],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],qo,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],qo,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",qo,"{1} 'at' {0}",qo],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function kF(t){const n=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===n&&0===i?1:5}];let Q3={};function tS(t){return t in Q3||(Q3[t]=Ut.ng&&Ut.ng.common&&Ut.ng.common.locales&&Ut.ng.common.locales[t]),Q3[t]}var nt=(()=>((nt=nt||{})[nt.LocaleId=0]="LocaleId",nt[nt.DayPeriodsFormat=1]="DayPeriodsFormat",nt[nt.DayPeriodsStandalone=2]="DayPeriodsStandalone",nt[nt.DaysFormat=3]="DaysFormat",nt[nt.DaysStandalone=4]="DaysStandalone",nt[nt.MonthsFormat=5]="MonthsFormat",nt[nt.MonthsStandalone=6]="MonthsStandalone",nt[nt.Eras=7]="Eras",nt[nt.FirstDayOfWeek=8]="FirstDayOfWeek",nt[nt.WeekendRange=9]="WeekendRange",nt[nt.DateFormat=10]="DateFormat",nt[nt.TimeFormat=11]="TimeFormat",nt[nt.DateTimeFormat=12]="DateTimeFormat",nt[nt.NumberSymbols=13]="NumberSymbols",nt[nt.NumberFormats=14]="NumberFormats",nt[nt.CurrencyCode=15]="CurrencyCode",nt[nt.CurrencySymbol=16]="CurrencySymbol",nt[nt.CurrencyName=17]="CurrencyName",nt[nt.Currencies=18]="Currencies",nt[nt.Directionality=19]="Directionality",nt[nt.PluralCase=20]="PluralCase",nt[nt.ExtraData=21]="ExtraData",nt))();const _h="en-US";let nS=_h;function Cp(t,e,n,i,r){if(t=qe(t),Array.isArray(t))for(let s=0;s<t.length;s++)Cp(t[s],e,n,i,r);else{const s=a1(),a=Ee();let o=k3(t)?t:qe(t.provide),c=Tb(t);const l=An(),u=1048575&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>20;if(k3(t)||!t.multi){const m=new T6(c,r,He),v=zp(o,e,r?u:u+d,f);-1===v?(Z5(L6(l,a),s,o),Ep(s,t,e.length),e.push(o),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),n.push(m),a.push(m)):(n[v]=m,a[v]=m)}else{const m=zp(o,e,u+d,f),v=zp(o,e,u,u+d),_=m>=0&&n[m],M=v>=0&&n[v];if(r&&!M||!r&&!_){Z5(L6(l,a),s,o);const y=function kB(t,e,n,i,r){const s=new T6(t,n,He);return s.multi=[],s.index=e,s.componentProviders=0,ES(s,r,i&&!n),s}(r?OB:VB,n.length,r,i,c);!r&&M&&(n[v].providerFactory=y),Ep(s,t,e.length,0),e.push(o),l.directiveStart++,l.directiveEnd++,r&&(l.providerIndexes+=1048576),n.push(y),a.push(y)}else Ep(s,t,m>-1?m:v,ES(n[r?v:m],c,!r&&i));!r&&i&&M&&n[v].componentProviders++}}}function Ep(t,e,n,i){const r=k3(e),s=function hk(t){return!!t.useClass}(e);if(r||s){const c=(s?qe(e.useClass):e).prototype.ngOnDestroy;if(c){const l=t.destroyHooks||(t.destroyHooks=[]);if(!r&&e.multi){const u=l.indexOf(n);-1===u?l.push(n,[i,c]):l[u+1].push(i,c)}else l.push(n,c)}}}function ES(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function zp(t,e,n,i){for(let r=n;r<i;r++)if(e[r]===t)return r;return-1}function VB(t,e,n,i){return Tp(this.multi,[])}function OB(t,e,n,i){const r=this.multi;let s;if(this.providerFactory){const a=this.providerFactory.componentProviders,o=D6(n,n[1],this.providerFactory.index,i);s=o.slice(0,a),Tp(r,s);for(let c=a;c<o.length;c++)s.push(o[c])}else s=[],Tp(r,s);return s}function Tp(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function zS(t,e=[]){return n=>{n.providersResolver=(i,r)=>function IB(t,e,n){const i=a1();if(i.firstCreatePass){const r=vi(t);Cp(n,i.data,i.blueprint,r,!0),Cp(e,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,e)}}class TS{}class UB{resolveComponentFactory(e){throw function BB(t){const e=Error(`No component factory found for ${s1(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(e)}}let Zo=(()=>{class t{}return t.NULL=new UB,t})();function GB(){return t0(An(),Ee())}function t0(t,e){return new ii(Pt(t,e))}let ii=(()=>{class t{constructor(n){this.nativeElement=n}}return t.__NG_ELEMENT_ID__=GB,t})();function WB(t){return t instanceof ii?t.nativeElement:t}class n0{}let ss=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function qB(){const t=Ee(),n=nn(An().index,t);return function jB(t){return t[11]}(ti(n)?n:t)}(),t})(),ZB=(()=>{class t{}return t.\u0275prov=xt({token:t,providedIn:"root",factory:()=>null}),t})();class Sh{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const $B=new Sh("13.1.3"),Ap={};function Ch(t,e,n,i,r=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&i.push(me(s)),gi(s))for(let o=10;o<s.length;o++){const c=s[o],l=c[1].firstChild;null!==l&&Ch(c[1],c,l,i)}const a=n.type;if(8&a)Ch(t,e,n.child,i);else if(32&a){const o=zd(n,e);let c;for(;c=o();)i.push(c)}else if(16&a){const o=VM(e,n);if(Array.isArray(o))i.push(...o);else{const c=j6(e[16]);Ch(c[1],c,o,i,!0)}}n=r?n.projectionNext:n.next}return i}class sl{constructor(e,n){this._lView=e,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,n=e[1];return Ch(n,e,n.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(gi(e)){const n=e[8],i=n?n.indexOf(this):-1;i>-1&&(Pd(e,i),X5(n,i))}this._attachedToViewContainer=!1}TM(this._lView[1],this._lView)}onDestroy(e){lb(this._lView[1],this._lView,null,e)}markForCheck(){tp(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){ip(this._lView[1],this._lView,this.context)}checkNoChanges(){!function QO(t,e,n){V5(!0);try{ip(t,e,n)}finally{V5(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Jt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function XV(t,e){q6(t,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Jt(902,"");this._appRef=e}}class XB extends sl{constructor(e){super(e),this._view=e}detectChanges(){yb(this._view)}checkNoChanges(){!function ek(t){V5(!0);try{yb(t)}finally{V5(!1)}}(this._view)}get context(){return null}}class LS extends Zo{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=Gn(e);return new Lp(n,this.ngModule)}}function DS(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const JB=new o1("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>_M});class Lp extends TS{constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function mO(t){return t.map(pO).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}get inputs(){return DS(this.componentDef.inputs)}get outputs(){return DS(this.componentDef.outputs)}create(e,n,i,r){const s=(r=r||this.ngModule)?function KB(t,e){return{get:(n,i,r)=>{const s=t.get(n,Ap,r);return s!==Ap||i===Ap?s:e.get(n,i,r)}}}(e,r.injector):e,a=s.get(n0,Q),o=s.get(ZB,null),c=a.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",u=i?function cb(t,e,n){if(R(t))return t.selectRootElement(e,n===p2.ShadowDom);let i="string"==typeof e?t.querySelector(e):e;return i.textContent="",i}(c,i,this.componentDef.encapsulation):Dd(a.createRenderer(null,this.componentDef),l,function YB(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),f=this.componentDef.onPush?576:528,d=function Fb(t,e){return{components:[],scheduler:t||_M,clean:tk,playerHandler:e||null,flags:0}}(),m=lh(0,null,null,1,0,null,null,null,null,null),v=Z6(null,m,d,f,null,null,a,c,o,s);let _,M;O5(v);try{const y=function Ob(t,e,n,i,r,s){const a=n[1];n[20]=t;const c=H3(a,20,2,"#host",null),l=c.mergedAttrs=e.hostAttrs;null!==l&&(uh(c,l,!0),null!==t&&(G5(r,t,l),null!==c.classes&&Vd(r,t,c.classes),null!==c.styles&&FM(r,t,c.styles)));const u=i.createRenderer(t,e),f=Z6(n,ab(e),null,e.onPush?64:16,n[20],c,i,u,s||null,null);return a.firstCreatePass&&(Z5(L6(c,n),a,e.type),pb(a,c),mb(c,n.length,1)),hh(n,f),n[20]=f}(u,this.componentDef,v,a,c);if(u)if(i)G5(c,u,["ng-version",$B.full]);else{const{attrs:g,classes:S}=function gO(t){const e=[],n=[];let i=1,r=2;for(;i<t.length;){let s=t[i];if("string"==typeof s)2===r?""!==s&&e.push(s,t[++i]):8===r&&n.push(s);else{if(!fr(r))break;r=s}i++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);g&&G5(c,u,g),S&&S.length>0&&Vd(c,u,S.join(" "))}if(M=hr(m,20),void 0!==n){const g=M.projection=[];for(let S=0;S<this.ngContentSelectors.length;S++){const b=n[S];g.push(null!=b?Array.from(b):null)}}_=function kb(t,e,n,i,r){const s=n[1],a=function VO(t,e,n){const i=An();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),gb(t,i,e,I3(t,e,1,null),n));const r=D6(e,t,i.directiveStart,i);yi(r,e);const s=Pt(i,e);return s&&yi(s,e),r}(s,n,e);if(i.components.push(a),t[8]=a,r&&r.forEach(c=>c(a,e)),e.contentQueries){const c=An();e.contentQueries(1,a,c.directiveStart)}const o=An();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(ya(o.index),fb(n[1],o,0,o.directiveStart,o.directiveEnd,e),db(e,a)),a}(y,this.componentDef,v,d,[Mk]),$6(m,v,null)}finally{k5()}return new eU(this.componentType,_,t0(M,v),v,M)}}class eU extends class FB{}{constructor(e,n,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=n,this.hostView=this.changeDetectorRef=new XB(r),this.componentType=e}get injector(){return new w3(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class Ns{}class PS{}const r0=new Map;class HS extends Ns{constructor(e,n){super(),this._parent=n,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new LS(this);const i=Zi(e);this._bootstrapComponents=es(i.bootstrap),this._r3Injector=zb(e,n,[{provide:Ns,useValue:this},{provide:Zo,useValue:this.componentFactoryResolver}],s1(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,n=Dn.THROW_IF_NOT_FOUND,i=zt.Default){return e===Dn||e===Ns||e===sp?this:this._r3Injector.get(e,n,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Dp extends PS{constructor(e){super(),this.moduleType=e,null!==Zi(e)&&function nU(t){const e=new Set;!function n(i){const r=Zi(i,!0),s=r.id;null!==s&&(function NS(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${s1(e)} vs ${s1(e.name)}`)}(s,r0.get(s),i),r0.set(s,i));const a=es(r.imports);for(const o of a)e.has(o)||(e.add(o),n(o))}(t)}(e)}create(e){return new HS(this.moduleType,e)}}function vr(t,e,n){const i=Ri()+t,r=Ee();return r[i]===Nt?ns(r,i,n?e.call(n):e()):function J6(t,e){return t[e]}(r,i)}function al(t,e,n,i){return function IS(t,e,n,i,r,s){const a=e+n;return _i(t,a,r)?ns(t,a+1,s?i.call(s,r):i(r)):function ol(t,e){const n=t[e];return n===Nt?void 0:n}(t,a+1)}(Ee(),Ri(),t,e,n,i)}function Pp(t){return e=>{setTimeout(t,void 0,e)}}const l1=class yU extends r1{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,i){var r,s,a;let o=e,c=n||(()=>null),l=i;if(e&&"object"==typeof e){const f=e;o=null===(r=f.next)||void 0===r?void 0:r.bind(f),c=null===(s=f.error)||void 0===s?void 0:s.bind(f),l=null===(a=f.complete)||void 0===a?void 0:a.bind(f)}this.__isAsync&&(c=Pp(c),o&&(o=Pp(o)),l&&(l=Pp(l)));const u=super.subscribe({next:o,error:c,complete:l});return e instanceof Jn&&e.add(u),u}};function _U(){return this._results[F3()]()}class Np{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const n=F3(),i=Np.prototype;i[n]||(i[n]=_U)}get changes(){return this._changes||(this._changes=new l1)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){const i=this;i.dirty=!1;const r=G2(e);(this._changesDetected=!function EI(t,e,n){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=e[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(i._results,r,n))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let yr=(()=>{class t{}return t.__NG_ELEMENT_ID__=bU,t})();const xU=yr,MU=class extends xU{constructor(e,n,i){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=i}createEmbeddedView(e){const n=this._declarationTContainer.tViews,i=Z6(this._declarationLView,n,e,16,null,n.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(n)),$6(n,i,e),new sl(i)}};function bU(){return Eh(An(),Ee())}function Eh(t,e){return 4&t.type?new MU(e,t,t0(t,e)):null}let M2=(()=>{class t{}return t.__NG_ELEMENT_ID__=wU,t})();function wU(){return GS(An(),Ee())}const SU=M2,BS=class extends SU{constructor(e,n,i){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=i}get element(){return t0(this._hostTNode,this._hostLView)}get injector(){return new w3(this._hostTNode,this._hostLView)}get parentInjector(){const e=q5(this._hostTNode,this._hostLView);if(Dx(e)){const n=b3(e,this._hostLView),i=M3(e);return new w3(n[1].data[i+8],n)}return new w3(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=US(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,n,i){const r=e.createEmbeddedView(n||{});return this.insert(r,i),r}createComponent(e,n,i,r,s){const a=e&&!function R6(t){return"function"==typeof t}(e);let o;if(a)o=n;else{const f=n||{};o=f.index,i=f.injector,r=f.projectableNodes,s=f.ngModuleRef}const c=a?e:new Lp(Gn(e)),l=i||this.parentInjector;if(!s&&null==c.ngModule&&l){const f=l.get(Ns,null);f&&(s=f)}const u=c.create(l,r,void 0,s);return this.insert(u.hostView,o),u}insert(e,n){const i=e._lView,r=i[1];if(function $9(t){return gi(t[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const f=i[3],d=new BS(f,f[6],f[3]);d.detach(d.indexOf(e))}}const s=this._adjustIndex(n),a=this._lContainer;!function JV(t,e,n,i){const r=10+i,s=n.length;i>0&&(n[r-1][4]=e),i<s-10?(e[4]=n[r],Bx(n,10+i,e)):(n.push(e),e[4]=null),e[3]=n;const a=e[17];null!==a&&n!==a&&function KV(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(a,e);const o=e[19];null!==o&&o.insertView(t),e[2]|=128}(r,i,a,s);const o=Hd(s,a),c=i[11],l=ih(c,a[7]);return null!==l&&function $V(t,e,n,i,r,s){i[0]=r,i[6]=e,q6(t,i,n,1,r,s)}(r,a[6],c,i,l,o),e.attachToViewContainerRef(),Bx(Rp(a),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=US(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),i=Pd(this._lContainer,n);i&&(X5(Rp(this._lContainer),n),TM(i[1],i))}detach(e){const n=this._adjustIndex(e,-1),i=Pd(this._lContainer,n);return i&&null!=X5(Rp(this._lContainer),n)?new sl(i):null}_adjustIndex(e,n=0){return null==e?this.length+n:e}};function US(t){return t[8]}function Rp(t){return t[8]||(t[8]=[])}function GS(t,e){let n;const i=e[t.index];if(gi(i))n=i;else{let r;if(8&t.type)r=me(i);else{const s=e[11];r=s.createComment("");const a=Pt(t,e);Bo(s,ih(s,a),r,function nO(t,e){return R(t)?t.nextSibling(e):e.nextSibling}(s,a),!1)}e[t.index]=n=vb(i,e,r,t),hh(e,n)}return new BS(n,t,e)}class Hp{constructor(e){this.queryList=e,this.matches=null}clone(){return new Hp(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ip{constructor(e=[]){this.queries=e}createEmbeddedView(e){const n=e.queries;if(null!==n){const i=null!==e.contentQueries?e.contentQueries[0]:n.length,r=[];for(let s=0;s<i;s++){const a=n.getByIndex(s);r.push(this.queries[a.indexInDeclarationView].clone())}return new Ip(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)null!==$S(e,n).matches&&this.queries[n].setDirty()}}class WS{constructor(e,n,i=null){this.predicate=e,this.flags=n,this.read=i}}class Vp{constructor(e=[]){this.queries=e}elementStart(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let i=0;i<this.length;i++){const r=null!==n?n.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==n?n.push(s):n=[s])}return null!==n?new Vp(n):null}template(e,n){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Op{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new Op(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const n=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==n;)i=i.parent;return n===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,n){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,n,zU(n,s)),this.matchTNodeWithReadOption(e,n,$5(n,e,s,!1,!1))}else i===yr?4&n.type&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,$5(n,e,i,!1,!1))}matchTNodeWithReadOption(e,n,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===ii||r===M2||r===yr&&4&n.type)this.addMatch(n.index,-2);else{const s=$5(n,e,r,!1,!1);null!==s&&this.addMatch(n.index,s)}else this.addMatch(n.index,i)}}addMatch(e,n){null===this.matches?this.matches=[e,n]:this.matches.push(e,n)}}function zU(t,e){const n=t.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===e)return n[i+1];return null}function AU(t,e,n,i){return-1===n?function TU(t,e){return 11&t.type?t0(t,e):4&t.type?Eh(t,e):null}(e,t):-2===n?function LU(t,e,n){return n===ii?t0(e,t):n===yr?Eh(e,t):n===M2?GS(e,t):void 0}(t,e,i):D6(t,t[1],n,e)}function jS(t,e,n,i){const r=e[19].queries[i];if(null===r.matches){const s=t.data,a=n.matches,o=[];for(let c=0;c<a.length;c+=2){const l=a[c];o.push(l<0?null:AU(e,s[l],a[c+1],n.metadata.read))}r.matches=o}return r.matches}function kp(t,e,n,i){const r=t.queries.getByIndex(n),s=r.matches;if(null!==s){const a=jS(t,e,r,n);for(let o=0;o<s.length;o+=2){const c=s[o];if(c>0)i.push(a[o/2]);else{const l=s[o+1],u=e[-c];for(let f=10;f<u.length;f++){const d=u[f];d[17]===d[3]&&kp(d[1],d,l,i)}if(null!==u[9]){const f=u[9];for(let d=0;d<f.length;d++){const m=f[d];kp(m[1],m,l,i)}}}}}return i}function Sa(t){const e=Ee(),n=a1(),i=bx();td(i+1);const r=$S(n,i);if(t.dirty&&y3(e)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const s=r.crossesNgTemplate?kp(n,e,i,[]):jS(n,e,r,i);t.reset(s,WB),t.notifyOnChanges()}return!0}return!1}function s0(t,e,n){const i=a1();i.firstCreatePass&&(function ZS(t,e,n){null===t.queries&&(t.queries=new Vp),t.queries.track(new Op(e,n))}(i,new WS(t,e,n),-1),2==(2&e)&&(i.staticViewQueries=!0)),function qS(t,e,n){const i=new Np(4==(4&n));lb(t,e,i,i.destroy),null===e[19]&&(e[19]=new Ip),e[19].queries.push(new Hp(i))}(i,Ee(),e)}function Ca(){return function DU(t,e){return t[19].queries[e].queryList}(Ee(),bx())}function $S(t,e){return t.queries.getByIndex(e)}function ll(t,e){return Eh(t,e)}function Ah(...t){}const Lh=new o1("Application Initializer");let o0=(()=>{class t{constructor(n){this.appInits=n,this.resolve=Ah,this.reject=Ah,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const n=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(vh(s))n.push(s);else if(hw(s)){const a=new Promise((o,c)=>{s.subscribe({complete:o,error:c})});n.push(a)}}Promise.all(n).then(()=>{i()}).catch(r=>{this.reject(r)}),0===n.length&&i(),this.initialized=!0}}return t.\u0275fac=function(n){return new(n||t)(ot(Lh,8))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();const ul=new o1("AppId"),YU={provide:ul,useFactory:function XU(){return`${qp()}${qp()}${qp()}`},deps:[]};function qp(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const uC=new o1("Platform Initializer"),Dh=new o1("Platform ID"),fC=new o1("appBootstrapListener");let dC=(()=>{class t{log(n){console.log(n)}warn(n){console.warn(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();const Ea=new o1("LocaleId"),pC=new o1("DefaultCurrencyCode");class JU{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}}let Ph=(()=>{class t{compileModuleSync(n){return new Dp(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),s=es(Zi(n).declarations).reduce((a,o)=>{const c=Gn(o);return c&&a.push(new Lp(c)),a},[]);return new JU(i,s)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();const QU=(()=>Promise.resolve(0))();function Zp(t){"undefined"==typeof Zone?QU.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Y1{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new l1(!1),this.onMicrotaskEmpty=new l1(!1),this.onStable=new l1(!1),this.onError=new l1(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&n,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function eG(){let t=Ut.requestAnimationFrame,e=Ut.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function iG(t){const e=()=>{!function nG(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Ut,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Xp(t),t.isCheckStableRunning=!0,$p(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Xp(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,a,o)=>{try{return mC(t),n.invokeTask(r,s,a,o)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),gC(t)}},onInvoke:(n,i,r,s,a,o,c)=>{try{return mC(t),n.invoke(r,s,a,o,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),gC(t)}},onHasTask:(n,i,r,s)=>{n.hasTask(r,s),i===r&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,Xp(t),$p(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,i,r,s)=>(n.handleError(r,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Y1.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Y1.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,n,i){return this._inner.run(e,n,i)}runTask(e,n,i,r){const s=this._inner,a=s.scheduleEventTask("NgZoneEvent: "+r,e,tG,Ah,Ah);try{return s.runTask(a,n,i)}finally{s.cancelTask(a)}}runGuarded(e,n,i){return this._inner.runGuarded(e,n,i)}runOutsideAngular(e){return this._outer.run(e)}}const tG={};function $p(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Xp(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function mC(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function gC(t){t._nesting--,$p(t)}class rG{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new l1,this.onMicrotaskEmpty=new l1,this.onStable=new l1,this.onError=new l1}run(e,n,i){return e.apply(n,i)}runGuarded(e,n,i){return e.apply(n,i)}runOutsideAngular(e){return e()}runTask(e,n,i,r){return e.apply(n,i)}}let Yp=(()=>{class t{constructor(n){this._ngZone=n,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Y1.assertNotInAngularZone(),Zp(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Zp(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==s),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:s,updateCb:r})}whenStable(n,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(n,i,r){return[]}}return t.\u0275fac=function(n){return new(n||t)(ot(Y1))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})(),vC=(()=>{class t{constructor(){this._applications=new Map,Jp.addToWindow(this)}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return Jp.findTestabilityInTree(this,n,i)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();class sG{addToWindow(e){}findTestabilityInTree(e,n,i){return null}}let _r,Jp=new sG;const yC=new o1("AllowMultipleToken");class _C{constructor(e,n){this.name=e,this.token=n}}function xC(t,e,n=[]){const i=`Platform: ${e}`,r=new o1(i);return(s=[])=>{let a=MC();if(!a||a.injector.get(yC,!1))if(t)t(n.concat(s).concat({provide:r,useValue:!0}));else{const o=n.concat(s).concat({provide:r,useValue:!0},{provide:ap,useValue:"platform"});!function lG(t){if(_r&&!_r.destroyed&&!_r.injector.get(yC,!1))throw new Jt(400,"");_r=t.get(bC);const e=t.get(uC,null);e&&e.forEach(n=>n())}(Dn.create({providers:o,name:i}))}return function hG(t){const e=MC();if(!e)throw new Jt(401,"");return e}()}}function MC(){return _r&&!_r.destroyed?_r:null}let bC=(()=>{class t{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const o=function uG(t,e){let n;return n="noop"===t?new rG:("zone.js"===t?void 0:t)||new Y1({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),c=[{provide:Y1,useValue:o}];return o.run(()=>{const l=Dn.create({providers:c,parent:this.injector,name:n.moduleType.name}),u=n.create(l),f=u.injector.get(P3,null);if(!f)throw new Jt(402,"");return o.runOutsideAngular(()=>{const d=o.onError.subscribe({next:m=>{f.handleError(m)}});u.onDestroy(()=>{Kp(this._modules,u),d.unsubscribe()})}),function fG(t,e,n){try{const i=n();return vh(i)?i.catch(r=>{throw e.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>t.handleError(i)),i}}(f,o,()=>{const d=u.injector.get(o0);return d.runInitializers(),d.donePromise.then(()=>(function jF(t){I1(t,"Expected localeId to be defined"),"string"==typeof t&&(nS=t.toLowerCase().replace(/_/g,"-"))}(u.injector.get(Ea,_h)||_h),this._moduleDoBootstrap(u),u))})})}bootstrapModule(n,i=[]){const r=wC({},i);return function oG(t,e,n){const i=new Dp(n);return Promise.resolve(i)}(0,0,n).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(n){const i=n.injector.get(c0);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!n.instance.ngDoBootstrap)throw new Jt(403,"");n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Jt(404,"");this._modules.slice().forEach(n=>n.destroy()),this._destroyListeners.forEach(n=>n()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(n){return new(n||t)(ot(Dn))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();function wC(t,e){return Array.isArray(e)?e.reduce(wC,t):Object.assign(Object.assign({},t),e)}let c0=(()=>{class t{constructor(n,i,r,s,a){this._zone=n,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new qt(l=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{l.next(this._stable),l.complete()})}),c=new qt(l=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{Y1.assertNotInAngularZone(),Zp(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,l.next(!0))})})});const f=this._zone.onUnstable.subscribe(()=>{Y1.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{l.next(!1)}))});return()=>{u.unsubscribe(),f.unsubscribe()}});this.isStable=fa(o,c.pipe(function u5(t={}){const{connector:e=(()=>new r1),resetOnError:n=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=t;return s=>{let a=null,o=null,c=null,l=0,u=!1,f=!1;const d=()=>{null==o||o.unsubscribe(),o=null},m=()=>{d(),a=c=null,u=f=!1},v=()=>{const _=a;m(),null==_||_.unsubscribe()};return Yt((_,M)=>{l++,!f&&!u&&d();const y=c=null!=c?c:e();M.add(()=>{l--,0===l&&!f&&!u&&(o=xs(v,r))}),y.subscribe(M),a||(a=new Y4({next:g=>y.next(g),error:g=>{f=!0,d(),o=xs(m,n,g),y.error(g)},complete:()=>{u=!0,d(),o=xs(m,i),y.complete()}}),cn(_).subscribe(a))})(s)}}()))}bootstrap(n,i){if(!this._initStatus.done)throw new Jt(405,"");let r;r=n instanceof TS?n:this._componentFactoryResolver.resolveComponentFactory(n),this.componentTypes.push(r.componentType);const s=function cG(t){return t.isBoundToModule}(r)?void 0:this._injector.get(Ns),o=r.create(Dn.NULL,[],i||r.selector,s),c=o.location.nativeElement,l=o.injector.get(Yp,null),u=l&&o.injector.get(vC);return l&&u&&u.registerApplication(c,l),o.onDestroy(()=>{this.detachView(o.hostView),Kp(this.components,o),u&&u.unregisterApplication(c)}),this._loadComponent(o),o}tick(){if(this._runningTick)throw new Jt(101,"");try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(n))}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;Kp(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(fC,[]).concat(this._bootstrapListeners).forEach(r=>r(n))}ngOnDestroy(){this._views.slice().forEach(n=>n.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(n){return new(n||t)(ot(Y1),ot(Dn),ot(P3),ot(Zo),ot(o0))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();function Kp(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}let CC=!0,fl=(()=>{class t{}return t.__NG_ELEMENT_ID__=mG,t})();function mG(t){return function gG(t,e,n){if(Ho(t)&&!n){const i=nn(t.index,e);return new sl(i,i)}return 47&t.type?new sl(e[16],e):null}(An(),Ee(),16==(16&t))}class PC{constructor(){}supports(e){return Y6(e)}create(e){return new bG(e)}}const MG=(t,e)=>e;class bG{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||MG}forEachItem(e){let n;for(n=this._itHead;null!==n;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,i=this._removalsHead,r=0,s=null;for(;n||i;){const a=!i||n&&n.currentIndex<RC(i,r,s)?n:i,o=RC(a,r,s),c=a.currentIndex;if(a===i)r--,i=i._nextRemoved;else if(n=n._next,null==a.previousIndex)r++;else{s||(s=[]);const l=o-r,u=c-r;if(l!=u){for(let d=0;d<l;d++){const m=d<s.length?s[d]:s[d]=0,v=m+d;u<=v&&v<l&&(s[d]=m+1)}s[a.previousIndex]=u-l}}o!==c&&e(a,o,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;null!==n;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;null!==n;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;null!==n;n=n._nextIdentityChange)e(n)}diff(e){if(null==e&&(e=[]),!Y6(e))throw new Jt(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,a,n=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let o=0;o<this.length;o++)s=e[o],a=this._trackByFn(o,s),null!==n&&Object.is(n.trackById,a)?(i&&(n=this._verifyReinsertion(n,s,a,o)),Object.is(n.item,s)||this._addIdentityChange(n,s)):(n=this._mismatch(n,s,a,o),i=!0),n=n._next}else r=0,function Dk(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[F3()]();let i;for(;!(i=n.next()).done;)e(i.value)}}(e,o=>{a=this._trackByFn(r,o),null!==n&&Object.is(n.trackById,a)?(i&&(n=this._verifyReinsertion(n,o,a,r)),Object.is(n.item,o)||this._addIdentityChange(n,o)):(n=this._mismatch(n,o,a,r),i=!0),n=n._next,r++}),this.length=r;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,r)):e=this._addAfter(new wG(n,i),s,r),e}_verifyReinsertion(e,n,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const n=e._next;this._addToRemovals(this._unlink(e)),e=n}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,n,i),this._addToMoves(e,i),e}_moveAfter(e,n,i){return this._unlink(e),this._insertAfter(e,n,i),this._addToMoves(e,i),e}_addAfter(e,n,i){return this._insertAfter(e,n,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,n,i){const r=null===n?this._itHead:n._next;return e._next=r,e._prev=n,null===r?this._itTail=e:r._prev=e,null===n?this._itHead=e:n._next=e,null===this._linkedRecords&&(this._linkedRecords=new NC),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const n=e._prev,i=e._next;return null===n?this._itHead=i:n._next=i,null===i?this._itTail=n:i._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new NC),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class wG{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class SG{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===n||n<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const n=e._prevDup,i=e._nextDup;return null===n?this._head=i:n._nextDup=i,null===i?this._tail=n:i._prevDup=n,null===this._head}}class NC{constructor(){this.map=new Map}put(e){const n=e.trackById;let i=this.map.get(n);i||(i=new SG,this.map.set(n,i)),i.add(e)}get(e,n){const r=this.map.get(e);return r?r.get(e,n):null}remove(e){const n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function RC(t,e,n){const i=t.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+e+r}class HC{constructor(){}supports(e){return e instanceof Map||fp(e)}create(){return new CG}}class CG{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let n;for(n=this._mapHead;null!==n;n=n._next)e(n)}forEachPreviousItem(e){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)e(n)}forEachChangedItem(e){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)e(n)}diff(e){if(e){if(!(e instanceof Map||fp(e)))throw new Jt(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(n&&n.key===r)this._maybeAddToChanges(n,i),this._appendAfter=n,n=n._next;else{const s=this._getOrCreateRecordForKey(r,i);n=this._insertBeforeOrAppend(n,s)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let i=n;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,n){if(e){const i=e._prev;return n._next=e,n._prev=i,e._prev=n,i&&(i._next=n),e===this._mapHead&&(this._mapHead=n),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(e,n){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,n);const s=r._prev,a=r._next;return s&&(s._next=a),a&&(a._prev=s),r._next=null,r._prev=null,r}const i=new EG(e);return this._records.set(e,i),i.currentValue=n,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,n){Object.is(n,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=n,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,n){e instanceof Map?e.forEach(n):Object.keys(e).forEach(i=>n(e[i],i))}}class EG{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function IC(){return new dl([new PC])}let dl=(()=>{class t{constructor(n){this.factories=n}static create(n,i){if(null!=i){const r=i.factories.slice();n=n.concat(r)}return new t(n)}static extend(n){return{provide:t,useFactory:i=>t.create(n,i||IC()),deps:[[t,new A3,new Jr]]}}find(n){const i=this.factories.find(r=>r.supports(n));if(null!=i)return i;throw new Jt(901,"")}}return t.\u0275prov=xt({token:t,providedIn:"root",factory:IC}),t})();function VC(){return new l0([new HC])}let l0=(()=>{class t{constructor(n){this.factories=n}static create(n,i){if(i){const r=i.factories.slice();n=n.concat(r)}return new t(n)}static extend(n){return{provide:t,useFactory:i=>t.create(n,i||VC()),deps:[[t,new A3,new Jr]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(i)return i;throw new Jt(901,"")}}return t.\u0275prov=xt({token:t,providedIn:"root",factory:VC}),t})();const zG=[new HC],AG=new dl([new PC]),LG=new l0(zG),DG=xC(null,"core",[{provide:Dh,useValue:"unknown"},{provide:bC,deps:[Dn]},{provide:vC,deps:[]},{provide:dC,deps:[]}]),IG=[{provide:c0,useClass:c0,deps:[Y1,Dn,P3,Zo,o0]},{provide:JB,deps:[Y1],useFactory:function VG(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(n){e.push(n)}}},{provide:o0,useClass:o0,deps:[[new Jr,Lh]]},{provide:Ph,useClass:Ph,deps:[]},YU,{provide:dl,useFactory:function PG(){return AG},deps:[]},{provide:l0,useFactory:function NG(){return LG},deps:[]},{provide:Ea,useFactory:function RG(t){return t||function HG(){return"undefined"!=typeof $localize&&$localize.locale||_h}()},deps:[[new k6(Ea),new Jr,new A3]]},{provide:pC,useValue:"USD"}];let OG=(()=>{class t{constructor(n){}}return t.\u0275fac=function(n){return new(n||t)(ot(c0))},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({providers:IG}),t})(),Rh=null;function za(){return Rh}const xi=new o1("DocumentToken");let Xo=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:function(){return function UG(){return ot(OC)}()},providedIn:"platform"}),t})();const GG=new o1("Location Initialized");let OC=(()=>{class t extends Xo{constructor(n){super(),this._doc=n,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return za().getBaseHref(this._doc)}onPopState(n){const i=za().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=za().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(n){this.location.pathname=n}pushState(n,i,r){kC()?this._history.pushState(n,i,r):this.location.hash=r}replaceState(n,i,r){kC()?this._history.replaceState(n,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return t.\u0275fac=function(n){return new(n||t)(ot(xi))},t.\u0275prov=xt({token:t,factory:function(){return function WG(){return new OC(ot(xi))}()},providedIn:"platform"}),t})();function kC(){return!!window.history.pushState}function im(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function FC(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function Rs(t){return t&&"?"!==t[0]?"?"+t:t}let h0=(()=>{class t{historyGo(n){throw new Error("Not implemented")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:function(){return function jG(t){const e=ot(xi).location;return new BC(ot(Xo),e&&e.origin||"")}()},providedIn:"root"}),t})();const rm=new o1("appBaseHref");let BC=(()=>{class t extends h0{constructor(n,i){if(super(),this._platformLocation=n,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return im(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+Rs(this._platformLocation.search),r=this._platformLocation.hash;return r&&n?`${i}${r}`:i}pushState(n,i,r,s){const a=this.prepareExternalUrl(r+Rs(s));this._platformLocation.pushState(n,i,a)}replaceState(n,i,r,s){const a=this.prepareExternalUrl(r+Rs(s));this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return t.\u0275fac=function(n){return new(n||t)(ot(Xo),ot(rm,8))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})(),qG=(()=>{class t extends h0{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=im(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,r,s){let a=this.prepareExternalUrl(r+Rs(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(n,i,a)}replaceState(n,i,r,s){let a=this.prepareExternalUrl(r+Rs(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,n)}}return t.\u0275fac=function(n){return new(n||t)(ot(Xo),ot(rm,8))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})(),sm=(()=>{class t{constructor(n,i){this._subject=new l1,this._urlChangeListeners=[],this._platformStrategy=n;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=FC(UC(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(n=!1){return this.normalize(this._platformStrategy.path(n))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+Rs(i))}normalize(n){return t.stripTrailingSlash(function $G(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,UC(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._platformStrategy.prepareExternalUrl(n)}go(n,i="",r=null){this._platformStrategy.pushState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Rs(i)),r)}replaceState(n,i="",r=null){this._platformStrategy.replaceState(r,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Rs(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(n=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,n)}onUrlChange(n){this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(r=>r(n,i))}subscribe(n,i,r){return this._subject.subscribe({next:n,error:i,complete:r})}}return t.normalizeQueryParams=Rs,t.joinWithSlash=im,t.stripTrailingSlash=FC,t.\u0275fac=function(n){return new(n||t)(ot(h0),ot(Xo))},t.\u0275prov=xt({token:t,factory:function(){return function ZG(){return new sm(ot(h0),ot(Xo))}()},providedIn:"root"}),t})();function UC(t){return t.replace(/\/index.html$/,"")}var Mn=(()=>((Mn=Mn||{})[Mn.Zero=0]="Zero",Mn[Mn.One=1]="One",Mn[Mn.Two=2]="Two",Mn[Mn.Few=3]="Few",Mn[Mn.Many=4]="Many",Mn[Mn.Other=5]="Other",Mn))();const tW=function eS(t){return function Vi(t){const e=function BF(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=tS(e);if(n)return n;const i=e.split("-")[0];if(n=tS(i),n)return n;if("en"===i)return FF;throw new Error(`Missing locale data for the locale "${t}".`)}(t)[nt.PluralCase]};class Wh{}let LW=(()=>{class t extends Wh{constructor(n){super(),this.locale=n}getPluralCategory(n,i){switch(tW(i||this.locale)(n)){case Mn.Zero:return"zero";case Mn.One:return"one";case Mn.Two:return"two";case Mn.Few:return"few";case Mn.Many:return"many";default:return"other"}}}return t.\u0275fac=function(n){return new(n||t)(ot(Ea))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})(),pm=(()=>{class t{constructor(n,i,r,s){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(n){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof n?n.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(n){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof n?n.split(/\s+/):n,this._rawClass&&(Y6(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const n=this._iterableDiffer.diff(this._rawClass);n&&this._applyIterableChanges(n)}else if(this._keyValueDiffer){const n=this._keyValueDiffer.diff(this._rawClass);n&&this._applyKeyValueChanges(n)}}_applyKeyValueChanges(n){n.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),n.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),n.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(n){n.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${s1(i.item)}`);this._toggleClass(i.item,!0)}),n.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(i=>this._toggleClass(i,!0)):Object.keys(n).forEach(i=>this._toggleClass(i,!!n[i])))}_removeClasses(n){n&&(Array.isArray(n)||n instanceof Set?n.forEach(i=>this._toggleClass(i,!1)):Object.keys(n).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(n,i){(n=n.trim())&&n.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(n){return new(n||t)(He(dl),He(l0),He(ii),He(ss))},t.\u0275dir=$1({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class NW{constructor(e,n,i,r){this.$implicit=e,this.ngForOf=n,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ta=(()=>{class t{constructor(n,i,r){this._viewContainer=n,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((r,s,a)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new NW(r.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)i.remove(null===s?void 0:s);else if(null!==s){const o=i.get(s);i.move(o,a),JC(o,r)}});for(let r=0,s=i.length;r<s;r++){const o=i.get(r).context;o.index=r,o.count=s,o.ngForOf=this._ngForOf}n.forEachIdentityChange(r=>{JC(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(n,i){return!0}}return t.\u0275fac=function(n){return new(n||t)(He(M2),He(yr),He(dl))},t.\u0275dir=$1({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();function JC(t,e){t.context.$implicit=e.item}let u0=(()=>{class t{constructor(n,i){this._viewContainer=n,this._context=new RW,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){KC("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){KC("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return t.\u0275fac=function(n){return new(n||t)(He(M2),He(yr))},t.\u0275dir=$1({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class RW{constructor(){this.$implicit=null,this.ngIf=null}}function KC(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${s1(e)}'.`)}let _m=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({providers:[{provide:Wh,useClass:LW}]}),t})();const tE="browser";let uj=(()=>{class t{}return t.\u0275prov=xt({token:t,providedIn:"root",factory:()=>new fj(ot(xi),window)}),t})();class fj{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const n=function dj(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const i=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const a=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(a)return a}r=i.nextNode()}}return null}(this.document,e);n&&(this.scrollToElement(n),this.attemptFocus(n))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const n=this.window.history;n&&n.scrollRestoration&&(n.scrollRestoration=e)}}scrollToElement(e){const n=e.getBoundingClientRect(),i=n.left+this.window.pageXOffset,r=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=nE(this.window.history)||nE(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function nE(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class xm extends class mj extends class BG{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function FG(t){Rh||(Rh=t)}(new xm)}onAndCancel(e,n,i){return e.addEventListener(n,i,!1),()=>{e.removeEventListener(n,i,!1)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function gj(){return gl=gl||document.querySelector("base"),gl?gl.getAttribute("href"):null}();return null==n?null:function vj(t){jh=jh||document.createElement("a"),jh.setAttribute("href",t);const e=jh.pathname;return"/"===e.charAt(0)?e:`/${e}`}(n)}resetBaseElement(){gl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function DW(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const i=n.indexOf("="),[r,s]=-1==i?[n,""]:[n.slice(0,i),n.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let jh,gl=null;const iE=new o1("TRANSITION_ID"),_j=[{provide:Lh,useFactory:function yj(t,e,n){return()=>{n.get(o0).donePromise.then(()=>{const i=za(),r=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[iE,xi,Dn],multi:!0}];class Mm{static init(){!function aG(t){Jp=t}(new Mm)}addToWindow(e){Ut.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Ut.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ut.getAllAngularRootElements=()=>e.getAllRootElements(),Ut.frameworkStabilizers||(Ut.frameworkStabilizers=[]),Ut.frameworkStabilizers.push(i=>{const r=Ut.getAllAngularTestabilities();let s=r.length,a=!1;const o=function(c){a=a||c,s--,0==s&&i(a)};r.forEach(function(c){c.whenStable(o)})})}findTestabilityInTree(e,n,i){if(null==n)return null;const r=e.getTestability(n);return null!=r?r:i?za().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null}}let xj=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();const qh=new o1("EventManagerPlugins");let Zh=(()=>{class t{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(r=>r.manager=this),this._plugins=n.slice().reverse()}addEventListener(n,i,r){return this._findPluginFor(i).addEventListener(n,i,r)}addGlobalEventListener(n,i,r){return this._findPluginFor(i).addGlobalEventListener(n,i,r)}getZone(){return this._zone}_findPluginFor(n){const i=this._eventNameToPlugin.get(n);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const a=r[s];if(a.supports(n))return this._eventNameToPlugin.set(n,a),a}throw new Error(`No event manager plugin found for event ${n}`)}}return t.\u0275fac=function(n){return new(n||t)(ot(qh),ot(Y1))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();class rE{constructor(e){this._doc=e}addGlobalEventListener(e,n,i){const r=za().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${n}`);return this.addEventListener(r,n,i)}}let sE=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(n){const i=new Set;n.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(n){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})(),vl=(()=>{class t extends sE{constructor(n){super(),this._doc=n,this._hostNodes=new Map,this._hostNodes.set(n.head,[])}_addStylesToHost(n,i,r){n.forEach(s=>{const a=this._doc.createElement("style");a.textContent=s,r.push(i.appendChild(a))})}addHost(n){const i=[];this._addStylesToHost(this._stylesSet,n,i),this._hostNodes.set(n,i)}removeHost(n){const i=this._hostNodes.get(n);i&&i.forEach(aE),this._hostNodes.delete(n)}onStylesAdded(n){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(n,r,i)})}ngOnDestroy(){this._hostNodes.forEach(n=>n.forEach(aE))}}return t.\u0275fac=function(n){return new(n||t)(ot(xi))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();function aE(t){za().remove(t)}const bm={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},wm=/%COMP%/g;function $h(t,e,n){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?$h(t,r,n):(r=r.replace(wm,t),n.push(r))}return n}function lE(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Xh=(()=>{class t{constructor(n,i,r){this.eventManager=n,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Sm(n)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;switch(i.encapsulation){case p2.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new Ej(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(n),r}case 1:case p2.ShadowDom:return new zj(this.eventManager,this.sharedStylesHost,n,i);default:if(!this.rendererByCompId.has(i.id)){const r=$h(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(n){return new(n||t)(ot(Zh),ot(vl),ot(ul))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();class Sm{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,n){return n?document.createElementNS(bm[n]||n,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,n){e.appendChild(n)}insertBefore(e,n,i){e&&e.insertBefore(n,i)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return n||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,i,r){if(r){n=r+":"+n;const s=bm[r];s?e.setAttributeNS(s,n,i):e.setAttribute(n,i)}else e.setAttribute(n,i)}removeAttribute(e,n,i){if(i){const r=bm[i];r?e.removeAttributeNS(r,n):e.removeAttribute(`${i}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,i,r){r&(y2.DashCase|y2.Important)?e.style.setProperty(n,i,r&y2.Important?"important":""):e.style[n]=i}removeStyle(e,n,i){i&y2.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,i){e[n]=i}setValue(e,n){e.nodeValue=n}listen(e,n,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,n,lE(i)):this.eventManager.addEventListener(e,n,lE(i))}}class Ej extends Sm{constructor(e,n,i,r){super(e),this.component=i;const s=$h(r+"-"+i.id,i.styles,[]);n.addStyles(s),this.contentAttr=function wj(t){return"_ngcontent-%COMP%".replace(wm,t)}(r+"-"+i.id),this.hostAttr=function Sj(t){return"_nghost-%COMP%".replace(wm,t)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,n){const i=super.createElement(e,n);return super.setAttribute(i,this.contentAttr,""),i}}class zj extends Sm{constructor(e,n,i,r){super(e),this.sharedStylesHost=n,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=$h(r.id,r.styles,[]);for(let a=0;a<s.length;a++){const o=document.createElement("style");o.textContent=s[a],this.shadowRoot.appendChild(o)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,i){return super.insertBefore(this.nodeOrShadowRoot(e),n,i)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Tj=(()=>{class t extends rE{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,r){return n.addEventListener(i,r,!1),()=>this.removeEventListener(n,i,r)}removeEventListener(n,i,r){return n.removeEventListener(i,r)}}return t.\u0275fac=function(n){return new(n||t)(ot(xi))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();const uE=["alt","control","meta","shift"],Lj={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},fE={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Dj={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let Pj=(()=>{class t extends rE{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,i,r){const s=t.parseEventName(i),a=t.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>za().onAndCancel(n,s.domEventName,a))}static parseEventName(n){const i=n.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=t._normalizeKey(i.pop());let a="";if(uE.forEach(c=>{const l=i.indexOf(c);l>-1&&(i.splice(l,1),a+=c+".")}),a+=s,0!=i.length||0===s.length)return null;const o={};return o.domEventName=r,o.fullKey=a,o}static getEventFullKey(n){let i="",r=function Nj(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&fE.hasOwnProperty(e)&&(e=fE[e]))}return Lj[e]||e}(n);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),uE.forEach(s=>{s!=r&&Dj[s](n)&&(i+=s+".")}),i+=r,i}static eventCallback(n,i,r){return s=>{t.getEventFullKey(s)===n&&r.runGuarded(()=>i(s))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return t.\u0275fac=function(n){return new(n||t)(ot(xi))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();const Vj=xC(DG,"browser",[{provide:Dh,useValue:tE},{provide:uC,useValue:function Rj(){xm.makeCurrent(),Mm.init()},multi:!0},{provide:xi,useFactory:function Ij(){return function x(t){p=t}(document),document},deps:[]}]),Oj=[{provide:ap,useValue:"root"},{provide:P3,useFactory:function Hj(){return new P3},deps:[]},{provide:qh,useClass:Tj,multi:!0,deps:[xi,Y1,Dh]},{provide:qh,useClass:Pj,multi:!0,deps:[xi]},{provide:Xh,useClass:Xh,deps:[Zh,vl,ul]},{provide:n0,useExisting:Xh},{provide:sE,useExisting:vl},{provide:vl,useClass:vl,deps:[xi]},{provide:Yp,useClass:Yp,deps:[Y1]},{provide:Zh,useClass:Zh,deps:[qh,Y1]},{provide:class pj{},useClass:xj,deps:[]}];let dE=(()=>{class t{constructor(n){if(n)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(n){return{ngModule:t,providers:[{provide:ul,useValue:n.appId},{provide:iE,useExisting:ul},_j]}}}return t.\u0275fac=function(n){return new(n||t)(ot(t,12))},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({providers:Oj,imports:[_m,OG]}),t})();"undefined"!=typeof window&&window;let gE=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:function(n){let i=null;return i=n?new(n||t):ot(vE),i},providedIn:"root"}),t})(),vE=(()=>{class t extends gE{constructor(n){super(),this._doc=n}sanitize(n,i){if(null==i)return null;switch(n){case A1.NONE:return i;case A1.HTML:return Kr(i,"HTML")?v2(i):hM(this._doc,String(i)).toString();case A1.STYLE:return Kr(i,"Style")?v2(i):i;case A1.SCRIPT:if(Kr(i,"Script"))return v2(i);throw new Error("unsafe value used in a script context");case A1.URL:return nM(i),Kr(i,"URL")?v2(i):B6(String(i));case A1.RESOURCE_URL:if(Kr(i,"ResourceURL"))return v2(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${n} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(n){return function iV(t){return new KI(t)}(n)}bypassSecurityTrustStyle(n){return function rV(t){return new QI(t)}(n)}bypassSecurityTrustScript(n){return function sV(t){return new eV(t)}(n)}bypassSecurityTrustUrl(n){return function aV(t){return new tV(t)}(n)}bypassSecurityTrustResourceUrl(n){return function oV(t){return new nV(t)}(n)}}return t.\u0275fac=function(n){return new(n||t)(ot(xi))},t.\u0275prov=xt({token:t,factory:function(n){let i=null;return i=n?new n:function $j(t){return new vE(t.get(xi))}(ot(Dn)),i},providedIn:"root"}),t})();function Ot(...t){return cn(t,Co(t))}class br extends r1{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:i}=this;if(e)throw n;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const{isArray:Xj}=Array,{getPrototypeOf:Yj,prototype:Jj,keys:Kj}=Object;const{isArray:tq}=Array;function yE(t){return Et(e=>function nq(t,e){return tq(e)?t(...e):t(e)}(t,e))}function rq(...t){const e=Co(t),n=function A9(t){return t1(h6(t))?t.pop():void 0}(t),{args:i,keys:r}=function Qj(t){if(1===t.length){const e=t[0];if(Xj(e))return{args:e,keys:null};if(function eq(t){return t&&"object"==typeof t&&Yj(t)===Jj}(e)){const n=Kj(e);return{args:n.map(i=>e[i]),keys:n}}}return{args:t,keys:null}}(t);if(0===i.length)return cn([],e);const s=new qt(function sq(t,e,n=ms){return i=>{_E(e,()=>{const{length:r}=t,s=new Array(r);let a=r,o=r;for(let c=0;c<r;c++)_E(e,()=>{const l=cn(t[c],e);let u=!1;l.subscribe(new Dt(i,f=>{s[c]=f,u||(u=!0,o--),o||i.next(n(s.slice()))},()=>{--a||i.complete()}))},i)},i)}}(i,e,r?a=>function iq(t,e){return t.reduce((n,i,r)=>(n[i]=e[r],n),{})}(r,a):ms));return n?s.pipe(yE(n)):s}function _E(t,e,n){t?rr(n,t,e):e()}const Yh=u1(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function Em(...t){return function aq(){return ys(1)}()(cn(t,Co(t)))}function xE(t){return new qt(e=>{u2(t()).subscribe(e)})}function ME(){return Yt((t,e)=>{let n=null;t._refCount++;const i=new Dt(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(n=null);const r=t._connection,s=n;n=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});t.subscribe(i),i.closed||(n=t.connect())})}class oq extends qt{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Kn(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Jn;const n=this.getSubject();e.add(this.source.subscribe(new Dt(n,void 0,()=>{this._teardown(),n.complete()},i=>{this._teardown(),n.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Jn.EMPTY)}return e}refCount(){return ME()(this)}}function Yo(t,e){return Yt((n,i)=>{let r=null,s=0,a=!1;const o=()=>a&&!r&&i.complete();n.subscribe(new Dt(i,c=>{null==r||r.unsubscribe();let l=0;const u=s++;u2(t(c,u)).subscribe(r=new Dt(i,f=>i.next(e?e(c,f,u,l++):f),()=>{r=null,o()}))},()=>{a=!0,o()}))})}function lq(t,e,n,i,r){return(s,a)=>{let o=n,c=e,l=0;s.subscribe(new Dt(a,u=>{const f=l++;c=o?t(c,u,f):(o=!0,u),i&&a.next(c)},r&&(()=>{o&&a.next(c),a.complete()})))}}function bE(t,e){return Yt(lq(t,e,arguments.length>=2,!0))}function Jo(t,e){return Yt((n,i)=>{let r=0;n.subscribe(new Dt(i,s=>t.call(e,s,r++)&&i.next(s)))})}function La(t){return Yt((e,n)=>{let s,i=null,r=!1;i=e.subscribe(new Dt(n,void 0,void 0,a=>{s=u2(t(a,La(t)(e))),i?(i.unsubscribe(),i=null,s.subscribe(n)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(n))})}function yl(t,e){return t1(e)?Z1(t,e,1):Z1(t,1)}function zm(t){return t<=0?()=>f2:Yt((e,n)=>{let i=[];e.subscribe(new Dt(n,r=>{i.push(r),t<i.length&&i.shift()},()=>{for(const r of i)n.next(r);n.complete()},void 0,()=>{i=null}))})}function wE(t=hq){return Yt((e,n)=>{let i=!1;e.subscribe(new Dt(n,r=>{i=!0,n.next(r)},()=>i?n.complete():n.error(t())))})}function hq(){return new Yh}function SE(t){return Yt((e,n)=>{let i=!1;e.subscribe(new Dt(n,r=>{i=!0,n.next(r)},()=>{i||n.next(t),n.complete()}))})}function f0(t,e){const n=arguments.length>=2;return i=>i.pipe(t?Jo((r,s)=>t(r,s,i)):ms,Eo(1),n?SE(e):wE(()=>new Yh))}function b2(t,e,n){const i=t1(t)||e||n?{next:t,error:e,complete:n}:t;return i?Yt((r,s)=>{var a;null===(a=i.subscribe)||void 0===a||a.call(i);let o=!0;r.subscribe(new Dt(s,c=>{var l;null===(l=i.next)||void 0===l||l.call(i,c),s.next(c)},()=>{var c;o=!1,null===(c=i.complete)||void 0===c||c.call(i),s.complete()},c=>{var l;o=!1,null===(l=i.error)||void 0===l||l.call(i,c),s.error(c)},()=>{var c,l;o&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(l=i.finalize)||void 0===l||l.call(i)}))}):ms}class Is{constructor(e,n){this.id=e,this.url=n}}class Tm extends Is{constructor(e,n,i="imperative",r=null){super(e,n),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class _l extends Is{constructor(e,n,i){super(e,n),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class CE extends Is{constructor(e,n,i){super(e,n),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class dq extends Is{constructor(e,n,i){super(e,n),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class pq extends Is{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class mq extends Is{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class gq extends Is{constructor(e,n,i,r,s){super(e,n),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class vq extends Is{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class yq extends Is{constructor(e,n,i,r){super(e,n),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class EE{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class zE{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class _q{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class xq{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Mq{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class bq{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class TE{constructor(e,n,i){this.routerEvent=e,this.position=n,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const jt="primary";class wq{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function d0(t){return new wq(t)}const AE="ngNavigationCancelingError";function Am(t){const e=Error("NavigationCancelingError: "+t);return e[AE]=!0,e}function Cq(t,e,n){const i=n.path.split("/");if(i.length>t.length||"full"===n.pathMatch&&(e.hasChildren()||i.length<t.length))return null;const r={};for(let s=0;s<i.length;s++){const a=i[s],o=t[s];if(a.startsWith(":"))r[a.substring(1)]=o;else if(a!==o.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function as(t,e){const n=t?Object.keys(t):void 0,i=e?Object.keys(e):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!LE(t[r],e[r]))return!1;return!0}function LE(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),i=[...e].sort();return n.every((r,s)=>i[s]===r)}return t===e}function DE(t){return Array.prototype.concat.apply([],t)}function PE(t){return t.length>0?t[t.length-1]:null}function ri(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function os(t){return hw(t)?t:vh(t)?cn(Promise.resolve(t)):Ot(t)}const Tq={exact:function HE(t,e,n){if(!Qo(t.segments,e.segments)||!Jh(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!t.children[i]||!HE(t.children[i],e.children[i],n))return!1;return!0},subset:IE},NE={exact:function Aq(t,e){return as(t,e)},subset:function Lq(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>LE(t[n],e[n]))},ignored:()=>!0};function RE(t,e,n){return Tq[n.paths](t.root,e.root,n.matrixParams)&&NE[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function IE(t,e,n){return VE(t,e,e.segments,n)}function VE(t,e,n,i){if(t.segments.length>n.length){const r=t.segments.slice(0,n.length);return!(!Qo(r,n)||e.hasChildren()||!Jh(r,n,i))}if(t.segments.length===n.length){if(!Qo(t.segments,n)||!Jh(t.segments,n,i))return!1;for(const r in e.children)if(!t.children[r]||!IE(t.children[r],e.children[r],i))return!1;return!0}{const r=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!(Qo(t.segments,r)&&Jh(t.segments,r,i)&&t.children[jt])&&VE(t.children[jt],e,s,i)}}function Jh(t,e,n){return e.every((i,r)=>NE[n](t[r].parameters,i.parameters))}class Ko{constructor(e,n,i){this.root=e,this.queryParams=n,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=d0(this.queryParams)),this._queryParamMap}toString(){return Nq.serialize(this)}}class Kt{constructor(e,n){this.segments=e,this.children=n,this.parent=null,ri(n,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Kh(this)}}class xl{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=d0(this.parameters)),this._parameterMap}toString(){return UE(this)}}function Qo(t,e){return t.length===e.length&&t.every((n,i)=>n.path===e[i].path)}class OE{}class kE{parse(e){const n=new Uq(e);return new Ko(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){const n=`/${Ml(e.root,!0)}`,i=function Iq(t){const e=Object.keys(t).map(n=>{const i=t[n];return Array.isArray(i)?i.map(r=>`${Qh(n)}=${Qh(r)}`).join("&"):`${Qh(n)}=${Qh(i)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${n}${i}${"string"==typeof e.fragment?`#${function Rq(t){return encodeURI(t)}(e.fragment)}`:""}`}}const Nq=new kE;function Kh(t){return t.segments.map(e=>UE(e)).join("/")}function Ml(t,e){if(!t.hasChildren())return Kh(t);if(e){const n=t.children[jt]?Ml(t.children[jt],!1):"",i=[];return ri(t.children,(r,s)=>{s!==jt&&i.push(`${s}:${Ml(r,!1)}`)}),i.length>0?`${n}(${i.join("//")})`:n}{const n=function Pq(t,e){let n=[];return ri(t.children,(i,r)=>{r===jt&&(n=n.concat(e(i,r)))}),ri(t.children,(i,r)=>{r!==jt&&(n=n.concat(e(i,r)))}),n}(t,(i,r)=>r===jt?[Ml(t.children[jt],!1)]:[`${r}:${Ml(i,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[jt]?`${Kh(t)}/${n[0]}`:`${Kh(t)}/(${n.join("//")})`}}function FE(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Qh(t){return FE(t).replace(/%3B/gi,";")}function Lm(t){return FE(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function eu(t){return decodeURIComponent(t)}function BE(t){return eu(t.replace(/\+/g,"%20"))}function UE(t){return`${Lm(t.path)}${function Hq(t){return Object.keys(t).map(e=>`;${Lm(e)}=${Lm(t[e])}`).join("")}(t.parameters)}`}const Vq=/^[^\/()?;=#]+/;function tu(t){const e=t.match(Vq);return e?e[0]:""}const Oq=/^[^=?&#]+/,Fq=/^[^&#]+/;class Uq{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Kt([],{}):new Kt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(i[jt]=new Kt(e,n)),i}parseSegment(){const e=tu(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new xl(eu(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const n=tu(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const r=tu(this.remaining);r&&(i=r,this.capture(i))}e[eu(n)]=eu(i)}parseQueryParam(e){const n=function kq(t){const e=t.match(Oq);return e?e[0]:""}(this.remaining);if(!n)return;this.capture(n);let i="";if(this.consumeOptional("=")){const a=function Bq(t){const e=t.match(Fq);return e?e[0]:""}(this.remaining);a&&(i=a,this.capture(i))}const r=BE(n),s=BE(i);if(e.hasOwnProperty(r)){let a=e[r];Array.isArray(a)||(a=[a],e[r]=a),a.push(s)}else e[r]=s}parseParens(e){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=tu(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=jt);const a=this.parseChildren();n[s]=1===Object.keys(a).length?a[jt]:new Kt([],a),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class GE{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){const n=Dm(e,this._root);return n?n.children.map(i=>i.value):[]}firstChild(e){const n=Dm(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){const n=Pm(e,this._root);return n.length<2?[]:n[n.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Pm(e,this._root).map(n=>n.value)}}function Dm(t,e){if(t===e.value)return e;for(const n of e.children){const i=Dm(t,n);if(i)return i}return null}function Pm(t,e){if(t===e.value)return[e];for(const n of e.children){const i=Pm(t,n);if(i.length)return i.unshift(e),i}return[]}class Vs{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}}function p0(t){const e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}class WE extends GE{constructor(e,n){super(e),this.snapshot=n,Nm(this,e)}toString(){return this.snapshot.toString()}}function jE(t,e){const n=function Gq(t,e){const a=new nu([],{},{},"",{},jt,e,null,t.root,-1,{});return new ZE("",new Vs(a,[]))}(t,e),i=new br([new xl("",{})]),r=new br({}),s=new br({}),a=new br({}),o=new br(""),c=new Da(i,r,a,o,s,jt,e,n.root);return c.snapshot=n.root,new WE(new Vs(c,[]),n)}class Da{constructor(e,n,i,r,s,a,o,c){this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=a,this.component=o,this._futureSnapshot=c}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Et(e=>d0(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Et(e=>d0(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function qE(t,e="emptyOnly"){const n=t.pathFromRoot;let i=0;if("always"!==e)for(i=n.length-1;i>=1;){const r=n[i],s=n[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function Wq(t){return t.reduce((e,n)=>({params:Object.assign(Object.assign({},e.params),n.params),data:Object.assign(Object.assign({},e.data),n.data),resolve:Object.assign(Object.assign({},e.resolve),n._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(i))}class nu{constructor(e,n,i,r,s,a,o,c,l,u,f){this.url=e,this.params=n,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=a,this.component=o,this.routeConfig=c,this._urlSegment=l,this._lastPathIndex=u,this._resolve=f}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=d0(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=d0(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ZE extends GE{constructor(e,n){super(n),this.url=e,Nm(this,n)}toString(){return $E(this._root)}}function Nm(t,e){e.value._routerState=t,e.children.forEach(n=>Nm(t,n))}function $E(t){const e=t.children.length>0?` { ${t.children.map($E).join(", ")} } `:"";return`${t.value}${e}`}function Rm(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,as(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),as(e.params,n.params)||t.params.next(n.params),function Eq(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!as(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),as(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Hm(t,e){const n=as(t.params,e.params)&&function Dq(t,e){return Qo(t,e)&&t.every((n,i)=>as(n.parameters,e[i].parameters))}(t.url,e.url);return n&&!(!t.parent!=!e.parent)&&(!t.parent||Hm(t.parent,e.parent))}function bl(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=e.value;const r=function qq(t,e,n){return e.children.map(i=>{for(const r of n.children)if(t.shouldReuseRoute(i.value,r.value.snapshot))return bl(t,i,r);return bl(t,i)})}(t,e,n);return new Vs(i,r)}{if(t.shouldAttach(e.value)){const s=t.retrieve(e.value);if(null!==s){const a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(o=>bl(t,o)),a}}const i=function Zq(t){return new Da(new br(t.url),new br(t.params),new br(t.queryParams),new br(t.fragment),new br(t.data),t.outlet,t.component,t)}(e.value),r=e.children.map(s=>bl(t,s));return new Vs(i,r)}}function iu(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function wl(t){return"object"==typeof t&&null!=t&&t.outlets}function Im(t,e,n,i,r){let s={};return i&&ri(i,(a,o)=>{s[o]=Array.isArray(a)?a.map(c=>`${c}`):`${a}`}),new Ko(n.root===t?e:XE(n.root,t,e),s,r)}function XE(t,e,n){const i={};return ri(t.children,(r,s)=>{i[s]=r===e?n:XE(r,e,n)}),new Kt(t.segments,i)}class YE{constructor(e,n,i){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=i,e&&i.length>0&&iu(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(wl);if(r&&r!==PE(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Vm{constructor(e,n,i){this.segmentGroup=e,this.processChildren=n,this.index=i}}function JE(t,e,n){if(t||(t=new Kt([],{})),0===t.segments.length&&t.hasChildren())return ru(t,e,n);const i=function Qq(t,e,n){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return s;const a=t.segments[r],o=n[i];if(wl(o))break;const c=`${o}`,l=i<n.length-1?n[i+1]:null;if(r>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!QE(c,l,a))return s;i+=2}else{if(!QE(c,{},a))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){const s=new Kt(t.segments.slice(0,i.pathIndex),{});return s.children[jt]=new Kt(t.segments.slice(i.pathIndex),t.children),ru(s,0,r)}return i.match&&0===r.length?new Kt(t.segments,{}):i.match&&!t.hasChildren()?Om(t,e,n):i.match?ru(t,0,r):Om(t,e,n)}function ru(t,e,n){if(0===n.length)return new Kt(t.segments,{});{const i=function Kq(t){return wl(t[0])?t[0].outlets:{[jt]:t}}(n),r={};return ri(i,(s,a)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[a]=JE(t.children[a],e,s))}),ri(t.children,(s,a)=>{void 0===i[a]&&(r[a]=s)}),new Kt(t.segments,r)}}function Om(t,e,n){const i=t.segments.slice(0,e);let r=0;for(;r<n.length;){const s=n[r];if(wl(s)){const c=eZ(s.outlets);return new Kt(i,c)}if(0===r&&iu(n[0])){i.push(new xl(t.segments[e].path,KE(n[0]))),r++;continue}const a=wl(s)?s.outlets[jt]:`${s}`,o=r<n.length-1?n[r+1]:null;a&&o&&iu(o)?(i.push(new xl(a,KE(o))),r+=2):(i.push(new xl(a,{})),r++)}return new Kt(i,{})}function eZ(t){const e={};return ri(t,(n,i)=>{"string"==typeof n&&(n=[n]),null!==n&&(e[i]=Om(new Kt([],{}),0,n))}),e}function KE(t){const e={};return ri(t,(n,i)=>e[i]=`${n}`),e}function QE(t,e,n){return t==n.path&&as(e,n.parameters)}class nZ{constructor(e,n,i,r){this.routeReuseStrategy=e,this.futureState=n,this.currState=i,this.forwardEvent=r}activate(e){const n=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,i,e),Rm(this.futureState.root),this.activateChildRoutes(n,i,e)}deactivateChildRoutes(e,n,i){const r=p0(n);e.children.forEach(s=>{const a=s.value.outlet;this.deactivateRoutes(s,r[a],i),delete r[a]}),ri(r,(s,a)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,n,i){const r=e.value,s=n?n.value:null;if(r===s)if(r.component){const a=i.getContext(r.outlet);a&&this.deactivateChildRoutes(e,n,a.children)}else this.deactivateChildRoutes(e,n,i);else s&&this.deactivateRouteAndItsChildren(n,i)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){const i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=p0(e);for(const a of Object.keys(s))this.deactivateRouteAndItsChildren(s[a],r);if(i&&i.outlet){const a=i.outlet.detach(),o=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:o})}}deactivateRouteAndOutlet(e,n){const i=n.getContext(e.value.outlet),r=i&&e.value.component?i.children:n,s=p0(e);for(const a of Object.keys(s))this.deactivateRouteAndItsChildren(s[a],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,n,i){const r=p0(n);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new bq(s.value.snapshot))}),e.children.length&&this.forwardEvent(new xq(e.value.snapshot))}activateRoutes(e,n,i){const r=e.value,s=n?n.value:null;if(Rm(r),r===s)if(r.component){const a=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,n,a.children)}else this.activateChildRoutes(e,n,i);else if(r.component){const a=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const o=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(o.contexts),a.attachRef=o.componentRef,a.route=o.route.value,a.outlet&&a.outlet.attach(o.componentRef,o.route.value),Rm(o.route.value),this.activateChildRoutes(e,null,a.children)}else{const o=function iZ(t){for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=o?o.module.componentFactoryResolver:null;a.attachRef=null,a.route=r,a.resolver=c,a.outlet&&a.outlet.activateWith(r,c),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,i)}}class km{constructor(e,n){this.routes=e,this.module=n}}function Pa(t){return"function"==typeof t}function e4(t){return t instanceof Ko}const Sl=Symbol("INITIAL_VALUE");function Cl(){return Yo(t=>rq(t.map(e=>e.pipe(Eo(1),function cq(...t){const e=Co(t);return Yt((n,i)=>{(e?Em(t,n,e):Em(t,n)).subscribe(i)})}(Sl)))).pipe(bE((e,n)=>{let i=!1;return n.reduce((r,s,a)=>r!==Sl?r:(s===Sl&&(i=!0),i||!1!==s&&a!==n.length-1&&!e4(s)?r:s),e)},Sl),Jo(e=>e!==Sl),Et(e=>e4(e)?e:!0===e),Eo(1)))}class lZ{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new El,this.attachRef=null}}class El{constructor(){this.contexts=new Map}onChildOutletCreated(e,n){const i=this.getOrCreateContext(e);i.outlet=n,this.contexts.set(e,i)}onChildOutletDestroyed(e){const n=this.getContext(e);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let n=this.getContext(e);return n||(n=new lZ,this.contexts.set(e,n)),n}getContext(e){return this.contexts.get(e)||null}}let Fm=(()=>{class t{constructor(n,i,r,s,a){this.parentContexts=n,this.location=i,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new l1,this.deactivateEvents=new l1,this.attachEvents=new l1,this.detachEvents=new l1,this.name=s||jt,n.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const n=this.parentContexts.getContext(this.name);n&&n.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=n;const a=(i=i||this.resolver).resolveComponentFactory(n._futureSnapshot.routeConfig.component),o=this.parentContexts.getOrCreateContext(this.name).children,c=new hZ(n,o,this.location.injector);this.activated=this.location.createComponent(a,this.location.length,c),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(n){return new(n||t)(He(El),He(M2),He(Zo),P6("name"),He(fl))},t.\u0275dir=$1({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),t})();class hZ{constructor(e,n,i){this.route=e,this.childContexts=n,this.parent=i}get(e,n){return e===Da?this.route:e===El?this.childContexts:this.parent.get(e,n)}}let ez=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=O1({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(n,i){1&n&&Vt(0,"router-outlet")},directives:[Fm],encapsulation:2}),t})();function tz(t,e=""){for(let n=0;n<t.length;n++){const i=t[n];uZ(i,fZ(e,i))}}function uZ(t,e){t.children&&tz(t.children,e)}function fZ(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function Bm(t){const e=t.children&&t.children.map(Bm),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==jt&&(n.component=ez),n}function Z2(t){return t.outlet||jt}function nz(t,e){const n=t.filter(i=>Z2(i)===e);return n.push(...t.filter(i=>Z2(i)!==e)),n}const iz={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function su(t,e,n){var i;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?Object.assign({},iz):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const s=(e.matcher||Cq)(n,t,e);if(!s)return Object.assign({},iz);const a={};ri(s.posParams,(c,l)=>{a[l]=c.path});const o=s.consumed.length>0?Object.assign(Object.assign({},a),s.consumed[s.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:s.consumed,lastChild:s.consumed.length,parameters:o,positionalParamSegments:null!==(i=s.posParams)&&void 0!==i?i:{}}}function au(t,e,n,i,r="corrected"){if(n.length>0&&function mZ(t,e,n){return n.some(i=>ou(t,e,i)&&Z2(i)!==jt)}(t,n,i)){const a=new Kt(e,function pZ(t,e,n,i){const r={};r[jt]=i,i._sourceSegment=t,i._segmentIndexShift=e.length;for(const s of n)if(""===s.path&&Z2(s)!==jt){const a=new Kt([],{});a._sourceSegment=t,a._segmentIndexShift=e.length,r[Z2(s)]=a}return r}(t,e,i,new Kt(n,t.children)));return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function gZ(t,e,n){return n.some(i=>ou(t,e,i))}(t,n,i)){const a=new Kt(t.segments,function dZ(t,e,n,i,r,s){const a={};for(const o of i)if(ou(t,n,o)&&!r[Z2(o)]){const c=new Kt([],{});c._sourceSegment=t,c._segmentIndexShift="legacy"===s?t.segments.length:e.length,a[Z2(o)]=c}return Object.assign(Object.assign({},r),a)}(t,e,n,i,t.children,r));return a._sourceSegment=t,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:n}}const s=new Kt(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}function ou(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function rz(t,e,n,i){return!!(Z2(t)===i||i!==jt&&ou(e,n,t))&&("**"===t.path||su(e,t,n).matched)}function sz(t,e,n){return 0===e.length&&!t.children[n]}class zl{constructor(e){this.segmentGroup=e||null}}class az{constructor(e){this.urlTree=e}}function cu(t){return new qt(e=>e.error(new zl(t)))}function oz(t){return new qt(e=>e.error(new az(t)))}function vZ(t){return new qt(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class xZ{constructor(e,n,i,r,s){this.configLoader=n,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(Ns)}apply(){const e=au(this.urlTree.root,[],[],this.config).segmentGroup,n=new Kt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,n,jt).pipe(Et(s=>this.createUrlTree(Um(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(La(s=>{if(s instanceof az)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof zl?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,jt).pipe(Et(r=>this.createUrlTree(Um(r),e.queryParams,e.fragment))).pipe(La(r=>{throw r instanceof zl?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,n,i){const r=e.segments.length>0?new Kt([],{[jt]:e}):e;return new Ko(r,n,i)}expandSegmentGroup(e,n,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,n,i).pipe(Et(s=>new Kt([],s))):this.expandSegment(e,i,n,i.segments,r,!0)}expandChildren(e,n,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return cn(r).pipe(yl(s=>{const a=i.children[s],o=nz(n,s);return this.expandSegmentGroup(e,o,a,s).pipe(Et(c=>({segment:c,outlet:s})))}),bE((s,a)=>(s[a.outlet]=a.segment,s),{}),function uq(t,e){const n=arguments.length>=2;return i=>i.pipe(t?Jo((r,s)=>t(r,s,i)):ms,zm(1),n?SE(e):wE(()=>new Yh))}())}expandSegment(e,n,i,r,s,a){return cn(i).pipe(yl(o=>this.expandSegmentAgainstRoute(e,n,i,o,r,s,a).pipe(La(l=>{if(l instanceof zl)return Ot(null);throw l}))),f0(o=>!!o),La((o,c)=>{if(o instanceof Yh||"EmptyError"===o.name){if(sz(n,r,s))return Ot(new Kt([],{}));throw new zl(n)}throw o}))}expandSegmentAgainstRoute(e,n,i,r,s,a,o){return rz(r,n,s,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,n,r,s,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,n,i,r,s,a):cu(n):cu(n)}expandSegmentAgainstRouteUsingRedirect(e,n,i,r,s,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,n,i,r,s,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?oz(s):this.lineralizeSegments(i,s).pipe(Z1(a=>{const o=new Kt(a,{});return this.expandSegment(e,o,n,a,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,n,i,r,s,a){const{matched:o,consumedSegments:c,lastChild:l,positionalParamSegments:u}=su(n,r,s);if(!o)return cu(n);const f=this.applyRedirectCommands(c,r.redirectTo,u);return r.redirectTo.startsWith("/")?oz(f):this.lineralizeSegments(r,f).pipe(Z1(d=>this.expandSegment(e,n,i,d.concat(s.slice(l)),a,!1)))}matchSegmentAgainstRoute(e,n,i,r,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?Ot(i._loadedConfig):this.configLoader.load(e.injector,i)).pipe(Et(d=>(i._loadedConfig=d,new Kt(r,{})))):Ot(new Kt(r,{}));const{matched:a,consumedSegments:o,lastChild:c}=su(n,i,r);if(!a)return cu(n);const l=r.slice(c);return this.getChildConfig(e,i,r).pipe(Z1(f=>{const d=f.module,m=f.routes,{segmentGroup:v,slicedSegments:_}=au(n,o,l,m),M=new Kt(v.segments,v.children);if(0===_.length&&M.hasChildren())return this.expandChildren(d,m,M).pipe(Et(b=>new Kt(o,b)));if(0===m.length&&0===_.length)return Ot(new Kt(o,{}));const y=Z2(i)===s;return this.expandSegment(d,M,m,_,y?jt:s,!0).pipe(Et(S=>new Kt(o.concat(S.segments),S.children)))}))}getChildConfig(e,n,i){return n.children?Ot(new km(n.children,e)):n.loadChildren?void 0!==n._loadedConfig?Ot(n._loadedConfig):this.runCanLoadGuards(e.injector,n,i).pipe(Z1(r=>r?this.configLoader.load(e.injector,n).pipe(Et(s=>(n._loadedConfig=s,s))):function yZ(t){return new qt(e=>e.error(Am(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(n))):Ot(new km([],e))}runCanLoadGuards(e,n,i){const r=n.canLoad;return r&&0!==r.length?Ot(r.map(a=>{const o=e.get(a);let c;if(function sZ(t){return t&&Pa(t.canLoad)}(o))c=o.canLoad(n,i);else{if(!Pa(o))throw new Error("Invalid CanLoad guard");c=o(n,i)}return os(c)})).pipe(Cl(),b2(a=>{if(!e4(a))return;const o=Am(`Redirecting to "${this.urlSerializer.serialize(a)}"`);throw o.url=a,o}),Et(a=>!0===a)):Ot(!0)}lineralizeSegments(e,n){let i=[],r=n.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Ot(i);if(r.numberOfChildren>1||!r.children[jt])return vZ(e.redirectTo);r=r.children[jt]}}applyRedirectCommands(e,n,i){return this.applyRedirectCreatreUrlTree(n,this.urlSerializer.parse(n),e,i)}applyRedirectCreatreUrlTree(e,n,i,r){const s=this.createSegmentGroup(e,n.root,i,r);return new Ko(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){const i={};return ri(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const o=r.substring(1);i[s]=n[o]}else i[s]=r}),i}createSegmentGroup(e,n,i,r){const s=this.createSegments(e,n.segments,i,r);let a={};return ri(n.children,(o,c)=>{a[c]=this.createSegmentGroup(e,o,i,r)}),new Kt(s,a)}createSegments(e,n,i,r){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,n,i){const r=i[n.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${n.path}'.`);return r}findOrReturn(e,n){let i=0;for(const r of n){if(r.path===e.path)return n.splice(i),r;i++}return e}}function Um(t){const e={};for(const i of Object.keys(t.children)){const s=Um(t.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function MZ(t){if(1===t.numberOfChildren&&t.children[jt]){const e=t.children[jt];return new Kt(t.segments.concat(e.segments),e.children)}return t}(new Kt(t.segments,e))}class cz{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class lu{constructor(e,n){this.component=e,this.route=n}}function wZ(t,e,n){const i=t._root;return Tl(i,e?e._root:null,n,[i.value])}function hu(t,e,n){const i=function CZ(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(e);return(i?i.module.injector:n).get(t)}function Tl(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=p0(e);return t.children.forEach(a=>{(function EZ(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,a=e?e.value:null,o=n?n.getContext(t.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){const c=function zZ(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Qo(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Qo(t.url,e.url)||!as(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Hm(t,e)||!as(t.queryParams,e.queryParams);default:return!Hm(t,e)}}(a,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new cz(i)):(s.data=a.data,s._resolvedData=a._resolvedData),Tl(t,e,s.component?o?o.children:null:n,i,r),c&&o&&o.outlet&&o.outlet.isActivated&&r.canDeactivateChecks.push(new lu(o.outlet.component,a))}else a&&Al(e,o,r),r.canActivateChecks.push(new cz(i)),Tl(t,null,s.component?o?o.children:null:n,i,r)})(a,s[a.value.outlet],n,i.concat([a.value]),r),delete s[a.value.outlet]}),ri(s,(a,o)=>Al(a,n.getContext(o),r)),r}function Al(t,e,n){const i=p0(t),r=t.value;ri(i,(s,a)=>{Al(s,r.component?e?e.children.getContext(a):null:e,n)}),n.canDeactivateChecks.push(new lu(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class IZ{}function lz(t){return new qt(e=>e.error(t))}class OZ{constructor(e,n,i,r,s,a){this.rootComponentType=e,this.config=n,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=a}recognize(){const e=au(this.urlTree.root,[],[],this.config.filter(a=>void 0===a.redirectTo),this.relativeLinkResolution).segmentGroup,n=this.processSegmentGroup(this.config,e,jt);if(null===n)return null;const i=new nu([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},jt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Vs(i,n),s=new ZE(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const n=e.value,i=qE(n,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,n):this.processSegment(e,n,n.segments,i)}processChildren(e,n){const i=[];for(const s of Object.keys(n.children)){const a=n.children[s],o=nz(e,s),c=this.processSegmentGroup(o,a,s);if(null===c)return null;i.push(...c)}const r=hz(i);return function kZ(t){t.sort((e,n)=>e.value.outlet===jt?-1:n.value.outlet===jt?1:e.value.outlet.localeCompare(n.value.outlet))}(r),r}processSegment(e,n,i,r){for(const s of e){const a=this.processSegmentAgainstRoute(s,n,i,r);if(null!==a)return a}return sz(n,i,r)?[]:null}processSegmentAgainstRoute(e,n,i,r){if(e.redirectTo||!rz(e,n,i,r))return null;let s,a=[],o=[];if("**"===e.path){const m=i.length>0?PE(i).parameters:{};s=new nu(i,m,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,dz(e),Z2(e),e.component,e,uz(n),fz(n)+i.length,pz(e))}else{const m=su(n,e,i);if(!m.matched)return null;a=m.consumedSegments,o=i.slice(m.lastChild),s=new nu(a,m.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,dz(e),Z2(e),e.component,e,uz(n),fz(n)+a.length,pz(e))}const c=function FZ(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(e),{segmentGroup:l,slicedSegments:u}=au(n,a,o,c.filter(m=>void 0===m.redirectTo),this.relativeLinkResolution);if(0===u.length&&l.hasChildren()){const m=this.processChildren(c,l);return null===m?null:[new Vs(s,m)]}if(0===c.length&&0===u.length)return[new Vs(s,[])];const f=Z2(e)===r,d=this.processSegment(c,l,u,f?jt:r);return null===d?null:[new Vs(s,d)]}}function BZ(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function hz(t){const e=[],n=new Set;for(const i of t){if(!BZ(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),n.add(r)):e.push(i)}for(const i of n){const r=hz(i.children);e.push(new Vs(i.value,r))}return e.filter(i=>!n.has(i))}function uz(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function fz(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function dz(t){return t.data||{}}function pz(t){return t.resolve||{}}function Gm(t){return Yo(e=>{const n=t(e);return n?cn(n).pipe(Et(()=>e)):Ot(e)})}class XZ extends class $Z{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}}{}const Wm=new o1("ROUTES");class mz{constructor(e,n,i,r){this.injector=e,this.compiler=n,this.onLoadStartListener=i,this.onLoadEndListener=r}load(e,n){if(n._loader$)return n._loader$;this.onLoadStartListener&&this.onLoadStartListener(n);const r=this.loadModuleFactory(n.loadChildren).pipe(Et(s=>{this.onLoadEndListener&&this.onLoadEndListener(n);const a=s.create(e);return new km(DE(a.injector.get(Wm,void 0,zt.Self|zt.Optional)).map(Bm),a)}),La(s=>{throw n._loader$=void 0,s}));return n._loader$=new oq(r,()=>new r1).pipe(ME()),n._loader$}loadModuleFactory(e){return os(e()).pipe(Z1(n=>n instanceof PS?Ot(n):cn(this.compiler.compileModuleAsync(n))))}}class JZ{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,n){return e}}function KZ(t){throw t}function QZ(t,e,n){return e.parse("/")}function gz(t,e){return Ot(null)}const e$={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},t$={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ki=(()=>{class t{constructor(n,i,r,s,a,o,c){this.rootComponentType=n,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=c,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new r1,this.errorHandler=KZ,this.malformedUriErrorHandler=QZ,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:gz,afterPreactivation:gz},this.urlHandlingStrategy=new JZ,this.routeReuseStrategy=new XZ,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(Ns),this.console=a.get(dC);const f=a.get(Y1);this.isNgZoneEnabled=f instanceof Y1&&Y1.isInAngularZone(),this.resetConfig(c),this.currentUrlTree=function zq(){return new Ko(new Kt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new mz(a,o,d=>this.triggerEvent(new EE(d)),d=>this.triggerEvent(new zE(d))),this.routerState=jE(this.currentUrlTree,this.rootComponentType),this.transitions=new br({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var n;return null===(n=this.location.getState())||void 0===n?void 0:n.\u0275routerPageId}setupNavigations(n){const i=this.events;return n.pipe(Jo(r=>0!==r.id),Et(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Yo(r=>{let s=!1,a=!1;return Ot(r).pipe(b2(o=>{this.currentNavigation={id:o.id,initialUrl:o.currentRawUrl,extractedUrl:o.extractedUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Yo(o=>{const c=this.browserUrlTree.toString(),l=!this.navigated||o.extractedUrl.toString()!==c||c!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||l)&&this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return uu(o.source)&&(this.browserUrlTree=o.extractedUrl),Ot(o).pipe(Yo(f=>{const d=this.transitions.getValue();return i.next(new Tm(f.id,this.serializeUrl(f.extractedUrl),f.source,f.restoredState)),d!==this.transitions.getValue()?f2:Promise.resolve(f)}),function bZ(t,e,n,i){return Yo(r=>function _Z(t,e,n,i,r){return new xZ(t,e,n,i,r).apply()}(t,e,n,r.extractedUrl,i).pipe(Et(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),b2(f=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:f.urlAfterRedirects})}),function UZ(t,e,n,i,r){return Z1(s=>function VZ(t,e,n,i,r="emptyOnly",s="legacy"){try{const a=new OZ(t,e,n,i,r,s).recognize();return null===a?lz(new IZ):Ot(a)}catch(a){return lz(a)}}(t,e,s.urlAfterRedirects,n(s.urlAfterRedirects),i,r).pipe(Et(a=>Object.assign(Object.assign({},s),{targetSnapshot:a}))))}(this.rootComponentType,this.config,f=>this.serializeUrl(f),this.paramsInheritanceStrategy,this.relativeLinkResolution),b2(f=>{if("eager"===this.urlUpdateStrategy){if(!f.extras.skipLocationChange){const m=this.urlHandlingStrategy.merge(f.urlAfterRedirects,f.rawUrl);this.setBrowserUrl(m,f)}this.browserUrlTree=f.urlAfterRedirects}const d=new pq(f.id,this.serializeUrl(f.extractedUrl),this.serializeUrl(f.urlAfterRedirects),f.targetSnapshot);i.next(d)}));if(l&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:d,extractedUrl:m,source:v,restoredState:_,extras:M}=o,y=new Tm(d,this.serializeUrl(m),v,_);i.next(y);const g=jE(m,this.rootComponentType).snapshot;return Ot(Object.assign(Object.assign({},o),{targetSnapshot:g,urlAfterRedirects:m,extras:Object.assign(Object.assign({},M),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=o.rawUrl,o.resolve(null),f2}),Gm(o=>{const{targetSnapshot:c,id:l,extractedUrl:u,rawUrl:f,extras:{skipLocationChange:d,replaceUrl:m}}=o;return this.hooks.beforePreactivation(c,{navigationId:l,appliedUrlTree:u,rawUrlTree:f,skipLocationChange:!!d,replaceUrl:!!m})}),b2(o=>{const c=new mq(o.id,this.serializeUrl(o.extractedUrl),this.serializeUrl(o.urlAfterRedirects),o.targetSnapshot);this.triggerEvent(c)}),Et(o=>Object.assign(Object.assign({},o),{guards:wZ(o.targetSnapshot,o.currentSnapshot,this.rootContexts)})),function TZ(t,e){return Z1(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:a}}=n;return 0===a.length&&0===s.length?Ot(Object.assign(Object.assign({},n),{guardsResult:!0})):function AZ(t,e,n,i){return cn(t).pipe(Z1(r=>function HZ(t,e,n,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Ot(s.map(o=>{const c=hu(o,e,r);let l;if(function cZ(t){return t&&Pa(t.canDeactivate)}(c))l=os(c.canDeactivate(t,e,n,i));else{if(!Pa(c))throw new Error("Invalid CanDeactivate guard");l=os(c(t,e,n,i))}return l.pipe(f0())})).pipe(Cl()):Ot(!0)}(r.component,r.route,n,e,i)),f0(r=>!0!==r,!0))}(a,i,r,t).pipe(Z1(o=>o&&function rZ(t){return"boolean"==typeof t}(o)?function LZ(t,e,n,i){return cn(e).pipe(yl(r=>Em(function PZ(t,e){return null!==t&&e&&e(new _q(t)),Ot(!0)}(r.route.parent,i),function DZ(t,e){return null!==t&&e&&e(new Mq(t)),Ot(!0)}(r.route,i),function RZ(t,e,n){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>function SZ(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(a)).filter(a=>null!==a).map(a=>xE(()=>Ot(a.guards.map(c=>{const l=hu(c,a.node,n);let u;if(function oZ(t){return t&&Pa(t.canActivateChild)}(l))u=os(l.canActivateChild(i,t));else{if(!Pa(l))throw new Error("Invalid CanActivateChild guard");u=os(l(i,t))}return u.pipe(f0())})).pipe(Cl())));return Ot(s).pipe(Cl())}(t,r.path,n),function NZ(t,e,n){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Ot(!0);const r=i.map(s=>xE(()=>{const a=hu(s,e,n);let o;if(function aZ(t){return t&&Pa(t.canActivate)}(a))o=os(a.canActivate(e,t));else{if(!Pa(a))throw new Error("Invalid CanActivate guard");o=os(a(e,t))}return o.pipe(f0())}));return Ot(r).pipe(Cl())}(t,r.route,n))),f0(r=>!0!==r,!0))}(i,s,t,e):Ot(o)),Et(o=>Object.assign(Object.assign({},n),{guardsResult:o})))})}(this.ngModule.injector,o=>this.triggerEvent(o)),b2(o=>{if(e4(o.guardsResult)){const l=Am(`Redirecting to "${this.serializeUrl(o.guardsResult)}"`);throw l.url=o.guardsResult,l}const c=new gq(o.id,this.serializeUrl(o.extractedUrl),this.serializeUrl(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.triggerEvent(c)}),Jo(o=>!!o.guardsResult||(this.restoreHistory(o),this.cancelNavigationTransition(o,""),!1)),Gm(o=>{if(o.guards.canActivateChecks.length)return Ot(o).pipe(b2(c=>{const l=new vq(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(l)}),Yo(c=>{let l=!1;return Ot(c).pipe(function GZ(t,e){return Z1(n=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=n;if(!r.length)return Ot(n);let s=0;return cn(r).pipe(yl(a=>function WZ(t,e,n,i){return function jZ(t,e,n,i){const r=Object.keys(t);if(0===r.length)return Ot({});const s={};return cn(r).pipe(Z1(a=>function qZ(t,e,n,i){const r=hu(t,e,i);return os(r.resolve?r.resolve(e,n):r(e,n))}(t[a],e,n,i).pipe(b2(o=>{s[a]=o}))),zm(1),Z1(()=>Object.keys(s).length===r.length?Ot(s):f2))}(t._resolve,t,e,i).pipe(Et(s=>(t._resolvedData=s,t.data=Object.assign(Object.assign({},t.data),qE(t,n).resolve),null)))}(a.route,i,t,e)),b2(()=>s++),zm(1),Z1(a=>s===r.length?Ot(n):f2))})}(this.paramsInheritanceStrategy,this.ngModule.injector),b2({next:()=>l=!0,complete:()=>{l||(this.restoreHistory(c),this.cancelNavigationTransition(c,"At least one route resolver didn't emit any value."))}}))}),b2(c=>{const l=new yq(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(l)}))}),Gm(o=>{const{targetSnapshot:c,id:l,extractedUrl:u,rawUrl:f,extras:{skipLocationChange:d,replaceUrl:m}}=o;return this.hooks.afterPreactivation(c,{navigationId:l,appliedUrlTree:u,rawUrlTree:f,skipLocationChange:!!d,replaceUrl:!!m})}),Et(o=>{const c=function jq(t,e,n){const i=bl(t,e._root,n?n._root:void 0);return new WE(i,e)}(this.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return Object.assign(Object.assign({},o),{targetRouterState:c})}),b2(o=>{this.currentUrlTree=o.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(o.urlAfterRedirects,o.rawUrl),this.routerState=o.targetRouterState,"deferred"===this.urlUpdateStrategy&&(o.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,o),this.browserUrlTree=o.urlAfterRedirects)}),((t,e,n)=>Et(i=>(new nZ(e,i.targetRouterState,i.currentRouterState,n).activate(t),i)))(this.rootContexts,this.routeReuseStrategy,o=>this.triggerEvent(o)),b2({next(){s=!0},complete(){s=!0}}),function fq(t){return Yt((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}(()=>{var o;s||a||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(o=this.currentNavigation)||void 0===o?void 0:o.id)===r.id&&(this.currentNavigation=null)}),La(o=>{if(a=!0,function Sq(t){return t&&t[AE]}(o)){const c=e4(o.url);c||(this.navigated=!0,this.restoreHistory(r,!0));const l=new CE(r.id,this.serializeUrl(r.extractedUrl),o.message);i.next(l),c?setTimeout(()=>{const u=this.urlHandlingStrategy.merge(o.url,this.rawUrlTree),f={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||uu(r.source)};this.scheduleNavigation(u,"imperative",null,f,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const c=new dq(r.id,this.serializeUrl(r.extractedUrl),o);i.next(c);try{r.resolve(this.errorHandler(o))}catch(l){r.reject(l)}}return f2}))}))}resetRootComponentType(n){this.rootComponentType=n,this.routerState.root.component=this.rootComponentType}setTransition(n){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),n))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var r;const s={replaceUrl:!0},a=(null===(r=n.state)||void 0===r?void 0:r.navigationId)?n.state:null;if(a){const c=Object.assign({},a);delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const o=this.parseUrl(n.url);this.scheduleNavigation(o,i,a,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(n){this.events.next(n)}resetConfig(n){tz(n),this.config=n.map(Bm),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:r,queryParams:s,fragment:a,queryParamsHandling:o,preserveFragment:c}=i,l=r||this.routerState.root,u=c?this.currentUrlTree.fragment:a;let f=null;switch(o){case"merge":f=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=s||null}return null!==f&&(f=this.removeEmptyProps(f)),function $q(t,e,n,i,r){if(0===n.length)return Im(e.root,e.root,e,i,r);const s=function Xq(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new YE(!0,0,t);let e=0,n=!1;const i=t.reduce((r,s,a)=>{if("object"==typeof s&&null!=s){if(s.outlets){const o={};return ri(s.outlets,(c,l)=>{o[l]="string"==typeof c?c.split("/"):c}),[...r,{outlets:o}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===a?(s.split("/").forEach((o,c)=>{0==c&&"."===o||(0==c&&""===o?n=!0:".."===o?e++:""!=o&&r.push(o))}),r):[...r,s]},[]);return new YE(n,e,i)}(n);if(s.toRoot())return Im(e.root,new Kt([],{}),e,i,r);const a=function Yq(t,e,n){if(t.isAbsolute)return new Vm(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const s=n.snapshot._urlSegment;return new Vm(s,s===e.root,0)}const i=iu(t.commands[0])?0:1;return function Jq(t,e,n){let i=t,r=e,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new Vm(i,!1,r-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,t.numberOfDoubleDots)}(s,e,t),o=a.processChildren?ru(a.segmentGroup,a.index,s.commands):JE(a.segmentGroup,a.index,s.commands);return Im(a.segmentGroup,o,e,i,r)}(l,this.currentUrlTree,n,f,null!=u?u:null)}navigateByUrl(n,i={skipLocationChange:!1}){const r=e4(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(n,i={skipLocationChange:!1}){return function n$(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,n)}return i}isActive(n,i){let r;if(r=!0===i?Object.assign({},e$):!1===i?Object.assign({},t$):i,e4(n))return RE(this.currentUrlTree,n,r);const s=this.parseUrl(n);return RE(this.currentUrlTree,s,r)}removeEmptyProps(n){return Object.keys(n).reduce((i,r)=>{const s=n[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(n=>{this.navigated=!0,this.lastSuccessfulId=n.id,this.currentPageId=n.targetPageId,this.events.next(new _l(n.id,this.serializeUrl(n.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,n.resolve(!0)},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}scheduleNavigation(n,i,r,s,a){var o,c,l;if(this.disposed)return Promise.resolve(!1);const u=this.transitions.value,f=uu(i)&&u&&!uu(u.source),d=u.rawUrl.toString()===n.toString(),m=u.id===(null===(o=this.currentNavigation)||void 0===o?void 0:o.id);if(f&&d&&m)return Promise.resolve(!0);let _,M,y;a?(_=a.resolve,M=a.reject,y=a.promise):y=new Promise((b,E)=>{_=b,M=E});const g=++this.navigationId;let S;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),S=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(c=this.browserPageId)&&void 0!==c?c:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):S=0,this.setTransition({id:g,targetPageId:S,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:n,extras:s,resolve:_,reject:M,promise:y,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),y.catch(b=>Promise.reject(b))}setBrowserUrl(n,i){const r=this.urlSerializer.serialize(n),s=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(n,i=!1){var r,s;if("computed"===this.canceledNavigationResolution){const a=this.currentPageId-n.targetPageId;"popstate"!==n.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===a?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===a&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(a)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(n,i){const r=new CE(n.id,this.serializeUrl(n.extractedUrl),i);this.triggerEvent(r),n.resolve(!1)}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return t.\u0275fac=function(n){vp()},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();function uu(t){return"imperative"!==t}let fu=(()=>{class t{constructor(n,i,r,s,a){this.router=n,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=a,this.commands=null,this.onChanges=new r1,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){if(null!=this.tabIndexAttribute)return;const i=this.renderer,r=this.el.nativeElement;null!==n?i.setAttribute(r,"tabindex",n):i.removeAttribute(r,"tabindex")}ngOnChanges(n){this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const n={skipLocationChange:m0(this.skipLocationChange),replaceUrl:m0(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,n),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:m0(this.preserveFragment)})}}return t.\u0275fac=function(n){return new(n||t)(He(ki),He(Da),P6("tabindex"),He(ss),He(ii))},t.\u0275dir=$1({type:t,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(n,i){1&n&&c1("click",function(){return i.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[ni]}),t})(),du=(()=>{class t{constructor(n,i,r){this.router=n,this.route=i,this.locationStrategy=r,this.commands=null,this.href=null,this.onChanges=new r1,this.subscription=n.events.subscribe(s=>{s instanceof _l&&this.updateTargetUrlAndHref()})}set routerLink(n){this.commands=null!=n?Array.isArray(n)?n:[n]:null}ngOnChanges(n){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(n,i,r,s,a){if(0!==n||i||r||s||a||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;const o={skipLocationChange:m0(this.skipLocationChange),replaceUrl:m0(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,o),!1}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:m0(this.preserveFragment)})}}return t.\u0275fac=function(n){return new(n||t)(He(ki),He(Da),He(h0))},t.\u0275dir=$1({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(n,i){1&n&&c1("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&n&&ba("target",i.target)("href",i.href,nh)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[ni]}),t})();function m0(t){return""===t||!!t}class vz{}class yz{preload(e,n){return Ot(null)}}let _z=(()=>{class t{constructor(n,i,r,s){this.router=n,this.injector=r,this.preloadingStrategy=s,this.loader=new mz(r,i,c=>n.triggerEvent(new EE(c)),c=>n.triggerEvent(new zE(c)))}setUpPreloading(){this.subscription=this.router.events.pipe(Jo(n=>n instanceof _l),yl(()=>this.preload())).subscribe(()=>{})}preload(){const n=this.injector.get(Ns);return this.processRoutes(n,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const r=[];for(const s of i)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const a=s._loadedConfig;r.push(this.processRoutes(a.module,a.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(n,s)):s.children&&r.push(this.processRoutes(n,s.children));return cn(r).pipe(ys(),Et(s=>{}))}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?Ot(i._loadedConfig):this.loader.load(n.injector,i)).pipe(Z1(s=>(i._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return t.\u0275fac=function(n){return new(n||t)(ot(ki),ot(Ph),ot(Dn),ot(vz))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})(),jm=(()=>{class t{constructor(n,i,r={}){this.router=n,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(n=>{n instanceof Tm?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof _l&&(this.lastId=n.id,this.scheduleScrollEvent(n,this.router.parseUrl(n.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(n=>{n instanceof TE&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.router.triggerEvent(new TE(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(n){vp()},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();const t4=new o1("ROUTER_CONFIGURATION"),xz=new o1("ROUTER_FORROOT_GUARD"),a$=[sm,{provide:OE,useClass:kE},{provide:ki,useFactory:function u$(t,e,n,i,r,s,a={},o,c){const l=new ki(null,t,e,n,i,r,DE(s));return o&&(l.urlHandlingStrategy=o),c&&(l.routeReuseStrategy=c),function f$(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy),t.canceledNavigationResolution&&(e.canceledNavigationResolution=t.canceledNavigationResolution)}(a,l),a.enableTracing&&l.events.subscribe(u=>{var f,d;null===(f=console.group)||void 0===f||f.call(console,`Router Event: ${u.constructor.name}`),console.log(u.toString()),console.log(u),null===(d=console.groupEnd)||void 0===d||d.call(console)}),l},deps:[OE,El,sm,Dn,Ph,Wm,t4,[class YZ{},new Jr],[class ZZ{},new Jr]]},El,{provide:Da,useFactory:function d$(t){return t.routerState.root},deps:[ki]},_z,yz,class s${preload(e,n){return n().pipe(La(()=>Ot(null)))}},{provide:t4,useValue:{enableTracing:!1}}];function o$(){return new _C("Router",ki)}let Mz=(()=>{class t{constructor(n,i){}static forRoot(n,i){return{ngModule:t,providers:[a$,bz(n),{provide:xz,useFactory:h$,deps:[[ki,new Jr,new A3]]},{provide:t4,useValue:i||{}},{provide:h0,useFactory:l$,deps:[Xo,[new k6(rm),new Jr],t4]},{provide:jm,useFactory:c$,deps:[ki,uj,t4]},{provide:vz,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:yz},{provide:_C,multi:!0,useFactory:o$},[qm,{provide:Lh,multi:!0,useFactory:p$,deps:[qm]},{provide:wz,useFactory:m$,deps:[qm]},{provide:fC,multi:!0,useExisting:wz}]]}}static forChild(n){return{ngModule:t,providers:[bz(n)]}}}return t.\u0275fac=function(n){return new(n||t)(ot(xz,8),ot(ki,8))},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({}),t})();function c$(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new jm(t,e,n)}function l$(t,e,n={}){return n.useHash?new qG(t,e):new BC(t,e)}function h$(t){return"guarded"}function bz(t){return[{provide:CI,multi:!0,useValue:t},{provide:Wm,multi:!0,useValue:t}]}let qm=(()=>{class t{constructor(n){this.injector=n,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new r1}appInitializer(){return this.injector.get(GG,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(o=>i=o),s=this.injector.get(ki),a=this.injector.get(t4);return"disabled"===a.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabled"===a.initialNavigation||"enabledBlocking"===a.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?Ot(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),r})}bootstrapListener(n){const i=this.injector.get(t4),r=this.injector.get(_z),s=this.injector.get(jm),a=this.injector.get(ki),o=this.injector.get(c0);n===o.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&a.initialNavigation(),r.setUpPreloading(),s.init(),a.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return t.\u0275fac=function(n){return new(n||t)(ot(Dn))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();function p$(t){return t.appInitializer.bind(t)}function m$(t){return t.bootstrapListener.bind(t)}const wz=new o1("Router Initializer");class Zm{constructor(e,n,i,r,s=""){this.id=e,this.x=n,this.y=i,this.type=r,this.link=s}}var Mi=(()=>{return(t=Mi||(Mi={}))[t.WAYPOINT=0]="WAYPOINT",t[t.TREE=1]="TREE",t[t.SPINNING=2]="SPINNING",t[t.LIGHTUP=3]="LIGHTUP",t[t.SEVEN=4]="SEVEN",t[t.BROKEN=5]="BROKEN",Mi;var t})();const v$=JSON.parse('[{"id":"x18601","x":1851.5,"y":9015},{"id":"x18599","x":1860.5,"y":8821},{"id":"x18593","x":1864,"y":8536},{"id":"x18591","x":1801.5000305175781,"y":8323},{"id":"x18589","x":2092,"y":8610.5},{"id":"x18587","x":2055.99,"y":8365},{"id":"x18586","x":2355.5,"y":8594.99},{"id":"x16030","x":3447,"y":6569.5},{"id":"x16029","x":3699.5,"y":6610},{"id":"x16027","x":3444,"y":6712.5},{"id":"x16026","x":3149.5,"y":6721.5},{"id":"x16024","x":3422,"y":6896.5},{"id":"x16020","x":3730.69,"y":6909.8},{"id":"x16018","x":3505.5,"y":7113},{"id":"x16014","x":2932.5,"y":6606},{"id":"x16012","x":2953,"y":7013.5},{"id":"x15951","x":573,"y":6100.5},{"id":"x15947","x":312.5,"y":6270},{"id":"x15944","x":19.5,"y":5886.5},{"id":"x15942","x":17.5,"y":6118.5},{"id":"x15940","x":9.5,"y":6325},{"id":"x13670","x":2654.5,"y":5883.5},{"id":"x13669","x":2490.5,"y":5492.5},{"id":"x13652","x":2888,"y":4854},{"id":"x13429","x":2692.5,"y":5640.68},{"id":"x12746","x":3379,"y":4087},{"id":"x12742","x":3603,"y":4486.75},{"id":"x12738","x":3840,"y":4910.5},{"id":"x12735","x":3476.5,"y":4725.5},{"id":"x12733","x":3634.094,"y":4823.2},{"id":"x12731","x":3065.5,"y":4874.5},{"id":"x12729","x":3296,"y":4992.5},{"id":"x12728","x":3376.6,"y":5084.59},{"id":"x12726","x":3684,"y":5125},{"id":"x12725","x":3473.5,"y":5326.5},{"id":"x12724","x":3658,"y":5383.5},{"id":"x12722","x":3748,"y":5544},{"id":"x12720","x":2735,"y":6079},{"id":"x12719","x":2544.5,"y":5973},{"id":"x12718","x":2266.5,"y":5951},{"id":"x12717","x":1990,"y":5742},{"id":"x12716","x":1794,"y":5864},{"id":"x12715","x":2411.5,"y":6211.5},{"id":"x12714","x":1658.1,"y":6252.09},{"id":"x12711","x":1642,"y":6454.5},{"id":"x12704","x":1445,"y":5810.5},{"id":"x12696","x":1219.5,"y":5895.5},{"id":"x6609","x":46,"y":1295},{"id":"x6608","x":-42,"y":1406},{"id":"x6606","x":-260.5,"y":1472},{"id":"x6604","x":587.5,"y":1497.5},{"id":"x6603","x":265.5,"y":1302},{"id":"x6601","x":265,"y":991.5},{"id":"x6600","x":260,"y":1473},{"id":"x6599","x":-337.5,"y":1171.5},{"id":"x6596","x":-192,"y":1093},{"id":"x6594","x":96.5,"y":1059},{"id":"x6540","x":-174.5,"y":869},{"id":"x6538","x":389,"y":732},{"id":"x1748","x":-1473,"y":1263},{"id":"x937","x":-1119.5,"y":2844},{"id":"x343","x":-1083,"y":1790.5},{"id":"x119","x":-1860.5,"y":1155.5},{"id":"x118","x":-2352.5,"y":1301.5},{"id":"x116","x":-545.1,"y":459.3},{"id":"x111","x":-1272.5,"y":2953},{"id":"x110","x":-1582.5,"y":2087.5},{"id":"x109","x":-1897.5,"y":2191.5},{"id":"x108","x":-2014,"y":2396.5},{"id":"x106","x":-1784,"y":2890.5},{"id":"x105","x":-1574,"y":2918},{"id":"x104","x":-1017,"y":2996.5},{"id":"x101","x":-1235.5,"y":2106.5},{"id":"x100","x":-805,"y":2196.5},{"id":"x96","x":-772.5,"y":2449},{"id":"x94","x":-1039,"y":2573.5},{"id":"x92","x":-1358,"y":2612.5},{"id":"x57","x":128.5,"y":55},{"id":"x55","x":2.5,"y":70.5},{"id":"x54","x":-76.5,"y":2418.5},{"id":"x53","x":-269,"y":1890},{"id":"x52","x":-697.5,"y":1672},{"id":"x51","x":-1080.5,"y":1456},{"id":"x50","x":-592.5,"y":1151},{"id":"x49","x":-1461.5,"y":3100},{"id":"x48","x":-1870,"y":3324},{"id":"x47","x":-2413.5,"y":1943.5},{"id":"x46","x":-2134,"y":1821.5},{"id":"x45","x":-2549,"y":1619},{"id":"x44","x":-1796,"y":1393},{"id":"x43","x":-1644.5,"y":1749.5},{"id":"x42","x":-1930.5,"y":1710},{"id":"x40","x":-2181.5,"y":1498},{"id":"x39","x":-2195.5,"y":1302},{"id":"x38","x":-2028.5,"y":761},{"id":"x37","x":-1554.5,"y":548},{"id":"x36","x":-1594,"y":793},{"id":"x34","x":-547,"y":1390},{"id":"x32","x":-1229,"y":894},{"id":"x31","x":-1289,"y":567},{"id":"x30","x":-949.5,"y":767},{"id":"x29","x":-1035,"y":665},{"id":"x28","x":-787,"y":-35.14},{"id":"x27","x":-1013,"y":-588.5},{"id":"x26","x":-1090,"y":-247.5},{"id":"x24","x":-871,"y":-318.55},{"id":"x23","x":-659,"y":-454.5},{"id":"x22","x":-313,"y":-251.5},{"id":"x21","x":-366,"y":45.69},{"id":"x20","x":-218,"y":158},{"id":"x18","x":689,"y":875.5},{"id":"x17","x":1254,"y":897.5},{"id":"x16","x":124.5,"y":340.5},{"id":"x15","x":780,"y":362.5},{"id":"x14","x":162,"y":540},{"id":"x10","x":889,"y":-483.5},{"id":"x9","x":891.5,"y":-352.5},{"id":"x8","x":521.5,"y":-392.5},{"id":"x7","x":756.5,"y":46.5},{"id":"x3","x":373.5,"y":145.5}]');var y$=Ve.t(v$,2);const _$=JSON.parse('[{"id":"x19254","x":2127.89,"y":8363.8,"count":"4","type":"LIGHT","camera":[0,1,4],"face":"S","ortho":9,"description":"This puzzle is hidden, you need the Peculiar Pinion Feather Gadget to reveal it.","connection":[[1,3],[0,2],[1],[0]],"direction":["2","3","3","1"],"position":[[-2.8,-1.85,-2],[-1,-0.6,-1],[2.4,-0.6,-2],[3.4,-1.85,-2]],"island":"tsur"},{"id":"x19238","x":2548,"y":8369.5,"island":"tsur"},{"id":"x18760","x":2450.5,"y":8433.5,"island":"tsur"},{"id":"x18758","x":2330,"y":8523.5,"island":"tsur"},{"id":"x18757","x":2143,"y":8373.5,"island":"tsur"},{"id":"x18756","x":1925.5,"y":8579.5,"island":"tsur"},{"id":"x18755","x":1728.4,"y":8635.43,"island":"tsur"},{"id":"x18754","x":1800.09,"y":8564.6,"island":"tsur"},{"id":"x18705","x":1833,"y":8126,"island":"tsur"},{"id":"x18703","x":1824.19,"y":8113.5,"island":"tsur"},{"id":"x16779","x":2724.3940071973902,"y":6406.28,"count":"4","type":"LIGHT","camera":[0,1,4],"face":"E","description":"This puzzle is on two different islands, use the bush to jump betweem them.","connection":[[1,3],[0,2],[1,3],[3,0]],"direction":["1","1","2","2"],"position":[[-2.5,-2.25,-1],[-4.25,3.25,-1],[3.5,2,-1],[2.75,-2.45,-1]],"island":"seir"},{"id":"x16786","x":3439.5,"y":7177,"count":"4","type":"LIGHT","camera":[0,1,4],"face":"N","description":"This puzzle is on the ground outside of Amakumo Peak. There are 4 specters nearby.","connection":[[1],[0,2],[1,3],[2]],"direction":["1","2","3","1"],"position":[[-4.5,-1,-1],[-0.8,0,-1],[2,0,-1],[5,0,-1]],"island":"seir"},{"id":"x16787","x":3374,"y":7174,"count":"4","type":"SPIN","camera":[0,2.75,4],"face":"E","description":"This puzzle is located on the beach.","connection":[[0],[1],[2],[]],"direction":["S","N","E","W"],"edit":[true,true,true,false],"position":[[-3,0,-0.45],[-0.15,1.55,0],[2.75,-0.25,-0.75],[-0.15,0,0.5]],"island":"seir"},{"id":"x16790","x":3254,"y":6950,"count":"5","face":"S","type":"SPIN","camera":[0,2.75,4],"description":"This puzzle is located on a small island.  Watch out for the nearby enemies.","connection":[[0],[0],[1,3],[4],[4]],"direction":["N","W","N","W","N"],"position":[[-5,0,-0.45],[-3,0,-2],[-0.45,0.25,-2.5],[2.45,0,-2],[5.65,-0.45,-0.45]],"island":"seir"},{"id":"x16793","x":3128.5,"y":6874,"count":"5","face":"E","type":"SPIN","camera":[-0.25,2.75,4],"description":"This puzzle is located on a small island near the cats.  Most of the pieces are independent.","connection":[[0],[1],[2],[4],[0]],"direction":["N","N","N","E","S"],"position":[[-1.85,1.4,-1.25],[-1.85,0,-1.25],[-1.85,-1.65,-1.25],[-0.25,-1.65,-1.25],[1.5,-1.65,-1.25]],"island":"seir"},{"id":"x16803","x":3560.5,"y":6606.5,"count":"3","type":"LIGHT","camera":[0,1,4],"ortho":9,"face":"W","description":"This puzzle is east of the teleporter up on a hill.","connection":[[2],[2],[0,1]],"direction":["3","1","2"],"position":[[-2,1.65,-1],[0.05,-0.35,-1],[2.5,0.85,-1]],"island":"seir"},{"id":"x16804","x":3398.5,"y":6594,"count":"4","type":"SPIN","camera":[0,2.25,4],"face":"E","description":"This puzzle is located west of the teleport point, up on the hill.","connection":[[0],[1],[1],[]],"direction":["E","W","W","N"],"edit":[true,true,true,false],"position":[[-7,0,-2],[5.5,3,-5],[2,0,-0.25],[4.5,2,-1]],"island":"seir"},{"id":"x17287","x":3217.55,"y":6684.07,"count":"3","face":"S","camera":[-0.25,2,3],"type":"SPIN","description":"This puzzle is located north of the destroyed village.","connection":[[0],[],[2]],"direction":["N","E","S"],"position":[[-2.85,0,-2],[-0.15,-0.25,-2],[3.25,-0.25,-2]],"edit":[true,false,true],"island":"seir"},{"id":"x17364","x":201,"y":5992,"island":"wata"},{"id":"x16370","x":513,"y":6092,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"N","ortho":12,"description":"This puzzle is located just west of the Teleporter.","connection":[[1],[0,2],[1]],"direction":["3","2","1"],"position":[[-4.2,-0.1,-1],[0.1,0.9,-1],[4.8,2.35,-1]],"island":"wata"},{"id":"x16440","x":284,"y":6101.5,"island":"wata"},{"id":"x16432","x":156.5,"y":6149.5,"island":"wata"},{"id":"x16346","x":115,"y":5908,"count":"5","type":"SPIN","camera":[0,2.15,6],"face":"S","description":"This puzzle is located east of the teleporter and it is all over the place.  No chest, it unlocks a little island so you can grab the Electroculus.","connection":[[0],[],[],[3],[4]],"direction":["W","S","S","N","E"],"position":[[-3,-3,2],[-1,-3,2],[1,-3,2],[3,-3,2],[3,-1.5,2]],"edit":[true,false,false,true,true],"island":"wata"},{"id":"x16380","x":-196.5,"y":6126.5,"count":"4","type":"SPIN","camera":[1,2.15,2],"face":"N","description":"This puzzle is located north statue of the seven up on a hill.  No chest, it unlocks another puzzle element.  Just make every cube face in-ward","connection":[[0],[1],[2],[3]],"direction":["S","S","E","W"],"forced":["N","E","S","W"],"position":[[-1,-1,0.55],[-4.5,0.5,-3],[-1.5,-1,-7],[3.75,-1.5,-3]],"island":"wata"},{"id":"x16384","x":-103.5,"y":6172.5,"count":"4","type":"SPIN","camera":[-3,4.15,4],"face":"E","description":"This puzzle is loacted at the bottom.  Use the bush to enter the bubble and cancel the shield.","connection":[[0],[1],[2],[3]],"direction":["N","E","E","E"],"position":[[-4.5,-3,-2.55],[0,3,-6],[7,2,-2],[3,-1.5,4]],"island":"wata"},{"id":"x16415","x":67,"y":6381,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"W","ortho":8,"description":"This puzzle is located just south of the Bourou Village.","connection":[[1],[0,2],[1]],"direction":["3","2","1"],"position":[[-1.7,-0.7,-1],[-0.5,1,-1],[2.95,0.75,-1]],"island":"wata"},{"id":"x16444","x":320,"y":6233.5,"count":"8","type":"SPIN","camera":[-0.15,3.15,2],"face":"N","description":"This part 1 of 3 of a puzzle.  After solving it, log out/in to start the next one.  This is a special puzzle it only wants you hit the designated piece the right number of times.","connection":[[],[0,2],[],[2,4],[],[],[],[],[]],"direction":["E","W","W","E","N","S","S","W"],"position":[[-4.8,-2,0.8],[0,-2,0.8],[4.8,-2,1.4],[0.5,-2,-5],[6,-2,-5],[-4.15,-3,-10],[0.5,-1.5,-10],[5.5,-1.2,-10]],"edit":[false,false,false,false,false,false,false],"solution":[1,1,1,2,2,3,3,3,5],"island":"wata"},{"id":"x17357","x":339.5,"y":6233.5,"count":"8","type":"SPIN","camera":[-0.15,3.15,2.56],"face":"N","description":"This part 2 of 3 of a puzzle.  After solving it, log out/in to start the next one.  This is a special puzzle it only wants you hit the designated piece the right number of times.","connection":[[],[0,2],[],[2,4],[],[],[],[],[]],"direction":["W","S","E","S","S","E","N","E"],"position":[[-5.2,-2,0.4],[0.1,-1.5,0.8],[4.8,-2,1.25],[-5.5,-2.5,-5],[0.5,-1.75,-5],[5.8,-2,-5],[-4.15,-3,-10],[5.5,-1.4,-10]],"edit":[false,false,false,false,false,false,false],"solution":[6,6,6,5,4,4,1,1],"island":"wata"},{"id":"x17358","x":354.5,"y":6232.5,"count":"8","type":"SPIN","camera":[-0.15,3.15,2],"face":"N","description":"This part 3 of 3 of a puzzle.  This is a special puzzle it only wants you hit the designated piece the right number of times.","connection":[[],[0,2],[],[2,4],[],[],[],[],[]],"direction":["N","S","S","N","N","W","S","W"],"position":[[-4.8,-2,0.8],[0,-2,0.8],[4.8,-2,1.4],[0.5,-2,-5],[6,-2,-5],[-4.15,-3,-10],[0.5,-1.5,-10],[5.5,-1.2,-10]],"edit":[false,false,false,false,false,false,false],"solution":[5,5,7,7,2,0,0,0],"island":"wata"},{"id":"x14197","x":3666.5,"y":4710.5,"count":"5","type":"SPIN","camera":[0,1.15,2],"face":"N","description":"This puzzle is located north of the \'court of flowing sand\'.  Only the front two cubes can be hit.","connection":[[],[0,2],[],[2,4],[]],"direction":["S","S","E","S","S"],"position":[[-3.5,-1,-2],[-1.5,-0.25,-1],[0,-1,-2],[1.5,-0.25,-1],[3.5,-1,-2]],"island":"naru"},{"id":"x14196","x":3607,"y":4918,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"N","ortho":8,"description":"This puzzle is located just right of the Mt. Yougou text.","connection":[[1],[0,2],[1]],"direction":["1","2","3"],"position":[[-2.85,0.2,-1],[0.1,0.5,-1],[3.2,0.65,-1]],"island":"naru"},{"id":"x14193","x":3751,"y":5339,"count":"4","type":"LIGHT","camera":[0,1,4],"face":"S","ortho":8,"description":"This puzzle is located just north of Inazuma City, jump off the cliff and it is near the ocean.","connection":[[1],[0,2],[1,3],[2]],"direction":["1","2","3","1"],"position":[[-3.15,0.35,-1],[-1.1,0.5,-1],[0.85,0.55,-1],[3.2,0.35,-1]],"island":"naru"},{"id":"x14206","x":3346.5,"y":4988,"count":"3","type":"SPIN","camera":[0,0.95,2],"face":"E","ortho":9,"description":"This puzzle is located north-east of Konda Village.  The left cube is fixed.","connection":[[],[1],[2]],"direction":["W","E","S"],"position":[[-2.5,-0.1,-1],[0,-0.2,-1],[2.5,-0.7,-1]],"edit":[false,true,true],"island":"naru"},{"id":"x14204","x":3422,"y":5011.5,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"N","ortho":9,"description":"This puzzle is located east of Konda Village, in the river.  Watch out for the nearby enemies.","connection":[[1],[0,2],[1]],"direction":["2","2","3"],"position":[[-2.8,0.55,-2],[0.3,-0.1,-1],[2.4,0.45,-2]],"island":"naru"},{"id":"x14205","x":3471,"y":5144,"count":"3","type":"SPIN","camera":[0,0.95,2],"face":"E","ortho":9,"description":"This puzzle is located north-east of Byakko Plain.  The left cube is fixed.","connection":[[],[1],[2]],"direction":["W","E","E"],"position":[[-2.5,-0.1,-1],[0,-0.2,-1],[2.5,-0.7,-1]],"edit":[false,true,true],"island":"naru"},{"id":"x14203","x":3475,"y":4902,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"N","ortho":7,"description":"This puzzle is up on a mountain side south-west of Grand Narukami Shrine.","connection":[[1],[0,2],[1]],"direction":["1","2","3"],"position":[[-1.63,-0.68,-2],[0,-0.1,-1],[1.53,0.35,-2]],"island":"naru"},{"id":"x14202","x":3449,"y":4863,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"N","ortho":9,"description":"The center cube is hidden inside the breakable rock.","connection":[[1],[0,2],[1]],"direction":["1","2","3"],"position":[[-3.2,0.35,-2],[0.8,0.1,-1],[3,0.1,-2]],"island":"naru"},{"id":"x14201","x":3414,"y":4623,"count":"4","type":"LIGHT","camera":[0,1,4],"face":"N","ortho":9,"description":"These cubes are under the beach.","connection":[[1],[0,2],[1,3],[2]],"direction":["3","1","2","3"],"position":[[-3.2,-0.35,-2],[-1.2,0,-1],[0.9,0,-2],[3.35,-0.3,-2]],"island":"naru"},{"id":"x14030","x":3478,"y":4656,"count":"5","type":"SPIN","camera":[0,1.5,3],"face":"S","description":"This puzzle is located underground.  After you swim and go up a ramp, turn around.","connection":[[2],[0,2],[0,4],[2,4],[2]],"direction":["N","S","N","S","N"],"position":[[-4.5,-1,-2],[-2.25,-1,-2],[0,-1,-2],[2.25,-1,-2],[4.5,-1,-2]],"island":"naru"},{"id":"x14200","x":3489,"y":4650,"count":"5","type":"SPIN","camera":[0,0.25,2],"face":"W","description":"This puzzle need to be activated first.  Unsure what the bottom cubes do.","direction":["E","W","E","W","E"],"position":[[-2.5,-1,-1],[-2.5,1,-1],[0,1,-1],[2.5,1,-1],[2.5,-1,-1]],"island":"naru"},{"id":"x14198","x":3620,"y":4752,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"N","ortho":9,"description":"On the mountain side, the cube on the right is hidden inside a boulder.  Unsure what the middle cube does.","connection":[[1],[0,2],[1]],"direction":["2","3","1"],"position":[[-3.1,0,-2],[0.9,0.5,-1],[3.2,0.5,-2]],"island":"naru"},{"id":"x14194","x":3753.5,"y":4692,"count":"4","type":"LIGHT","camera":[0,1,4],"face":"N","ortho":9,"description":"On the north side of the island.","connection":[[1,3],[0,2],[1,3],[0,2]],"direction":["1","1","2","2"],"position":[[-3.1,0.65,-2],[-1.65,1.35,-1],[1.95,0.65,-2],[3.45,-0.45,-2]],"island":"naru"},{"id":"x14195","x":3646,"y":5048,"count":"5","type":"SPIN","camera":[0,0.25,3],"face":"E","description":"This puzzle is located north of the Chinju Forest.  Watch out for the mage ontop of the hill.","connection":[[1,2],[],[],[],[2,3]],"direction":["E","E","W","E","E"],"position":[[-5.5,0,-2],[-2.6,0.2,-2],[0,0.75,-2],[2.6,1,-2],[5.5,1.5,-2]],"island":"naru"},{"id":"x14199","x":3530,"y":4646,"count":"5","type":"SPIN","camera":[0,4,3.5],"face":"N","description":"This puzzle is located under the giant tree.  After you get inside, it is on the left side.","connection":[[1,3],[0,2],[1,3],[2,0],[]],"direction":["S","E","W","N","S"],"position":[[-3.5,0,1],[-3.5,1.15,-3],[3.5,1.15,-3],[4.5,0,1],[0,0,-2]],"edit":[true,true,true,true,false],"island":"naru"},{"id":"x14192","x":2691.5,"y":5539,"count":"5","type":"SPIN","camera":[-0.25,4,4.5],"face":"S","description":"This puzzle is located north of the Kujou Encampment, up on the hill.","connection":[[1,2],[],[],[],[3,2]],"direction":["N","N","W","N","N"],"position":[[-4.75,0,1],[-4.5,1.15,-3.5],[0.25,1.85,-3.5],[5.5,2.3,-4.5],[4.5,0,0.75]],"edit":[true,false,false,false,true],"island":"kann"},{"id":"x14191","x":2838.5,"y":5522.5,"count":"3","type":"SPIN","camera":[0,5,3.5],"face":"E","description":"This puzzle is located north-east of the Kujou Encampment, down near the beach.","connection":[[1],[0,2],[1]],"direction":["S","W","S"],"position":[[-4,1.5,0.6],[1.25,1.15,-3.5],[4,1.5,1]],"island":"kann"},{"id":"x14190","x":2959.5,"y":5695.5,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"W","ortho":9,"description":"Up on the hill.","connection":[[1],[0,2],[1]],"direction":["1","2","3"],"position":[[-2.87,1,-2],[0.1,0.75,-1],[2.8,0.05,-2]],"island":"kann"},{"id":"x14189","x":2220,"y":5679.5,"count":"4","type":"LIGHT","camera":[0,1,4],"face":"N","ortho":9,"description":"Part of another puzzle, on the water.","connection":[[1],[0,2],[1,3],[2]],"direction":["3","1","1","3"],"position":[[-3.17,0.5,-2],[-1.8,0.25,-1],[1.55,0.2,-2],[2.8,0.8,-2]],"island":"kann"},{"id":"x14189B","x":2220,"y":5720,"count":"3","type":"SPIN","camera":[0,3,3.5],"face":"W","description":"Part of a puzzle, on the water.  Remember to turn off the shield barrier first.","connection":[[0],[1],[2]],"direction":["W","S","E"],"position":[[-5.4,0.7,-2],[0,0.7,-2],[5.5,0.5,-2]],"island":"kann"},{"id":"x14188","x":2155,"y":5835.5,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"W","ortho":9,"description":"On a little island","connection":[[1],[0,2],[1]],"direction":["1","2","3"],"position":[[-2.37,0,-2],[0.76,0.25,-1],[2.75,0,-2]],"island":"kann"},{"id":"x14188","x":2155,"y":5835.5,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"W","ortho":9,"description":"On a little island","connection":[[1],[0,2],[1]],"direction":["1","2","3"],"position":[[-2.37,0,-2],[0.76,0.25,-1],[2.75,0,-2]],"island":"kann"},{"id":"x14187","x":2532,"y":6073.5,"count":"5","type":"LIGHT","camera":[0,1,4],"face":"W","ortho":9,"description":"Near the beach.","connection":[[1],[0,2],[1,3],[2,4],[3]],"direction":["2","1","2","1","2"],"position":[[-3.17,-0.3,-2],[-1.8,0.55,-1],[-0.25,0.85,-2],[1.75,1.25,-2],[3.5,0.25,-2]],"island":"kann"},{"id":"x14186","link":"x16779","x":2565.5,"y":6271,"island":"kann"},{"id":"x14467","x":1626,"y":6133.5,"count":"3","type":"LIGHT","camera":[0,1,4],"face":"W","ortho":9,"description":"Underground, watch out for the ruin dudes.","connection":[[1],[0,2],[1]],"direction":["2","2","3"],"position":[[-2.3,0.35,-2],[0.2,0.35,-1],[2.7,0.35,-2]],"island":"yash"},{"id":"x14029","x":1224,"y":5796,"count":"4","type":"SPIN","camera":[-4,3,3.5],"face":"S","description":"This puzzle is located on a tiny island to the north.  Each puzzle piece is independent.","connection":[[0],[1],[2],[3]],"direction":["E","S","N","W"],"position":[[-2.7,1.4,-3],[1,2,-6],[3.5,1.15,1],[1.5,0.5,3.5]],"island":"yash"}]');var x$=Ve.t(_$,2);const M$=JSON.parse('[{"id":"x18584","x":2522,"y":8454},{"id":"x16022","x":3288.5,"y":6761},{"id":"x15938","x":-169,"y":6160},{"id":"x12749","x":1476.5,"y":6029.5},{"id":"x12745","x":2491.5,"y":5860.5},{"id":"x12740","x":3160.5,"y":4756},{"id":"x6537","x":278,"y":1156},{"id":"x107","x":-1732.5,"y":2680},{"id":"x97","x":-998.5,"y":2347},{"id":"x41","x":-2228,"y":1572.5},{"id":"x35","x":-489.5,"y":1706.5},{"id":"x33","x":-1004,"y":1056},{"id":"x25","x":-925,"y":-306},{"id":"x19","x":-173.5,"y":475.5},{"id":"x13","x":516.5,"y":404},{"id":"x12","x":577,"y":-233}]');var b$=Ve.t(M$,2);class w${constructor(e,n,i){this.type=e,this.direction=n,this.connections=i}}var Ae=(()=>{return(t=Ae||(Ae={}))[t.NORTH=0]="NORTH",t[t.EAST=1]="EAST",t[t.SOUTH=2]="SOUTH",t[t.WEST=3]="WEST",t[t.ZERO=4]="ZERO",t[t.ONE=5]="ONE",t[t.TWO=6]="TWO",t[t.THREE=7]="THREE",Ae;var t})();class Sz{constructor(e,n,i,r,s){this.id=e,this.type=n,this.count=i,this.directions=r,this.connections=s,this.locationX=0,this.locationY=0,this.camera=[0,3,5],this.position=[],this.facing=Ae.NORTH,this.description="No description",this.orthoWidth=12,this.edit=[],this.islandIndex=0,this.forced=void 0,this.solution=[]}getCubes(){let e=new Array;for(let n=0;n<this.count;n++){let i=new w$(this.type,this.directions[n],this.connections[n]);e.push(i)}return e}}var E1=(()=>{return(t=E1||(E1={}))[t.SPIN=0]="SPIN",t[t.LIGHT=1]="LIGHT",t[t.BROKEN=2]="BROKEN",E1;var t})();let Ll=(()=>{class t{constructor(){this.puzzles=new Map,this.totalPuzzles=0,this.workingPuzzles=0,this.islands=["Narukami Island","Kannazuka Island","Yashiori Island","Watatsumi Island","Seirai Island","Tsurumi Island"],this.islandLoopup=new Map([["naru",0],["kann",1],["yash",2],["wata",3],["seir",4],["tsur",5]]),this.islandCounts=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]],this.locations=[];{let n=b$;for(let i=0;i<n.length;i++){let s=Number(n[i].y);s<3500||this.locations.push(new Zm(n[i].id,Number(n[i].x),Number(s),Mi.SEVEN))}}{let n=y$;for(let i=0;i<n.length;i++){let s=Number(n[i].y);s<3500||this.locations.push(new Zm(n[i].id,Number(n[i].x),Number(s),Mi.WAYPOINT))}}{let n=x$;for(let i=0;i<n.length;i++){let r=n[i];this.totalPuzzles++;let s=Number(r.y);this.locations.push(new Zm(r.id,Number(r.x),s,r.type||r.link?Mi.SPINNING:Mi.BROKEN,r.link||""));let a=this.islandLoopup.get(r.island),o=this.islandCounts[a];if(o[0]+=1,r.link)this.workingPuzzles++,o[1]+=1;else if(r.type){let c;this.workingPuzzles++,"LIGHT"===r.type?(c=E1.LIGHT,o[1]+=1):"SPIN"===r.type?(c=E1.SPIN,o[1]+=1):c=E1.BROKEN;let l=new Sz(r.id,c,Number(r.count),[],[]);if(l.islandIndex=a,l.locationX=Number(r.x),l.locationY=s,r.forced){l.forced=[];for(let u=0;u<r.forced.length;u++){let f=0;switch(r.forced[u]){case"N":f=0;break;case"E":f=1;break;case"S":f=2;break;case"W":f=3}l.forced.push(f)}}if(r.camera&&(l.camera=r.camera),r.edit)l.edit=r.edit;else for(let u=0;u<l.count;u++)l.edit.push(!0);if(r.face)switch(r.face){case"N":l.facing=Ae.NORTH;break;case"E":l.facing=Ae.EAST;break;case"S":l.facing=Ae.SOUTH;break;case"W":l.facing=Ae.WEST}if(r.solution&&(l.solution=r.solution),l.directions=[],r.direction)for(let u=0;u<r.direction.length;u++)switch(r.direction[u]){case"N":l.directions.push(Ae.NORTH);break;case"E":l.directions.push(Ae.EAST);break;case"S":l.directions.push(Ae.SOUTH);break;case"W":l.directions.push(Ae.WEST);break;case"0":l.directions.push(Ae.ZERO);break;case"1":l.directions.push(Ae.ONE);break;case"2":l.directions.push(Ae.TWO);break;case"3":l.directions.push(Ae.THREE)}else for(let u=0;u<r.count;u++)l.directions.push("LIGHT"===r.type?Ae.ZERO:Ae.NORTH);if(r.ortho&&(l.orthoWidth=r.ortho),r.connection&&(l.connections=r.connection),r.description&&(l.description=r.description),r.position)l.position=r.position;else for(let u=0;u<r.count;u++)l.position.push([u,0,-u]);this.puzzles.set(l.id,l)}else{let c=new Sz(r.id,E1.BROKEN,3,[Ae.ZERO,Ae.ZERO,Ae.ZERO],[[],[],[]]);c.locationX=Number(r.x),c.locationY=Number(r.y),this.puzzles.set(c.id,c)}}}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var bi=Ve(407);class S${constructor(e,n){this.open=e,this.close=n||e}isManual(){return"manual"===this.open||"manual"===this.close}}const C$={hover:["mouseover","mouseout"],focus:["focusin","focusout"]};const F1="undefined"!=typeof window&&window||{};let w2;function $m(){if(void 0===F1.document)return"bs4";const t=F1.document.createElement("span");t.innerText="testing bs version",t.classList.add("d-none"),t.classList.add("pl-1"),F1.document.head.appendChild(t);const e=t.getBoundingClientRect(),n=F1.getComputedStyle(t).paddingLeft;return!e||e&&0!==e.top?(F1.document.head.removeChild(t),"bs3"):n&&parseFloat(n)?(F1.document.head.removeChild(t),"bs4"):(F1.document.head.removeChild(t),"bs5")}function n4(){return void 0===F1||(void 0===F1.__theme?(w2||(w2=$m()),"bs3"===w2):"bs3"===F1.__theme)}function Ez(){return!n4()&&(w2||(w2=$m()),"bs4"===w2)}function Dl(){return{isBs3:n4(),isBs4:Ez(),isBs5:!n4()&&!Ez()&&(w2||(w2=$m()),"bs5"===w2)}}"undefined"==typeof console||console;class Pl{}const Os="*";function Xm(t,e=null){return{type:4,styles:e,timings:t}}function Tz(t,e=null){return{type:2,steps:t,options:e}}function Na(t){return{type:6,styles:t,offset:null}}function Az(t){Promise.resolve(null).then(t)}class g0{constructor(e=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Az(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const n="start"==e?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class Lz{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let n=0,i=0,r=0;const s=this.players.length;0==s?Az(()=>this._onFinish()):this.players.forEach(a=>{a.onDone(()=>{++n==s&&this._onFinish()}),a.onDestroy(()=>{++i==s&&this._onDestroy()}),a.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((a,o)=>Math.max(a,o.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const n=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,n/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((n,i)=>null===n||i.totalTime>n.totalTime?i:n,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const n="start"==e?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}const R$=["addListener","removeListener"],H$=["addEventListener","removeEventListener"],I$=["on","off"];function pu(t,e,n,i){if(t1(n)&&(i=n,n=void 0),i)return pu(t,e,n).pipe(yE(i));const[r,s]=function k$(t){return t1(t.addEventListener)&&t1(t.removeEventListener)}(t)?H$.map(a=>o=>t[a](e,o,n)):function V$(t){return t1(t.addListener)&&t1(t.removeListener)}(t)?R$.map(Dz(t,e)):function O$(t){return t1(t.on)&&t1(t.off)}(t)?I$.map(Dz(t,e)):[];if(!r&&bo(t))return Z1(a=>pu(a,e,n))(u2(t));if(!r)throw new TypeError("Invalid event target");return new qt(a=>{const o=(...c)=>a.next(1<c.length?c:c[0]);return r(o),()=>s(o)})}function Dz(t,e){return n=>i=>t[n](e,i)}class F$ extends Jn{constructor(e,n){super()}schedule(e,n=0){return this}}const mu={setInterval(...t){const{delegate:e}=mu;return((null==e?void 0:e.setInterval)||setInterval)(...t)},clearInterval(t){const{delegate:e}=mu;return((null==e?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0};class B$ extends F${constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,n)),this.pending=!0,this.delay=n,this.id=this.id||this.requestAsyncId(r,this.id,n),this}requestAsyncId(e,n,i=0){return mu.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,n,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return n;mu.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,n);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:n}=this,{actions:i}=n;this.work=this.state=this.scheduler=null,this.pending=!1,f1(i,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}}const Nl={schedule(t){let e=requestAnimationFrame,n=cancelAnimationFrame;const{delegate:i}=Nl;i&&(e=i.requestAnimationFrame,n=i.cancelAnimationFrame);const r=e(s=>{n=void 0,t(s)});return new Jn(()=>null==n?void 0:n(r))},requestAnimationFrame(...t){const{delegate:e}=Nl;return((null==e?void 0:e.requestAnimationFrame)||requestAnimationFrame)(...t)},cancelAnimationFrame(...t){const{delegate:e}=Nl;return((null==e?void 0:e.cancelAnimationFrame)||cancelAnimationFrame)(...t)},delegate:void 0},Pz={now:()=>(Pz.delegate||Date).now(),delegate:void 0};class Rl{constructor(e,n=Rl.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,i){return new this.schedulerActionCtor(this,e).schedule(i,n)}}Rl.now=Pz.now;class G$ extends Rl{constructor(e,n=Rl.now){super(e,n),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:n}=this;if(this._active)return void n.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=n.shift());if(this._active=!1,i){for(;e=n.shift();)e.unsubscribe();throw i}}}const j$=new class W$ extends G${flush(e){this._active=!0,this._scheduled=void 0;const{actions:n}=this;let i,r=-1;e=e||n.shift();const s=n.length;do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=n.shift()));if(this._active=!1,i){for(;++r<s&&(e=n.shift());)e.unsubscribe();throw i}}}(class U$ extends B${constructor(e,n){super(e,n),this.scheduler=e,this.work=n}requestAsyncId(e,n,i=0){return null!==i&&i>0?super.requestAsyncId(e,n,i):(e.actions.push(this),e._scheduled||(e._scheduled=Nl.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,n,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(e,n,i);0===e.actions.length&&(Nl.cancelAnimationFrame(n),e._scheduled=void 0)}});var gu=(()=>{return(t=gu||(gu={})).top="top",t.bottom="bottom",t.left="left",t.right="right",t.auto="auto",t.end="right",t.start="left",t["top left"]="top left",t["top right"]="top right",t["right top"]="right top",t["right bottom"]="right bottom",t["bottom right"]="bottom right",t["bottom left"]="bottom left",t["left bottom"]="left bottom",t["left top"]="left top",t["top start"]="top left",t["top end"]="top right",t["end top"]="right top",t["end bottom"]="right bottom",t["bottom end"]="bottom right",t["bottom start"]="bottom left",t["start bottom"]="start bottom",t["start top"]="left top",gu;var t})(),Hl=(()=>{return(t=Hl||(Hl={})).top="top",t.bottom="bottom",t.left="start",t.right="end",t.auto="auto",t.end="end",t.start="start",t["top left"]="top start",t["top right"]="top end",t["right top"]="end top",t["right bottom"]="end bottom",t["bottom right"]="bottom end",t["bottom left"]="bottom start",t["left bottom"]="start bottom",t["left top"]="start top",t["top start"]="top start",t["top end"]="top end",t["end top"]="end top",t["end bottom"]="end bottom",t["bottom end"]="bottom end",t["bottom start"]="bottom start",t["start bottom"]="start bottom",t["start top"]="start top",Hl;var t})();function i4(t,e){if(1!==t.nodeType)return[];const n=t.ownerDocument.defaultView,i=null==n?void 0:n.getComputedStyle(t,null);return e?i&&i[e]:i}function Jm(t){if(!t)return document.documentElement;let i,n=null==t?void 0:t.offsetParent;for(;null===n&&t.nextElementSibling&&i!==t.nextElementSibling;)i=t.nextElementSibling,n=i.offsetParent;const r=n&&n.nodeName;return r&&"BODY"!==r&&"HTML"!==r?n&&-1!==["TH","TD","TABLE"].indexOf(n.nodeName)&&"static"===i4(n,"position")?Jm(n):n:i?i.ownerDocument.documentElement:document.documentElement}function Km(t){return null!==t.parentNode?Km(t.parentNode):t}function vu(t,e){if(!(t&&t.nodeType&&e&&e.nodeType))return document.documentElement;const n=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING,i=n?t:e,r=n?e:t,s=document.createRange();s.setStart(i,0),s.setEnd(r,0);const a=s.commonAncestorContainer;if(t!==a&&e!==a||i.contains(r))return function q$(t){const{nodeName:e}=t;return"BODY"!==e&&("HTML"===e||Jm(t.firstElementChild)===t)}(a)?a:Jm(a);const o=Km(t);return o.host?vu(o.host,e):vu(t,Km(e).host)}function Nz(t){if(!t||!t.parentElement)return document.documentElement;let e=t.parentElement;for(;(null==e?void 0:e.parentElement)&&"none"===i4(e,"transform");)e=e.parentElement;return e||document.documentElement}function Rz(t,e){const n="x"===e?"Left":"Top",i="Left"===n?"Right":"Bottom";return parseFloat(t[`border${n}Width`])+parseFloat(t[`border${i}Width`])}function Hz(t,e,n,i){return Math.max(e[`offset${t}`],e[`scroll${t}`],n[`client${t}`],n[`offset${t}`],n[`scroll${t}`],0)}function Iz(t){const e=t.body,n=t.documentElement;return{height:Hz("Height",e,n),width:Hz("Width",e,n)}}function Il(t){return Object.assign(Object.assign({},t),{right:(t.left||0)+t.width,bottom:(t.top||0)+t.height})}function B1(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)}function Vz(t){const e=t.getBoundingClientRect();if(!(e&&B1(e.top)&&B1(e.left)&&B1(e.bottom)&&B1(e.right)))return e;const n={left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top},i="HTML"===t.nodeName?Iz(t.ownerDocument):void 0,r=(null==i?void 0:i.width)||t.clientWidth||B1(e.right)&&B1(n.left)&&e.right-n.left||0,s=(null==i?void 0:i.height)||t.clientHeight||B1(e.bottom)&&B1(n.top)&&e.bottom-n.top||0;let a=t.offsetWidth-r,o=t.offsetHeight-s;if(a||o){const c=i4(t);a-=Rz(c,"x"),o-=Rz(c,"y"),n.width-=a,n.height-=o}return Il(n)}function Qm(t){return"HTML"===t.nodeName?t:t.parentNode||t.host}function eg(t){if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}const{overflow:e,overflowX:n,overflowY:i}=i4(t);return/(auto|scroll|overlay)/.test(String(e)+String(i)+String(n))?t:eg(Qm(t))}function tg(t,e,n=!1){var i,r,s,a,o,c;const l="HTML"===e.nodeName,u=Vz(t),f=Vz(e),m=(eg(t),i4(e)),v=parseFloat(m.borderTopWidth),_=parseFloat(m.borderLeftWidth);n&&l&&(f.top=Math.max(null!==(i=f.top)&&void 0!==i?i:0,0),f.left=Math.max(null!==(r=f.left)&&void 0!==r?r:0,0));const M=Il({top:(null!==(s=u.top)&&void 0!==s?s:0)-(null!==(a=f.top)&&void 0!==a?a:0)-v,left:(null!==(o=u.left)&&void 0!==o?o:0)-(null!==(c=f.left)&&void 0!==c?c:0)-_,width:u.width,height:u.height});if(M.marginTop=0,M.marginLeft=0,l){const y=parseFloat(m.marginTop),g=parseFloat(m.marginLeft);B1(M.top)&&(M.top-=v-y),B1(M.bottom)&&(M.bottom-=v-y),B1(M.left)&&(M.left-=_-g),B1(M.right)&&(M.right-=_-g),M.marginTop=y,M.marginLeft=g}return M}function Oz(t,e="top"){const n="top"===e?"scrollTop":"scrollLeft",i=t.nodeName;if("BODY"===i||"HTML"===i){const r=t.ownerDocument.documentElement;return(t.ownerDocument.scrollingElement||r)[n]}return t[n]}function kz(t){const e=t.nodeName;return"BODY"!==e&&"HTML"!==e&&("fixed"===i4(t,"position")||kz(Qm(t)))}function ng(t,e,n=0,i,r=!1){let s={top:0,left:0};const a=r?Nz(t):vu(t,e);if("viewport"===i)s=function $$(t,e=!1){const n=t.ownerDocument.documentElement,i=tg(t,n),r=Math.max(n.clientWidth,window.innerWidth||0),s=Math.max(n.clientHeight,window.innerHeight||0),a=e?0:Oz(n),o=e?0:Oz(n,"left");return Il({top:a-Number(null==i?void 0:i.top)+Number(null==i?void 0:i.marginTop),left:o-Number(null==i?void 0:i.left)+Number(null==i?void 0:i.marginLeft),width:r,height:s})}(a,r);else{let o;"scrollParent"===i?(o=eg(Qm(e)),"BODY"===o.nodeName&&(o=t.ownerDocument.documentElement)):o="window"===i?t.ownerDocument.documentElement:i;const c=tg(o,a,r);if(c&&"HTML"===o.nodeName&&!kz(a)){const{height:l,width:u}=Iz(t.ownerDocument);B1(s.top)&&B1(c.top)&&B1(c.marginTop)&&(s.top+=c.top-c.marginTop),B1(s.top)&&(s.bottom=Number(l)+Number(c.top)),B1(s.left)&&B1(c.left)&&B1(c.marginLeft)&&(s.left+=c.left-c.marginLeft),B1(s.top)&&(s.right=Number(u)+Number(c.left))}else c&&(s=c)}return B1(s.left)&&(s.left+=n),B1(s.top)&&(s.top+=n),B1(s.right)&&(s.right-=n),B1(s.bottom)&&(s.bottom-=n),s}function X$({width:t,height:e}){return t*e}function Fz(t,e,n,i,r=["top","bottom","right","left"],s="viewport",a=0){var o,c,l,u,f,d,m,v,_,M,y,g;if(-1===t.indexOf("auto"))return t;const S=ng(n,i,a,s),b={top:{width:null!==(o=null==S?void 0:S.width)&&void 0!==o?o:0,height:(null!==(c=null==e?void 0:e.top)&&void 0!==c?c:0)-(null!==(l=null==S?void 0:S.top)&&void 0!==l?l:0)},right:{width:(null!==(u=null==S?void 0:S.right)&&void 0!==u?u:0)-(null!==(f=null==e?void 0:e.right)&&void 0!==f?f:0),height:null!==(d=null==S?void 0:S.height)&&void 0!==d?d:0},bottom:{width:null!==(m=null==S?void 0:S.width)&&void 0!==m?m:0,height:(null!==(v=null==S?void 0:S.bottom)&&void 0!==v?v:0)-(null!==(_=null==e?void 0:e.bottom)&&void 0!==_?_:0)},left:{width:(null!==(M=e.left)&&void 0!==M?M:0)-(null!==(y=null==S?void 0:S.left)&&void 0!==y?y:0),height:null!==(g=null==S?void 0:S.height)&&void 0!==g?g:0}},E=Object.keys(b).map(Y=>Object.assign(Object.assign({position:Y},b[Y]),{area:X$(b[Y])})).sort((Y,G)=>G.area-Y.area);let P=E.filter(({width:Y,height:G})=>Y>=n.clientWidth&&G>=n.clientHeight);P=P.filter(({position:Y})=>r.some(G=>G===Y));const V=P.length>0?P[0].position:E[0].position,j=t.split(" ")[1];return n.className=n.className.replace(/bs-tooltip-auto/g,`bs-tooltip-${Dl().isBs5?Hl[V]:V}`),V+(j?`-${j}`:"")}const yu=(t,e=0)=>t?parseFloat(t):e;function Bz(t){const e=t.ownerDocument.defaultView,n=null==e?void 0:e.getComputedStyle(t),i=yu(null==n?void 0:n.marginTop)+yu(null==n?void 0:n.marginBottom),r=yu(null==n?void 0:n.marginLeft)+yu(null==n?void 0:n.marginRight);return{width:Number(t.offsetWidth)+r,height:Number(t.offsetHeight)+i}}function Uz(t,e,n){return tg(e,n?Nz(t):vu(t,e),n)}function ig(t,e,n){var i,r,s;const a=n.split(" ")[0],o=Bz(t),c={width:o.width,height:o.height},l=-1!==["right","left"].indexOf(a),u=l?"top":"left",f=l?"left":"top",d=l?"height":"width",m=l?"width":"height";return c[u]=(null!==(i=e[u])&&void 0!==i?i:0)+e[d]/2-o[d]/2,c[f]=a===f?(null!==(r=e[f])&&void 0!==r?r:0)-o[m]:null!==(s=e[function J$(t){const e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,n=>e[n])}(f)])&&void 0!==s?s:0,c}function Gz(t,e){var n;return!!(null===(n=t.modifiers[e])||void 0===n?void 0:n.enabled)}const Q$={top:["top","top start","top end"],bottom:["bottom","bottom start","bottom end"],start:["start","start top","start bottom"],end:["end","end top","end bottom"]};function _u(t,e){return!!Dl().isBs5&&Q$[e].includes(t)}function Wz(t,e,n){!t||!e||Object.keys(e).forEach(i=>{let r="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&function Z$(t){return""!==t&&!isNaN(parseFloat(t))&&isFinite(Number(t))}(e[i])&&(r="px"),n?n.setStyle(t,i,`${String(e[i])}${r}`):t.style[i]=String(e[i])+r})}function nX(t){var e,n,i,r,s,a;let o=t.offsets.target;const c=t.instance.target.querySelector(".arrow");if(!c)return t;const l=-1!==["left","right"].indexOf(t.placement.split(" ")[0]),u=l?"height":"width",f=l?"Top":"Left",d=f.toLowerCase(),m=l?"left":"top",v=l?"bottom":"right",_=Bz(c)[u],M=t.placement.split(" ")[1];(null!==(e=t.offsets.host[v])&&void 0!==e?e:0)-_<(null!==(n=o[d])&&void 0!==n?n:0)&&(o[d]-=(null!==(i=o[d])&&void 0!==i?i:0)-((null!==(r=t.offsets.host[v])&&void 0!==r?r:0)-_)),Number(t.offsets.host[d])+Number(_)>(null!==(s=o[v])&&void 0!==s?s:0)&&(o[d]+=Number(t.offsets.host[d])+Number(_)-Number(o[v])),o=Il(o);const y=i4(t.instance.target),g=parseFloat(y[`margin${f}`])||0,S=parseFloat(y[`border${f}Width`])||0;let b;if(M){const P=parseFloat(y.borderRadius)||0,V=Number(g+S+P);b=d===M?Number(t.offsets.host[d])+V:Number(t.offsets.host[d])+Number(t.offsets.host[u]-V)}else b=Number(t.offsets.host[d])+Number(t.offsets.host[u]/2-_/2);let E=b-(null!==(a=o[d])&&void 0!==a?a:0)-g-S;return E=Math.max(Math.min(o[u]-(_+5),E),0),t.offsets.arrow={[d]:Math.round(E),[m]:""},t.instance.arrow=c,t}function iX(t){if(t.offsets.target=Il(t.offsets.target),!Gz(t.options,"flip"))return t.offsets.target=Object.assign(Object.assign({},t.offsets.target),ig(t.instance.target,t.offsets.host,t.placement)),t;const e=ng(t.instance.target,t.instance.host,0,"viewport",!1);let n=t.placement.split(" ")[0],i=t.placement.split(" ")[1]||"";const o=Fz("auto",t.offsets.host,t.instance.target,t.instance.host,t.options.allowedPositions),c=[n,o];return c.forEach((l,u)=>{var f,d,m,v,_,M,y,g,S,b,E,P,V,j,Y,G;if(n!==l||c.length===u+1)return;n=t.placement.split(" ")[0];const C="left"===n&&Math.floor(null!==(f=t.offsets.target.right)&&void 0!==f?f:0)>Math.floor(null!==(d=t.offsets.host.left)&&void 0!==d?d:0)||"right"===n&&Math.floor(null!==(m=t.offsets.target.left)&&void 0!==m?m:0)<Math.floor(null!==(v=t.offsets.host.right)&&void 0!==v?v:0)||"top"===n&&Math.floor(null!==(_=t.offsets.target.bottom)&&void 0!==_?_:0)>Math.floor(null!==(M=t.offsets.host.top)&&void 0!==M?M:0)||"bottom"===n&&Math.floor(null!==(y=t.offsets.target.top)&&void 0!==y?y:0)<Math.floor(null!==(g=t.offsets.host.bottom)&&void 0!==g?g:0),N=Math.floor(null!==(S=t.offsets.target.left)&&void 0!==S?S:0)<Math.floor(null!==(b=e.left)&&void 0!==b?b:0),F=Math.floor(null!==(E=t.offsets.target.right)&&void 0!==E?E:0)>Math.floor(null!==(P=e.right)&&void 0!==P?P:0),U=Math.floor(null!==(V=t.offsets.target.top)&&void 0!==V?V:0)<Math.floor(null!==(j=e.top)&&void 0!==j?j:0),$=Math.floor(null!==(Y=t.offsets.target.bottom)&&void 0!==Y?Y:0)>Math.floor(null!==(G=e.bottom)&&void 0!==G?G:0),O="left"===n&&N||"right"===n&&F||"top"===n&&U||"bottom"===n&&$,I=-1!==["top","bottom"].indexOf(n),k=I&&"left"===i&&N||I&&"right"===i&&F||!I&&"left"===i&&U||!I&&"right"===i&&$;(C||O||k)&&((C||O)&&(n=c[u+1]),k&&(i=function K$(t){return"right"===t?"left":"left"===t?"right":t}(i)),t.placement=n+(i?` ${i}`:""),t.offsets.target=Object.assign(Object.assign({},t.offsets.target),ig(t.instance.target,t.offsets.host,t.placement)))}),t}function sX(t){var e;if(!Gz(t.options,"preventOverflow"))return t;const n="transform",i=t.instance.target.style,{top:r,left:s,[n]:a}=i;i.top="",i.left="",i[n]="";const o=ng(t.instance.target,t.instance.host,0,(null===(e=t.options.modifiers.preventOverflow)||void 0===e?void 0:e.boundariesElement)||"scrollParent",!1);i.top=r,i.left=s,i[n]=a;const l={primary(u){var f,d,m,v;let _=t.offsets.target[u];return(null!==(f=t.offsets.target[u])&&void 0!==f?f:0)<(null!==(d=o[u])&&void 0!==d?d:0)&&(_=Math.max(null!==(m=t.offsets.target[u])&&void 0!==m?m:0,null!==(v=o[u])&&void 0!==v?v:0)),{[u]:_}},secondary(u){var f,d,m,v;const _="right"===u,M=_?"left":"top";let g=t.offsets.target[M];return(null!==(f=t.offsets.target[u])&&void 0!==f?f:0)>(null!==(d=o[u])&&void 0!==d?d:0)&&(g=Math.min(null!==(m=t.offsets.target[M])&&void 0!==m?m:0,(null!==(v=o[u])&&void 0!==v?v:0)-t.offsets.target[_?"width":"height"])),{[M]:g}}};return["left","right","top","bottom"].forEach(u=>{const f=-1!==["left","top","start"].indexOf(u)?l.primary:l.secondary;t.offsets.target=Object.assign(Object.assign({},t.offsets.target),f(u))}),t}function aX(t){var e;const n=t.placement,i=n.split(" ")[0],r=n.split(" ")[1];if(r){const{host:s,target:a}=t.offsets,o=-1!==["bottom","top"].indexOf(i),c=o?"left":"top",l=o?"width":"height",u={start:{[c]:s[c]},end:{[c]:(null!==(e=s[c])&&void 0!==e?e:0)+s[l]-a[l]}};t.offsets.target=Object.assign(Object.assign({},a),{[c]:c===r?u.start[c]:u.end[c]})}return t}const cX=new class oX{position(e,n){return this.offset(e,n)}offset(e,n){return Uz(n,e)}positionElements(e,n,i,r,s){const a=[iX,aX,sX,nX],c=function rX(t,e,n,i){if(!t||!e)return;const r=Uz(t,e);!n.match(/^(auto)*\s*(left|right|top|bottom|start|end)*$/)&&!n.match(/^(left|right|top|bottom|start|end)*(?: (left|right|top|bottom|start|end))*$/)&&(n="auto");const s=!!n.match(/auto/g);let a=n.match(/auto\s(left|right|top|bottom|start|end)/)?n.split(" ")[1]||"auto":n;const o=a.match(/^(left|right|top|bottom|start|end)* ?(?!\1)(left|right|top|bottom|start|end)?/);return o&&(a=o[1]+(o[2]?` ${o[2]}`:"")),-1!==["left right","right left","top bottom","bottom top"].indexOf(a)&&(a="auto"),a=Fz(a,r,t,e,i?i.allowedPositions:void 0),{options:i||{modifiers:{}},instance:{target:t,host:e,arrow:void 0},offsets:{target:ig(t,r,a),host:r,arrow:void 0},positionFixed:!1,placement:a,placementAuto:s}}(n,e,gu[i],s);if(c)return a.reduce((l,u)=>u(l),c)}};function lX(t,e,n,i,r,s){const a=cX.positionElements(t,e,n,i,r);if(!a)return;const o=function Y$(t){var e,n,i,r;return{width:t.offsets.target.width,height:t.offsets.target.height,left:Math.floor(null!==(e=t.offsets.target.left)&&void 0!==e?e:0),top:Math.round(null!==(n=t.offsets.target.top)&&void 0!==n?n:0),bottom:Math.round(null!==(i=t.offsets.target.bottom)&&void 0!==i?i:0),right:Math.floor(null!==(r=t.offsets.target.right)&&void 0!==r?r:0)}}(a);Wz(e,{"will-change":"transform",top:"0px",left:"0px",transform:`translate3d(${o.left}px, ${o.top}px, 0px)`},s),a.instance.arrow&&Wz(a.instance.arrow,a.offsets.arrow,s),function tX(t,e){const n=t.instance.target;let i=n.className;const r=Dl().isBs5?Hl[t.placement]:t.placement;t.placementAuto&&(i=i.replace(/bs-popover-auto/g,`bs-popover-${r}`),i=i.replace(/ms-2|me-2|mb-2|mt-2/g,""),i=i.replace(/bs-tooltip-auto/g,`bs-tooltip-${r}`),i=i.replace(/\sauto/g,` ${r}`),-1!==i.indexOf("popover")&&(i=i+" "+function eX(t){return Dl().isBs5?_u(t,"end")?"ms-2":_u(t,"start")?"me-2":_u(t,"top")?"mb-2":_u(t,"bottom")?"mt-2":"":""}(r)),-1!==i.indexOf("popover")&&-1===i.indexOf("popover-auto")&&(i+=" popover-auto"),-1!==i.indexOf("tooltip")&&-1===i.indexOf("tooltip-auto")&&(i+=" tooltip-auto")),i=i.replace(/left|right|top|bottom|end|start/g,`${r.split(" ")[0]}`),e?e.setAttribute(n,"class",i):n.className=i}(a,s)}let jz=(()=>{class t{constructor(n,i,r){this.update$$=new r1,this.positionElements=new Map,this.isDisabled=!1,function hj(t){return t===tE}(r)&&n.runOutsideAngular(()=>{this.triggerEvent$=fa(pu(window,"scroll",{passive:!0}),pu(window,"resize",{passive:!0}),Ot(0,j$),this.update$$),this.triggerEvent$.subscribe(()=>{this.isDisabled||this.positionElements.forEach(s=>{lX(xu(s.target),xu(s.element),s.attachment,s.appendToBody,this.options,i.createRenderer(null,null))})})})}position(n){this.addPositionElement(n)}get event$(){return this.triggerEvent$}disable(){this.isDisabled=!0}enable(){this.isDisabled=!1}addPositionElement(n){this.positionElements.set(xu(n.element),n)}calcPosition(){this.update$$.next(null)}deletePositionElement(n){this.positionElements.delete(xu(n))}setOptions(n){this.options=n}}return t.\u0275fac=function(n){return new(n||t)(ot(Y1),ot(n0),ot(Dh))},t.\u0275prov=xt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function xu(t){return"string"==typeof t?document.querySelector(t):t instanceof ii?t.nativeElement:null!=t?t:null}class Vl{constructor(e,n,i){this.nodes=e,this.viewRef=n,this.componentRef=i}}class hX{constructor(e,n,i,r,s,a,o,c){this._viewContainerRef=e,this._renderer=n,this._elementRef=i,this._injector=r,this._componentFactoryResolver=s,this._ngZone=a,this._applicationRef=o,this._posService=c,this.onBeforeShow=new l1,this.onShown=new l1,this.onBeforeHide=new l1,this.onHidden=new l1,this._providers=[],this._isHiding=!1,this.containerDefaultSelector="body",this._listenOpts={},this._globalListener=Function.prototype}get isShown(){return!this._isHiding&&!!this._componentRef}attach(e){return this._componentFactory=this._componentFactoryResolver.resolveComponentFactory(e),this}to(e){return this.container=e||this.container,this}position(e){return e?(this.attachment=e.attachment||this.attachment,this._elementRef=e.target||this._elementRef,this):this}provide(e){return this._providers.push(e),this}show(e={}){if(this._subscribePositioning(),this._innerComponent=void 0,!this._componentRef){this.onBeforeShow.emit(),this._contentRef=this._getContentRef(e.content,e.context,e.initialState);const n=Dn.create({providers:this._providers,parent:this._injector});if(!this._componentFactory)return;if(this._componentRef=this._componentFactory.create(n,this._contentRef.nodes),this._applicationRef.attachView(this._componentRef.hostView),this.instance=this._componentRef.instance,Object.assign(this._componentRef.instance,e),this.container instanceof ii&&this.container.nativeElement.appendChild(this._componentRef.location.nativeElement),"string"==typeof this.container&&"undefined"!=typeof document){const i=document.querySelector(this.container)||document.querySelector(this.containerDefaultSelector);if(!i)return;i.appendChild(this._componentRef.location.nativeElement)}!this.container&&this._elementRef&&this._elementRef.nativeElement.parentElement&&this._elementRef.nativeElement.parentElement.appendChild(this._componentRef.location.nativeElement),this._contentRef.componentRef&&(this._innerComponent=this._contentRef.componentRef.instance,this._contentRef.componentRef.changeDetectorRef.markForCheck(),this._contentRef.componentRef.changeDetectorRef.detectChanges()),this._componentRef.changeDetectorRef.markForCheck(),this._componentRef.changeDetectorRef.detectChanges(),this.onShown.emit(e.id?{id:e.id}:this._componentRef.instance)}return this._registerOutsideClick(),this._componentRef}hide(e){var n,i,r,s,a,o;if(!this._componentRef)return this;this._posService.deletePositionElement(this._componentRef.location),this.onBeforeHide.emit(this._componentRef.instance);const c=this._componentRef.location.nativeElement;return null===(n=c.parentNode)||void 0===n||n.removeChild(c),null===(r=null===(i=this._contentRef)||void 0===i?void 0:i.componentRef)||void 0===r||r.destroy(),this._viewContainerRef&&(null===(s=this._contentRef)||void 0===s?void 0:s.viewRef)&&this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._contentRef.viewRef)),null===(o=null===(a=this._contentRef)||void 0===a?void 0:a.viewRef)||void 0===o||o.destroy(),this._contentRef=void 0,this._componentRef=void 0,this._removeGlobalListener(),this.onHidden.emit(e?{id:e}:null),this}toggle(){this.isShown?this.hide():this.show()}dispose(){this.isShown&&this.hide(),this._unsubscribePositioning(),this._unregisterListenersFn&&this._unregisterListenersFn()}listen(e){var n;this.triggers=e.triggers||this.triggers,this._listenOpts.outsideClick=e.outsideClick,this._listenOpts.outsideEsc=e.outsideEsc,e.target=e.target||(null===(n=this._elementRef)||void 0===n?void 0:n.nativeElement);const i=this._listenOpts.hide=()=>e.hide?e.hide():void this.hide(),r=this._listenOpts.show=a=>{e.show?e.show(a):this.show(a),a()};return this._renderer&&(this._unregisterListenersFn=function E$(t,e){const n=function Cz(t,e=C$){const n=(t||"").trim();if(0===n.length)return[];const i=n.split(/\s+/).map(s=>s.split(":")).map(s=>{const a=e[s[0]]||s;return new S$(a[0],a[1])}),r=i.filter(s=>s.isManual());if(r.length>1)throw new Error("Triggers parse error: only one manual trigger is allowed");if(1===r.length&&i.length>1)throw new Error("Triggers parse error: manual trigger can't be mixed with other triggers");return i}(e.triggers),i=e.target;if(1===n.length&&n[0].isManual())return Function.prototype;const r=[],s=[],a=()=>{s.forEach(o=>r.push(o())),s.length=0};return n.forEach(o=>{const c=o.open===o.close,l=c?e.toggle:e.show;if(!c&&o.close&&e.hide){const u=t.listen(i,o.close,e.hide);s.push(()=>u)}l&&r.push(t.listen(i,o.open,()=>l(a)))}),()=>{r.forEach(o=>o())}}(this._renderer,{target:e.target,triggers:e.triggers,show:r,hide:i,toggle:a=>{this.isShown?i():r(a)}})),this}_removeGlobalListener(){this._globalListener&&(this._globalListener(),this._globalListener=Function.prototype)}attachInline(e,n){return e&&n&&(this._inlineViewRef=e.createEmbeddedView(n)),this}_registerOutsideClick(){if(this._componentRef&&this._componentRef.location){if(this._listenOpts.outsideClick){const e=this._componentRef.location.nativeElement;setTimeout(()=>{this._renderer&&this._elementRef&&(this._globalListener=function z$(t,e){return e.outsideClick?t.listen("document","click",n=>{e.target&&e.target.contains(n.target)||e.targets&&e.targets.some(i=>i.contains(n.target))||e.hide&&e.hide()}):Function.prototype}(this._renderer,{targets:[e,this._elementRef.nativeElement],outsideClick:this._listenOpts.outsideClick,hide:()=>this._listenOpts.hide&&this._listenOpts.hide()}))})}this._listenOpts.outsideEsc&&this._renderer&&this._elementRef&&(this._globalListener=function T$(t,e){return e.outsideEsc?t.listen("document","keyup.esc",n=>{e.target&&e.target.contains(n.target)||e.targets&&e.targets.some(i=>i.contains(n.target))||e.hide&&e.hide()}):Function.prototype}(this._renderer,{targets:[this._componentRef.location.nativeElement,this._elementRef.nativeElement],outsideEsc:this._listenOpts.outsideEsc,hide:()=>this._listenOpts.hide&&this._listenOpts.hide()}))}}getInnerComponent(){return this._innerComponent}_subscribePositioning(){this._zoneSubscription||!this.attachment||(this.onShown.subscribe(()=>{var e;this._posService.position({element:null===(e=this._componentRef)||void 0===e?void 0:e.location,target:this._elementRef,attachment:this.attachment,appendToBody:"body"===this.container})}),this._zoneSubscription=this._ngZone.onStable.subscribe(()=>{!this._componentRef||this._posService.calcPosition()}))}_unsubscribePositioning(){!this._zoneSubscription||(this._zoneSubscription.unsubscribe(),this._zoneSubscription=void 0)}_getContentRef(e,n,i){if(!e)return new Vl([]);if(e instanceof yr){if(this._viewContainerRef){const a=this._viewContainerRef.createEmbeddedView(e,n);return a.markForCheck(),new Vl([a.rootNodes],a)}const s=e.createEmbeddedView({});return this._applicationRef.attachView(s),new Vl([s.rootNodes],s)}if("function"==typeof e){const s=this._componentFactoryResolver.resolveComponentFactory(e),a=Dn.create({providers:this._providers,parent:this._injector}),o=s.create(a);return Object.assign(o.instance,i),this._applicationRef.attachView(o.hostView),new Vl([[o.location.nativeElement]],o.hostView,o)}const r=this._renderer?[this._renderer.createText(`${e}`)]:[];return new Vl([r])}}let qz=(()=>{class t{constructor(n,i,r,s,a){this._componentFactoryResolver=n,this._ngZone=i,this._injector=r,this._posService=s,this._applicationRef=a}createLoader(n,i,r){return new hX(i,r,n,this._injector,this._componentFactoryResolver,this._ngZone,this._applicationRef,this._posService)}}return t.\u0275fac=function(n){return new(n||t)(ot(Zo),ot(Y1),ot(Dn),ot(jz),ot(c0))},t.\u0275prov=xt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const uX=function(t){return{dropdown:t}},fX=["*"],Zz=[Na({height:0,overflow:"hidden"}),Xm("220ms cubic-bezier(0, 0, 0.2, 1)",Na({height:"*",overflow:"hidden"}))];let r4=(()=>{class t{constructor(){this.direction="down",this.autoClose=!0,this.insideClick=!1,this.isAnimated=!1,this.stopOnClickPropagation=!1,this.isOpenChange=new l1,this.isDisabledChange=new l1,this.toggleClick=new l1,this.counts=0,this.dropdownMenu=new Promise(n=>{this.resolveDropdownMenu=n})}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})(),pX=(()=>{class t{constructor(n,i,r,s,a){this._state=n,this.cd=i,this._renderer=r,this._element=s,this.isOpen=!1,this._factoryDropDownAnimation=a.build(Zz),this._subscription=n.isOpenChange.subscribe(o=>{this.isOpen=o;const c=this._element.nativeElement.querySelector(".dropdown-menu");this._renderer.addClass(this._element.nativeElement.querySelector("div"),"open"),c&&!n4()&&(this._renderer.addClass(c,"show"),(c.classList.contains("dropdown-menu-right")||c.classList.contains("dropdown-menu-end"))&&(this._renderer.setStyle(c,"left","auto"),this._renderer.setStyle(c,"right","0")),"up"===this.direction&&(this._renderer.setStyle(c,"top","auto"),this._renderer.setStyle(c,"transform","translateY(-101%)"))),c&&this._state.isAnimated&&this._factoryDropDownAnimation.create(c).play(),this.cd.markForCheck(),this.cd.detectChanges()})}get direction(){return this._state.direction}_contains(n){return this._element.nativeElement.contains(n)}ngOnDestroy(){this._subscription.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(He(r4),He(fl),He(ss),He(ii),He(Pl))},t.\u0275cmp=O1({type:t,selectors:[["bs-dropdown-container"]],hostAttrs:[2,"display","block","position","absolute","z-index","1040"],ngContentSelectors:fX,decls:2,vars:9,consts:[[3,"ngClass"]],template:function(n,i){1&n&&(K6(),le(0,"div",0),Q6(1),he()),2&n&&(jo("dropup","up"===i.direction)("show",i.isOpen)("open",i.isOpen),yt("ngClass",al(7,uX,"down"===i.direction)))},directives:[pm],encapsulation:2,changeDetection:0}),t})(),mX=(()=>{class t{constructor(){this.autoClose=!0,this.insideClick=!1,this.isAnimated=!1,this.stopOnClickPropagation=!1}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),rg=(()=>{class t{constructor(n,i,r,s,a,o,c){this._elementRef=n,this._renderer=i,this._viewContainerRef=r,this._cis=s,this._state=a,this._config=o,this.dropup=!1,this._isInlineOpen=!1,this._isDisabled=!1,this._subscriptions=[],this._isInited=!1,this._state.autoClose=this._config.autoClose,this._state.insideClick=this._config.insideClick,this._state.isAnimated=this._config.isAnimated,this._state.stopOnClickPropagation=this._config.stopOnClickPropagation,this._factoryDropDownAnimation=c.build(Zz),this._dropdown=this._cis.createLoader(this._elementRef,this._viewContainerRef,this._renderer).provide({provide:r4,useValue:this._state}),this.onShown=this._dropdown.onShown,this.onHidden=this._dropdown.onHidden,this.isOpenChange=this._state.isOpenChange}set autoClose(n){this._state.autoClose=n}get autoClose(){return this._state.autoClose}set isAnimated(n){this._state.isAnimated=n}get isAnimated(){return this._state.isAnimated}set insideClick(n){this._state.insideClick=n}get insideClick(){return this._state.insideClick}set isDisabled(n){this._isDisabled=n,this._state.isDisabledChange.emit(n),n&&this.hide()}get isDisabled(){return this._isDisabled}get isOpen(){return this._showInline?this._isInlineOpen:this._dropdown.isShown}set isOpen(n){n?this.show():this.hide()}get isBs4(){return!n4()}get _showInline(){return!this.container}ngOnInit(){this._isInited||(this._isInited=!0,this._dropdown.listen({outsideClick:!1,triggers:this.triggers,show:()=>this.show()}),this._subscriptions.push(this._state.toggleClick.subscribe(n=>this.toggle(n))),this._subscriptions.push(this._state.isDisabledChange.pipe(Jo(n=>n)).subscribe(()=>this.hide())))}show(){if(!this.isOpen&&!this.isDisabled){if(this._showInline)return this._inlinedMenu||this._state.dropdownMenu.then(n=>{this._dropdown.attachInline(n.viewContainer,n.templateRef),this._inlinedMenu=this._dropdown._inlineViewRef,this.addBs4Polyfills(),this._inlinedMenu&&this._renderer.addClass(this._inlinedMenu.rootNodes[0].parentNode,"open"),this.playAnimation()}).catch(),this.addBs4Polyfills(),this._isInlineOpen=!0,this.onShown.emit(!0),this._state.isOpenChange.emit(!0),void this.playAnimation();this._state.dropdownMenu.then(n=>{const i=this.dropup||void 0!==this.dropup&&this.dropup;this._state.direction=i?"up":"down";const r=this.placement||(i?"top start":"bottom start");this._dropdown.attach(pX).to(this.container).position({attachment:r}).show({content:n.templateRef,placement:r}),this._state.isOpenChange.emit(!0)}).catch()}}hide(){!this.isOpen||(this._showInline?(this.removeShowClass(),this.removeDropupStyles(),this._isInlineOpen=!1,this.onHidden.emit(!0)):this._dropdown.hide(),this._state.isOpenChange.emit(!1))}toggle(n){return this.isOpen||!n?this.hide():this.show()}_contains(n){return this._elementRef.nativeElement.contains(n.target)||this._dropdown.instance&&this._dropdown.instance._contains(n.target)}navigationClick(n){const i=this._elementRef.nativeElement.querySelector(".dropdown-menu");if(!i)return;const r=this._elementRef.nativeElement.ownerDocument.activeElement,s=i.querySelectorAll(".dropdown-item");switch(n.keyCode){case 38:this._state.counts>0&&s[--this._state.counts].focus();break;case 40:this._state.counts+1<s.length&&(r.classList!==s[this._state.counts].classList?s[this._state.counts].focus():s[++this._state.counts].focus())}n.preventDefault()}ngOnDestroy(){for(const n of this._subscriptions)n.unsubscribe();this._dropdown.dispose()}addBs4Polyfills(){n4()||(this.addShowClass(),this.checkRightAlignment(),this.addDropupStyles())}playAnimation(){this._state.isAnimated&&this._inlinedMenu&&setTimeout(()=>{this._inlinedMenu&&this._factoryDropDownAnimation.create(this._inlinedMenu.rootNodes[0]).play()})}addShowClass(){this._inlinedMenu&&this._inlinedMenu.rootNodes[0]&&this._renderer.addClass(this._inlinedMenu.rootNodes[0],"show")}removeShowClass(){this._inlinedMenu&&this._inlinedMenu.rootNodes[0]&&this._renderer.removeClass(this._inlinedMenu.rootNodes[0],"show")}checkRightAlignment(){if(this._inlinedMenu&&this._inlinedMenu.rootNodes[0]){const n=this._inlinedMenu.rootNodes[0].classList.contains("dropdown-menu-right")||this._inlinedMenu.rootNodes[0].classList.contains("dropdown-menu-end");this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"left",n?"auto":"0"),this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"right",n?"0":"auto")}}addDropupStyles(){this._inlinedMenu&&this._inlinedMenu.rootNodes[0]&&(this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"top",this.dropup?"auto":"100%"),this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"transform",this.dropup?"translateY(-101%)":"translateY(0)"),this._renderer.setStyle(this._inlinedMenu.rootNodes[0],"bottom","auto"))}removeDropupStyles(){this._inlinedMenu&&this._inlinedMenu.rootNodes[0]&&(this._renderer.removeStyle(this._inlinedMenu.rootNodes[0],"top"),this._renderer.removeStyle(this._inlinedMenu.rootNodes[0],"transform"),this._renderer.removeStyle(this._inlinedMenu.rootNodes[0],"bottom"))}}return t.\u0275fac=function(n){return new(n||t)(He(ii),He(ss),He(M2),He(qz),He(r4),He(mX),He(Pl))},t.\u0275dir=$1({type:t,selectors:[["","bsDropdown",""],["","dropdown",""]],hostVars:6,hostBindings:function(n,i){1&n&&c1("keydown.arrowDown",function(s){return i.navigationClick(s)})("keydown.arrowUp",function(s){return i.navigationClick(s)}),2&n&&jo("dropup",i.dropup)("open",i.isOpen)("show",i.isOpen&&i.isBs4)},inputs:{placement:"placement",triggers:"triggers",container:"container",dropup:"dropup",autoClose:"autoClose",isAnimated:"isAnimated",insideClick:"insideClick",isDisabled:"isDisabled",isOpen:"isOpen"},outputs:{isOpenChange:"isOpenChange",onShown:"onShown",onHidden:"onHidden"},exportAs:["bs-dropdown"],features:[zS([r4])]}),t})(),$z=(()=>{class t{constructor(n,i,r){n.resolveDropdownMenu({templateRef:r,viewContainer:i})}}return t.\u0275fac=function(n){return new(n||t)(He(r4),He(M2),He(yr))},t.\u0275dir=$1({type:t,selectors:[["","bsDropdownMenu",""],["","dropdownMenu",""]],exportAs:["bs-dropdown-menu"]}),t})(),Xz=(()=>{class t{constructor(n,i,r,s,a){this._changeDetectorRef=n,this._dropdown=i,this._element=r,this._renderer=s,this._state=a,this.isOpen=!1,this._subscriptions=[],this._subscriptions.push(this._state.isOpenChange.subscribe(o=>{this.isOpen=o,o?(this._documentClickListener=this._renderer.listen("document","click",c=>{this._state.autoClose&&2!==c.button&&!this._element.nativeElement.contains(c.target)&&(!this._state.insideClick||!this._dropdown._contains(c))&&(this._state.toggleClick.emit(!1),this._changeDetectorRef.detectChanges())}),this._escKeyUpListener=this._renderer.listen(this._element.nativeElement,"keyup.esc",()=>{this._state.autoClose&&(this._state.toggleClick.emit(!1),this._changeDetectorRef.detectChanges())})):(this._documentClickListener&&this._documentClickListener(),this._escKeyUpListener&&this._escKeyUpListener())})),this._subscriptions.push(this._state.isDisabledChange.subscribe(o=>this.isDisabled=o||void 0))}onClick(n){this._state.stopOnClickPropagation&&n.stopPropagation(),!this.isDisabled&&this._state.toggleClick.emit(!0)}ngOnDestroy(){this._documentClickListener&&this._documentClickListener(),this._escKeyUpListener&&this._escKeyUpListener();for(const n of this._subscriptions)n.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(He(fl),He(rg),He(ii),He(ss),He(r4))},t.\u0275dir=$1({type:t,selectors:[["","bsDropdownToggle",""],["","dropdownToggle",""]],hostVars:3,hostBindings:function(n,i){1&n&&c1("click",function(s){return i.onClick(s)}),2&n&&ba("aria-haspopup",!0)("disabled",i.isDisabled)("aria-expanded",i.isOpen)},exportAs:["bs-dropdown-toggle"]}),t})(),gX=(()=>{class t{static forRoot(){return{ngModule:t,providers:[qz,jz,r4]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({imports:[[_m]]}),t})();function Ol(t){return(Ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function Yz(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _X(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),i.forEach(function(r){_X(t,r,n[r])})}return t}function sg(t,e){return function MX(t){if(Array.isArray(t))return t}(t)||function wX(t,e){var n=[],i=!0,r=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(c){r=!0,s=c}finally{try{!i&&null!=a.return&&a.return()}finally{if(r)throw s}}return n}(t,e)||function CX(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var og={},Kz={};try{"undefined"!=typeof window&&(og=window),"undefined"!=typeof document&&(Kz=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(t){}var tT=(og.navigator||{}).userAgent,nT=void 0===tT?"":tT,v0=og,wn=Kz,ks=!!wn.documentElement&&!!wn.head&&"function"==typeof wn.addEventListener&&"function"==typeof wn.createElement,Fs=(~nT.indexOf("MSIE")||nT.indexOf("Trident/"),"___FONT_AWESOME___"),aT="svg-inline--fa",hT=[1,2,3,4,5,6,7,8,9,10],IX=hT.concat([11,12,13,14,15,16,17,18,19,20]),s4={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},uT=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",s4.GROUP,s4.SWAP_OPACITY,s4.PRIMARY,s4.SECONDARY].concat(hT.map(function(t){return"".concat(t,"x")})).concat(IX.map(function(t){return"w-".concat(t)})),v0.FontAwesomeConfig||{});wn&&"function"==typeof wn.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(t){var e=sg(t,2),i=e[1],r=function FX(t){return""===t||"false"!==t&&("true"===t||t)}(function kX(t){var e=wn.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}(e[0]));null!=r&&(uT[i]=r)});var hg=Qt({},{familyPrefix:"fa",replacementClass:aT,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},uT);hg.autoReplaceSvg||(hg.observeMutations=!1);var Ht=Qt({},hg);v0.FontAwesomeConfig=Ht;var Bs=v0||{};Bs[Fs]||(Bs[Fs]={}),Bs[Fs].styles||(Bs[Fs].styles={}),Bs[Fs].hooks||(Bs[Fs].hooks={}),Bs[Fs].shims||(Bs[Fs].shims=[]);var wr=Bs[Fs],fT=[];ks&&((wn.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(wn.readyState)||wn.addEventListener("DOMContentLoaded",function t(){wn.removeEventListener("DOMContentLoaded",t),fT.map(function(e){return e()})}));var fg,ug="pending",dT="settled",wu="fulfilled",Su="rejected",jX=function(){},pT="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,qX="undefined"==typeof setImmediate?setTimeout:setImmediate,kl=[];function ZX(){for(var t=0;t<kl.length;t++)kl[t][0](kl[t][1]);kl=[],fg=!1}function Cu(t,e){kl.push([t,e]),fg||(fg=!0,qX(ZX,0))}function mT(t){var e=t.owner,n=e._state,i=e._data,r=t[n],s=t.then;if("function"==typeof r){n=wu;try{i=r(i)}catch(a){Fl(s,a)}}gT(s,i)||(n===wu&&dg(s,i),n===Su&&Fl(s,i))}function gT(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"===Ol(e))){var i=e.then;if("function"==typeof i)return i.call(e,function(r){n||(n=!0,e===r?vT(t,r):dg(t,r))},function(r){n||(n=!0,Fl(t,r))}),!0}}catch(r){return n||Fl(t,r),!0}return!1}function dg(t,e){(t===e||!gT(t,e))&&vT(t,e)}function vT(t,e){t._state===ug&&(t._state=dT,t._data=e,Cu(XX,t))}function Fl(t,e){t._state===ug&&(t._state=dT,t._data=e,Cu(YX,t))}function yT(t){t._then=t._then.forEach(mT)}function XX(t){t._state=wu,yT(t)}function YX(t){t._state=Su,yT(t),!t._handled&&pT&&global.process.emit("unhandledRejection",t._data,t)}function JX(t){global.process.emit("rejectionHandled",t)}function S2(t){if("function"!=typeof t)throw new TypeError("Promise resolver "+t+" is not a function");if(!(this instanceof S2))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function $X(t,e){function i(r){Fl(e,r)}try{t(function n(r){dg(e,r)},i)}catch(r){i(r)}}(t,this)}S2.prototype={constructor:S2,_state:ug,_then:null,_data:void 0,_handled:!1,then:function(e,n){var i={owner:this,then:new this.constructor(jX),fulfilled:e,rejected:n};return(n||e)&&!this._handled&&(this._handled=!0,this._state===Su&&pT&&Cu(JX,this)),this._state===wu||this._state===Su?Cu(mT,i):this._then.push(i),i.then},catch:function(e){return this.then(null,e)}},S2.all=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.all().");return new S2(function(e,n){var i=[],r=0;function s(c){return r++,function(l){i[c]=l,--r||e(i)}}for(var o,a=0;a<t.length;a++)(o=t[a])&&"function"==typeof o.then?o.then(s(a),n):i[a]=o;r||e(i)})},S2.race=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.race().");return new S2(function(e,n){for(var r,i=0;i<t.length;i++)(r=t[i])&&"function"==typeof r.then?r.then(e,n):e(r)})},S2.resolve=function(t){return t&&"object"===Ol(t)&&t.constructor===S2?t:new S2(function(e){e(t)})},S2.reject=function(t){return new S2(function(e,n){n(t)})};var Us={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Bl(){for(var t=12,e="";t-- >0;)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return e}function xT(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Eu(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,": ").concat(t[n],";")},"")}function mg(t){return t.size!==Us.size||t.x!==Us.x||t.y!==Us.y||t.rotate!==Us.rotate||t.flipX||t.flipY}function MT(t){var e=t.transform,i=t.iconWidth,r={transform:"translate(".concat(t.containerWidth/2," 256)")},s="translate(".concat(32*e.x,", ").concat(32*e.y,") "),a="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),o="rotate(".concat(e.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(s," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(i/2*-1," -256)")}}}var gg={x:0,y:0,width:"100%",height:"100%"};function bT(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function iY(t){return"g"===t.tag?t.children:[t]}function vg(t){var e=t.icons,n=e.main,i=e.mask,r=t.prefix,s=t.iconName,a=t.transform,o=t.symbol,c=t.title,l=t.maskId,u=t.titleId,f=t.extra,d=t.watchable,m=void 0!==d&&d,v=i.found?i:n,_=v.width,M=v.height,y="fak"===r,g=y?"":"fa-w-".concat(Math.ceil(_/M*16)),S=[Ht.replacementClass,s?"".concat(Ht.familyPrefix,"-").concat(s):"",g].filter(function(G){return-1===f.classes.indexOf(G)}).filter(function(G){return""!==G||!!G}).concat(f.classes).join(" "),b={children:[],attributes:Qt({},f.attributes,{"data-prefix":r,"data-icon":s,class:S,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(_," ").concat(M)})},E=y&&!~f.classes.indexOf("fa-fw")?{width:"".concat(_/M*16*.0625,"em")}:{};m&&(b.attributes["data-fa-i2svg"]=""),c&&b.children.push({tag:"title",attributes:{id:b.attributes["aria-labelledby"]||"title-".concat(u||Bl())},children:[c]});var P=Qt({},b,{prefix:r,iconName:s,main:n,mask:i,maskId:l,transform:a,symbol:o,styles:Qt({},E,f.styles)}),V=i.found&&n.found?function rY(t){var e=t.children,n=t.attributes,i=t.main,r=t.mask,s=t.maskId,c=i.icon,u=r.icon,f=MT({transform:t.transform,containerWidth:r.width,iconWidth:i.width}),d={tag:"rect",attributes:Qt({},gg,{fill:"white"})},m=c.children?{children:c.children.map(bT)}:{},v={tag:"g",attributes:Qt({},f.inner),children:[bT(Qt({tag:c.tag,attributes:Qt({},c.attributes,f.path)},m))]},_={tag:"g",attributes:Qt({},f.outer),children:[v]},M="mask-".concat(s||Bl()),y="clip-".concat(s||Bl()),g={tag:"mask",attributes:Qt({},gg,{id:M,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[d,_]},S={tag:"defs",children:[{tag:"clipPath",attributes:{id:y},children:iY(u)},g]};return e.push(S,{tag:"rect",attributes:Qt({fill:"currentColor","clip-path":"url(#".concat(y,")"),mask:"url(#".concat(M,")")},gg)}),{children:e,attributes:n}}(P):function sY(t){var e=t.children,n=t.attributes,i=t.main,r=t.transform,a=Eu(t.styles);if(a.length>0&&(n.style=a),mg(r)){var o=MT({transform:r,containerWidth:i.width,iconWidth:i.width});e.push({tag:"g",attributes:Qt({},o.outer),children:[{tag:"g",attributes:Qt({},o.inner),children:[{tag:i.icon.tag,children:i.icon.children,attributes:Qt({},i.icon.attributes,o.path)}]}]})}else e.push(i.icon);return{children:e,attributes:n}}(P),Y=V.attributes;return P.children=V.children,P.attributes=Y,o?function oY(t){var n=t.iconName,i=t.children,s=t.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Qt({},t.attributes,{id:!0===s?"".concat(t.prefix,"-").concat(Ht.familyPrefix,"-").concat(n):s}),children:i}]}]}(P):function aY(t){var e=t.children,n=t.main,i=t.mask,r=t.attributes,s=t.styles,a=t.transform;if(mg(a)&&n.found&&!i.found){var l={x:n.width/n.height/2,y:.5};r.style=Eu(Qt({},s,{"transform-origin":"".concat(l.x+a.x/16,"em ").concat(l.y+a.y/16,"em")}))}return[{tag:"svg",attributes:r,children:e}]}(P)}var xg=function(e,n,i,r){var c,l,u,s=Object.keys(e),a=s.length,o=void 0!==r?function(e,n){return function(i,r,s,a){return e.call(n,i,r,s,a)}}(n,r):n;for(void 0===i?(c=1,u=e[s[0]]):(c=0,u=i);c<a;c++)u=o(u,e[l=s[c]],l,e);return u};function zT(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.skipHooks,r=void 0!==i&&i,s=Object.keys(e).reduce(function(a,o){var c=e[o];return c.icon?a[c.iconName]=c.icon:a[o]=c,a},{});"function"!=typeof wr.hooks.addPack||r?wr.styles[t]=Qt({},wr.styles[t]||{},s):wr.hooks.addPack(t,s),"fas"===t&&zT("fa",e)}var TT=wr.styles,uY=wr.shims,PT=function(){var e=function(r){return xg(TT,function(s,a,o){return s[o]=xg(a,r,{}),s},{})};e(function(i,r,s){return r[3]&&(i[r[3]]=s),i}),e(function(i,r,s){var a=r[2];return i[s]=s,a.forEach(function(o){i[o]=s}),i});var n="far"in TT;xg(uY,function(i,r){var a=r[1];return"far"===a&&!n&&(a="fas"),i[r[0]]={prefix:a,iconName:r[2]},i},{})};function RT(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}function x0(t){var e=t.tag,n=t.attributes,i=void 0===n?{}:n,r=t.children,s=void 0===r?[]:r;return"string"==typeof t?xT(t):"<".concat(e," ").concat(function tY(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,'="').concat(xT(t[n]),'" ')},"").trim()}(i),">").concat(s.map(x0).join(""),"</").concat(e,">")}PT();function Gl(t){this.name="MissingIcon",this.message=t||"Icon unavailable",this.stack=(new Error).stack}(Gl.prototype=Object.create(Error.prototype)).constructor=Gl;var Au={fill:"currentColor"},FT={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},Sg=(Qt({},Au,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),Qt({},FT,{attributeName:"opacity"}));function Eg(t){var e=t[0],n=t[1],s=sg(t.slice(4),1)[0];return{found:!0,width:e,height:n,icon:Array.isArray(s)?{tag:"g",attributes:{class:"".concat(Ht.familyPrefix,"-").concat(s4.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Ht.familyPrefix,"-").concat(s4.SECONDARY),fill:"currentColor",d:s[0]}},{tag:"path",attributes:{class:"".concat(Ht.familyPrefix,"-").concat(s4.PRIMARY),fill:"currentColor",d:s[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:s}}}}function Wl(){Ht.autoAddCss&&!Du&&(function _T(t){if(t&&ks){var e=wn.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;for(var n=wn.head.childNodes,i=null,r=n.length-1;r>-1;r--){var s=n[r],a=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(a)>-1&&(i=s)}return wn.head.insertBefore(e,i),t}}(function Tg(){var t="fa",e=aT,n=Ht.familyPrefix,i=Ht.replacementClass,r='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==t||i!==e){var s=new RegExp("\\.".concat(t,"\\-"),"g"),a=new RegExp("\\--".concat(t,"\\-"),"g"),o=new RegExp("\\.".concat(e),"g");r=r.replace(s,".".concat(n,"-")).replace(a,"--".concat(n,"-")).replace(o,".".concat(i))}return r}()),Du=!0)}function Lu(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(function(i){return x0(i)})}}),Object.defineProperty(t,"node",{get:function(){if(ks){var i=wn.createElement("div");return i.innerHTML=t.html,i.children}}}),t}function Ag(t){var e=t.prefix,n=void 0===e?"fa":e,i=t.iconName;if(i)return RT(jT.definitions,n,i)||RT(wr.styles,n,i)}Qt({},Au,{cx:"256",cy:"364",r:"28"}),Qt({},FT,{attributeName:"r",values:"28;14;28;28;14;28;"}),Qt({},Sg,{values:"1;0;1;1;0;1;"}),Qt({},Au,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),Qt({},Sg,{values:"1;0;0;0;0;1;"}),Qt({},Au,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),Qt({},Sg,{values:"0;0;1;1;0;0;"});var jT=new(function(){function t(){(function vX(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.definitions={}}return function yX(t,e,n){e&&Yz(t.prototype,e),n&&Yz(t,n)}(t,[{key:"add",value:function(){for(var n=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];var a=r.reduce(this._pullDefinitions,{});Object.keys(a).forEach(function(o){n.definitions[o]=Qt({},n.definitions[o]||{},a[o]),zT(o,a[o]),PT()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(n,i){var r=i.prefix&&i.iconName&&i.icon?{0:i}:i;return Object.keys(r).map(function(s){var a=r[s],o=a.prefix,c=a.iconName,l=a.icon;n[o]||(n[o]={}),n[o][c]=l}),n}}]),t}()),Du=!1,qT_transform=function(e){return function(e){var n={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(i,r){var s=r.toLowerCase().split("-"),a=s[0],o=s.slice(1).join("-");if(a&&"h"===o)return i.flipX=!0,i;if(a&&"v"===o)return i.flipY=!0,i;if(o=parseFloat(o),isNaN(o))return i;switch(a){case"grow":i.size=i.size+o;break;case"shrink":i.size=i.size-o;break;case"left":i.x=i.x-o;break;case"right":i.x=i.x+o;break;case"up":i.y=i.y-o;break;case"down":i.y=i.y+o;break;case"rotate":i.rotate=i.rotate+o}return i},n):n}(e)},ZT=function BY(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=(e||{}).icon?e:Ag(e||{}),r=n.mask;return r&&(r=(r||{}).icon?r:Ag(r||{})),t(i,Qt({},n,{mask:r}))}}(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.transform,i=void 0===n?Us:n,r=e.symbol,s=void 0!==r&&r,a=e.mask,o=void 0===a?null:a,c=e.maskId,l=void 0===c?null:c,u=e.title,f=void 0===u?null:u,d=e.titleId,m=void 0===d?null:d,v=e.classes,_=void 0===v?[]:v,M=e.attributes,y=void 0===M?{}:M,g=e.styles,S=void 0===g?{}:g;if(t){var b=t.prefix,E=t.iconName,P=t.icon;return Lu(Qt({type:"icon"},t),function(){return Wl(),Ht.autoA11y&&(f?y["aria-labelledby"]="".concat(Ht.replacementClass,"-title-").concat(m||Bl()):(y["aria-hidden"]="true",y.focusable="false")),vg({icons:{main:Eg(P),mask:o?Eg(o.icon):{found:!1,width:null,height:null,icon:{}}},prefix:b,iconName:E,transform:Qt({},Us,i),symbol:s,title:f,maskId:l,titleId:m,extra:{attributes:y,styles:S,classes:_}})})}});const XY=["*"],KY=t=>{const e={"fa-spin":t.spin,"fa-pulse":t.pulse,"fa-fw":t.fixedWidth,"fa-border":t.border,"fa-inverse":t.inverse,"fa-layers-counter":t.counter,"fa-flip-horizontal":"horizontal"===t.flip||"both"===t.flip,"fa-flip-vertical":"vertical"===t.flip||"both"===t.flip,[`fa-${t.size}`]:null!==t.size,[`fa-rotate-${t.rotate}`]:null!==t.rotate,[`fa-pull-${t.pull}`]:null!==t.pull,[`fa-stack-${t.stackItemSize}`]:null!=t.stackItemSize};return Object.keys(e).map(n=>e[n]?n:null).filter(n=>n)};let tJ=(()=>{class t{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),$T=(()=>{class t{constructor(){this.definitions={}}addIcons(...n){for(const i of n){i.prefix in this.definitions||(this.definitions[i.prefix]={}),this.definitions[i.prefix][i.iconName]=i;for(const r of i.icon[2])"string"==typeof r&&(this.definitions[i.prefix][r]=i)}}addIconPacks(...n){for(const i of n){const r=Object.keys(i).map(s=>i[s]);this.addIcons(...r)}}getIconDefinition(n,i){return n in this.definitions&&i in this.definitions[n]?this.definitions[n][i]:null}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),nJ=(()=>{class t{constructor(){this.stackItemSize="1x"}ngOnChanges(n){if("size"in n)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=$1({type:t,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[ni]}),t})(),iJ=(()=>{class t{constructor(n,i){this.renderer=n,this.elementRef=i}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(n){"size"in n&&(null!=n.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${n.size.currentValue}`),null!=n.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${n.size.previousValue}`))}}return t.\u0275fac=function(n){return new(n||t)(He(ss),He(ii))},t.\u0275cmp=O1({type:t,selectors:[["fa-stack"]],inputs:{size:"size"},features:[ni],ngContentSelectors:XY,decls:1,vars:0,template:function(n,i){1&n&&(K6(),Q6(0))},encapsulation:2}),t})(),jl=(()=>{class t{constructor(n,i,r,s,a){this.sanitizer=n,this.config=i,this.iconLibrary=r,this.stackItem=s,this.classes=[],null!=a&&null==s&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(n){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let i=null;if(i=null==this.icon?this.config.fallbackIcon:this.icon,n){const r=this.findIconDefinition(i);if(null!=r){const s=this.buildParams();this.renderIcon(r,s)}}}render(){this.ngOnChanges({})}findIconDefinition(n){const i=((t,e)=>(t=>void 0!==t.prefix&&void 0!==t.iconName)(t)?t:Array.isArray(t)&&2===t.length?{prefix:t[0],iconName:t[1]}:"string"==typeof t?{prefix:e,iconName:t}:void 0)(n,this.config.defaultPrefix);if("icon"in i)return i;const r=this.iconLibrary.getIconDefinition(i.prefix,i.iconName);return null!=r?r:((t=>{throw new Error(`Could not find icon with iconName=${t.iconName} and prefix=${t.prefix} in the icon library.`)})(i),null)}buildParams(){const n={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},i="string"==typeof this.transform?qT_transform(this.transform):this.transform;return{title:this.title,transform:i,classes:[...KY(n),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(n,i){const r=ZT(n,i);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(r.html.join("\n"))}}return t.\u0275fac=function(n){return new(n||t)(He(gE),He(tJ),He($T),He(nJ,8),He(iJ,8))},t.\u0275cmp=O1({type:t,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,i){2&n&&(bp("innerHTML",i.renderedIconHTML,uM),ba("title",i.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[ni],decls:0,vars:0,template:function(n,i){},encapsulation:2}),t})(),rJ=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({}),t})();const sJ=["m1"];function aJ(t,e){if(1&t){const n=Go();le(0,"li",12),le(1,"span",13),c1("click",function(){const s=Ts(n).index;return y1(2).showLocation(s)}),Ge(2),he(),he()}if(2&t){const n=e.$implicit;ht(2),wa(n)}}function oJ(t,e){if(1&t){const n=Go();le(0,"ul",11),le(1,"li",12),le(2,"span",13),c1("click",function(){return Ts(n),y1().centerMap()}),Ge(3,"Center"),he(),he(),Vt(4,"li",14),X1(5,aJ,3,1,"li",15),he()}if(2&t){const n=y1();ht(5),yt("ngForOf",n.dataSource.islands)}}const cJ=function(){return["fas","map-signs"]};let Lg=(()=>{class t{constructor(n,i){this.dataSource=n,this.router=i,this.fixedHeight=!1,this.origX=0,this.origY=0,this.origZoom=3,this.isInit=!1}ngOnChanges(n){n&&n.puzzleInfo&&this.puzzleInfo&&this.map&&(this.origX=this.puzzleInfo.locationX,this.origY=-this.puzzleInfo.locationY,this.origZoom=1,this.map.setView([-this.puzzleInfo.locationY,this.puzzleInfo.locationX],1))}initMap(){this.isInit=!0;let n=new bi.Icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"leaflet/marker-icon.png",shadowUrl:"leaflet/marker-shadow.png"}),i=new bi.Icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"assets/waypoint.png",shadowUrl:"leaflet/marker-shadow.png"}),r=new bi.Icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"assets/puzzle.png",shadowUrl:"leaflet/marker-shadow.png"}),s=new bi.Icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"assets/bad-puzzle.png",shadowUrl:"leaflet/marker-shadow.png"}),a=new bi.Icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"assets/seven.png",shadowUrl:"leaflet/marker-shadow.png"});this.map=bi.map(this.m1Ref.nativeElement,{crs:bi.CRS.Simple,minZoom:-5}),this.map.setMinZoom(-5),this.map.setMaxZoom(1);let o=5350,c=-545,l=-4025;var u=new bi.LatLngBounds(bi.latLng([l,c]),bi.latLng([l-o,c+o]));var d=new bi.LatLngBounds(bi.latLng([-3125,-1445]),bi.latLng([-10275,5705]));this.map.setMaxBounds(d),bi.imageOverlay("./assets/inazuma-map.png",u).addTo(this.map),this.puzzleInfo?(this.origX=this.puzzleInfo.locationX,this.origY=-this.puzzleInfo.locationY,this.origZoom=1,this.map.setView([-this.puzzleInfo.locationY,this.puzzleInfo.locationX],1)):(this.origX=1520,this.origY=-6570,this.origZoom=-3),this.map.setView([this.origY,this.origX],this.origZoom);for(let _=0;_<this.dataSource.locations.length;_++){let M=this.dataSource.locations[_];var v=bi.latLng([-M.y,M.x]);let y,g="",S=M.link||M.id;switch(this.dataSource.locations[_].type){case Mi.WAYPOINT:y=i,g="Teleporter";break;case Mi.LIGHTUP:case Mi.SPINNING:y=r;break;case Mi.BROKEN:y=s;break;case Mi.SEVEN:y=a,g="Statue of the Seven";break;default:y=n}let b=bi.marker(v,{icon:y});switch(this.dataSource.locations[_].type){case Mi.LIGHTUP:case Mi.SPINNING:case Mi.BROKEN:b.addEventListener("click",()=>{this.router.navigateByUrl(`/puzzle/${S}`)});break;default:b.bindPopup(g)}b.addTo(this.map)}}ngAfterViewInit(){!1===this.isInit&&this.initMap()}centerMap(){this.map.setView([this.origY,this.origX],this.origZoom)}showLocation(n){let i=0,r=0;switch(n){case 5:r=2092,i=-8610;break;case 4:r=3422,i=-6896;break;case 3:r=17,i=-6118;break;case 2:r=1658,i=-6252;break;case 1:r=2411,i=-6011;break;default:r=3473,i=-5126}this.map.setView([i,r],-1)}}return t.\u0275fac=function(n){return new(n||t)(He(Ll),He(ki))},t.\u0275cmp=O1({type:t,selectors:[["app-map"]],viewQuery:function(n,i){if(1&n&&s0(sJ,5),2&n){let r;Sa(r=Ca())&&(i.m1Ref=r.first)}},inputs:{fixedHeight:"fixedHeight",puzzleInfo:"puzzleInfo"},features:[ni],decls:11,vars:3,consts:[[1,"button-holder"],["dropdown","",1,"btn-group"],["id","button-basic","dropdownToggle","","type","button","aria-controls","dropdown-basic",1,"btn","btn-sm","btn-primary","dropdown-toggle"],[3,"icon"],[1,"caret"],["id","dropdown-basic","class","dropdown-menu dropdown-menu-right","role","menu","aria-labelledby","button-basic",4,"dropdownMenu"],[3,"className"],["mapElement",""],[1,"map-frame"],["id","map"],["m1",""],["id","dropdown-basic","role","menu","aria-labelledby","button-basic",1,"dropdown-menu","dropdown-menu-right"],["role","menuitem"],[1,"dropdown-item",3,"click"],[1,"divider","dropdown-divider"],["role","menuitem",4,"ngFor","ngForOf"]],template:function(n,i){1&n&&(le(0,"div",0),le(1,"div",1),le(2,"button",2),Vt(3,"fa-icon",3),Vt(4,"span",4),he(),X1(5,oJ,6,1,"ul",5),he(),he(),le(6,"div",6,7),le(8,"div",8),Vt(9,"div",9,10),he(),he()),2&n&&(ht(3),yt("icon",vr(2,cJ)),ht(3),yt("className",i.fixedHeight?"map-component":"map-container"))},directives:[rg,Xz,jl,$z,Ta],styles:[".map-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;margin:40px 10px 10px}.map-component[_ngcontent-%COMP%]{height:300px;margin:4px 0}.leaflet-container[_ngcontent-%COMP%]{background-color:#00008b}.map-frame[_ngcontent-%COMP%]{border:2px solid black;height:100%}#map[_ngcontent-%COMP%], #map2[_ngcontent-%COMP%]{height:100%}.button-holder[_ngcontent-%COMP%]{margin:4px 10px 4px 0;height:32px;text-align:right}"]}),t})(),XT=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=O1({type:t,selectors:[["app-map-key"]],decls:17,vars:0,consts:[[1,"card"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["src","assets/waypoint.png"],["src","assets/seven.png"],["src","assets/puzzle.png"],["src","assets/bad-puzzle.png"]],template:function(n,i){1&n&&(le(0,"div",0),le(1,"div",1),le(2,"h5",2),Ge(3,"Map Key"),he(),le(4,"p",3),Vt(5,"img",4),Ge(6," Teleport Waypoint"),Vt(7,"br"),Vt(8,"img",5),Ge(9," Statue of the Seven"),Vt(10,"br"),Vt(11,"img",6),Ge(12," Working Puzzle"),Vt(13,"br"),Vt(14,"img",7),Ge(15," Broken Puzzle"),Vt(16,"br"),he(),he(),he())},styles:["div.card[_ngcontent-%COMP%]{margin-top:4px}"]}),t})();const YT=["*"];function lJ(t,e){1&t&&function cw(t,e,n){mh(t,e,n),gh()}(0)}function hJ(t,e){if(1&t&&(le(0,"bar",3),Q6(1),he()),2&t){const n=y1();yt("type",n.type)("value",n._value)("max",n.max)("animate",n.animate)("striped",n.striped)}}function uJ(t,e){if(1&t&&(le(0,"bar",3),Ge(1),he()),2&t){const n=e.$implicit,i=y1(2);yt("type",n.type)("value",n.value)("max",n.max||i.max)("animate",i.animate)("striped",i.striped),ht(1),wa(n.label)}}function fJ(t,e){1&t&&X1(0,uJ,2,6,"bar",4),2&t&&yt("ngForOf",y1()._values)}let dJ=(()=>{class t{constructor(n,i){this.el=n,this.renderer=i,this.max=100,this.value=0,this.animate=!1,this.striped=!1,this.type="info",this.percent=100}get isBs3(){return n4()}ngOnChanges(n){var i,r;(n.value||n.max)&&(this.percent=Number((null===(i=n.value)||void 0===i?void 0:i.currentValue)||this.value)/Number((null===(r=n.max)||void 0===r?void 0:r.currentValue)||this.max||100)*100),n.type&&this.applyTypeClasses()}applyTypeClasses(){if(this._prevType){const i=`bg-${this._prevType}`;this.renderer.removeClass(this.el.nativeElement,`progress-bar-${this._prevType}`),this.renderer.removeClass(this.el.nativeElement,i),this._prevType=void 0}if(this.type){const i=`bg-${this.type}`;this.renderer.addClass(this.el.nativeElement,`progress-bar-${this.type}`),this.renderer.addClass(this.el.nativeElement,i),this._prevType=this.type}}}return t.\u0275fac=function(n){return new(n||t)(He(ii),He(ss))},t.\u0275cmp=O1({type:t,selectors:[["bar"]],hostAttrs:["role","progressbar","aria-valuemin","0"],hostVars:15,hostBindings:function(n,i){2&n&&(ba("aria-valuenow",i.value)("aria-valuetext",i.percent?i.percent.toFixed(0)+"%":"")("aria-valuemax",i.max),xp("height","100","%")("width",i.percent,"%"),jo("progress-bar",!0)("progress-bar-animated",!i.isBs3&&i.animate)("progress-bar-striped",i.striped)("active",i.isBs3&&i.animate))},inputs:{max:"max",value:"value",animate:"animate",striped:"striped",type:"type"},features:[ni],ngContentSelectors:YT,decls:1,vars:0,template:function(n,i){1&n&&(K6(),Q6(0))},encapsulation:2,changeDetection:0}),t})(),pJ=(()=>{class t{constructor(){this.animate=!1,this.max=100}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),mJ=(()=>{class t{constructor(n){this.max=100,this.animate=!1,this.striped=!1,this.isStacked=!1,this._value=0,Object.assign(this,n)}set value(n){this.isStacked=Array.isArray(n),"number"==typeof n?(this._value=n,this._values=void 0):(this._value=void 0,this._values=n)}}return t.\u0275fac=function(n){return new(n||t)(He(pJ))},t.\u0275cmp=O1({type:t,selectors:[["progressbar"]],hostVars:3,hostBindings:function(n,i){2&n&&(ba("max",i.max),jo("progress",!0))},inputs:{max:"max",animate:"animate",striped:"striped",type:"type",value:"value"},ngContentSelectors:YT,decls:5,vars:3,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["NotStacked",""],["Stacked",""],[3,"type","value","max","animate","striped"],[3,"type","value","max","animate","striped",4,"ngFor","ngForOf"]],template:function(n,i){if(1&n&&(K6(),X1(0,lJ,1,0,"ng-container",0),X1(1,hJ,2,5,"ng-template",null,1,ll),X1(3,fJ,1,1,"ng-template",null,2,ll)),2&n){const r=Y3(2),s=Y3(4);yt("ngIf",!i.isStacked)("ngIfThen",r)("ngIfElse",s)}},directives:[dJ,u0,Ta],styles:["[_nghost-%COMP%]{width:100%;display:flex}"],changeDetection:0}),t})(),gJ=(()=>{class t{static forRoot(){return{ngModule:t,providers:[]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({imports:[[_m]]}),t})();function vJ(t,e){if(1&t&&(le(0,"div"),le(1,"h5"),Ge(2),he(),le(3,"progressbar",14),Ge(4),he(),he()),2&t){const n=e.$implicit,i=e.index,r=y1();ht(2),wa(n),ht(1),yt("value",r.getIslandPercentComplete(i))("striped",!0),ht(1),x2("",r.getIslandPercentComplete(i),"%")}}let yJ=(()=>{class t{constructor(n){this.dataSource=n}getPercentComplete(){return Math.round(this.dataSource.workingPuzzles/this.dataSource.totalPuzzles*100)}getIslandPercentComplete(n){return Math.round(this.dataSource.islandCounts[n][1]/this.dataSource.islandCounts[n][0]*100)}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)(He(Ll))},t.\u0275cmp=O1({type:t,selectors:[["app-home"]],decls:28,vars:5,consts:[[1,"container"],[1,"row","head-row"],[1,"col-xs-12","col-sm-12","col-md-12"],[1,"display-4"],[1,"lead"],["href","https://github.com/mgatelabs/GenshinSolvers","target","_blank"],[1,"row"],[1,"col-xs-12","col-sm-12","col-md-8"],["id","mapArea",1,"card-text",3,"fixedHeight"],[1,"col-xs-12","col-sm-12","col-md-4"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["type","info",3,"value","striped"],[4,"ngFor","ngForOf"],[1,"col","col-md-4"]],template:function(n,i){1&n&&(le(0,"div",0),le(1,"div",1),le(2,"div",2),le(3,"h1",3),Ge(4,"Genshin Impact Puzzle Solver"),he(),le(5,"p",4),Ge(6," Welcome to the Genshin Impact Cube Puzzle Solver. We're here to help you solve those complex spinning / light up puzzles without losing your mind or wasting bursts trying to luck your way through. This project has all the basic functiuonality working, but some puzzles are in-complete and need to be researched more. If you want to help, please see our "),le(7,"a",5),Ge(8,"GitHub"),he(),Ge(9," page. "),he(),he(),he(),le(10,"div",6),le(11,"div",7),Vt(12,"app-map",8),he(),le(13,"div",9),Vt(14,"app-map-key"),he(),he(),le(15,"div",6),le(16,"div",9),le(17,"div",10),le(18,"div",11),le(19,"h5",12),Ge(20,"Puzzle Completion"),he(),le(21,"div",13),le(22,"h5"),Ge(23,"Total"),he(),le(24,"progressbar",14),Ge(25),he(),X1(26,vJ,5,4,"div",15),he(),he(),he(),he(),Vt(27,"div",16),he(),he()),2&n&&(ht(12),yt("fixedHeight",!0),ht(12),yt("value",i.getPercentComplete())("striped",!0),ht(1),x2("",i.getPercentComplete(),"%"),ht(1),yt("ngForOf",i.dataSource.islands))},directives:[Lg,XT,mJ,Ta],styles:[".head-row[_ngcontent-%COMP%]{margin-bottom:4px}"]}),t})();var lt=(()=>{return(t=lt||(lt={}))[t.UNKNOWN=0]="UNKNOWN",t[t.EMPTY=1]="EMPTY",t[t.CABBAGE=2]="CABBAGE",t[t.ORE=3]="ORE",t[t.BOMB=4]="BOMB",t[t.POTENTIAL_BOMB=5]="POTENTIAL_BOMB",t[t.SAFE_SPOT=6]="SAFE_SPOT",t[t.TREASURE=7]="TREASURE",t[t.FAKE=8]="FAKE",lt;var t})();class JT{constructor(e=0,n=0,i=lt.UNKNOWN){this.x=e,this.y=n,this.classification=i,this.edgeBombs=0,this.edgeUnknown=0,this.safe=!1,this.solved=!1,this.user=!1}reset(){this.edgeBombs=0,this.edgeUnknown=0,this.safe=!1,this.solved=!1}}class M0{constructor(e){if(this.grid=[],e)this.grid=e.grid;else for(let n=0;n<5;n++){this.grid.push([]);for(let i=0;i<5;i++)this.grid[n].push(new JT(i,n))}}getSpot(e,n){return e<0||e>=5||n<0||n>=5?lt.FAKE:this.grid[n][e].classification}getItem(e,n){return e<0||e>=5||n<0||n>=5?M0.FAKEITEM:this.grid[n][e]}sniffSpot(e,n){if(e<0||e>=5||n<0||n>=5)return lt.FAKE;let i=this.grid[n][e].classification;switch(i){case lt.ORE:case lt.CABBAGE:case lt.EMPTY:case lt.BOMB:return i;default:return lt.UNKNOWN}}each(e){let n=!0;for(;n;){n=!1;for(let i=0;i<this.grid.length;i++)for(let r=0;r<this.grid.length;r++){let s=[],a=this.getItem(r,i-1);a.classification!=lt.FAKE&&s.push(a),a=this.getItem(r,i+1),a.classification!=lt.FAKE&&s.push(a),a=this.getItem(r-1,i),a.classification!=lt.FAKE&&s.push(a),a=this.getItem(r+1,i),a.classification!=lt.FAKE&&s.push(a),e(r,i,this.grid[i][r],s)&&(n=!0)}}}sniffSpot2(e,n){if(e<0||e>=5||n<0||n>=5)return lt.FAKE;let i=this.grid[n][e].classification;switch(i){case lt.ORE:case lt.CABBAGE:case lt.EMPTY:case lt.BOMB:case lt.SAFE_SPOT:case lt.TREASURE:return i;default:return lt.UNKNOWN}}forceSpot(e,n,i){e<0||e>=5||n<0||n>=5||(this.grid[n][e].classification=i)}updateSpot(e,n){this.clean();let r=lt.EMPTY;switch(this.grid[n][e].classification){case lt.EMPTY:r=lt.CABBAGE;break;case lt.CABBAGE:r=lt.ORE;break;case lt.ORE:r=lt.UNKNOWN;break;default:r=lt.EMPTY}this.grid[n][e].classification=r,this.grid[n][e].user=this.grid[n][e].classification!=lt.UNKNOWN,this.each((a,o,c,l)=>{if(c.classification==lt.EMPTY)for(let u of l)u.safe=!0,u.classification==lt.UNKNOWN&&(u.classification=lt.SAFE_SPOT);return!1}),this.each((a,o,c,l)=>{if(c.solved)return!1;if(c.classification==lt.CABBAGE||c.classification==lt.ORE)if(c.classification==lt.ORE&&2==l.length){c.solved=!0;for(let u of l)u.classification=lt.BOMB,u.safe=!1,u.edgeBombs+=100}else{let u=c.classification==lt.CABBAGE?1:2,f=0,d=0,m=[];for(let v of l)v.classification==lt.BOMB?d++:1==v.safe||1==v.user||(f++,m.push(v));if(u==d){c.solved=!0;for(let v of m)v.classification=lt.SAFE_SPOT}else{if(0==d&&f==u||d>0&&f>0&&f==u-d){c.solved=!0;for(let v of m)v.classification=lt.BOMB;return!0}{let v=25;switch(m.length){case 1:v=100;break;case 2:v=50;break;case 3:v=33}for(let _ of m)_.classification=lt.POTENTIAL_BOMB,_.edgeBombs+=v}}}return!1}),this.each((a,o,c,l)=>{if(0==c.solved&&c.classification==lt.CABBAGE){let u=[],f=[];for(let d of l)d.classification==lt.BOMB||1==d.safe||1==d.user||(d.edgeBombs<=50&&u.push(d),f.push(d));if(f.length>u.length)for(let d of u)d.classification=lt.SAFE_SPOT,d.edgeBombs=0}else if(0==c.solved&&c.classification==lt.UNKNOWN){let u=0;for(let f of l)f.classification==lt.BOMB&&u++;u==l.length&&(c.classification=lt.TREASURE)}return!1})}reset(){for(let e=0;e<this.grid.length;e++)for(let n=0;n<this.grid[e].length;n++){let i=this.grid[e][n];i.reset(),i.user=!1,i.classification=lt.UNKNOWN}}clean(){for(let e=0;e<this.grid.length;e++)for(let n=0;n<this.grid[e].length;n++){let i=this.grid[e][n];switch(i.reset(),i.classification){case lt.EMPTY:case lt.CABBAGE:case lt.ORE:break;default:i.classification=lt.UNKNOWN}}}}M0.FAKEITEM=new JT(0,0,lt.FAKE);const _J=["thebutton"];let xJ=(()=>{class t{constructor(){this.label="?",this.y=0,this.x=0,this.cellClicked=new l1}set config(n){if(this._config=n,this._config){let r="";switch(this._config.grid[this.y][this.x].classification){case lt.BOMB:this.label="BOMB",r="barrel";break;case lt.CABBAGE:this.label="CABBAGE",r="cabbage";break;case lt.EMPTY:this.label="EMPTY",r="empty";break;case lt.ORE:this.label="ORE",r="iron";break;case lt.POTENTIAL_BOMB:this.label="?BOMB?",r="question";break;case lt.SAFE_SPOT:this.label="SAFE",r="safe";break;case lt.TREASURE:this.label="TREASURE",r="safe";break;case lt.UNKNOWN:this.label="???",r="unknown"}this.thebutton&&this.thebutton.nativeElement&&this.thebutton.nativeElement.setAttribute("mode",r)}else this.label="?"}ngOnInit(){}buttonPressed(){this.cellClicked.emit(5*this.y+this.x)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=O1({type:t,selectors:[["app-old-chou-treasure-button"]],viewQuery:function(n,i){if(1&n&&s0(_J,5,ii),2&n){let r;Sa(r=Ca())&&(i.thebutton=r.first)}},inputs:{y:"y",x:"x",config:"config"},outputs:{cellClicked:"cellClicked"},decls:5,vars:1,consts:[["mode","unknown",3,"click"],["thebutton",""],[1,"icon"],[1,"text"]],template:function(n,i){1&n&&(le(0,"button",0,1),c1("click",function(){return i.buttonPressed()}),Vt(2,"span",2),le(3,"span",3),Ge(4),he(),he()),2&n&&(ht(4),wa(i.label))},styles:["button[_ngcontent-%COMP%]{display:inline-block;width:96px;height:96px;background-color:#deb887;position:relative}button[_ngcontent-%COMP%]   span.icon[_ngcontent-%COMP%]{width:96px;height:96px;display:block;position:absolute;top:0;left:0;background-repeat:no-repeat;background-position:center center}button[_ngcontent-%COMP%]   span.text[_ngcontent-%COMP%]{width:96px;height:9px;display:block;position:absolute;bottom:0;left:0;font-size:12px}button[mode=empty][_ngcontent-%COMP%]   span.icon[_ngcontent-%COMP%]{background-image:url(empty.924e880fb5ad3291.png)}button[mode=cabbage][_ngcontent-%COMP%]   span.icon[_ngcontent-%COMP%]{background-image:url(cabbage.285b3077ff8ced6e.png)}button[mode=iron][_ngcontent-%COMP%]   span.icon[_ngcontent-%COMP%]{background-image:url(iron.afd93171e7982e10.png);background-size:70%}button[mode=barrel][_ngcontent-%COMP%]   span.icon[_ngcontent-%COMP%]{background-image:url(barrel.0f951aff90ebab46.png);background-size:80%}button[mode=question][_ngcontent-%COMP%]   span.icon[_ngcontent-%COMP%]{background-image:url(question.f0b1b4207dc54779.png);background-size:70%}button[mode=unknown][_ngcontent-%COMP%]   span.icon[_ngcontent-%COMP%]{background-image:url(unknown.cf75bd1dbd7fe4c0.png)}button[mode=safe][_ngcontent-%COMP%]   span.icon[_ngcontent-%COMP%]{background-image:url(safe.47e42ea5f0f8211f.png);background-size:70%}"]}),t})(),MJ=(()=>{class t{constructor(){this.y=0,this.cellClicked=new l1}ngOnInit(){}cellClickEvent(n){this.cellClicked.emit(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=O1({type:t,selectors:[["app-old-chou-treasure-row"]],inputs:{y:"y",config:"config"},outputs:{cellClicked:"cellClicked"},decls:5,vars:15,consts:[[3,"x","y","config","cellClicked"]],template:function(n,i){1&n&&(le(0,"app-old-chou-treasure-button",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he(),le(1,"app-old-chou-treasure-button",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he(),le(2,"app-old-chou-treasure-button",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he(),le(3,"app-old-chou-treasure-button",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he(),le(4,"app-old-chou-treasure-button",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he()),2&n&&(yt("x",0)("y",i.y)("config",i.config),ht(1),yt("x",1)("y",i.y)("config",i.config),ht(1),yt("x",2)("y",i.y)("config",i.config),ht(1),yt("x",3)("y",i.y)("config",i.config),ht(1),yt("x",4)("y",i.y)("config",i.config))},directives:[xJ],styles:["app-old-chou-treasure-button[_ngcontent-%COMP%]{display:inline-block;width:96px;height:96px}"]}),t})(),bJ=(()=>{class t{constructor(){this.cellClicked=new l1}ngOnInit(){}cellClickEvent(n){this.cellClicked.emit(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=O1({type:t,selectors:[["app-old-chou-treasure-area"]],inputs:{config:"config"},outputs:{cellClicked:"cellClicked"},decls:5,vars:10,consts:[[3,"y","config","cellClicked"]],template:function(n,i){1&n&&(le(0,"app-old-chou-treasure-row",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he(),le(1,"app-old-chou-treasure-row",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he(),le(2,"app-old-chou-treasure-row",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he(),le(3,"app-old-chou-treasure-row",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he(),le(4,"app-old-chou-treasure-row",0),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he()),2&n&&(yt("y",0)("config",i.config),ht(1),yt("y",1)("config",i.config),ht(1),yt("y",2)("config",i.config),ht(1),yt("y",3)("config",i.config),ht(1),yt("y",4)("config",i.config))},directives:[MJ],styles:["app-old-chou-treasure-row[_ngcontent-%COMP%]{display:block;line-height:0;white-space:nowrap}"]}),t})(),wJ=(()=>{class t{constructor(){this.grid=new M0(void 0)}ngOnInit(){}cellClickEvent(n){let i=n%5,r=Math.floor(n/5);this.grid.updateSpot(i,r),this.grid=new M0(this.grid)}resetGrid(){this.grid=new M0(void 0)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=O1({type:t,selectors:[["app-old-chou-treasure"]],decls:96,vars:1,consts:[[1,"container"],[1,"tool-area"],[1,"ResetLink",3,"click"],[1,"wrap"],[1,"house"],[3,"config","cellClicked"],[1,"blockquote"],[1,"row"],[1,"card",2,"width","18rem"],["src","./assets/chou/unknown.png","alt","...",1,"card-img-top"],[1,"card-body"],[1,"card-title"],[1,"card-text"],["src","./assets/chou/empty.png","alt","...",1,"card-img-top"],["title","North"],["title","East"],["title","South"],["title","West"],["src","./assets/chou/cabbage.png","alt","...",1,"card-img-top"],["src","./assets/chou/iron.png","alt","...",1,"card-img-top"],["src","./assets/chou/question.png","alt","...",1,"card-img-top"],["src","./assets/chou/safe.png","alt","...",1,"card-img-top"]],template:function(n,i){1&n&&(le(0,"div",0),le(1,"div",1),le(2,"h3"),Ge(3,"Old Chou's Treasure Solver"),he(),le(4,"button",2),c1("click",function(){return i.resetGrid()}),Ge(5,"Reset Puzzle"),he(),he(),le(6,"div",3),le(7,"div",4),Ge(8,"Old Chou's"),Vt(9,"br"),Ge(10,"House"),he(),le(11,"app-old-chou-treasure-area",5),c1("cellClicked",function(s){return i.cellClickEvent(s)}),he(),he(),Vt(12,"p"),le(13,"blockquote",6),Ge(14,' Welcome to the Old Chou\u2019s Treasure solver. Basically, it is modified version of Minesweeper. The only real difference is each spot can only have 1 or 2 bombs nearby and it only looks at spots in the \u201cup\u201d, \u201cright\u201d, \u201cdown\u201d and "left" position. So, in game dig out one of the corners and see what happens and make this map match. So, if you get Cabbage, click that spot until it displays a cabbage icon. The goal is to find the Treasure, which is hidden between 4 bombs or on the edge surrounded by bombs. '),he(),le(15,"h3"),Ge(16,"Icon Description"),he(),le(17,"div",7),le(18,"div",8),Vt(19,"img",9),le(20,"div",10),le(21,"h5",11),Ge(22,"Unknown Tile"),he(),le(23,"p",12),Ge(24,"This tile is a mystery."),he(),he(),he(),le(25,"div",8),Vt(26,"img",13),le(27,"div",10),le(28,"h5",11),Ge(29,"Empty Tile"),he(),le(30,"p",12),Ge(31," This tile has no bombs on the "),le(32,"abbr",14),Ge(33,"N"),he(),Ge(34,", "),le(35,"abbr",15),Ge(36,"E"),he(),Ge(37,", "),le(38,"abbr",16),Ge(39,"S"),he(),Ge(40,", "),le(41,"abbr",17),Ge(42,"W"),he(),Ge(43," edges. "),he(),he(),he(),le(44,"div",8),Vt(45,"img",18),le(46,"div",10),le(47,"h5",11),Ge(48,"Cabbage Tile"),he(),le(49,"p",12),Ge(50," This tile has a total of one bomb on either the "),le(51,"abbr",14),Ge(52,"N"),he(),Ge(53,", "),le(54,"abbr",15),Ge(55,"E"),he(),Ge(56,", "),le(57,"abbr",16),Ge(58,"S"),he(),Ge(59,", "),le(60,"abbr",17),Ge(61,"W"),he(),Ge(62," edges. "),he(),he(),he(),le(63,"div",8),Vt(64,"img",19),le(65,"div",10),le(66,"h5",11),Ge(67,"Iron Tile"),he(),le(68,"p",12),Ge(69," This tile has a total of two bombs on either the "),le(70,"abbr",14),Ge(71,"N"),he(),Ge(72,", "),le(73,"abbr",15),Ge(74,"E"),he(),Ge(75,", "),le(76,"abbr",16),Ge(77,"S"),he(),Ge(78,", "),le(79,"abbr",17),Ge(80,"W"),he(),Ge(81," edges. "),he(),he(),he(),le(82,"div",8),Vt(83,"img",20),le(84,"div",10),le(85,"h5",11),Ge(86,"Question Tile"),he(),le(87,"p",12),Ge(88,"The program is unsure what is under this tile."),he(),he(),he(),le(89,"div",8),Vt(90,"img",21),le(91,"div",10),le(92,"h5",11),Ge(93,"Safe Tile"),he(),le(94,"p",12),Ge(95,"The program is sure this tile is safe to dig."),he(),he(),he(),he(),he()),2&n&&(ht(11),yt("config",i.grid))},directives:[bJ],styles:["app-old-chou-treasure-area[_ngcontent-%COMP%]{text-align:center;display:inline-block}.tool-area[_ngcontent-%COMP%]{text-align:center;margin:16px}.wrap[_ngcontent-%COMP%]{text-align:center;white-space:nowrap}.house[_ngcontent-%COMP%]{display:inline-block;background-color:brown;color:#fff;width:128px;height:480px;vertical-align:top;margin-right:16px;font-weight:700}"]}),t})();function SJ(t,e){if(1&t&&(le(0,"div",5),le(1,"div",6),Vt(2,"img",7),le(3,"div",8),le(4,"h5",9),Ge(5),he(),le(6,"h6",10),Ge(7),he(),le(8,"p",11),Ge(9),he(),he(),he(),he()),2&t){const n=e.$implicit,i=y1(2);ht(2),Wo("src","assets/backgrounds/",n.id,".jpg",nh),Wo("alt","Puzzle Image ",n.id,""),ht(2),Wo("routerLink","/puzzle/",n.id,""),ht(1),x2(" ",n.id," "),ht(2),x2(" ",i.getPuzzleType(n)," "),ht(2),x2(" ",n.description," ")}}function CJ(t,e){if(1&t&&(mh(0),X1(1,SJ,10,6,"div",4),gh()),2&t){const n=y1(),i=Y3(6);ht(1),yt("ngForOf",n.items)("ngForElse",i)}}function EJ(t,e){1&t&&(le(0,"div",12),Ge(1," No puzzles are available "),he())}let zJ=(()=>{class t{constructor(n,i){this.dataSource=n,this.route=i,this.pageName="Unknown",this.items=[],this.route.params.subscribe(r=>{let s=parseInt(r.island);if(s>=-1&&s<this.dataSource.islands.length){this.pageName=s>=0?this.dataSource.islands[s]:"All";let a=[];this.dataSource.puzzles.forEach(function(o,c){o.type!=E1.BROKEN&&(o.islandIndex==s||-1==s)&&a.push(o)}),a.sort((o,c)=>o.id<c.id?-1:o.id>c.id?1:0),this.items=a}})}ngOnInit(){}getPuzzleType(n){return n.type===E1.LIGHT?"Light Up":"Spinning"}}return t.\u0275fac=function(n){return new(n||t)(He(Ll),He(Da))},t.\u0275cmp=O1({type:t,selectors:[["app-puzzle-listing"]],decls:7,vars:3,consts:[[1,"container"],[1,"row"],[4,"ngIf","ngIfElse"],["noSolutionBlock",""],["class","col-xs-12 col-sm-12 col-md-4",4,"ngFor","ngForOf","ngForElse"],[1,"col-xs-12","col-sm-12","col-md-4"],[1,"card"],[1,"card-img-top",3,"src","alt"],[1,"card-body"],["title","View Pizzle Details",1,"card-title",3,"routerLink"],[1,"card-subtitle","mb-2","text-muted"],[1,"card-text"],[1,"solutionRow","alert","alert-warning"]],template:function(n,i){if(1&n&&(le(0,"div",0),le(1,"h2"),Ge(2),he(),le(3,"div",1),X1(4,CJ,2,2,"ng-container",2),X1(5,EJ,2,0,"ng-template",null,3,ll),he(),he()),2&n){const r=Y3(6);ht(2),wa(i.pageName),ht(2),yt("ngIf",i.items&&i.items.length>0)("ngIfElse",r)}},directives:[u0,Ta,fu],styles:["h5.card-title[_ngcontent-%COMP%]{color:#0d6efd;cursor:pointer}h5.card-title[_ngcontent-%COMP%]:hover{color:#0a58ca}div.card[_ngcontent-%COMP%]{margin-top:4px}"]}),t})();class ql{constructor(e,n){this.puzzleType=e,this.directions=n}rotateIndex(e,n){if(e>=0&&e<this.directions.length){let i=this.directions[e],r=i;if(r=n?this.getPreviousDirection(i):this.getNextDirection(i),r!=i)return this.directions[e]=r,!0}return!1}getNextDirection(e){switch(e){case Ae.NORTH:return Ae.EAST;case Ae.EAST:return Ae.SOUTH;case Ae.SOUTH:return Ae.WEST;case Ae.WEST:return Ae.NORTH;case Ae.ONE:return Ae.TWO;case Ae.TWO:return Ae.THREE;case Ae.THREE:return Ae.ONE}return Ae.NORTH}getPreviousDirection(e){switch(e){case Ae.NORTH:return Ae.WEST;case Ae.EAST:return Ae.NORTH;case Ae.SOUTH:return Ae.EAST;case Ae.WEST:return Ae.SOUTH;case Ae.ONE:return Ae.THREE;case Ae.TWO:return Ae.ONE;case Ae.THREE:return Ae.TWO}return Ae.NORTH}}function TJ(t){return t.every(e=>e==t[0])}function KT(t,e){return(t%e+e)%e}function QT(t,e,n,i,r,s,a){try{var o=t[s](a),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(i,r)}function eA(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var s=t.apply(e,n);function a(c){QT(s,i,r,a,o,"next",c)}function o(c){QT(s,i,r,a,o,"throw",c)}a(void 0)})}}const Ki=1001,Rn=1003,an=1006,c4=1009,Xl=1012,Va=1015,z0=1016,T0=1020,Fi=1023,l4=1026,A0=1027,L0=2400,D0=2401,Oa=3e3,U1=3001,Yl=35044,Jl=35048;class h4{addEventListener(e,n){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(n)&&i[e].push(n)}hasEventListener(e,n){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(n)}removeEventListener(e,n){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(n);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const si=[];for(let t=0;t<256;t++)si[t]=(t<16?"0":"")+t.toString(16);const u4=Math.PI/180,Kl=180/Math.PI;function C2(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(si[255&t]+si[t>>8&255]+si[t>>16&255]+si[t>>24&255]+"-"+si[255&e]+si[e>>8&255]+"-"+si[e>>16&15|64]+si[e>>24&255]+"-"+si[63&n|128]+si[n>>8&255]+"-"+si[n>>16&255]+si[n>>24&255]+si[255&i]+si[i>>8&255]+si[i>>16&255]+si[i>>24&255]).toUpperCase()}function ai(t,e,n){return Math.max(e,Math.min(n,t))}function Ql(t,e,n){return(1-n)*t+n*e}function jg(t){return 0==(t&t-1)&&0!==t}function Gu(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}class ze{constructor(e=0,n=0){this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,n){return void 0!==n?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e,n){return void 0!==n?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,a=this.y-e.y;return this.x=s*i-a*r+e.x,this.y=s*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}ze.prototype.isVector2=!0;class jn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,n,i,r,s,a,o,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=n,u[4]=s,u[5]=c,u[6]=i,u[7]=a,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[3],c=i[6],l=i[1],u=i[4],f=i[7],d=i[2],m=i[5],v=i[8],_=r[0],M=r[3],y=r[6],g=r[1],S=r[4],b=r[7],E=r[2],P=r[5],V=r[8];return s[0]=a*_+o*g+c*E,s[3]=a*M+o*S+c*P,s[6]=a*y+o*b+c*V,s[1]=l*_+u*g+f*E,s[4]=l*M+u*S+f*P,s[7]=l*y+u*b+f*V,s[2]=d*_+m*g+v*E,s[5]=d*M+m*S+v*P,s[8]=d*y+m*b+v*V,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8];return n*a*u-n*o*l-i*s*u+i*o*c+r*s*l-r*a*c}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8],f=u*a-o*l,d=o*c-u*s,m=l*s-a*c,v=n*f+i*d+r*m;if(0===v)return this.set(0,0,0,0,0,0,0,0,0);const _=1/v;return e[0]=f*_,e[1]=(r*l-u*i)*_,e[2]=(o*i-r*a)*_,e[3]=d*_,e[4]=(u*n-r*c)*_,e[5]=(r*s-o*n)*_,e[6]=m*_,e[7]=(i*c-l*n)*_,e[8]=(a*n-i*s)*_,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,a,o){const c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*a+l*o)+a+e,-r*l,r*c,-r*(-l*a+c*o)+o+n,0,0,1),this}scale(e,n){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=n,i[4]*=n,i[7]*=n,this}rotate(e){const n=Math.cos(e),i=Math.sin(e),r=this.elements,s=r[0],a=r[3],o=r[6],c=r[1],l=r[4],u=r[7];return r[0]=n*s+i*c,r[3]=n*a+i*l,r[6]=n*o+i*u,r[1]=-i*s+n*c,r[4]=-i*a+n*l,r[7]=-i*o+n*u,this}translate(e,n){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=n*i[2],i[4]+=n*i[5],i[7]+=n*i[8],this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function IA(t){for(let e=t.length-1;e>=0;--e)if(t[e]>65535)return!0;return!1}function e8(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}jn.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const VA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Cr={h:0,s:0,l:0},Wu={h:0,s:0,l:0};function qg(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function R0(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Zg(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let H0,it=(()=>{class t{constructor(n,i,r){return void 0===i&&void 0===r?this.set(n):this.setRGB(n,i,r)}set(n){return n&&n.isColor?this.copy(n):"number"==typeof n?this.setHex(n):"string"==typeof n&&this.setStyle(n),this}setScalar(n){return this.r=n,this.g=n,this.b=n,this}setHex(n){return n=Math.floor(n),this.r=(n>>16&255)/255,this.g=(n>>8&255)/255,this.b=(255&n)/255,this}setRGB(n,i,r){return this.r=n,this.g=i,this.b=r,this}setHSL(n,i,r){if(n=function Wg(t,e){return(t%e+e)%e}(n,1),i=ai(i,0,1),r=ai(r,0,1),0===i)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+i):r+i-r*i,a=2*r-s;this.r=qg(a,s,n+1/3),this.g=qg(a,s,n),this.b=qg(a,s,n-1/3)}return this}setStyle(n){function i(s){void 0!==s&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+n+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(n)){let s;const o=r[2];switch(r[1]){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const c=parseFloat(s[1])/360,l=parseInt(s[2],10)/100,u=parseInt(s[3],10)/100;return i(s[4]),this.setHSL(c,l,u)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(n)){const s=r[1],a=s.length;if(3===a)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===a)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return n&&n.length>0?this.setColorName(n):this}setColorName(n){const i=VA[n.toLowerCase()];return void 0!==i?this.setHex(i):console.warn("THREE.Color: Unknown color "+n),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(n){return this.r=n.r,this.g=n.g,this.b=n.b,this}copySRGBToLinear(n){return this.r=R0(n.r),this.g=R0(n.g),this.b=R0(n.b),this}copyLinearToSRGB(n){return this.r=Zg(n.r),this.g=Zg(n.g),this.b=Zg(n.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(n){const i=this.r,r=this.g,s=this.b,a=Math.max(i,r,s),o=Math.min(i,r,s);let c,l;const u=(o+a)/2;if(o===a)c=0,l=0;else{const f=a-o;switch(l=u<=.5?f/(a+o):f/(2-a-o),a){case i:c=(r-s)/f+(r<s?6:0);break;case r:c=(s-i)/f+2;break;case s:c=(i-r)/f+4}c/=6}return n.h=c,n.s=l,n.l=u,n}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(n,i,r){return this.getHSL(Cr),Cr.h+=n,Cr.s+=i,Cr.l+=r,this.setHSL(Cr.h,Cr.s,Cr.l),this}add(n){return this.r+=n.r,this.g+=n.g,this.b+=n.b,this}addColors(n,i){return this.r=n.r+i.r,this.g=n.g+i.g,this.b=n.b+i.b,this}addScalar(n){return this.r+=n,this.g+=n,this.b+=n,this}sub(n){return this.r=Math.max(0,this.r-n.r),this.g=Math.max(0,this.g-n.g),this.b=Math.max(0,this.b-n.b),this}multiply(n){return this.r*=n.r,this.g*=n.g,this.b*=n.b,this}multiplyScalar(n){return this.r*=n,this.g*=n,this.b*=n,this}lerp(n,i){return this.r+=(n.r-this.r)*i,this.g+=(n.g-this.g)*i,this.b+=(n.b-this.b)*i,this}lerpColors(n,i,r){return this.r=n.r+(i.r-n.r)*r,this.g=n.g+(i.g-n.g)*r,this.b=n.b+(i.b-n.b)*r,this}lerpHSL(n,i){this.getHSL(Cr),n.getHSL(Wu);const r=Ql(Cr.h,Wu.h,i),s=Ql(Cr.s,Wu.s,i),a=Ql(Cr.l,Wu.l,i);return this.setHSL(r,s,a),this}equals(n){return n.r===this.r&&n.g===this.g&&n.b===this.b}fromArray(n,i=0){return this.r=n[i],this.g=n[i+1],this.b=n[i+2],this}toArray(n=[],i=0){return n[i]=this.r,n[i+1]=this.g,n[i+2]=this.b,n}fromBufferAttribute(n,i){return this.r=n.getX(i),this.g=n.getY(i),this.b=n.getZ(i),!0===n.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return t.NAMES=VA,t})();it.prototype.isColor=!0,it.prototype.r=1,it.prototype.g=1,it.prototype.b=1;class f4{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{void 0===H0&&(H0=e8("canvas")),H0.width=e.width,H0.height=e.height;const i=H0.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=H0}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const n=e8("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=255*R0(s[a]/255);return i.putImageData(r,0,0),n}if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n[i]=n instanceof Uint8Array||n instanceof Uint8ClampedArray?Math.floor(255*R0(n[i]/255)):R0(n[i]);return{data:n,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class I0{constructor(e=null){this.uuid=C2(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const n=void 0===e||"string"==typeof e;if(!n&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)s.push($g(r[a].isDataTexture?r[a].image:r[a]))}else s=$g(r);i.url=s}return n||(e.images[this.uuid]=i),i}}function $g(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?f4.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}I0.prototype.isSource=!0;let GK=0,Qi=(()=>{class t extends h4{constructor(n=t.DEFAULT_IMAGE,i=t.DEFAULT_MAPPING,r=Ki,s=Ki,a=an,o=1008,c=Fi,l=c4,u=1,f=Oa){super(),Object.defineProperty(this,"id",{value:GK++}),this.uuid=C2(),this.name="",this.source=new I0(n),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=s,this.magFilter=a,this.minFilter=o,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new ze(0,0),this.repeat=new ze(1,1),this.center=new ze(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new jn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(n){this.source.data=n}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(n){return this.name=n.name,this.source=n.source,this.mipmaps=n.mipmaps.slice(0),this.mapping=n.mapping,this.wrapS=n.wrapS,this.wrapT=n.wrapT,this.magFilter=n.magFilter,this.minFilter=n.minFilter,this.anisotropy=n.anisotropy,this.format=n.format,this.internalFormat=n.internalFormat,this.type=n.type,this.offset.copy(n.offset),this.repeat.copy(n.repeat),this.center.copy(n.center),this.rotation=n.rotation,this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrix.copy(n.matrix),this.generateMipmaps=n.generateMipmaps,this.premultiplyAlpha=n.premultiplyAlpha,this.flipY=n.flipY,this.unpackAlignment=n.unpackAlignment,this.encoding=n.encoding,this.userData=JSON.parse(JSON.stringify(n.userData)),this.needsUpdate=!0,this}toJSON(n){const i=void 0===n||"string"==typeof n;if(!i&&void 0!==n.textures[this.uuid])return n.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(n).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i||(n.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(n){if(300!==this.mapping)return n;if(n.applyMatrix3(this.matrix),n.x<0||n.x>1)switch(this.wrapS){case 1e3:n.x=n.x-Math.floor(n.x);break;case Ki:n.x=n.x<0?0:1;break;case 1002:n.x=1===Math.abs(Math.floor(n.x)%2)?Math.ceil(n.x)-n.x:n.x-Math.floor(n.x)}if(n.y<0||n.y>1)switch(this.wrapT){case 1e3:n.y=n.y-Math.floor(n.y);break;case Ki:n.y=n.y<0?0:1;break;case 1002:n.y=1===Math.abs(Math.floor(n.y)%2)?Math.ceil(n.y)-n.y:n.y-Math.floor(n.y)}return this.flipY&&(n.y=1-n.y),n}set needsUpdate(n){!0===n&&(this.version++,this.source.needsUpdate=!0)}}return t.DEFAULT_IMAGE=null,t.DEFAULT_MAPPING=300,t})();Qi.prototype.isTexture=!0;class _1{constructor(e=0,n=0,i=0,r=1){this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,n){return void 0!==n?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e,n){return void 0!==n?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*r+a[12]*s,this.y=a[1]*n+a[5]*i+a[9]*r+a[13]*s,this.z=a[2]*n+a[6]*i+a[10]*r+a[14]*s,this.w=a[3]*n+a[7]*i+a[11]*r+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const c=e.elements,l=c[0],u=c[4],f=c[8],d=c[1],m=c[5],v=c[9],_=c[2],M=c[6],y=c[10];if(Math.abs(u-d)<.01&&Math.abs(f-_)<.01&&Math.abs(v-M)<.01){if(Math.abs(u+d)<.1&&Math.abs(f+_)<.1&&Math.abs(v+M)<.1&&Math.abs(l+m+y-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const S=(l+1)/2,b=(m+1)/2,E=(y+1)/2,P=(u+d)/4,V=(f+_)/4,j=(v+M)/4;return S>b&&S>E?S<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(S),r=P/i,s=V/i):b>E?b<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),i=P/r,s=j/r):E<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(E),i=V/s,r=j/s),this.set(i,r,s,n),this}let g=Math.sqrt((M-v)*(M-v)+(f-_)*(f-_)+(d-u)*(d-u));return Math.abs(g)<.001&&(g=1),this.x=(M-v)/g,this.y=(f-_)/g,this.z=(d-u)/g,this.w=Math.acos((l+m+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}_1.prototype.isVector4=!0;class e2 extends h4{constructor(e,n,i={}){super(),this.width=e,this.height=n,this.depth=1,this.scissor=new _1(0,0,e,n),this.scissorTest=!1,this.viewport=new _1(0,0,e,n),this.texture=new Qi({width:e,height:n,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:an,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,n,i=1){(this.width!==e||this.height!==n||this.depth!==i)&&(this.width=e,this.height=n,this.depth=i,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}e2.prototype.isWebGLRenderTarget=!0;class t8 extends Qi{constructor(e=null,n=1,i=1,r=1){super(null),this.image={data:e,width:n,height:i,depth:r},this.magFilter=Rn,this.minFilter=Rn,this.wrapR=Ki,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}t8.prototype.isDataArrayTexture=!0,class WK extends e2{constructor(e,n,i){super(e,n),this.depth=i,this.texture=new t8(null,e,n,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGLArrayRenderTarget=!0;class ju extends Qi{constructor(e=null,n=1,i=1,r=1){super(null),this.image={data:e,width:n,height:i,depth:r},this.magFilter=Rn,this.minFilter=Rn,this.wrapR=Ki,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}ju.prototype.isData3DTexture=!0,class jK extends e2{constructor(e,n,i){super(e,n),this.depth=i,this.texture=new ju(null,e,n,i),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGL3DRenderTarget=!0,class qK extends e2{constructor(e,n,i,r={}){super(e,n,r);const s=this.texture;this.texture=[];for(let a=0;a<i;a++)this.texture[a]=s.clone(),this.texture[a].isRenderTargetTexture=!0}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=n,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let n=0,i=e.texture.length;n<i;n++)this.texture[n]=e.texture[n].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class wi{constructor(e=0,n=0,i=0,r=1){this._x=e,this._y=n,this._z=i,this._w=r}static slerp(e,n,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,n,r)}static slerpFlat(e,n,i,r,s,a,o){let c=i[r+0],l=i[r+1],u=i[r+2],f=i[r+3];const d=s[a+0],m=s[a+1],v=s[a+2],_=s[a+3];if(0===o)return e[n+0]=c,e[n+1]=l,e[n+2]=u,void(e[n+3]=f);if(1===o)return e[n+0]=d,e[n+1]=m,e[n+2]=v,void(e[n+3]=_);if(f!==_||c!==d||l!==m||u!==v){let M=1-o;const y=c*d+l*m+u*v+f*_,g=y>=0?1:-1,S=1-y*y;if(S>Number.EPSILON){const E=Math.sqrt(S),P=Math.atan2(E,y*g);M=Math.sin(M*P)/E,o=Math.sin(o*P)/E}const b=o*g;if(c=c*M+d*b,l=l*M+m*b,u=u*M+v*b,f=f*M+_*b,M===1-o){const E=1/Math.sqrt(c*c+l*l+u*u+f*f);c*=E,l*=E,u*=E,f*=E}}e[n]=c,e[n+1]=l,e[n+2]=u,e[n+3]=f}static multiplyQuaternionsFlat(e,n,i,r,s,a){const o=i[r],c=i[r+1],l=i[r+2],u=i[r+3],f=s[a],d=s[a+1],m=s[a+2],v=s[a+3];return e[n]=o*v+u*f+c*m-l*d,e[n+1]=c*v+u*d+l*f-o*m,e[n+2]=l*v+u*m+o*d-c*f,e[n+3]=u*v-o*f-c*d-l*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,c=Math.sin,l=o(i/2),u=o(r/2),f=o(s/2),d=c(i/2),m=c(r/2),v=c(s/2);switch(a){case"XYZ":this._x=d*u*f+l*m*v,this._y=l*m*f-d*u*v,this._z=l*u*v+d*m*f,this._w=l*u*f-d*m*v;break;case"YXZ":this._x=d*u*f+l*m*v,this._y=l*m*f-d*u*v,this._z=l*u*v-d*m*f,this._w=l*u*f+d*m*v;break;case"ZXY":this._x=d*u*f-l*m*v,this._y=l*m*f+d*u*v,this._z=l*u*v+d*m*f,this._w=l*u*f-d*m*v;break;case"ZYX":this._x=d*u*f-l*m*v,this._y=l*m*f+d*u*v,this._z=l*u*v-d*m*f,this._w=l*u*f+d*m*v;break;case"YZX":this._x=d*u*f+l*m*v,this._y=l*m*f+d*u*v,this._z=l*u*v-d*m*f,this._w=l*u*f-d*m*v;break;case"XZY":this._x=d*u*f-l*m*v,this._y=l*m*f-d*u*v,this._z=l*u*v+d*m*f,this._w=l*u*f+d*m*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==n&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],a=n[1],o=n[5],c=n[9],l=n[2],u=n[6],f=n[10],d=i+o+f;if(d>0){const m=.5/Math.sqrt(d+1);this._w=.25/m,this._x=(u-c)*m,this._y=(s-l)*m,this._z=(a-r)*m}else if(i>o&&i>f){const m=2*Math.sqrt(1+i-o-f);this._w=(u-c)/m,this._x=.25*m,this._y=(r+a)/m,this._z=(s+l)/m}else if(o>f){const m=2*Math.sqrt(1+o-i-f);this._w=(s-l)/m,this._x=(r+a)/m,this._y=.25*m,this._z=(c+u)/m}else{const m=2*Math.sqrt(1+f-i-o);this._w=(a-r)/m,this._x=(s+l)/m,this._y=(c+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ai(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,n){return void 0!==n?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,n)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,a=e._w,o=n._x,c=n._y,l=n._z,u=n._w;return this._x=i*u+a*o+r*l-s*c,this._y=r*u+a*c+s*o-i*l,this._z=s*u+a*l+i*c-r*o,this._w=a*u-i*o-r*c-s*l,this._onChangeCallback(),this}slerp(e,n){if(0===n)return this;if(1===n)return this.copy(e);const i=this._x,r=this._y,s=this._z,a=this._w;let o=a*e._w+i*e._x+r*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=i,this._y=r,this._z=s,this;const c=1-o*o;if(c<=Number.EPSILON){const m=1-n;return this._w=m*a+n*this._w,this._x=m*i+n*this._x,this._y=m*r+n*this._y,this._z=m*s+n*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(c),u=Math.atan2(l,o),f=Math.sin((1-n)*u)/l,d=Math.sin(n*u)/l;return this._w=a*f+this._w*d,this._x=i*f+this._x*d,this._y=r*f+this._y*d,this._z=s*f+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=Math.random(),n=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(n*Math.cos(r),i*Math.sin(s),i*Math.cos(s),n*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}wi.prototype.isQuaternion=!0;class W{constructor(e=0,n=0,i=0){this.x=e,this.y=n,this.z=i}set(e,n,i){return void 0===i&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,n){return void 0!==n?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,n)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e,n){return void 0!==n?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,n)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e,n){return void 0!==n?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,n)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(OA.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(OA.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,a=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*a,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*a,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,a=e.y,o=e.z,c=e.w,l=c*n+a*r-o*i,u=c*i+o*n-s*r,f=c*r+s*i-a*n,d=-s*n-a*i-o*r;return this.x=l*c+d*-s+u*-o-f*-a,this.y=u*c+d*-a+f*-s-l*-o,this.z=f*c+d*-o+l*-a-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e,n){return void 0!==n?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,n)):this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,a=n.x,o=n.y,c=n.z;return this.x=r*c-s*o,this.y=s*a-i*c,this.z=i*o-r*a,this}projectOnVector(e){const n=e.lengthSq();if(0===n)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Xg.copy(this).projectOnVector(e),this.sub(Xg)}reflect(e){return this.sub(Xg.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===n)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(ai(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,4*n)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,3*n)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}W.prototype.isVector3=!0;const Xg=new W,OA=new wi;class $2{constructor(e=new W(1/0,1/0,1/0),n=new W(-1/0,-1/0,-1/0)){this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){let n=1/0,i=1/0,r=1/0,s=-1/0,a=-1/0,o=-1/0;for(let c=0,l=e.length;c<l;c+=3){const u=e[c],f=e[c+1],d=e[c+2];u<n&&(n=u),f<i&&(i=f),d<r&&(r=d),u>s&&(s=u),f>a&&(a=f),d>o&&(o=d)}return this.min.set(n,i,r),this.max.set(s,a,o),this}setFromBufferAttribute(e){let n=1/0,i=1/0,r=1/0,s=-1/0,a=-1/0,o=-1/0;for(let c=0,l=e.count;c<l;c++){const u=e.getX(c),f=e.getY(c),d=e.getZ(c);u<n&&(n=u),f<i&&(i=f),d<r&&(r=d),u>s&&(s=u),f>a&&(a=f),d>o&&(o=d)}return this.min.set(n,i,r),this.max.set(s,a,o),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=d4.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(n&&null!=i.attributes&&void 0!==i.attributes.position){const s=i.attributes.position;for(let a=0,o=s.count;a<o;a++)d4.fromBufferAttribute(s,a).applyMatrix4(e.matrixWorld),this.expandByPoint(d4)}else null===i.boundingBox&&i.computeBoundingBox(),Yg.copy(i.boundingBox),Yg.applyMatrix4(e.matrixWorld),this.union(Yg);const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,d4),d4.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(n8),qu.subVectors(this.max,n8),V0.subVectors(e.a,n8),O0.subVectors(e.b,n8),k0.subVectors(e.c,n8),ka.subVectors(O0,V0),Fa.subVectors(k0,O0),p4.subVectors(V0,k0);let n=[0,-ka.z,ka.y,0,-Fa.z,Fa.y,0,-p4.z,p4.y,ka.z,0,-ka.x,Fa.z,0,-Fa.x,p4.z,0,-p4.x,-ka.y,ka.x,0,-Fa.y,Fa.x,0,-p4.y,p4.x,0];return!(!Jg(n,V0,O0,k0,qu)||(n=[1,0,0,0,1,0,0,0,1],!Jg(n,V0,O0,k0,qu)))&&(Zu.crossVectors(ka,Fa),n=[Zu.x,Zu.y,Zu.z],Jg(n,V0,O0,k0,qu))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return d4.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(d4).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Gs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Gs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Gs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Gs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Gs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Gs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Gs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Gs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Gs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}$2.prototype.isBox3=!0;const Gs=[new W,new W,new W,new W,new W,new W,new W,new W],d4=new W,Yg=new $2,V0=new W,O0=new W,k0=new W,ka=new W,Fa=new W,p4=new W,n8=new W,qu=new W,Zu=new W,m4=new W;function Jg(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){m4.fromArray(t,s);const o=r.x*Math.abs(m4.x)+r.y*Math.abs(m4.y)+r.z*Math.abs(m4.z),c=e.dot(m4),l=n.dot(m4),u=i.dot(m4);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>o)return!1}return!0}const ZK=new $2,kA=new W,$u=new W,Kg=new W;class g4{constructor(e=new W,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;void 0!==n?i.copy(n):ZK.setFromPoints(e).getCenter(i);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Kg.subVectors(e,this.center);const n=Kg.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=.5*(i-this.radius);this.center.add(Kg.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?$u.set(0,0,1).multiplyScalar(e.radius):$u.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(kA.copy(e.center).add($u)),this.expandByPoint(kA.copy(e.center).sub($u)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Ws=new W,Qg=new W,Xu=new W,Ba=new W,ev=new W,Yu=new W,tv=new W;class v4{constructor(e=new W,n=new W(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ws)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Ws.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Ws.copy(this.direction).multiplyScalar(n).add(this.origin),Ws.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){Qg.copy(e).add(n).multiplyScalar(.5),Xu.copy(n).sub(e).normalize(),Ba.copy(this.origin).sub(Qg);const s=.5*e.distanceTo(n),a=-this.direction.dot(Xu),o=Ba.dot(this.direction),c=-Ba.dot(Xu),l=Ba.lengthSq(),u=Math.abs(1-a*a);let f,d,m,v;if(u>0)if(f=a*c-o,d=a*o-c,v=s*u,f>=0)if(d>=-v)if(d<=v){const _=1/u;f*=_,d*=_,m=f*(f+a*d+2*o)+d*(a*f+d+2*c)+l}else d=s,f=Math.max(0,-(a*d+o)),m=-f*f+d*(d+2*c)+l;else d=-s,f=Math.max(0,-(a*d+o)),m=-f*f+d*(d+2*c)+l;else d<=-v?(f=Math.max(0,-(-a*s+o)),d=f>0?-s:Math.min(Math.max(-s,-c),s),m=-f*f+d*(d+2*c)+l):d<=v?(f=0,d=Math.min(Math.max(-s,-c),s),m=d*(d+2*c)+l):(f=Math.max(0,-(a*s+o)),d=f>0?s:Math.min(Math.max(-s,-c),s),m=-f*f+d*(d+2*c)+l);else d=a>0?-s:s,f=Math.max(0,-(a*d+o)),m=-f*f+d*(d+2*c)+l;return i&&i.copy(this.direction).multiplyScalar(f).add(this.origin),r&&r.copy(Xu).multiplyScalar(d).add(Qg),m}intersectSphere(e,n){Ws.subVectors(e.center,this.origin);const i=Ws.dot(this.direction),r=Ws.dot(Ws)-i*i,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=i-a,c=i+a;return o<0&&c<0?null:this.at(o<0?c:o,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(0===n)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return null===i?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return 0===n||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,a,o,c;const l=1/this.direction.x,u=1/this.direction.y,f=1/this.direction.z,d=this.origin;return l>=0?(i=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(s=(e.min.y-d.y)*u,a=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,a=(e.min.y-d.y)*u),i>a||s>r||((s>i||i!=i)&&(i=s),(a<r||r!=r)&&(r=a),f>=0?(o=(e.min.z-d.z)*f,c=(e.max.z-d.z)*f):(o=(e.max.z-d.z)*f,c=(e.min.z-d.z)*f),i>c||o>r)||((o>i||i!=i)&&(i=o),(c<r||r!=r)&&(r=c),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return null!==this.intersectBox(e,Ws)}intersectTriangle(e,n,i,r,s){ev.subVectors(n,e),Yu.subVectors(i,e),tv.crossVectors(ev,Yu);let o,a=this.direction.dot(tv);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}Ba.subVectors(this.origin,e);const c=o*this.direction.dot(Yu.crossVectors(Ba,Yu));if(c<0)return null;const l=o*this.direction.dot(ev.cross(Ba));if(l<0||c+l>a)return null;const u=-o*Ba.dot(tv);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class mt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,n,i,r,s,a,o,c,l,u,f,d,m,v,_,M){const y=this.elements;return y[0]=e,y[4]=n,y[8]=i,y[12]=r,y[1]=s,y[5]=a,y[9]=o,y[13]=c,y[2]=l,y[6]=u,y[10]=f,y[14]=d,y[3]=m,y[7]=v,y[11]=_,y[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new mt).fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/F0.setFromMatrixColumn(e,0).length(),s=1/F0.setFromMatrixColumn(e,1).length(),a=1/F0.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const n=this.elements,i=e.x,r=e.y,s=e.z,a=Math.cos(i),o=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),f=Math.sin(s);if("XYZ"===e.order){const d=a*u,m=a*f,v=o*u,_=o*f;n[0]=c*u,n[4]=-c*f,n[8]=l,n[1]=m+v*l,n[5]=d-_*l,n[9]=-o*c,n[2]=_-d*l,n[6]=v+m*l,n[10]=a*c}else if("YXZ"===e.order){const d=c*u,m=c*f,v=l*u,_=l*f;n[0]=d+_*o,n[4]=v*o-m,n[8]=a*l,n[1]=a*f,n[5]=a*u,n[9]=-o,n[2]=m*o-v,n[6]=_+d*o,n[10]=a*c}else if("ZXY"===e.order){const d=c*u,m=c*f,v=l*u,_=l*f;n[0]=d-_*o,n[4]=-a*f,n[8]=v+m*o,n[1]=m+v*o,n[5]=a*u,n[9]=_-d*o,n[2]=-a*l,n[6]=o,n[10]=a*c}else if("ZYX"===e.order){const d=a*u,m=a*f,v=o*u,_=o*f;n[0]=c*u,n[4]=v*l-m,n[8]=d*l+_,n[1]=c*f,n[5]=_*l+d,n[9]=m*l-v,n[2]=-l,n[6]=o*c,n[10]=a*c}else if("YZX"===e.order){const d=a*c,m=a*l,v=o*c,_=o*l;n[0]=c*u,n[4]=_-d*f,n[8]=v*f+m,n[1]=f,n[5]=a*u,n[9]=-o*u,n[2]=-l*u,n[6]=m*f+v,n[10]=d-_*f}else if("XZY"===e.order){const d=a*c,m=a*l,v=o*c,_=o*l;n[0]=c*u,n[4]=-f,n[8]=l*u,n[1]=d*f+_,n[5]=a*u,n[9]=m*f-v,n[2]=v*f-m,n[6]=o*u,n[10]=_*f+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose($K,e,XK)}lookAt(e,n,i){const r=this.elements;return E2.subVectors(e,n),0===E2.lengthSq()&&(E2.z=1),E2.normalize(),Ua.crossVectors(i,E2),0===Ua.lengthSq()&&(1===Math.abs(i.z)?E2.x+=1e-4:E2.z+=1e-4,E2.normalize(),Ua.crossVectors(i,E2)),Ua.normalize(),Ju.crossVectors(E2,Ua),r[0]=Ua.x,r[4]=Ju.x,r[8]=E2.x,r[1]=Ua.y,r[5]=Ju.y,r[9]=E2.y,r[2]=Ua.z,r[6]=Ju.z,r[10]=E2.z,this}multiply(e,n){return void 0!==n?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,n)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[4],c=i[8],l=i[12],u=i[1],f=i[5],d=i[9],m=i[13],v=i[2],_=i[6],M=i[10],y=i[14],g=i[3],S=i[7],b=i[11],E=i[15],P=r[0],V=r[4],j=r[8],Y=r[12],G=r[1],C=r[5],N=r[9],F=r[13],U=r[2],$=r[6],O=r[10],I=r[14],k=r[3],K=r[7],re=r[11],ae=r[15];return s[0]=a*P+o*G+c*U+l*k,s[4]=a*V+o*C+c*$+l*K,s[8]=a*j+o*N+c*O+l*re,s[12]=a*Y+o*F+c*I+l*ae,s[1]=u*P+f*G+d*U+m*k,s[5]=u*V+f*C+d*$+m*K,s[9]=u*j+f*N+d*O+m*re,s[13]=u*Y+f*F+d*I+m*ae,s[2]=v*P+_*G+M*U+y*k,s[6]=v*V+_*C+M*$+y*K,s[10]=v*j+_*N+M*O+y*re,s[14]=v*Y+_*F+M*I+y*ae,s[3]=g*P+S*G+b*U+E*k,s[7]=g*V+S*C+b*$+E*K,s[11]=g*j+S*N+b*O+E*re,s[15]=g*Y+S*F+b*I+E*ae,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],a=e[1],o=e[5],c=e[9],l=e[13],u=e[2],f=e[6],d=e[10],m=e[14];return e[3]*(+s*c*f-r*l*f-s*o*d+i*l*d+r*o*m-i*c*m)+e[7]*(+n*c*m-n*l*d+s*a*d-r*a*m+r*l*u-s*c*u)+e[11]*(+n*l*f-n*o*m-s*a*f+i*a*m+s*o*u-i*l*u)+e[15]*(-r*o*u-n*c*f+n*o*d+r*a*f-i*a*d+i*c*u)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8],f=e[9],d=e[10],m=e[11],v=e[12],_=e[13],M=e[14],y=e[15],g=f*M*l-_*d*l+_*c*m-o*M*m-f*c*y+o*d*y,S=v*d*l-u*M*l-v*c*m+a*M*m+u*c*y-a*d*y,b=u*_*l-v*f*l+v*o*m-a*_*m-u*o*y+a*f*y,E=v*f*c-u*_*c-v*o*d+a*_*d+u*o*M-a*f*M,P=n*g+i*S+r*b+s*E;if(0===P)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const V=1/P;return e[0]=g*V,e[1]=(_*d*s-f*M*s-_*r*m+i*M*m+f*r*y-i*d*y)*V,e[2]=(o*M*s-_*c*s+_*r*l-i*M*l-o*r*y+i*c*y)*V,e[3]=(f*c*s-o*d*s-f*r*l+i*d*l+o*r*m-i*c*m)*V,e[4]=S*V,e[5]=(u*M*s-v*d*s+v*r*m-n*M*m-u*r*y+n*d*y)*V,e[6]=(v*c*s-a*M*s-v*r*l+n*M*l+a*r*y-n*c*y)*V,e[7]=(a*d*s-u*c*s+u*r*l-n*d*l-a*r*m+n*c*m)*V,e[8]=b*V,e[9]=(v*f*s-u*_*s-v*i*m+n*_*m+u*i*y-n*f*y)*V,e[10]=(a*_*s-v*o*s+v*i*l-n*_*l-a*i*y+n*o*y)*V,e[11]=(u*o*s-a*f*s-u*i*l+n*f*l+a*i*m-n*o*m)*V,e[12]=E*V,e[13]=(u*_*r-v*f*r+v*i*d-n*_*d-u*i*M+n*f*M)*V,e[14]=(v*o*r-a*_*r-v*i*c+n*_*c+a*i*M-n*o*M)*V,e[15]=(a*f*r-u*o*r+u*i*c-n*f*c-a*i*d+n*o*d)*V,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,n,i){return this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,a=e.x,o=e.y,c=e.z,l=s*a,u=s*o;return this.set(l*a+i,l*o-r*c,l*c+r*o,0,l*o+r*c,u*o+i,u*c-r*a,0,l*c-r*o,u*c+r*a,s*c*c+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,a){return this.set(1,i,s,0,e,1,a,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,a=n._y,o=n._z,c=n._w,l=s+s,u=a+a,f=o+o,d=s*l,m=s*u,v=s*f,_=a*u,M=a*f,y=o*f,g=c*l,S=c*u,b=c*f,E=i.x,P=i.y,V=i.z;return r[0]=(1-(_+y))*E,r[1]=(m+b)*E,r[2]=(v-S)*E,r[3]=0,r[4]=(m-b)*P,r[5]=(1-(d+y))*P,r[6]=(M+g)*P,r[7]=0,r[8]=(v+S)*V,r[9]=(M-g)*V,r[10]=(1-(d+_))*V,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=F0.set(r[0],r[1],r[2]).length();const a=F0.set(r[4],r[5],r[6]).length(),o=F0.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Er.copy(this);const l=1/s,u=1/a,f=1/o;return Er.elements[0]*=l,Er.elements[1]*=l,Er.elements[2]*=l,Er.elements[4]*=u,Er.elements[5]*=u,Er.elements[6]*=u,Er.elements[8]*=f,Er.elements[9]*=f,Er.elements[10]*=f,n.setFromRotationMatrix(Er),i.x=s,i.y=a,i.z=o,this}makePerspective(e,n,i,r,s,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,l=2*s/(i-r),u=(n+e)/(n-e),f=(i+r)/(i-r),d=-(a+s)/(a-s),m=-2*a*s/(a-s);return o[0]=2*s/(n-e),o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=l,o[9]=f,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=m,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,n,i,r,s,a){const o=this.elements,c=1/(n-e),l=1/(i-r),u=1/(a-s),f=(n+e)*c,d=(i+r)*l,m=(a+s)*u;return o[0]=2*c,o[4]=0,o[8]=0,o[12]=-f,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-m,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}mt.prototype.isMatrix4=!0;const F0=new W,Er=new mt,$K=new W(0,0,0),XK=new W(1,1,1),Ua=new W,Ju=new W,E2=new W,FA=new mt,BA=new wi;class y4{constructor(e=0,n=0,i=0,r=y4.DefaultOrder){this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],c=r[1],l=r[5],u=r[9],f=r[2],d=r[6],m=r[10];switch(n){case"XYZ":this._y=Math.asin(ai(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-ai(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,m),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(ai(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,m),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-ai(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(ai(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(o,m));break;case"XZY":this._z=Math.asin(-ai(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===i&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return FA.makeRotationFromQuaternion(e),this.setFromRotationMatrix(FA,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return BA.setFromEuler(this),this.setFromQuaternion(BA,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}y4.prototype.isEuler=!0,y4.DefaultOrder="XYZ",y4.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class nv{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let YK=0;const UA=new W,B0=new wi,js=new mt,Ku=new W,i8=new W,JK=new W,KK=new wi,GA=new W(1,0,0),WA=new W(0,1,0),jA=new W(0,0,1),QK={type:"added"},qA={type:"removed"};class v1 extends h4{constructor(){super(),Object.defineProperty(this,"id",{value:YK++}),this.uuid=C2(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=v1.DefaultUp.clone();const e=new W,n=new y4,i=new wi,r=new W(1,1,1);n._onChange(function s(){i.setFromEuler(n,!1)}),i._onChange(function a(){n.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new mt},normalMatrix:{value:new jn}}),this.matrix=new mt,this.matrixWorld=new mt,this.matrixAutoUpdate=v1.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new nv,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return B0.setFromAxisAngle(e,n),this.quaternion.multiply(B0),this}rotateOnWorldAxis(e,n){return B0.setFromAxisAngle(e,n),this.quaternion.premultiply(B0),this}rotateX(e){return this.rotateOnAxis(GA,e)}rotateY(e){return this.rotateOnAxis(WA,e)}rotateZ(e){return this.rotateOnAxis(jA,e)}translateOnAxis(e,n){return UA.copy(e).applyQuaternion(this.quaternion),this.position.add(UA.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(GA,e)}translateY(e){return this.translateOnAxis(WA,e)}translateZ(e){return this.translateOnAxis(jA,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(js.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?Ku.copy(e):Ku.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),i8.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?js.lookAt(i8,Ku,this.up):js.lookAt(Ku,i8,this.up),this.quaternion.setFromRotationMatrix(js),r&&(js.extractRotation(r.matrixWorld),B0.setFromRotationMatrix(js),this.quaternion.premultiply(B0.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(QK)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(qA)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const n=this.children[e];n.parent=null,n.dispatchEvent(qA)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),js.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),js.multiply(e.parent.matrixWorld)),e.applyMatrix4(js),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const a=this.children[i].getObjectByProperty(e,n);if(void 0!==a)return a}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(i8,e,JK),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(i8,KK,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;null!==n&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===n){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const n=void 0===e||"string"==typeof e,i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function s(o,c){return void 0===o[c.uuid]&&(o[c.uuid]=c.toJSON(e)),c.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){const c=o.shapes;if(Array.isArray(c))for(let l=0,u=c.length;l<u;l++)s(e.shapes,c[l]);else s(e.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const o=[];for(let c=0,l=this.material.length;c<l;c++)o.push(s(e.materials,this.material[c]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++)r.animations.push(s(e.animations,this.animations[o]))}if(n){const o=a(e.geometries),c=a(e.materials),l=a(e.textures),u=a(e.images),f=a(e.shapes),d=a(e.skeletons),m=a(e.animations),v=a(e.nodes);o.length>0&&(i.geometries=o),c.length>0&&(i.materials=c),l.length>0&&(i.textures=l),u.length>0&&(i.images=u),f.length>0&&(i.shapes=f),d.length>0&&(i.skeletons=d),m.length>0&&(i.animations=m),v.length>0&&(i.nodes=v)}return i.object=r,i;function a(o){const c=[];for(const l in o){const u=o[l];delete u.metadata,c.push(u)}return c}}clone(e){return(new this.constructor).copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===n)for(let i=0;i<e.children.length;i++)this.add(e.children[i].clone());return this}}v1.DefaultUp=new W(0,1,0),v1.DefaultMatrixAutoUpdate=!0,v1.prototype.isObject3D=!0;const zr=new W,qs=new W,iv=new W,Zs=new W,U0=new W,G0=new W,ZA=new W,rv=new W,sv=new W,av=new W;class Cn{constructor(e=new W,n=new W,i=new W){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),zr.subVectors(e,n),r.cross(zr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){zr.subVectors(r,n),qs.subVectors(i,n),iv.subVectors(e,n);const a=zr.dot(zr),o=zr.dot(qs),c=zr.dot(iv),l=qs.dot(qs),u=qs.dot(iv),f=a*l-o*o;if(0===f)return s.set(-2,-1,-1);const d=1/f,m=(l*c-o*u)*d,v=(a*u-o*c)*d;return s.set(1-m-v,v,m)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,Zs),Zs.x>=0&&Zs.y>=0&&Zs.x+Zs.y<=1}static getUV(e,n,i,r,s,a,o,c){return this.getBarycoord(e,n,i,r,Zs),c.set(0,0),c.addScaledVector(s,Zs.x),c.addScaledVector(a,Zs.y),c.addScaledVector(o,Zs.z),c}static isFrontFacing(e,n,i,r){return zr.subVectors(i,n),qs.subVectors(e,n),zr.cross(qs).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return zr.subVectors(this.c,this.b),qs.subVectors(this.a,this.b),.5*zr.cross(qs).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Cn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Cn.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,i,r,s){return Cn.getUV(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return Cn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Cn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let a,o;U0.subVectors(r,i),G0.subVectors(s,i),rv.subVectors(e,i);const c=U0.dot(rv),l=G0.dot(rv);if(c<=0&&l<=0)return n.copy(i);sv.subVectors(e,r);const u=U0.dot(sv),f=G0.dot(sv);if(u>=0&&f<=u)return n.copy(r);const d=c*f-u*l;if(d<=0&&c>=0&&u<=0)return a=c/(c-u),n.copy(i).addScaledVector(U0,a);av.subVectors(e,s);const m=U0.dot(av),v=G0.dot(av);if(v>=0&&m<=v)return n.copy(s);const _=m*l-c*v;if(_<=0&&l>=0&&v<=0)return o=l/(l-v),n.copy(i).addScaledVector(G0,o);const M=u*v-m*f;if(M<=0&&f-u>=0&&m-v>=0)return ZA.subVectors(s,r),o=(f-u)/(f-u+(m-v)),n.copy(r).addScaledVector(ZA,o);const y=1/(M+_+d);return a=_*y,o=d*y,n.copy(i).addScaledVector(U0,a).addScaledVector(G0,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let eQ=0;class En extends h4{constructor(){super(),Object.defineProperty(this,"id",{value:eQ++}),this.uuid=C2(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const n in e){const i=e[n];if(void 0===i){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}if("shading"===n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;continue}const r=this[n];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i:console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.")}}toJSON(e){const n=void 0===e||"string"==typeof e;n&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(s){const a=[];for(const o in s){const c=s[o];delete c.metadata,a.push(c)}return a}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),n){const s=r(e.textures),a=r(e.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(null!==n){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}En.prototype.isMaterial=!0,En.fromType=function(){return null};class X2 extends En{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new it(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}X2.prototype.isMeshBasicMaterial=!0;const D1=new W,Qu=new ze;class z1{constructor(e,n,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=n,this.count=void 0!==e?e.length/n:0,this.normalized=!0===i,this.usage=Yl,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const n=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new it),n[i++]=a.r,n[i++]=a.g,n[i++]=a.b}return this}copyVector2sArray(e){const n=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new ze),n[i++]=a.x,n[i++]=a.y}return this}copyVector3sArray(e){const n=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new W),n[i++]=a.x,n[i++]=a.y,n[i++]=a.z}return this}copyVector4sArray(e){const n=this.array;let i=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new _1),n[i++]=a.x,n[i++]=a.y,n[i++]=a.z,n[i++]=a.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let n=0,i=this.count;n<i;n++)Qu.fromBufferAttribute(this,n),Qu.applyMatrix3(e),this.setXY(n,Qu.x,Qu.y);else if(3===this.itemSize)for(let n=0,i=this.count;n<i;n++)D1.fromBufferAttribute(this,n),D1.applyMatrix3(e),this.setXYZ(n,D1.x,D1.y,D1.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)D1.x=this.getX(n),D1.y=this.getY(n),D1.z=this.getZ(n),D1.applyMatrix4(e),this.setXYZ(n,D1.x,D1.y,D1.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)D1.x=this.getX(n),D1.y=this.getY(n),D1.z=this.getZ(n),D1.applyNormalMatrix(e),this.setXYZ(n,D1.x,D1.y,D1.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)D1.x=this.getX(n),D1.y=this.getY(n),D1.z=this.getZ(n),D1.transformDirection(e),this.setXYZ(n,D1.x,D1.y,D1.z);return this}set(e,n=0){return this.array.set(e,n),this}getX(e){return this.array[e*this.itemSize]}setX(e,n){return this.array[e*this.itemSize]=n,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,n){return this.array[e*this.itemSize+1]=n,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,n){return this.array[e*this.itemSize+2]=n,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,n){return this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return this.array[0+(e*=this.itemSize)]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return this.array[0+(e*=this.itemSize)]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return this.array[0+(e*=this.itemSize)]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Yl&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}z1.prototype.isBufferAttribute=!0;class ov extends z1{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class cv extends z1{constructor(e,n,i){super(new Uint32Array(e),n,i)}}(class aQ extends z1{constructor(e,n,i){super(new Uint16Array(e),n,i)}}).prototype.isFloat16BufferAttribute=!0;class ut extends z1{constructor(e,n,i){super(new Float32Array(e),n,i)}}let cQ=0;const Y2=new mt,lv=new v1,W0=new W,z2=new $2,r8=new $2,qn=new W;class St extends h4{constructor(){super(),Object.defineProperty(this,"id",{value:cQ++}),this.uuid=C2(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(IA(e)?cv:ov)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;void 0!==n&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const s=(new jn).getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Y2.makeRotationFromQuaternion(e),this.applyMatrix4(Y2),this}rotateX(e){return Y2.makeRotationX(e),this.applyMatrix4(Y2),this}rotateY(e){return Y2.makeRotationY(e),this.applyMatrix4(Y2),this}rotateZ(e){return Y2.makeRotationZ(e),this.applyMatrix4(Y2),this}translate(e,n,i){return Y2.makeTranslation(e,n,i),this.applyMatrix4(Y2),this}scale(e,n,i){return Y2.makeScale(e,n,i),this.applyMatrix4(Y2),this}lookAt(e){return lv.lookAt(e),lv.updateMatrix(),this.applyMatrix4(lv.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(W0).negate(),this.translate(W0.x,W0.y,W0.z),this}setFromPoints(e){const n=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ut(n,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new $2);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new W(-1/0,-1/0,-1/0),new W(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++)z2.setFromBufferAttribute(n[i]),this.morphTargetsRelative?(qn.addVectors(this.boundingBox.min,z2.min),this.boundingBox.expandByPoint(qn),qn.addVectors(this.boundingBox.max,z2.max),this.boundingBox.expandByPoint(qn)):(this.boundingBox.expandByPoint(z2.min),this.boundingBox.expandByPoint(z2.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new g4);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new W,1/0);if(e){const i=this.boundingSphere.center;if(z2.setFromBufferAttribute(e),n)for(let s=0,a=n.length;s<a;s++)r8.setFromBufferAttribute(n[s]),this.morphTargetsRelative?(qn.addVectors(z2.min,r8.min),z2.expandByPoint(qn),qn.addVectors(z2.max,r8.max),z2.expandByPoint(qn)):(z2.expandByPoint(r8.min),z2.expandByPoint(r8.max));z2.getCenter(i);let r=0;for(let s=0,a=e.count;s<a;s++)qn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(qn));if(n)for(let s=0,a=n.length;s<a;s++){const o=n[s],c=this.morphTargetsRelative;for(let l=0,u=o.count;l<u;l++)qn.fromBufferAttribute(o,l),c&&(W0.fromBufferAttribute(e,l),qn.add(W0)),r=Math.max(r,i.distanceToSquared(qn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(null===e||void 0===n.position||void 0===n.normal||void 0===n.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=n.position.array,s=n.normal.array,a=n.uv.array,o=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new z1(new Float32Array(4*o),4));const c=this.getAttribute("tangent").array,l=[],u=[];for(let G=0;G<o;G++)l[G]=new W,u[G]=new W;const f=new W,d=new W,m=new W,v=new ze,_=new ze,M=new ze,y=new W,g=new W;function S(G,C,N){f.fromArray(r,3*G),d.fromArray(r,3*C),m.fromArray(r,3*N),v.fromArray(a,2*G),_.fromArray(a,2*C),M.fromArray(a,2*N),d.sub(f),m.sub(f),_.sub(v),M.sub(v);const F=1/(_.x*M.y-M.x*_.y);!isFinite(F)||(y.copy(d).multiplyScalar(M.y).addScaledVector(m,-_.y).multiplyScalar(F),g.copy(m).multiplyScalar(_.x).addScaledVector(d,-M.x).multiplyScalar(F),l[G].add(y),l[C].add(y),l[N].add(y),u[G].add(g),u[C].add(g),u[N].add(g))}let b=this.groups;0===b.length&&(b=[{start:0,count:i.length}]);for(let G=0,C=b.length;G<C;++G){const N=b[G],F=N.start;for(let $=F,O=F+N.count;$<O;$+=3)S(i[$+0],i[$+1],i[$+2])}const E=new W,P=new W,V=new W,j=new W;function Y(G){V.fromArray(s,3*G),j.copy(V);const C=l[G];E.copy(C),E.sub(V.multiplyScalar(V.dot(C))).normalize(),P.crossVectors(j,C);const F=P.dot(u[G])<0?-1:1;c[4*G]=E.x,c[4*G+1]=E.y,c[4*G+2]=E.z,c[4*G+3]=F}for(let G=0,C=b.length;G<C;++G){const N=b[G],F=N.start;for(let $=F,O=F+N.count;$<O;$+=3)Y(i[$+0]),Y(i[$+1]),Y(i[$+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(void 0!==n){let i=this.getAttribute("normal");if(void 0===i)i=new z1(new Float32Array(3*n.count),3),this.setAttribute("normal",i);else for(let d=0,m=i.count;d<m;d++)i.setXYZ(d,0,0,0);const r=new W,s=new W,a=new W,o=new W,c=new W,l=new W,u=new W,f=new W;if(e)for(let d=0,m=e.count;d<m;d+=3){const v=e.getX(d+0),_=e.getX(d+1),M=e.getX(d+2);r.fromBufferAttribute(n,v),s.fromBufferAttribute(n,_),a.fromBufferAttribute(n,M),u.subVectors(a,s),f.subVectors(r,s),u.cross(f),o.fromBufferAttribute(i,v),c.fromBufferAttribute(i,_),l.fromBufferAttribute(i,M),o.add(u),c.add(u),l.add(u),i.setXYZ(v,o.x,o.y,o.z),i.setXYZ(_,c.x,c.y,c.z),i.setXYZ(M,l.x,l.y,l.z)}else for(let d=0,m=n.count;d<m;d+=3)r.fromBufferAttribute(n,d+0),s.fromBufferAttribute(n,d+1),a.fromBufferAttribute(n,d+2),u.subVectors(a,s),f.subVectors(r,s),u.cross(f),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,n){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===n&&(n=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const r in i){if(void 0===e.attributes[r])continue;const a=i[r].array,o=e.attributes[r],c=o.array,l=o.itemSize*n,u=Math.min(c.length,a.length-l);for(let f=0,d=l;f<u;f++,d++)a[d]=c[f]}return this}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)qn.fromBufferAttribute(e,n),qn.normalize(),e.setXYZ(n,qn.x,qn.y,qn.z)}toNonIndexed(){function e(o,c){const l=o.array,u=o.itemSize,f=o.normalized,d=new l.constructor(c.length*u);let m=0,v=0;for(let _=0,M=c.length;_<M;_++){m=o.isInterleavedBufferAttribute?c[_]*o.data.stride+o.offset:c[_]*u;for(let y=0;y<u;y++)d[v++]=l[m++]}return new z1(d,u,f)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new St,i=this.index.array,r=this.attributes;for(const o in r){const l=e(r[o],i);n.setAttribute(o,l)}const s=this.morphAttributes;for(const o in s){const c=[],l=s[o];for(let u=0,f=l.length;u<f;u++){const m=e(l[u],i);c.push(m)}n.morphAttributes[o]=c}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,c=a.length;o<c;o++){const l=a[o];n.addGroup(l.start,l.count,l.materialIndex)}return n}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const c=this.parameters;for(const l in c)void 0!==c[l]&&(e[l]=c[l]);return e}e.data={attributes:{}};const n=this.index;null!==n&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const c in i)e.data.attributes[c]=i[c].toJSON(e.data);const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let f=0,d=l.length;f<d;f++)u.push(l[f].toJSON(e.data));u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(n));const r=e.attributes;for(const l in r)this.setAttribute(l,r[l].clone(n));const s=e.morphAttributes;for(const l in s){const u=[],f=s[l];for(let d=0,m=f.length;d<m;d++)u.push(f[d].clone(n));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,u=a.length;l<u;l++){const f=a[l];this.addGroup(f.start,f.count,f.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}St.prototype.isBufferGeometry=!0;const $A=new mt,j0=new v4,hv=new g4,Ga=new W,Wa=new W,ja=new W,uv=new W,fv=new W,dv=new W,e7=new W,t7=new W,n7=new W,i7=new ze,r7=new ze,s7=new ze,pv=new W,a7=new W;class zn extends v1{constructor(e=new St,n=new X2){super(),this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const n=e.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}else{const n=e.morphTargets;void 0!==n&&n.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),hv.copy(i.boundingSphere),hv.applyMatrix4(s),!1===e.ray.intersectsSphere(hv))||($A.copy(s).invert(),j0.copy(e.ray).applyMatrix4($A),null!==i.boundingBox&&!1===j0.intersectsBox(i.boundingBox)))return;let a;if(i.isBufferGeometry){const o=i.index,c=i.attributes.position,l=i.morphAttributes.position,u=i.morphTargetsRelative,f=i.attributes.uv,d=i.attributes.uv2,m=i.groups,v=i.drawRange;if(null!==o)if(Array.isArray(r))for(let _=0,M=m.length;_<M;_++){const y=m[_],g=r[y.materialIndex];for(let E=Math.max(y.start,v.start),P=Math.min(o.count,Math.min(y.start+y.count,v.start+v.count));E<P;E+=3){const V=o.getX(E),j=o.getX(E+1),Y=o.getX(E+2);a=o7(this,g,e,j0,c,l,u,f,d,V,j,Y),a&&(a.faceIndex=Math.floor(E/3),a.face.materialIndex=y.materialIndex,n.push(a))}}else for(let y=Math.max(0,v.start),g=Math.min(o.count,v.start+v.count);y<g;y+=3){const S=o.getX(y),b=o.getX(y+1),E=o.getX(y+2);a=o7(this,r,e,j0,c,l,u,f,d,S,b,E),a&&(a.faceIndex=Math.floor(y/3),n.push(a))}else if(void 0!==c)if(Array.isArray(r))for(let _=0,M=m.length;_<M;_++){const y=m[_],g=r[y.materialIndex];for(let E=Math.max(y.start,v.start),P=Math.min(c.count,Math.min(y.start+y.count,v.start+v.count));E<P;E+=3)a=o7(this,g,e,j0,c,l,u,f,d,E,E+1,E+2),a&&(a.faceIndex=Math.floor(E/3),a.face.materialIndex=y.materialIndex,n.push(a))}else for(let y=Math.max(0,v.start),g=Math.min(c.count,v.start+v.count);y<g;y+=3)a=o7(this,r,e,j0,c,l,u,f,d,y,y+1,y+2),a&&(a.faceIndex=Math.floor(y/3),n.push(a))}else i.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function o7(t,e,n,i,r,s,a,o,c,l,u,f){Ga.fromBufferAttribute(r,l),Wa.fromBufferAttribute(r,u),ja.fromBufferAttribute(r,f);const d=t.morphTargetInfluences;if(s&&d){e7.set(0,0,0),t7.set(0,0,0),n7.set(0,0,0);for(let v=0,_=s.length;v<_;v++){const M=d[v],y=s[v];0!==M&&(uv.fromBufferAttribute(y,l),fv.fromBufferAttribute(y,u),dv.fromBufferAttribute(y,f),a?(e7.addScaledVector(uv,M),t7.addScaledVector(fv,M),n7.addScaledVector(dv,M)):(e7.addScaledVector(uv.sub(Ga),M),t7.addScaledVector(fv.sub(Wa),M),n7.addScaledVector(dv.sub(ja),M)))}Ga.add(e7),Wa.add(t7),ja.add(n7)}t.isSkinnedMesh&&(t.boneTransform(l,Ga),t.boneTransform(u,Wa),t.boneTransform(f,ja));const m=function lQ(t,e,n,i,r,s,a,o){let c;if(c=1===e.side?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,2!==e.side,o),null===c)return null;a7.copy(o),a7.applyMatrix4(t.matrixWorld);const l=n.ray.origin.distanceTo(a7);return l<n.near||l>n.far?null:{distance:l,point:a7.clone(),object:t}}(t,e,n,i,Ga,Wa,ja,pv);if(m){o&&(i7.fromBufferAttribute(o,l),r7.fromBufferAttribute(o,u),s7.fromBufferAttribute(o,f),m.uv=Cn.getUV(pv,Ga,Wa,ja,i7,r7,s7,new ze)),c&&(i7.fromBufferAttribute(c,l),r7.fromBufferAttribute(c,u),s7.fromBufferAttribute(c,f),m.uv2=Cn.getUV(pv,Ga,Wa,ja,i7,r7,s7,new ze));const v={a:l,b:u,c:f,normal:new W,materialIndex:0};Cn.getNormal(Ga,Wa,ja,v.normal),m.face=v}return m}zn.prototype.isMesh=!0;class qa extends St{constructor(e=1,n=1,i=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const c=[],l=[],u=[],f=[];let d=0,m=0;function v(_,M,y,g,S,b,E,P,V,j,Y){const G=b/V,C=E/j,N=b/2,F=E/2,U=P/2,$=V+1,O=j+1;let I=0,k=0;const K=new W;for(let re=0;re<O;re++){const ae=re*C-F;for(let ue=0;ue<$;ue++)K[_]=(ue*G-N)*g,K[M]=ae*S,K[y]=U,l.push(K.x,K.y,K.z),K[_]=0,K[M]=0,K[y]=P>0?1:-1,u.push(K.x,K.y,K.z),f.push(ue/V),f.push(1-re/j),I+=1}for(let re=0;re<j;re++)for(let ae=0;ae<V;ae++){const Le=d+ae+$*(re+1),Oe=d+(ae+1)+$*(re+1),Pe=d+(ae+1)+$*re;c.push(d+ae+$*re,Le,Pe),c.push(Le,Oe,Pe),k+=6}o.addGroup(m,k,Y),m+=k,d+=I}v("z","y","x",-1,-1,i,n,e,a,s,0),v("z","y","x",1,-1,i,n,-e,a,s,1),v("x","z","y",1,1,e,i,n,r,a,2),v("x","z","y",1,-1,e,i,-n,r,a,3),v("x","y","z",1,-1,e,n,i,r,s,4),v("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new ut(l,3)),this.setAttribute("normal",new ut(u,3)),this.setAttribute("uv",new ut(f,2))}static fromJSON(e){return new qa(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function q0(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];e[n][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function Si(t){const e={};for(let n=0;n<t.length;n++){const i=q0(t[n]);for(const r in i)e[r]=i[r]}return e}const hQ={clone:q0,merge:Si};class Tr extends En{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=q0(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;n.uniforms[r]=a&&a.isTexture?{type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?{type:"c",value:a.getHex()}:a&&a.isVector2?{type:"v2",value:a.toArray()}:a&&a.isVector3?{type:"v3",value:a.toArray()}:a&&a.isVector4?{type:"v4",value:a.toArray()}:a&&a.isMatrix3?{type:"m3",value:a.toArray()}:a&&a.isMatrix4?{type:"m4",value:a.toArray()}:{value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}Tr.prototype.isShaderMaterial=!0;class c7 extends v1{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new mt,this.projectionMatrix=new mt,this.projectionMatrixInverse=new mt}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(-n[8],-n[9],-n[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}c7.prototype.isCamera=!0;class Zn extends c7{constructor(e=50,n=1,i=.1,r=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=2*Kl*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*u4*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Kl*Math.atan(Math.tan(.5*u4*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,i,r,s,a){this.aspect=e/n,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(.5*u4*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const c=a.fullWidth,l=a.fullHeight;s+=a.offsetX*r/c,n-=a.offsetY*i/l,r*=a.width/c,i*=a.height/l}const o=this.filmOffset;0!==o&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,null!==this.view&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}Zn.prototype.isPerspectiveCamera=!0;class mv extends v1{constructor(e,n,i){if(super(),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const r=new Zn(90,1,e,n);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new W(1,0,0)),this.add(r);const s=new Zn(90,1,e,n);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new W(-1,0,0)),this.add(s);const a=new Zn(90,1,e,n);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new W(0,1,0)),this.add(a);const o=new Zn(90,1,e,n);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new W(0,-1,0)),this.add(o);const c=new Zn(90,1,e,n);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new W(0,0,1)),this.add(c);const l=new Zn(90,1,e,n);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new W(0,0,-1)),this.add(l)}update(e,n){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,a,o,c,l]=this.children,u=e.xr.enabled,f=e.getRenderTarget();e.xr.enabled=!1;const d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(n,r),e.setRenderTarget(i,1),e.render(n,s),e.setRenderTarget(i,2),e.render(n,a),e.setRenderTarget(i,3),e.render(n,o),e.setRenderTarget(i,4),e.render(n,c),i.texture.generateMipmaps=d,e.setRenderTarget(i,5),e.render(n,l),e.setRenderTarget(f),e.xr.enabled=u,i.texture.needsPMREMUpdate=!0}}class s8 extends Qi{constructor(e,n,i,r,s,a,o,c,l,u){super(e=void 0!==e?e:[],n=void 0!==n?n:301,i,r,s,a,o,c,l,u),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}s8.prototype.isCubeTexture=!0;class gv extends e2{constructor(e,n={}){super(e,e,n);const i={width:e,height:e,depth:1};this.texture=new s8([i,i,i,i,i,i],n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:an}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.format=Fi,this.texture.encoding=n.encoding,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new qa(5,5,5),s=new Tr({name:"CubemapFromEquirect",uniforms:q0(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=n;const a=new zn(r,s),o=n.minFilter;return 1008===n.minFilter&&(n.minFilter=an),new mv(1,10,this).update(e,a),n.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,n,i,r){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,i,r);e.setRenderTarget(s)}}gv.prototype.isWebGLCubeRenderTarget=!0;const vv=new W,dQ=new W,pQ=new jn;class $s{constructor(e=new W(1,0,0),n=0){this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=vv.subVectors(i,n).cross(dQ.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,n){const i=e.delta(vv),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||pQ.getNormalMatrix(e),r=this.coplanarPoint(vv).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}$s.prototype.isPlane=!0;const X0=new g4,l7=new W;class h7{constructor(e=new $s,n=new $s,i=new $s,r=new $s,s=new $s,a=new $s){this.planes=[e,n,i,r,s,a]}set(e,n,i,r,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(n),o[2].copy(i),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const n=this.planes,i=e.elements,r=i[0],s=i[1],a=i[2],o=i[3],c=i[4],l=i[5],u=i[6],f=i[7],d=i[8],m=i[9],v=i[10],_=i[11],M=i[12],y=i[13],g=i[14],S=i[15];return n[0].setComponents(o-r,f-c,_-d,S-M).normalize(),n[1].setComponents(o+r,f+c,_+d,S+M).normalize(),n[2].setComponents(o+s,f+l,_+m,S+y).normalize(),n[3].setComponents(o-s,f-l,_-m,S-y).normalize(),n[4].setComponents(o-a,f-u,_-v,S-g).normalize(),n[5].setComponents(o+a,f+u,_+v,S+g).normalize(),this}intersectsObject(e){const n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),X0.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(X0)}intersectsSprite(e){return X0.center.set(0,0,0),X0.radius=.7071067811865476,X0.applyMatrix4(e.matrixWorld),this.intersectsSphere(X0)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(l7.x=r.normal.x>0?e.max.x:e.min.x,l7.y=r.normal.y>0?e.max.y:e.min.y,l7.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(l7)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function XA(){let t=null,e=!1,n=null,i=null;function r(s,a){n(s,a),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function mQ(t,e){const n=e.isWebGL2,i=new WeakMap;return{get:function a(l){return l.isInterleavedBufferAttribute&&(l=l.data),i.get(l)},remove:function o(l){l.isInterleavedBufferAttribute&&(l=l.data);const u=i.get(l);u&&(t.deleteBuffer(u.buffer),i.delete(l))},update:function c(l,u){if(l.isGLBufferAttribute){const d=i.get(l);return void((!d||d.version<l.version)&&i.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version}))}l.isInterleavedBufferAttribute&&(l=l.data);const f=i.get(l);void 0===f?i.set(l,function r(l,u){const f=l.array,d=l.usage,m=t.createBuffer();let v;if(t.bindBuffer(u,m),t.bufferData(u,f,d),l.onUploadCallback(),f instanceof Float32Array)v=5126;else if(f instanceof Uint16Array)if(l.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");v=5131}else v=5123;else if(f instanceof Int16Array)v=5122;else if(f instanceof Uint32Array)v=5125;else if(f instanceof Int32Array)v=5124;else if(f instanceof Int8Array)v=5120;else if(f instanceof Uint8Array)v=5121;else{if(!(f instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);v=5121}return{buffer:m,type:v,bytesPerElement:f.BYTES_PER_ELEMENT,version:l.version}}(l,u)):f.version<l.version&&(function s(l,u,f){const d=u.array,m=u.updateRange;t.bindBuffer(f,l),-1===m.count?t.bufferSubData(f,0,d):(n?t.bufferSubData(f,m.offset*d.BYTES_PER_ELEMENT,d,m.offset,m.count):t.bufferSubData(f,m.offset*d.BYTES_PER_ELEMENT,d.subarray(m.offset,m.offset+m.count)),m.count=-1)}(f.buffer,l,u),f.version=l.version)}}}class a8 extends St{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,a=n/2,o=Math.floor(i),c=Math.floor(r),l=o+1,u=c+1,f=e/o,d=n/c,m=[],v=[],_=[],M=[];for(let y=0;y<u;y++){const g=y*d-a;for(let S=0;S<l;S++)v.push(S*f-s,-g,0),_.push(0,0,1),M.push(S/o),M.push(1-y/c)}for(let y=0;y<c;y++)for(let g=0;g<o;g++){const b=g+l*(y+1),E=g+1+l*(y+1),P=g+1+l*y;m.push(g+l*y,b,P),m.push(b,E,P)}this.setIndex(m),this.setAttribute("position",new ut(v,3)),this.setAttribute("normal",new ut(_,3)),this.setAttribute("uv",new ut(M,2))}static fromJSON(e){return new a8(e.width,e.height,e.widthSegments,e.heightSegments)}}const $t={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ]\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tfloat texelIndex = float( vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Je={common:{diffuse:{value:new it(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new jn},uv2Transform:{value:new jn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ze(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new it(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new it(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new jn}},sprite:{diffuse:{value:new it(16777215)},opacity:{value:1},center:{value:new ze(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new jn}}},cs={basic:{uniforms:Si([Je.common,Je.specularmap,Je.envmap,Je.aomap,Je.lightmap,Je.fog]),vertexShader:$t.meshbasic_vert,fragmentShader:$t.meshbasic_frag},lambert:{uniforms:Si([Je.common,Je.specularmap,Je.envmap,Je.aomap,Je.lightmap,Je.emissivemap,Je.fog,Je.lights,{emissive:{value:new it(0)}}]),vertexShader:$t.meshlambert_vert,fragmentShader:$t.meshlambert_frag},phong:{uniforms:Si([Je.common,Je.specularmap,Je.envmap,Je.aomap,Je.lightmap,Je.emissivemap,Je.bumpmap,Je.normalmap,Je.displacementmap,Je.fog,Je.lights,{emissive:{value:new it(0)},specular:{value:new it(1118481)},shininess:{value:30}}]),vertexShader:$t.meshphong_vert,fragmentShader:$t.meshphong_frag},standard:{uniforms:Si([Je.common,Je.envmap,Je.aomap,Je.lightmap,Je.emissivemap,Je.bumpmap,Je.normalmap,Je.displacementmap,Je.roughnessmap,Je.metalnessmap,Je.fog,Je.lights,{emissive:{value:new it(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:$t.meshphysical_vert,fragmentShader:$t.meshphysical_frag},toon:{uniforms:Si([Je.common,Je.aomap,Je.lightmap,Je.emissivemap,Je.bumpmap,Je.normalmap,Je.displacementmap,Je.gradientmap,Je.fog,Je.lights,{emissive:{value:new it(0)}}]),vertexShader:$t.meshtoon_vert,fragmentShader:$t.meshtoon_frag},matcap:{uniforms:Si([Je.common,Je.bumpmap,Je.normalmap,Je.displacementmap,Je.fog,{matcap:{value:null}}]),vertexShader:$t.meshmatcap_vert,fragmentShader:$t.meshmatcap_frag},points:{uniforms:Si([Je.points,Je.fog]),vertexShader:$t.points_vert,fragmentShader:$t.points_frag},dashed:{uniforms:Si([Je.common,Je.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:$t.linedashed_vert,fragmentShader:$t.linedashed_frag},depth:{uniforms:Si([Je.common,Je.displacementmap]),vertexShader:$t.depth_vert,fragmentShader:$t.depth_frag},normal:{uniforms:Si([Je.common,Je.bumpmap,Je.normalmap,Je.displacementmap,{opacity:{value:1}}]),vertexShader:$t.meshnormal_vert,fragmentShader:$t.meshnormal_frag},sprite:{uniforms:Si([Je.sprite,Je.fog]),vertexShader:$t.sprite_vert,fragmentShader:$t.sprite_frag},background:{uniforms:{uvTransform:{value:new jn},t2D:{value:null}},vertexShader:$t.background_vert,fragmentShader:$t.background_frag},cube:{uniforms:Si([Je.envmap,{opacity:{value:1}}]),vertexShader:$t.cube_vert,fragmentShader:$t.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:$t.equirect_vert,fragmentShader:$t.equirect_frag},distanceRGBA:{uniforms:Si([Je.common,Je.displacementmap,{referencePosition:{value:new W},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:$t.distanceRGBA_vert,fragmentShader:$t.distanceRGBA_frag},shadow:{uniforms:Si([Je.lights,Je.fog,{color:{value:new it(0)},opacity:{value:1}}]),vertexShader:$t.shadow_vert,fragmentShader:$t.shadow_frag}};function ute(t,e,n,i,r,s){const a=new it(0);let c,l,o=!0===r?0:1,u=null,f=0,d=null;function v(_,M){n.buffers.color.setClear(_.r,_.g,_.b,M,s)}return{getClearColor:function(){return a},setClearColor:function(_,M=1){a.set(_),o=M,v(a,o)},getClearAlpha:function(){return o},setClearAlpha:function(_){o=_,v(a,o)},render:function m(_,M){let y=!1,g=!0===M.isScene?M.background:null;g&&g.isTexture&&(g=e.get(g));const S=t.xr,b=S.getSession&&S.getSession();b&&"additive"===b.environmentBlendMode&&(g=null),null===g?v(a,o):g&&g.isColor&&(v(g,1),y=!0),(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),g&&(g.isCubeTexture||306===g.mapping)?(void 0===l&&(l=new zn(new qa(1,1,1),new Tr({name:"BackgroundCubeMaterial",uniforms:q0(cs.cube.uniforms),vertexShader:cs.cube.vertexShader,fragmentShader:cs.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(E,P,V){this.matrixWorld.copyPosition(V.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1,(u!==g||f!==g.version||d!==t.toneMapping)&&(l.material.needsUpdate=!0,u=g,f=g.version,d=t.toneMapping),_.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(void 0===c&&(c=new zn(new a8(2,2),new Tr({name:"BackgroundMaterial",uniforms:q0(cs.background.uniforms),vertexShader:cs.background.vertexShader,fragmentShader:cs.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=g,!0===g.matrixAutoUpdate&&g.updateMatrix(),c.material.uniforms.uvTransform.value.copy(g.matrix),(u!==g||f!==g.version||d!==t.toneMapping)&&(c.material.needsUpdate=!0,u=g,f=g.version,d=t.toneMapping),_.unshift(c,c.geometry,c.material,0,0,null))}}}function fte(t,e,n,i){const r=t.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),a=i.isWebGL2||null!==s,o={},c=_(null);let l=c;function d(F){return i.isWebGL2?t.bindVertexArray(F):s.bindVertexArrayOES(F)}function m(F){return i.isWebGL2?t.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function _(F){const U=[],$=[],O=[];for(let I=0;I<r;I++)U[I]=0,$[I]=0,O[I]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:$,attributeDivisors:O,object:F,attributes:{},index:null}}function g(){const F=l.newAttributes;for(let U=0,$=F.length;U<$;U++)F[U]=0}function S(F){b(F,0)}function b(F,U){const O=l.enabledAttributes,I=l.attributeDivisors;l.newAttributes[F]=1,0===O[F]&&(t.enableVertexAttribArray(F),O[F]=1),I[F]!==U&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,U),I[F]=U)}function E(){const F=l.newAttributes,U=l.enabledAttributes;for(let $=0,O=U.length;$<O;$++)U[$]!==F[$]&&(t.disableVertexAttribArray($),U[$]=0)}function P(F,U,$,O,I,k){!0!==i.isWebGL2||5124!==$&&5125!==$?t.vertexAttribPointer(F,U,$,O,I,k):t.vertexAttribIPointer(F,U,$,I,k)}function C(){N(),l!==c&&(l=c,d(l.object))}function N(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function u(F,U,$,O,I){let k=!1;if(a){const K=function v(F,U,$){const O=!0===$.wireframe;let I=o[F.id];void 0===I&&(I={},o[F.id]=I);let k=I[U.id];void 0===k&&(k={},I[U.id]=k);let K=k[O];return void 0===K&&(K=_(function f(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}()),k[O]=K),K}(O,$,U);l!==K&&(l=K,d(l.object)),k=function M(F,U){const $=l.attributes,O=F.attributes;let I=0;for(const k in O){const K=$[k],re=O[k];if(void 0===K||K.attribute!==re||K.data!==re.data)return!0;I++}return l.attributesNum!==I||l.index!==U}(O,I),k&&function y(F,U){const $={},O=F.attributes;let I=0;for(const k in O){const K=O[k],re={};re.attribute=K,K.data&&(re.data=K.data),$[k]=re,I++}l.attributes=$,l.attributesNum=I,l.index=U}(O,I)}else{const K=!0===U.wireframe;(l.geometry!==O.id||l.program!==$.id||l.wireframe!==K)&&(l.geometry=O.id,l.program=$.id,l.wireframe=K,k=!0)}!0===F.isInstancedMesh&&(k=!0),null!==I&&n.update(I,34963),k&&(function V(F,U,$,O){if(!1===i.isWebGL2&&(F.isInstancedMesh||O.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;g();const I=O.attributes,k=$.getAttributes(),K=U.defaultAttributeValues;for(const re in k){const ae=k[re];if(ae.location>=0){let ue=I[re];if(void 0===ue&&("instanceMatrix"===re&&F.instanceMatrix&&(ue=F.instanceMatrix),"instanceColor"===re&&F.instanceColor&&(ue=F.instanceColor)),void 0!==ue){const Le=ue.normalized,Oe=ue.itemSize,Pe=n.get(ue);if(void 0===Pe)continue;const ie=Pe.buffer,st=Pe.type,ke=Pe.bytesPerElement;if(ue.isInterleavedBufferAttribute){const _e=ue.data,oe=_e.stride,xe=ue.offset;if(_e.isInstancedInterleavedBuffer){for(let X=0;X<ae.locationSize;X++)b(ae.location+X,_e.meshPerAttribute);!0!==F.isInstancedMesh&&void 0===O._maxInstanceCount&&(O._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let X=0;X<ae.locationSize;X++)S(ae.location+X);t.bindBuffer(34962,ie);for(let X=0;X<ae.locationSize;X++)P(ae.location+X,Oe/ae.locationSize,st,Le,oe*ke,(xe+Oe/ae.locationSize*X)*ke)}else{if(ue.isInstancedBufferAttribute){for(let _e=0;_e<ae.locationSize;_e++)b(ae.location+_e,ue.meshPerAttribute);!0!==F.isInstancedMesh&&void 0===O._maxInstanceCount&&(O._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let _e=0;_e<ae.locationSize;_e++)S(ae.location+_e);t.bindBuffer(34962,ie);for(let _e=0;_e<ae.locationSize;_e++)P(ae.location+_e,Oe/ae.locationSize,st,Le,Oe*ke,Oe/ae.locationSize*_e*ke)}}else if(void 0!==K){const Le=K[re];if(void 0!==Le)switch(Le.length){case 2:t.vertexAttrib2fv(ae.location,Le);break;case 3:t.vertexAttrib3fv(ae.location,Le);break;case 4:t.vertexAttrib4fv(ae.location,Le);break;default:t.vertexAttrib1fv(ae.location,Le)}}}}E()}(F,U,$,O),null!==I&&t.bindBuffer(34963,n.get(I).buffer))},reset:C,resetDefaultState:N,dispose:function j(){C();for(const F in o){const U=o[F];for(const $ in U){const O=U[$];for(const I in O)m(O[I].object),delete O[I];delete U[$]}delete o[F]}},releaseStatesOfGeometry:function Y(F){if(void 0===o[F.id])return;const U=o[F.id];for(const $ in U){const O=U[$];for(const I in O)m(O[I].object),delete O[I];delete U[$]}delete o[F.id]},releaseStatesOfProgram:function G(F){for(const U in o){const $=o[U];if(void 0===$[F.id])continue;const O=$[F.id];for(const I in O)m(O[I].object),delete O[I];delete $[F.id]}},initAttributes:g,enableAttribute:S,disableUnusedAttributes:E}}function dte(t,e,n,i){const r=i.isWebGL2;let s;this.setMode=function a(l){s=l},this.render=function o(l,u){t.drawArrays(s,l,u),n.update(u,s,1)},this.renderInstances=function c(l,u,f){if(0===f)return;let d,m;if(r)d=t,m="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[m](s,l,u,f),n.update(u,s,f)}}function pte(t,e,n){let i;function s(V){if("highp"===V){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";V="mediump"}return"mediump"===V&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";const c=s(o);c!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",c,"instead."),o=c);const l=a||e.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,f=t.getParameter(34930),d=t.getParameter(35660),m=t.getParameter(3379),v=t.getParameter(34076),_=t.getParameter(34921),M=t.getParameter(36347),y=t.getParameter(36348),g=t.getParameter(36349),S=d>0,b=a||e.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const V=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(V.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:f,maxVertexTextures:d,maxTextureSize:m,maxCubemapSize:v,maxAttributes:_,maxVertexUniforms:M,maxVaryings:y,maxFragmentUniforms:g,vertexTextures:S,floatFragmentTextures:b,floatVertexTextures:S&&b,maxSamples:a?t.getParameter(36183):0}}function mte(t){const e=this;let n=null,i=0,r=!1,s=!1;const a=new $s,o=new jn,c={value:null,needsUpdate:!1};function l(){c.value!==n&&(c.value=n,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(f,d,m,v){const _=null!==f?f.length:0;let M=null;if(0!==_){if(M=c.value,!0!==v||null===M){const y=m+4*_,g=d.matrixWorldInverse;o.getNormalMatrix(g),(null===M||M.length<y)&&(M=new Float32Array(y));for(let S=0,b=m;S!==_;++S,b+=4)a.copy(f[S]).applyMatrix4(g,o),a.normal.toArray(M,b),M[b+3]=a.constant}c.value=M,c.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,M}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(f,d,m){const v=0!==f.length||d||0!==i||r;return r=d,n=u(f,m,0),i=f.length,v},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,l()},this.setState=function(f,d,m){const v=f.clippingPlanes,_=f.clipIntersection,M=f.clipShadows,y=t.get(f);if(!r||null===v||0===v.length||s&&!M)s?u(null):l();else{const g=s?0:i,S=4*g;let b=y.clippingState||null;c.value=b,b=u(v,d,S,m);for(let E=0;E!==S;++E)b[E]=n[E];y.clippingState=b,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=g}}}function gte(t){let e=new WeakMap;function n(a,o){return 303===o?a.mapping=301:304===o&&(a.mapping=302),a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const c=e.get(o);void 0!==c&&(e.delete(o),c.dispose())}return{get:function i(a){if(a&&a.isTexture&&!1===a.isRenderTargetTexture){const o=a.mapping;if(303===o||304===o){if(e.has(a))return n(e.get(a).texture,a.mapping);{const c=a.image;if(c&&c.height>0){const l=new gv(c.height/2);return l.fromEquirectangularTexture(t,a),e.set(a,l),a.addEventListener("dispose",r),n(l.texture,a.mapping)}return null}}}return a},dispose:function s(){e=new WeakMap}}}cs.physical={uniforms:Si([cs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ze(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new it(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ze},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new it(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new it(1,1,1)},specularColorMap:{value:null}}]),vertexShader:$t.meshphysical_vert,fragmentShader:$t.meshphysical_frag};class o8 extends c7{constructor(e=-1,n=1,i=1,r=-1,s=.1,a=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,a=i+e,o=r+n,c=r-n;if(null!==this.view&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,a=s+l*this.view.width,o-=u*this.view.offsetY,c=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,c,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,null!==this.view&&(n.object.view=Object.assign({},this.view)),n}}o8.prototype.isOrthographicCamera=!0;const YA=[.125,.215,.35,.446,.526,.582],yv=new o8,JA=new it;let _v=null;const x4=(1+Math.sqrt(5))/2,J0=1/x4,KA=[new W(1,1,1),new W(-1,1,1),new W(1,1,-1),new W(-1,1,-1),new W(0,x4,J0),new W(0,x4,-J0),new W(J0,0,x4),new W(-J0,0,x4),new W(x4,J0,0),new W(-x4,J0,0)];class QA{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100){_v=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),n>0&&this._blur(s,0,0,n),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=nL(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=tL(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_v),e.scissorTest=!1,u7(e,0,0,e.width,e.height)}_fromTexture(e,n){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),_v=this._renderer.getRenderTarget();const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize-32,i={magFilter:an,minFilter:an,generateMipmaps:!1,type:z0,format:Fi,encoding:Oa,depthBuffer:!1},r=eL(e,n,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=eL(e,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function vte(t){const e=[],n=[],i=[];let r=t;const s=t-4+1+YA.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);n.push(o);let c=1/o;a>t-4?c=YA[a-t+4-1]:0===a&&(c=0),i.push(c);const l=1/(o-1),u=-l/2,f=1+l/2,d=[u,u,f,u,f,f,u,u,f,f,u,f],m=6,v=6,_=3,M=2,y=1,g=new Float32Array(_*v*m),S=new Float32Array(M*v*m),b=new Float32Array(y*v*m);for(let P=0;P<m;P++){const V=P%3*2/3-1,j=P>2?0:-1;g.set([V,j,0,V+2/3,j,0,V+2/3,j+1,0,V,j,0,V+2/3,j+1,0,V,j+1,0],_*v*P),S.set(d,M*v*P),b.set([P,P,P,P,P,P],y*v*P)}const E=new St;E.setAttribute("position",new z1(g,_)),E.setAttribute("uv",new z1(S,M)),E.setAttribute("faceIndex",new z1(b,y)),e.push(E),r>4&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}(s)),this._blurMaterial=function yte(t,e,n){const i=new Float32Array(20),r=new W(0,1,0);return new Tr({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,n)}return r}_compileMaterial(e){const n=new zn(this._lodPlanes[0],e);this._renderer.compile(n,yv)}_sceneToCubeUV(e,n,i,r){const o=new Zn(90,1,n,i),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,f=u.autoClear,d=u.toneMapping;u.getClearColor(JA),u.toneMapping=0,u.autoClear=!1;const m=new X2({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),v=new zn(new qa,m);let _=!1;const M=e.background;M?M.isColor&&(m.color.copy(M),e.background=null,_=!0):(m.color.copy(JA),_=!0);for(let y=0;y<6;y++){const g=y%3;0===g?(o.up.set(0,c[y],0),o.lookAt(l[y],0,0)):1===g?(o.up.set(0,0,c[y]),o.lookAt(0,l[y],0)):(o.up.set(0,c[y],0),o.lookAt(0,0,l[y]));const S=this._cubeSize;u7(r,g*S,y>2?S:0,S,S),u.setRenderTarget(r),_&&u.render(v,o),u.render(e,o)}v.geometry.dispose(),v.material.dispose(),u.toneMapping=d,u.autoClear=f,e.background=M}_textureToCubeUV(e,n){const i=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=nL()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=tL());const s=r?this._cubemapMaterial:this._equirectMaterial,a=new zn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const c=this._cubeSize;u7(n,0,0,3*c,2*c),i.setRenderTarget(n),i.render(a,yv)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,KA[(r-1)%KA.length])}n.autoClear=i}_blur(e,n,i,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,i,r,"latitudinal",s),this._halfBlur(a,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,a,o){const c=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const f=new zn(this._lodPlanes[r],l),d=l.uniforms,m=this._sizeLods[i]-1,v=isFinite(s)?Math.PI/(2*m):2*Math.PI/39,_=s/v,M=isFinite(s)?1+Math.floor(3*_):20;M>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${M} samples when the maximum is set to 20`);const y=[];let g=0;for(let V=0;V<20;++V){const j=V/_,Y=Math.exp(-j*j/2);y.push(Y),0===V?g+=Y:V<M&&(g+=2*Y)}for(let V=0;V<y.length;V++)y[V]=y[V]/g;d.envMap.value=e.texture,d.samples.value=M,d.weights.value=y,d.latitudinal.value="latitudinal"===a,o&&(d.poleAxis.value=o);const{_lodMax:S}=this;d.dTheta.value=v,d.mipInt.value=S-i;const b=this._sizeLods[r];u7(n,3*b*(r>S-4?r-S+4:0),4*(this._cubeSize-b),3*b,2*b),c.setRenderTarget(n),c.render(f,yv)}}function eL(t,e,n){const i=new e2(t,e,n);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function u7(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function tL(){return new Tr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function nL(){return new Tr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function _te(t){let e=new WeakMap,n=null;function s(o){const c=o.target;c.removeEventListener("dispose",s);const l=e.get(c);void 0!==l&&(e.delete(c),l.dispose())}return{get:function i(o){if(o&&o.isTexture){const c=o.mapping,l=303===c||304===c,u=301===c||302===c;if(l||u){if(o.isRenderTargetTexture&&!0===o.needsPMREMUpdate){o.needsPMREMUpdate=!1;let f=e.get(o);return null===n&&(n=new QA(t)),f=l?n.fromEquirectangular(o,f):n.fromCubemap(o,f),e.set(o,f),f.texture}if(e.has(o))return e.get(o).texture;{const f=o.image;if(l&&f&&f.height>0||u&&f&&function r(o){let c=0;for(let u=0;u<6;u++)void 0!==o[u]&&c++;return 6===c}(f)){null===n&&(n=new QA(t));const d=l?n.fromEquirectangular(o):n.fromCubemap(o);return e.set(o,d),o.addEventListener("dispose",s),d.texture}return null}}}return o},dispose:function a(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function xte(t){const e={};function n(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==n(i)},init:function(i){i.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){const r=n(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Mte(t,e,n,i){const r={},s=new WeakMap;function a(f){const d=f.target;null!==d.index&&e.remove(d.index);for(const v in d.attributes)e.remove(d.attributes[v]);d.removeEventListener("dispose",a),delete r[d.id];const m=s.get(d);m&&(e.remove(m),s.delete(d)),i.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,n.memory.geometries--}function l(f){const d=[],m=f.index,v=f.attributes.position;let _=0;if(null!==m){const g=m.array;_=m.version;for(let S=0,b=g.length;S<b;S+=3){const E=g[S+0],P=g[S+1],V=g[S+2];d.push(E,P,P,V,V,E)}}else{_=v.version;for(let S=0,b=v.array.length/3-1;S<b;S+=3){const E=S+0,P=S+1,V=S+2;d.push(E,P,P,V,V,E)}}const M=new(IA(d)?cv:ov)(d,1);M.version=_;const y=s.get(f);y&&e.remove(y),s.set(f,M)}return{get:function o(f,d){return!0===r[d.id]||(d.addEventListener("dispose",a),r[d.id]=!0,n.memory.geometries++),d},update:function c(f){const d=f.attributes;for(const v in d)e.update(d[v],34962);const m=f.morphAttributes;for(const v in m){const _=m[v];for(let M=0,y=_.length;M<y;M++)e.update(_[M],34962)}},getWireframeAttribute:function u(f){const d=s.get(f);if(d){const m=f.index;null!==m&&d.version<m.version&&l(f)}else l(f);return s.get(f)}}}function bte(t,e,n,i){const r=i.isWebGL2;let s,o,c;this.setMode=function a(d){s=d},this.setIndex=function l(d){o=d.type,c=d.bytesPerElement},this.render=function u(d,m){t.drawElements(s,m,o,d*c),n.update(m,s,1)},this.renderInstances=function f(d,m,v){if(0===v)return;let _,M;if(r)_=t,M="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),M="drawElementsInstancedANGLE",null===_)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[M](s,m,o,d*c,v),n.update(m,s,v)}}function wte(t){const n={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:n,programs:null,autoReset:!0,reset:function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0},update:function i(s,a,o){switch(n.calls++,a){case 4:n.triangles+=o*(s/3);break;case 1:n.lines+=o*(s/2);break;case 3:n.lines+=o*(s-1);break;case 2:n.lines+=o*s;break;case 0:n.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}function Ste(t,e){return t[0]-e[0]}function Cte(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Mv(t,e){let n=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?n=127:i instanceof Int16Array?n=32767:i instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),t.divideScalar(n)}function Ete(t,e,n){const i={},r=new Float32Array(8),s=new WeakMap,a=new _1,o=[];for(let l=0;l<8;l++)o[l]=[l,0];return{update:function c(l,u,f,d){const m=l.morphTargetInfluences;if(!0===e.isWebGL2){const v=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,_=void 0!==v?v.length:0;let M=s.get(u);if(void 0===M||M.count!==_){let $=function(){F.dispose(),s.delete(u),u.removeEventListener("dispose",$)};void 0!==M&&M.texture.dispose();const S=void 0!==u.morphAttributes.position,b=void 0!==u.morphAttributes.normal,E=void 0!==u.morphAttributes.color,P=u.morphAttributes.position||[],V=u.morphAttributes.normal||[],j=u.morphAttributes.color||[];let Y=0;!0===S&&(Y=1),!0===b&&(Y=2),!0===E&&(Y=3);let G=u.attributes.position.count*Y,C=1;G>e.maxTextureSize&&(C=Math.ceil(G/e.maxTextureSize),G=e.maxTextureSize);const N=new Float32Array(G*C*4*_),F=new t8(N,G,C,_);F.format=Fi,F.type=Va,F.needsUpdate=!0;const U=4*Y;for(let O=0;O<_;O++){const I=P[O],k=V[O],K=j[O],re=G*C*4*O;for(let ae=0;ae<I.count;ae++){const ue=ae*U;!0===S&&(a.fromBufferAttribute(I,ae),!0===I.normalized&&Mv(a,I),N[re+ue+0]=a.x,N[re+ue+1]=a.y,N[re+ue+2]=a.z,N[re+ue+3]=0),!0===b&&(a.fromBufferAttribute(k,ae),!0===k.normalized&&Mv(a,k),N[re+ue+4]=a.x,N[re+ue+5]=a.y,N[re+ue+6]=a.z,N[re+ue+7]=0),!0===E&&(a.fromBufferAttribute(K,ae),!0===K.normalized&&Mv(a,k),N[re+ue+8]=a.x,N[re+ue+9]=a.y,N[re+ue+10]=a.z,N[re+ue+11]=4===K.itemSize?a.w:1)}}M={count:_,texture:F,size:new ze(G,C)},s.set(u,M),u.addEventListener("dispose",$)}let y=0;for(let S=0;S<m.length;S++)y+=m[S];const g=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(t,"morphTargetBaseInfluence",g),d.getUniforms().setValue(t,"morphTargetInfluences",m),d.getUniforms().setValue(t,"morphTargetsTexture",M.texture,n),d.getUniforms().setValue(t,"morphTargetsTextureSize",M.size)}else{const v=void 0===m?0:m.length;let _=i[u.id];if(void 0===_||_.length!==v){_=[];for(let b=0;b<v;b++)_[b]=[b,0];i[u.id]=_}for(let b=0;b<v;b++){const E=_[b];E[0]=b,E[1]=m[b]}_.sort(Cte);for(let b=0;b<8;b++)b<v&&_[b][1]?(o[b][0]=_[b][0],o[b][1]=_[b][1]):(o[b][0]=Number.MAX_SAFE_INTEGER,o[b][1]=0);o.sort(Ste);const M=u.morphAttributes.position,y=u.morphAttributes.normal;let g=0;for(let b=0;b<8;b++){const E=o[b],P=E[0],V=E[1];P!==Number.MAX_SAFE_INTEGER&&V?(M&&u.getAttribute("morphTarget"+b)!==M[P]&&u.setAttribute("morphTarget"+b,M[P]),y&&u.getAttribute("morphNormal"+b)!==y[P]&&u.setAttribute("morphNormal"+b,y[P]),r[b]=V,g+=V):(M&&!0===u.hasAttribute("morphTarget"+b)&&u.deleteAttribute("morphTarget"+b),y&&!0===u.hasAttribute("morphNormal"+b)&&u.deleteAttribute("morphNormal"+b),r[b]=0)}const S=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(t,"morphTargetBaseInfluence",S),d.getUniforms().setValue(t,"morphTargetInfluences",r)}}}}function zte(t,e,n,i){let r=new WeakMap;function o(c){const l=c.target;l.removeEventListener("dispose",o),n.remove(l.instanceMatrix),null!==l.instanceColor&&n.remove(l.instanceColor)}return{update:function s(c){const l=i.render.frame,f=e.get(c,c.geometry);return r.get(f)!==l&&(e.update(f),r.set(f,l)),c.isInstancedMesh&&(!1===c.hasEventListener("dispose",o)&&c.addEventListener("dispose",o),n.update(c.instanceMatrix,34962),null!==c.instanceColor&&n.update(c.instanceColor,34962)),f},dispose:function a(){r=new WeakMap}}}const iL=new Qi,rL=new t8,sL=new ju,aL=new s8,oL=[],cL=[],lL=new Float32Array(16),hL=new Float32Array(9),uL=new Float32Array(4);function K0(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=oL[r];if(void 0===s&&(s=new Float32Array(r),oL[r]=s),0!==e){i.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=n,t[a].toArray(s,o)}return s}function Bi(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Ci(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function f7(t,e){let n=cL[e];void 0===n&&(n=new Int32Array(e),cL[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function Tte(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Ate(t,e){const n=this.cache;if(void 0!==e.x)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Bi(n,e))return;t.uniform2fv(this.addr,e),Ci(n,e)}}function Lte(t,e){const n=this.cache;if(void 0!==e.x)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Bi(n,e))return;t.uniform3fv(this.addr,e),Ci(n,e)}}function Dte(t,e){const n=this.cache;if(void 0!==e.x)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Bi(n,e))return;t.uniform4fv(this.addr,e),Ci(n,e)}}function Pte(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(Bi(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Ci(n,e)}else{if(Bi(n,i))return;uL.set(i),t.uniformMatrix2fv(this.addr,!1,uL),Ci(n,i)}}function Nte(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(Bi(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Ci(n,e)}else{if(Bi(n,i))return;hL.set(i),t.uniformMatrix3fv(this.addr,!1,hL),Ci(n,i)}}function Rte(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(Bi(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Ci(n,e)}else{if(Bi(n,i))return;lL.set(i),t.uniformMatrix4fv(this.addr,!1,lL),Ci(n,i)}}function Hte(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Ite(t,e){const n=this.cache;Bi(n,e)||(t.uniform2iv(this.addr,e),Ci(n,e))}function Vte(t,e){const n=this.cache;Bi(n,e)||(t.uniform3iv(this.addr,e),Ci(n,e))}function Ote(t,e){const n=this.cache;Bi(n,e)||(t.uniform4iv(this.addr,e),Ci(n,e))}function kte(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Fte(t,e){const n=this.cache;Bi(n,e)||(t.uniform2uiv(this.addr,e),Ci(n,e))}function Bte(t,e){const n=this.cache;Bi(n,e)||(t.uniform3uiv(this.addr,e),Ci(n,e))}function Ute(t,e){const n=this.cache;Bi(n,e)||(t.uniform4uiv(this.addr,e),Ci(n,e))}function Gte(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||iL,r)}function Wte(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||sL,r)}function jte(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||aL,r)}function qte(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||rL,r)}function $te(t,e){t.uniform1fv(this.addr,e)}function Xte(t,e){const n=K0(e,this.size,2);t.uniform2fv(this.addr,n)}function Yte(t,e){const n=K0(e,this.size,3);t.uniform3fv(this.addr,n)}function Jte(t,e){const n=K0(e,this.size,4);t.uniform4fv(this.addr,n)}function Kte(t,e){const n=K0(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Qte(t,e){const n=K0(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function e1e(t,e){const n=K0(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function t1e(t,e){t.uniform1iv(this.addr,e)}function n1e(t,e){t.uniform2iv(this.addr,e)}function i1e(t,e){t.uniform3iv(this.addr,e)}function r1e(t,e){t.uniform4iv(this.addr,e)}function s1e(t,e){t.uniform1uiv(this.addr,e)}function a1e(t,e){t.uniform2uiv(this.addr,e)}function o1e(t,e){t.uniform3uiv(this.addr,e)}function c1e(t,e){t.uniform4uiv(this.addr,e)}function l1e(t,e,n){const i=e.length,r=f7(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTexture2D(e[s]||iL,r[s])}function h1e(t,e,n){const i=e.length,r=f7(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTexture3D(e[s]||sL,r[s])}function u1e(t,e,n){const i=e.length,r=f7(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTextureCube(e[s]||aL,r[s])}function f1e(t,e,n){const i=e.length,r=f7(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTexture2DArray(e[s]||rL,r[s])}function p1e(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function Zte(t){switch(t){case 5126:return Tte;case 35664:return Ate;case 35665:return Lte;case 35666:return Dte;case 35674:return Pte;case 35675:return Nte;case 35676:return Rte;case 5124:case 35670:return Hte;case 35667:case 35671:return Ite;case 35668:case 35672:return Vte;case 35669:case 35673:return Ote;case 5125:return kte;case 36294:return Fte;case 36295:return Bte;case 36296:return Ute;case 35678:case 36198:case 36298:case 36306:case 35682:return Gte;case 35679:case 36299:case 36307:return Wte;case 35680:case 36300:case 36308:case 36293:return jte;case 36289:case 36303:case 36311:case 36292:return qte}}(e.type)}function fL(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function d1e(t){switch(t){case 5126:return $te;case 35664:return Xte;case 35665:return Yte;case 35666:return Jte;case 35674:return Kte;case 35675:return Qte;case 35676:return e1e;case 5124:case 35670:return t1e;case 35667:case 35671:return n1e;case 35668:case 35672:return i1e;case 35669:case 35673:return r1e;case 5125:return s1e;case 36294:return a1e;case 36295:return o1e;case 36296:return c1e;case 35678:case 36198:case 36298:case 36306:case 35682:return l1e;case 35679:case 36299:case 36307:return h1e;case 35680:case 36300:case 36308:case 36293:return u1e;case 36289:case 36303:case 36311:case 36292:return f1e}}(e.type)}function dL(t){this.id=t,this.seq=[],this.map={}}fL.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),Ci(e,t)},dL.prototype.setValue=function(t,e,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const a=i[r];a.setValue(t,e[a.id],n)}};const bv=/(\w+)(\])?(\[|\.)?/g;function pL(t,e){t.seq.push(e),t.map[e.id]=e}function m1e(t,e,n){const i=t.name,r=i.length;for(bv.lastIndex=0;;){const s=bv.exec(i),a=bv.lastIndex;let o=s[1];const l=s[3];if("]"===s[2]&&(o|=0),void 0===l||"["===l&&a+2===r){pL(n,void 0===l?new p1e(o,t,e):new fL(o,t,e));break}{let f=n.map[o];void 0===f&&(f=new dL(o),pL(n,f)),n=f}}}function Za(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){const r=t.getActiveUniform(e,i);m1e(r,t.getUniformLocation(e,r.name),this)}}function mL(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}Za.prototype.setValue=function(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)},Za.prototype.setOptional=function(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)},Za.upload=function(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){const a=e[r],o=n[a.id];!1!==o.needsUpdate&&a.setValue(t,o.value,i)}},Za.seqWithValue=function(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.id in e&&n.push(s)}return n};let g1e=0;function gL(t,e,n){const i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();return i&&""===r?"":n.toUpperCase()+"\n\n"+r+"\n\n"+function v1e(t){const e=t.split("\n");for(let n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function _1e(t,e){const n=function y1e(t){switch(t){case Oa:return["Linear","( value )"];case U1:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function x1e(t,e){let n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function c8(t){return""!==t}function vL(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function yL(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const S1e=/^[ \t]*#include +<([\w\d./]+)>/gm;function wv(t){return t.replace(S1e,C1e)}function C1e(t,e){const n=$t[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return wv(n)}const E1e=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,z1e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _L(t){return t.replace(z1e,xL).replace(E1e,T1e)}function T1e(t,e,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),xL(0,e,n,i)}function xL(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function ML(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function R1e(t,e,n,i){const r=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const c=function A1e(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),l=function L1e(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),u=function D1e(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(n),f=function P1e(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),d=function N1e(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const n=Math.log2(e/32+1)+3,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),m=n.isWebGL2?"":function M1e(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(c8).join("\n")}(n),v=function b1e(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(s),_=r.createProgram();let M,y,g=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(M=[v].filter(c8).join("\n"),M.length>0&&(M+="\n"),y=[m,v].filter(c8).join("\n"),y.length>0&&(y+="\n")):(M=[ML(n),"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(c8).join("\n"),y=[m,ML(n),"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+u:"",n.envMap?"#define "+f:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?$t.tonemapping_pars_fragment:"",0!==n.toneMapping?x1e("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",$t.encodings_pars_fragment,_1e("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(c8).join("\n")),a=wv(a),a=vL(a,n),a=yL(a,n),o=wv(o),o=vL(o,n),o=yL(o,n),a=_L(a),o=_L(o),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(g="#version 300 es\n",M=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+M,y=["#define varying in","300 es"===n.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===n.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const b=g+y+o,E=mL(r,35633,g+M+a),P=mL(r,35632,b);if(r.attachShader(_,E),r.attachShader(_,P),void 0!==n.index0AttributeName?r.bindAttribLocation(_,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),t.debug.checkShaderErrors){const Y=r.getProgramInfoLog(_).trim(),G=r.getShaderInfoLog(E).trim(),C=r.getShaderInfoLog(P).trim();let N=!0,F=!0;if(!1===r.getProgramParameter(_,35714)){N=!1;const U=gL(r,E,"vertex"),$=gL(r,P,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,35715)+"\n\nProgram Info Log: "+Y+"\n"+U+"\n"+$)}else""!==Y?console.warn("THREE.WebGLProgram: Program Info Log:",Y):(""===G||""===C)&&(F=!1);F&&(this.diagnostics={runnable:N,programLog:Y,vertexShader:{log:G,prefix:M},fragmentShader:{log:C,prefix:y}})}let V,j;return r.deleteShader(E),r.deleteShader(P),this.getUniforms=function(){return void 0===V&&(V=new Za(r,_)),V},this.getAttributes=function(){return void 0===j&&(j=function w1e(t,e){const n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),a=s.name;let o=1;35674===s.type&&(o=2),35675===s.type&&(o=3),35676===s.type&&(o=4),n[a]={type:s.type,location:t.getAttribLocation(e,a),locationSize:o}}return n}(r,_)),j},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.name=n.shaderName,this.id=g1e++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=E,this.fragmentShader=P,this}let H1e=0;class I1e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(s)&&(a.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;return!1===n.has(e)&&n.set(e,new Set),n.get(e)}_getShaderStage(e){const n=this.shaderCache;if(!1===n.has(e)){const i=new V1e;n.set(e,i)}return n.get(e)}}class V1e{constructor(){this.id=H1e++,this.usedTimes=0}}function O1e(t,e,n,i,r,s,a){const o=new nv,c=new I1e,l=[],u=r.isWebGL2,f=r.logarithmicDepthBuffer,d=r.floatVertexTextures,m=r.maxVertexUniforms,v=r.vertexTextures;let _=r.precision;const M={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function g(C,N,F,U,$){const O=U.fog,I=$.geometry,K=(C.isMeshStandardMaterial?n:e).get(C.envMap||(C.isMeshStandardMaterial?U.environment:null)),re=!K||306!==K.mapping&&307!==K.mapping?null:K.image.height,ae=M[C.type],ue=$.isSkinnedMesh?function y(C){const F=C.skeleton.bones;if(d)return 1024;{const $=Math.floor((m-20)/4),O=Math.min($,F.length);return O<F.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+F.length+" bones. This GPU supports "+O+"."),0):O}}($):0;null!==C.precision&&(_=r.getMaxPrecision(C.precision),_!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",_,"instead."));const Le=I.morphAttributes.position||I.morphAttributes.normal||I.morphAttributes.color,Oe=void 0!==Le?Le.length:0;let ie,st,ke,_e,Pe=0;if(void 0!==I.morphAttributes.position&&(Pe=1),void 0!==I.morphAttributes.normal&&(Pe=2),void 0!==I.morphAttributes.color&&(Pe=3),ae){const pe=cs[ae];ie=pe.vertexShader,st=pe.fragmentShader}else ie=C.vertexShader,st=C.fragmentShader,c.update(C),ke=c.getVertexShaderID(C),_e=c.getFragmentShaderID(C);const oe=t.getRenderTarget(),X=C.clearcoat>0;return{isWebGL2:u,shaderID:ae,shaderName:C.type,vertexShader:ie,fragmentShader:st,defines:C.defines,customVertexShaderID:ke,customFragmentShaderID:_e,isRawShaderMaterial:!0===C.isRawShaderMaterial,glslVersion:C.glslVersion,precision:_,instancing:!0===$.isInstancedMesh,instancingColor:!0===$.isInstancedMesh&&null!==$.instanceColor,supportsVertexTextures:v,outputEncoding:null===oe?t.outputEncoding:!0===oe.isXRRenderTarget?oe.texture.encoding:Oa,map:!!C.map,matcap:!!C.matcap,envMap:!!K,envMapMode:K&&K.mapping,envMapCubeUVHeight:re,lightMap:!!C.lightMap,aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:1===C.normalMapType,tangentSpaceNormalMap:0===C.normalMapType,decodeVideoTexture:!!C.map&&!0===C.map.isVideoTexture&&C.map.encoding===U1,clearcoat:X,clearcoatMap:X&&!!C.clearcoatMap,clearcoatRoughnessMap:X&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:X&&!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,opaque:!1===C.transparent&&1===C.blending,alphaMap:!!C.alphaMap,alphaTest:C.alphaTest>0,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!I.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:!0===C.vertexColors&&!!I.attributes.color&&4===I.attributes.color.itemSize,vertexUvs:!!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatMap||C.clearcoatRoughnessMap||C.clearcoatNormalMap||C.displacementMap||C.transmissionMap||C.thicknessMap||C.specularIntensityMap||C.specularColorMap||C.sheenColorMap||C.sheenRoughnessMap),uvsVertexOnly:!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatNormalMap||C.transmission>0||C.transmissionMap||C.thicknessMap||C.specularIntensityMap||C.specularColorMap||C.sheen>0||C.sheenColorMap||C.sheenRoughnessMap||!C.displacementMap),fog:!!O,useFog:C.fog,fogExp2:O&&O.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:f,skinning:!0===$.isSkinnedMesh&&ue>0,maxBones:ue,useVertexTexture:d,morphTargets:void 0!==I.morphAttributes.position,morphNormals:void 0!==I.morphAttributes.normal,morphColors:void 0!==I.morphAttributes.color,morphTargetsCount:Oe,morphTextureStride:Pe,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:C.dithering,shadowMapEnabled:t.shadowMap.enabled&&F.length>0,shadowMapType:t.shadowMap.type,toneMapping:C.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:2===C.side,flipSided:1===C.side,depthPacking:void 0!==C.depthPacking&&C.depthPacking,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}},getProgramCacheKey:function S(C){const N=[];if(C.shaderID?N.push(C.shaderID):(N.push(C.customVertexShaderID),N.push(C.customFragmentShaderID)),void 0!==C.defines)for(const F in C.defines)N.push(F),N.push(C.defines[F]);return!1===C.isRawShaderMaterial&&(function b(C,N){C.push(N.precision),C.push(N.outputEncoding),C.push(N.envMapMode),C.push(N.envMapCubeUVHeight),C.push(N.combine),C.push(N.vertexUvs),C.push(N.fogExp2),C.push(N.sizeAttenuation),C.push(N.maxBones),C.push(N.morphTargetsCount),C.push(N.morphAttributeCount),C.push(N.numDirLights),C.push(N.numPointLights),C.push(N.numSpotLights),C.push(N.numHemiLights),C.push(N.numRectAreaLights),C.push(N.numDirLightShadows),C.push(N.numPointLightShadows),C.push(N.numSpotLightShadows),C.push(N.shadowMapType),C.push(N.toneMapping),C.push(N.numClippingPlanes),C.push(N.numClipIntersection)}(N,C),function E(C,N){o.disableAll(),N.isWebGL2&&o.enable(0),N.supportsVertexTextures&&o.enable(1),N.instancing&&o.enable(2),N.instancingColor&&o.enable(3),N.map&&o.enable(4),N.matcap&&o.enable(5),N.envMap&&o.enable(6),N.lightMap&&o.enable(7),N.aoMap&&o.enable(8),N.emissiveMap&&o.enable(9),N.bumpMap&&o.enable(10),N.normalMap&&o.enable(11),N.objectSpaceNormalMap&&o.enable(12),N.tangentSpaceNormalMap&&o.enable(13),N.clearcoat&&o.enable(14),N.clearcoatMap&&o.enable(15),N.clearcoatRoughnessMap&&o.enable(16),N.clearcoatNormalMap&&o.enable(17),N.displacementMap&&o.enable(18),N.specularMap&&o.enable(19),N.roughnessMap&&o.enable(20),N.metalnessMap&&o.enable(21),N.gradientMap&&o.enable(22),N.alphaMap&&o.enable(23),N.alphaTest&&o.enable(24),N.vertexColors&&o.enable(25),N.vertexAlphas&&o.enable(26),N.vertexUvs&&o.enable(27),N.vertexTangents&&o.enable(28),N.uvsVertexOnly&&o.enable(29),N.fog&&o.enable(30),C.push(o.mask),o.disableAll(),N.useFog&&o.enable(0),N.flatShading&&o.enable(1),N.logarithmicDepthBuffer&&o.enable(2),N.skinning&&o.enable(3),N.useVertexTexture&&o.enable(4),N.morphTargets&&o.enable(5),N.morphNormals&&o.enable(6),N.morphColors&&o.enable(7),N.premultipliedAlpha&&o.enable(8),N.shadowMapEnabled&&o.enable(9),N.physicallyCorrectLights&&o.enable(10),N.doubleSided&&o.enable(11),N.flipSided&&o.enable(12),N.depthPacking&&o.enable(13),N.dithering&&o.enable(14),N.specularIntensityMap&&o.enable(15),N.specularColorMap&&o.enable(16),N.transmission&&o.enable(17),N.transmissionMap&&o.enable(18),N.thicknessMap&&o.enable(19),N.sheen&&o.enable(20),N.sheenColorMap&&o.enable(21),N.sheenRoughnessMap&&o.enable(22),N.decodeVideoTexture&&o.enable(23),N.opaque&&o.enable(24),C.push(o.mask)}(N,C),N.push(t.outputEncoding)),N.push(C.customProgramCacheKey),N.join()},getUniforms:function P(C){const N=M[C.type];let F;return F=N?hQ.clone(cs[N].uniforms):C.uniforms,F},acquireProgram:function V(C,N){let F;for(let U=0,$=l.length;U<$;U++){const O=l[U];if(O.cacheKey===N){F=O,++F.usedTimes;break}}return void 0===F&&(F=new R1e(t,N,C,s),l.push(F)),F},releaseProgram:function j(C){if(0==--C.usedTimes){const N=l.indexOf(C);l[N]=l[l.length-1],l.pop(),C.destroy()}},releaseShaderCache:function Y(C){c.remove(C)},programs:l,dispose:function G(){c.dispose()}}}function k1e(){let t=new WeakMap;return{get:function e(s){let a=t.get(s);return void 0===a&&(a={},t.set(s,a)),a},remove:function n(s){t.delete(s)},update:function i(s,a,o){t.get(s)[a]=o},dispose:function r(){t=new WeakMap}}}function F1e(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function bL(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function wL(){const t=[];let e=0;const n=[],i=[],r=[];function a(f,d,m,v,_,M){let y=t[e];return void 0===y?(y={id:f.id,object:f,geometry:d,material:m,groupOrder:v,renderOrder:f.renderOrder,z:_,group:M},t[e]=y):(y.id=f.id,y.object=f,y.geometry=d,y.material=m,y.groupOrder=v,y.renderOrder=f.renderOrder,y.z=_,y.group=M),e++,y}return{opaque:n,transmissive:i,transparent:r,init:function s(){e=0,n.length=0,i.length=0,r.length=0},push:function o(f,d,m,v,_,M){const y=a(f,d,m,v,_,M);m.transmission>0?i.push(y):!0===m.transparent?r.push(y):n.push(y)},unshift:function c(f,d,m,v,_,M){const y=a(f,d,m,v,_,M);m.transmission>0?i.unshift(y):!0===m.transparent?r.unshift(y):n.unshift(y)},finish:function u(){for(let f=e,d=t.length;f<d;f++){const m=t[f];if(null===m.id)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}},sort:function l(f,d){n.length>1&&n.sort(f||F1e),i.length>1&&i.sort(d||bL),r.length>1&&r.sort(d||bL)}}}function B1e(){let t=new WeakMap;return{get:function e(i,r){let s;return!1===t.has(i)?(s=new wL,t.set(i,[s])):r>=t.get(i).length?(s=new wL,t.get(i).push(s)):s=t.get(i)[r],s},dispose:function n(){t=new WeakMap}}}function U1e(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new W,color:new it};break;case"SpotLight":n={position:new W,direction:new W,color:new it,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new W,color:new it,distance:0,decay:0};break;case"HemisphereLight":n={direction:new W,skyColor:new it,groundColor:new it};break;case"RectAreaLight":n={color:new it,position:new W,halfWidth:new W,halfHeight:new W}}return t[e.id]=n,n}}}let W1e=0;function j1e(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function q1e(t,e){const n=new U1e,i=function G1e(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ze};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ze,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new W);const s=new W,a=new mt,o=new mt;return{setup:function c(u,f){let d=0,m=0,v=0;for(let Y=0;Y<9;Y++)r.probe[Y].set(0,0,0);let _=0,M=0,y=0,g=0,S=0,b=0,E=0,P=0;u.sort(j1e);const V=!0!==f?Math.PI:1;for(let Y=0,G=u.length;Y<G;Y++){const C=u[Y],N=C.color,F=C.intensity,U=C.distance,$=C.shadow&&C.shadow.map?C.shadow.map.texture:null;if(C.isAmbientLight)d+=N.r*F*V,m+=N.g*F*V,v+=N.b*F*V;else if(C.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(C.sh.coefficients[O],F);else if(C.isDirectionalLight){const O=n.get(C);if(O.color.copy(C.color).multiplyScalar(C.intensity*V),C.castShadow){const I=C.shadow,k=i.get(C);k.shadowBias=I.bias,k.shadowNormalBias=I.normalBias,k.shadowRadius=I.radius,k.shadowMapSize=I.mapSize,r.directionalShadow[_]=k,r.directionalShadowMap[_]=$,r.directionalShadowMatrix[_]=C.shadow.matrix,b++}r.directional[_]=O,_++}else if(C.isSpotLight){const O=n.get(C);if(O.position.setFromMatrixPosition(C.matrixWorld),O.color.copy(N).multiplyScalar(F*V),O.distance=U,O.coneCos=Math.cos(C.angle),O.penumbraCos=Math.cos(C.angle*(1-C.penumbra)),O.decay=C.decay,C.castShadow){const I=C.shadow,k=i.get(C);k.shadowBias=I.bias,k.shadowNormalBias=I.normalBias,k.shadowRadius=I.radius,k.shadowMapSize=I.mapSize,r.spotShadow[y]=k,r.spotShadowMap[y]=$,r.spotShadowMatrix[y]=C.shadow.matrix,P++}r.spot[y]=O,y++}else if(C.isRectAreaLight){const O=n.get(C);O.color.copy(N).multiplyScalar(F),O.halfWidth.set(.5*C.width,0,0),O.halfHeight.set(0,.5*C.height,0),r.rectArea[g]=O,g++}else if(C.isPointLight){const O=n.get(C);if(O.color.copy(C.color).multiplyScalar(C.intensity*V),O.distance=C.distance,O.decay=C.decay,C.castShadow){const I=C.shadow,k=i.get(C);k.shadowBias=I.bias,k.shadowNormalBias=I.normalBias,k.shadowRadius=I.radius,k.shadowMapSize=I.mapSize,k.shadowCameraNear=I.camera.near,k.shadowCameraFar=I.camera.far,r.pointShadow[M]=k,r.pointShadowMap[M]=$,r.pointShadowMatrix[M]=C.shadow.matrix,E++}r.point[M]=O,M++}else if(C.isHemisphereLight){const O=n.get(C);O.skyColor.copy(C.color).multiplyScalar(F*V),O.groundColor.copy(C.groundColor).multiplyScalar(F*V),r.hemi[S]=O,S++}}g>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=Je.LTC_FLOAT_1,r.rectAreaLTC2=Je.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Je.LTC_HALF_1,r.rectAreaLTC2=Je.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=m,r.ambient[2]=v;const j=r.hash;(j.directionalLength!==_||j.pointLength!==M||j.spotLength!==y||j.rectAreaLength!==g||j.hemiLength!==S||j.numDirectionalShadows!==b||j.numPointShadows!==E||j.numSpotShadows!==P)&&(r.directional.length=_,r.spot.length=y,r.rectArea.length=g,r.point.length=M,r.hemi.length=S,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=E,r.pointShadowMap.length=E,r.spotShadow.length=P,r.spotShadowMap.length=P,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=E,r.spotShadowMatrix.length=P,j.directionalLength=_,j.pointLength=M,j.spotLength=y,j.rectAreaLength=g,j.hemiLength=S,j.numDirectionalShadows=b,j.numPointShadows=E,j.numSpotShadows=P,r.version=W1e++)},setupView:function l(u,f){let d=0,m=0,v=0,_=0,M=0;const y=f.matrixWorldInverse;for(let g=0,S=u.length;g<S;g++){const b=u[g];if(b.isDirectionalLight){const E=r.directional[d];E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(y),d++}else if(b.isSpotLight){const E=r.spot[v];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(y),E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(y),v++}else if(b.isRectAreaLight){const E=r.rectArea[_];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(y),o.identity(),a.copy(b.matrixWorld),a.premultiply(y),o.extractRotation(a),E.halfWidth.set(.5*b.width,0,0),E.halfHeight.set(0,.5*b.height,0),E.halfWidth.applyMatrix4(o),E.halfHeight.applyMatrix4(o),_++}else if(b.isPointLight){const E=r.point[m];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(y),m++}else if(b.isHemisphereLight){const E=r.hemi[M];E.direction.setFromMatrixPosition(b.matrixWorld),E.direction.transformDirection(y),E.direction.normalize(),M++}}},state:r}}function SL(t,e){const n=new q1e(t,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function c(f){n.setup(i,f)},setupLightsView:function l(f){n.setupView(i,f)},pushLight:function a(f){i.push(f)},pushShadow:function o(f){r.push(f)}}}function Z1e(t,e){let n=new WeakMap;return{get:function i(s,a=0){let o;return!1===n.has(s)?(o=new SL(t,e),n.set(s,[o])):a>=n.get(s).length?(o=new SL(t,e),n.get(s).push(o)):o=n.get(s)[a],o},dispose:function r(){n=new WeakMap}}}class Sv extends En{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Sv.prototype.isMeshDepthMaterial=!0;class Cv extends En{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new W,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function CL(t,e,n){let i=new h7;const r=new ze,s=new ze,a=new _1,o=new Sv({depthPacking:3201}),c=new Cv,l={},u=n.maxTextureSize,f={0:1,1:0,2:2},d=new Tr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ze},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),m=d.clone();m.defines.HORIZONTAL_PASS=1;const v=new St;v.setAttribute("position",new z1(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new zn(v,d),M=this;function y(b,E){const P=e.update(_);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,m.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,m.needsUpdate=!0),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,t.setRenderTarget(b.mapPass),t.clear(),t.renderBufferDirect(E,null,P,d,_,null),m.uniforms.shadow_pass.value=b.mapPass.texture,m.uniforms.resolution.value=b.mapSize,m.uniforms.radius.value=b.radius,t.setRenderTarget(b.map),t.clear(),t.renderBufferDirect(E,null,P,m,_,null)}function g(b,E,P,V,j,Y){let G=null;const C=!0===P.isPointLight?b.customDistanceMaterial:b.customDepthMaterial;if(G=void 0!==C?C:!0===P.isPointLight?c:o,t.localClippingEnabled&&!0===E.clipShadows&&0!==E.clippingPlanes.length||E.displacementMap&&0!==E.displacementScale||E.alphaMap&&E.alphaTest>0){const N=G.uuid,F=E.uuid;let U=l[N];void 0===U&&(U={},l[N]=U);let $=U[F];void 0===$&&($=G.clone(),U[F]=$),G=$}return G.visible=E.visible,G.wireframe=E.wireframe,G.side=3===Y?null!==E.shadowSide?E.shadowSide:E.side:null!==E.shadowSide?E.shadowSide:f[E.side],G.alphaMap=E.alphaMap,G.alphaTest=E.alphaTest,G.clipShadows=E.clipShadows,G.clippingPlanes=E.clippingPlanes,G.clipIntersection=E.clipIntersection,G.displacementMap=E.displacementMap,G.displacementScale=E.displacementScale,G.displacementBias=E.displacementBias,G.wireframeLinewidth=E.wireframeLinewidth,G.linewidth=E.linewidth,!0===P.isPointLight&&!0===G.isMeshDistanceMaterial&&(G.referencePosition.setFromMatrixPosition(P.matrixWorld),G.nearDistance=V,G.farDistance=j),G}function S(b,E,P,V,j){if(!1===b.visible)return;if(b.layers.test(E.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&3===j)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,b.matrixWorld);const C=e.update(b),N=b.material;if(Array.isArray(N)){const F=C.groups;for(let U=0,$=F.length;U<$;U++){const O=F[U],I=N[O.materialIndex];if(I&&I.visible){const k=g(b,I,V,P.near,P.far,j);t.renderBufferDirect(P,null,C,k,b,O)}}}else if(N.visible){const F=g(b,N,V,P.near,P.far,j);t.renderBufferDirect(P,null,C,F,b,null)}}const G=b.children;for(let C=0,N=G.length;C<N;C++)S(G[C],E,P,V,j)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(b,E,P){if(!1===M.enabled||!1===M.autoUpdate&&!1===M.needsUpdate||0===b.length)return;const V=t.getRenderTarget(),j=t.getActiveCubeFace(),Y=t.getActiveMipmapLevel(),G=t.state;G.setBlending(0),G.buffers.color.setClear(1,1,1,1),G.buffers.depth.setTest(!0),G.setScissorTest(!1);for(let C=0,N=b.length;C<N;C++){const F=b[C],U=F.shadow;if(void 0===U){console.warn("THREE.WebGLShadowMap:",F,"has no shadow.");continue}if(!1===U.autoUpdate&&!1===U.needsUpdate)continue;r.copy(U.mapSize);const $=U.getFrameExtents();if(r.multiply($),s.copy(U.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/$.x),r.x=s.x*$.x,U.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/$.y),r.y=s.y*$.y,U.mapSize.y=s.y)),null===U.map&&!U.isPointLightShadow&&3===this.type){const I={minFilter:an,magFilter:an,format:Fi};U.map=new e2(r.x,r.y,I),U.map.texture.name=F.name+".shadowMap",U.mapPass=new e2(r.x,r.y,I),U.camera.updateProjectionMatrix()}null===U.map&&(U.map=new e2(r.x,r.y,{minFilter:Rn,magFilter:Rn,format:Fi}),U.map.texture.name=F.name+".shadowMap",U.camera.updateProjectionMatrix()),t.setRenderTarget(U.map),t.clear();const O=U.getViewportCount();for(let I=0;I<O;I++){const k=U.getViewport(I);a.set(s.x*k.x,s.y*k.y,s.x*k.z,s.y*k.w),G.viewport(a),U.updateMatrices(F,I),i=U.getFrustum(),S(E,P,U.camera,F,this.type)}!U.isPointLightShadow&&3===this.type&&y(U,P),U.needsUpdate=!1}M.needsUpdate=!1,t.setRenderTarget(V,j,Y)}}function Y1e(t,e,n){const i=n.isWebGL2,o=new function r(){let H=!1;const be=new _1;let ve=null;const je=new _1(0,0,0,0);return{setMask:function(ye){ve!==ye&&!H&&(t.colorMask(ye,ye,ye,ye),ve=ye)},setLocked:function(ye){H=ye},setClear:function(ye,ce,Ue,et,q1){!0===q1&&(ye*=et,ce*=et,Ue*=et),be.set(ye,ce,Ue,et),!1===je.equals(be)&&(t.clearColor(ye,ce,Ue,et),je.copy(be))},reset:function(){H=!1,ve=null,je.set(-1,0,0,0)}}},c=new function s(){let H=!1,be=null,ve=null,je=null;return{setTest:function(ye){ye?Pe(2929):ie(2929)},setMask:function(ye){be!==ye&&!H&&(t.depthMask(ye),be=ye)},setFunc:function(ye){if(ve!==ye){if(ye)switch(ye){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:default:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517)}else t.depthFunc(515);ve=ye}},setLocked:function(ye){H=ye},setClear:function(ye){je!==ye&&(t.clearDepth(ye),je=ye)},reset:function(){H=!1,be=null,ve=null,je=null}}},l=new function a(){let H=!1,be=null,ve=null,je=null,ye=null,ce=null,Ue=null,et=null,q1=null;return{setTest:function(vt){H||(vt?Pe(2960):ie(2960))},setMask:function(vt){be!==vt&&!H&&(t.stencilMask(vt),be=vt)},setFunc:function(vt,mn,gn){(ve!==vt||je!==mn||ye!==gn)&&(t.stencilFunc(vt,mn,gn),ve=vt,je=mn,ye=gn)},setOp:function(vt,mn,gn){(ce!==vt||Ue!==mn||et!==gn)&&(t.stencilOp(vt,mn,gn),ce=vt,Ue=mn,et=gn)},setLocked:function(vt){H=vt},setClear:function(vt){q1!==vt&&(t.clearStencil(vt),q1=vt)},reset:function(){H=!1,be=null,ve=null,je=null,ye=null,ce=null,Ue=null,et=null,q1=null}}};let u={},f={},d=new WeakMap,m=[],v=null,_=!1,M=null,y=null,g=null,S=null,b=null,E=null,P=null,V=!1,j=null,Y=null,G=null,C=null,N=null;const F=t.getParameter(35661);let U=!1,$=0;const O=t.getParameter(7938);-1!==O.indexOf("WebGL")?($=parseFloat(/^WebGL (\d)/.exec(O)[1]),U=$>=1):-1!==O.indexOf("OpenGL ES")&&($=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),U=$>=2);let I=null,k={};const K=t.getParameter(3088),re=t.getParameter(2978),ae=(new _1).fromArray(K),ue=(new _1).fromArray(re);function Le(H,be,ve){const je=new Uint8Array(4),ye=t.createTexture();t.bindTexture(H,ye),t.texParameteri(H,10241,9728),t.texParameteri(H,10240,9728);for(let ce=0;ce<ve;ce++)t.texImage2D(be+ce,0,6408,1,1,0,6408,5121,je);return ye}const Oe={};function Pe(H){!0!==u[H]&&(t.enable(H),u[H]=!0)}function ie(H){!1!==u[H]&&(t.disable(H),u[H]=!1)}Oe[3553]=Le(3553,3553,1),Oe[34067]=Le(34067,34069,6),o.setClear(0,0,0,1),c.setClear(1),l.setClear(0),Pe(2929),c.setFunc(3),pe(!1),Te(1),Pe(2884),X(0);const oe={100:32774,101:32778,102:32779};if(i)oe[103]=32775,oe[104]=32776;else{const H=e.get("EXT_blend_minmax");null!==H&&(oe[103]=H.MIN_EXT,oe[104]=H.MAX_EXT)}const xe={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function X(H,be,ve,je,ye,ce,Ue,et){if(0!==H){if(!1===_&&(Pe(3042),_=!0),5===H)ye=ye||be,ce=ce||ve,Ue=Ue||je,(be!==y||ye!==b)&&(t.blendEquationSeparate(oe[be],oe[ye]),y=be,b=ye),(ve!==g||je!==S||ce!==E||Ue!==P)&&(t.blendFuncSeparate(xe[ve],xe[je],xe[ce],xe[Ue]),g=ve,S=je,E=ce,P=Ue),M=H,V=null;else if(H!==M||et!==V){if((100!==y||100!==b)&&(t.blendEquation(32774),y=100,b=100),et)switch(H){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",H)}else switch(H){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",H)}g=null,S=null,E=null,P=null,M=H,V=et}}else!0===_&&(ie(3042),_=!1)}function pe(H){j!==H&&(t.frontFace(H?2304:2305),j=H)}function Te(H){0!==H?(Pe(2884),H!==Y&&t.cullFace(1===H?1029:2===H?1028:1032)):ie(2884),Y=H}function We(H,be,ve){H?(Pe(32823),(C!==be||N!==ve)&&(t.polygonOffset(be,ve),C=be,N=ve)):ie(32823)}function rt(H){void 0===H&&(H=33984+F-1),I!==H&&(t.activeTexture(H),I=H)}return{buffers:{color:o,depth:c,stencil:l},enable:Pe,disable:ie,bindFramebuffer:function st(H,be){return f[H]!==be&&(t.bindFramebuffer(H,be),f[H]=be,i&&(36009===H&&(f[36160]=be),36160===H&&(f[36009]=be)),!0)},drawBuffers:function ke(H,be){let ve=m,je=!1;if(H)if(ve=d.get(be),void 0===ve&&(ve=[],d.set(be,ve)),H.isWebGLMultipleRenderTargets){const ye=H.texture;if(ve.length!==ye.length||36064!==ve[0]){for(let ce=0,Ue=ye.length;ce<Ue;ce++)ve[ce]=36064+ce;ve.length=ye.length,je=!0}}else 36064!==ve[0]&&(ve[0]=36064,je=!0);else 1029!==ve[0]&&(ve[0]=1029,je=!0);je&&(n.isWebGL2?t.drawBuffers(ve):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ve))},useProgram:function _e(H){return v!==H&&(t.useProgram(H),v=H,!0)},setBlending:X,setMaterial:function fe(H,be){2===H.side?ie(2884):Pe(2884);let ve=1===H.side;be&&(ve=!ve),pe(ve),1===H.blending&&!1===H.transparent?X(0):X(H.blending,H.blendEquation,H.blendSrc,H.blendDst,H.blendEquationAlpha,H.blendSrcAlpha,H.blendDstAlpha,H.premultipliedAlpha),c.setFunc(H.depthFunc),c.setTest(H.depthTest),c.setMask(H.depthWrite),o.setMask(H.colorWrite);const je=H.stencilWrite;l.setTest(je),je&&(l.setMask(H.stencilWriteMask),l.setFunc(H.stencilFunc,H.stencilRef,H.stencilFuncMask),l.setOp(H.stencilFail,H.stencilZFail,H.stencilZPass)),We(H.polygonOffset,H.polygonOffsetFactor,H.polygonOffsetUnits),!0===H.alphaToCoverage?Pe(32926):ie(32926)},setFlipSided:pe,setCullFace:Te,setLineWidth:function Se(H){H!==G&&(U&&t.lineWidth(H),G=H)},setPolygonOffset:We,setScissorTest:function Fe(H){H?Pe(3089):ie(3089)},activeTexture:rt,bindTexture:function Gt(H,be){null===I&&rt();let ve=k[I];void 0===ve&&(ve={type:void 0,texture:void 0},k[I]=ve),(ve.type!==H||ve.texture!==be)&&(t.bindTexture(H,be||Oe[H]),ve.type=H,ve.texture=be)},unbindTexture:function D(){const H=k[I];void 0!==H&&void 0!==H.type&&(t.bindTexture(H.type,null),H.type=void 0,H.texture=void 0)},compressedTexImage2D:function z(){try{t.compressedTexImage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage2D:function te(){try{t.texImage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage3D:function Be(){try{t.texImage3D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texStorage2D:function Me(){try{t.texStorage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texStorage3D:function Ne(){try{t.texStorage3D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texSubImage2D:function J(){try{t.texSubImage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texSubImage3D:function se(){try{t.texSubImage3D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexSubImage2D:function ge(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},scissor:function Ze(H){!1===ae.equals(H)&&(t.scissor(H.x,H.y,H.z,H.w),ae.copy(H))},viewport:function De(H){!1===ue.equals(H)&&(t.viewport(H.x,H.y,H.z,H.w),ue.copy(H))},reset:function we(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===i&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},I=null,k={},f={},d=new WeakMap,m=[],v=null,_=!1,M=null,y=null,g=null,S=null,b=null,E=null,P=null,V=!1,j=null,Y=null,G=null,C=null,N=null,ae.set(0,0,t.canvas.width,t.canvas.height),ue.set(0,0,t.canvas.width,t.canvas.height),o.reset(),c.reset(),l.reset()}}}function J1e(t,e,n,i,r,s,a){const o=r.isWebGL2,c=r.maxTextures,l=r.maxCubemapSize,u=r.maxTextureSize,f=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=new WeakMap;let v;const _=new WeakMap;let M=!1;try{M="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(D){}function y(D,z){return M?new OffscreenCanvas(D,z):e8("canvas")}function g(D,z,J,se){let ge=1;if((D.width>se||D.height>se)&&(ge=se/Math.max(D.width,D.height)),ge<1||!0===z){if("undefined"!=typeof HTMLImageElement&&D instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&D instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&D instanceof ImageBitmap){const Me=z?Gu:Math.floor,Ne=Me(ge*D.width),te=Me(ge*D.height);void 0===v&&(v=y(Ne,te));const Be=J?y(Ne,te):v;return Be.width=Ne,Be.height=te,Be.getContext("2d").drawImage(D,0,0,Ne,te),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+D.width+"x"+D.height+") to ("+Ne+"x"+te+")."),Be}return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+D.width+"x"+D.height+")."),D}return D}function S(D){return jg(D.width)&&jg(D.height)}function E(D,z){return D.generateMipmaps&&z&&D.minFilter!==Rn&&D.minFilter!==an}function P(D){t.generateMipmap(D)}function V(D,z,J,se,ge=!1){if(!1===o)return z;if(null!==D){if(void 0!==t[D])return t[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let Me=z;return 6403===z&&(5126===J&&(Me=33326),5131===J&&(Me=33325),5121===J&&(Me=33321)),33319===z&&(5126===J&&(Me=33328),5131===J&&(Me=33327),5121===J&&(Me=33323)),6408===z&&(5126===J&&(Me=34836),5131===J&&(Me=34842),5121===J&&(Me=se===U1&&!1===ge?35907:32856),32819===J&&(Me=32854),32820===J&&(Me=32855)),(33325===Me||33326===Me||33327===Me||33328===Me||34842===Me||34836===Me)&&e.get("EXT_color_buffer_float"),Me}function j(D,z,J){return!0===E(D,J)||D.isFramebufferTexture&&D.minFilter!==Rn&&D.minFilter!==an?Math.log2(Math.max(z.width,z.height))+1:void 0!==D.mipmaps&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?z.mipmaps.length:1}function Y(D){return D===Rn||1004===D||1005===D?9728:9729}function G(D){const z=D.target;z.removeEventListener("dispose",G),function N(D){const z=i.get(D);if(void 0===z.__webglInit)return;const J=D.source,se=_.get(J);if(se){const ge=se[z.__cacheKey];ge.usedTimes--,0===ge.usedTimes&&F(D),0===Object.keys(se).length&&_.delete(J)}i.remove(D)}(z),z.isVideoTexture&&m.delete(z)}function C(D){const z=D.target;z.removeEventListener("dispose",C),function U(D){const z=D.texture,J=i.get(D),se=i.get(z);if(void 0!==se.__webglTexture&&(t.deleteTexture(se.__webglTexture),a.memory.textures--),D.depthTexture&&D.depthTexture.dispose(),D.isWebGLCubeRenderTarget)for(let ge=0;ge<6;ge++)t.deleteFramebuffer(J.__webglFramebuffer[ge]),J.__webglDepthbuffer&&t.deleteRenderbuffer(J.__webglDepthbuffer[ge]);else t.deleteFramebuffer(J.__webglFramebuffer),J.__webglDepthbuffer&&t.deleteRenderbuffer(J.__webglDepthbuffer),J.__webglMultisampledFramebuffer&&t.deleteFramebuffer(J.__webglMultisampledFramebuffer),J.__webglColorRenderbuffer&&t.deleteRenderbuffer(J.__webglColorRenderbuffer),J.__webglDepthRenderbuffer&&t.deleteRenderbuffer(J.__webglDepthRenderbuffer);if(D.isWebGLMultipleRenderTargets)for(let ge=0,Me=z.length;ge<Me;ge++){const Ne=i.get(z[ge]);Ne.__webglTexture&&(t.deleteTexture(Ne.__webglTexture),a.memory.textures--),i.remove(z[ge])}i.remove(z),i.remove(D)}(z)}function F(D){const z=i.get(D);t.deleteTexture(z.__webglTexture),delete _.get(D.source)[z.__cacheKey],a.memory.textures--}let $=0;function K(D,z){const J=i.get(D);if(D.isVideoTexture&&function rt(D){const z=a.render.frame;m.get(D)!==z&&(m.set(D,z),D.update())}(D),!1===D.isRenderTargetTexture&&D.version>0&&J.__version!==D.version){const se=D.image;if(null===se)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==se.complete)return void st(J,D,z);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+z),n.bindTexture(3553,J.__webglTexture)}const Le={1e3:10497,[Ki]:33071,1002:33648},Oe={[Rn]:9728,1004:9984,1005:9986,[an]:9729,1007:9985,1008:9987};function Pe(D,z,J){if(J?(t.texParameteri(D,10242,Le[z.wrapS]),t.texParameteri(D,10243,Le[z.wrapT]),(32879===D||35866===D)&&t.texParameteri(D,32882,Le[z.wrapR]),t.texParameteri(D,10240,Oe[z.magFilter]),t.texParameteri(D,10241,Oe[z.minFilter])):(t.texParameteri(D,10242,33071),t.texParameteri(D,10243,33071),(32879===D||35866===D)&&t.texParameteri(D,32882,33071),(z.wrapS!==Ki||z.wrapT!==Ki)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(D,10240,Y(z.magFilter)),t.texParameteri(D,10241,Y(z.minFilter)),z.minFilter!==Rn&&z.minFilter!==an&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const se=e.get("EXT_texture_filter_anisotropic");if(z.type===Va&&!1===e.has("OES_texture_float_linear")||!1===o&&z.type===z0&&!1===e.has("OES_texture_half_float_linear"))return;(z.anisotropy>1||i.get(z).__currentAnisotropy)&&(t.texParameterf(D,se.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(z.anisotropy,r.getMaxAnisotropy())),i.get(z).__currentAnisotropy=z.anisotropy)}}function ie(D,z){let J=!1;void 0===D.__webglInit&&(D.__webglInit=!0,z.addEventListener("dispose",G));const se=z.source;let ge=_.get(se);void 0===ge&&(ge={},_.set(se,ge));const Me=function k(D){const z=[];return z.push(D.wrapS),z.push(D.wrapT),z.push(D.magFilter),z.push(D.minFilter),z.push(D.anisotropy),z.push(D.internalFormat),z.push(D.format),z.push(D.type),z.push(D.generateMipmaps),z.push(D.premultiplyAlpha),z.push(D.flipY),z.push(D.unpackAlignment),z.push(D.encoding),z.join()}(z);if(Me!==D.__cacheKey){void 0===ge[Me]&&(ge[Me]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,J=!0),ge[Me].usedTimes++;const Ne=ge[D.__cacheKey];void 0!==Ne&&(ge[D.__cacheKey].usedTimes--,0===Ne.usedTimes&&F(z)),D.__cacheKey=Me,D.__webglTexture=ge[Me].texture}return J}function st(D,z,J){let se=3553;z.isDataArrayTexture&&(se=35866),z.isData3DTexture&&(se=32879);const ge=ie(D,z),Me=z.source;if(n.activeTexture(33984+J),n.bindTexture(se,D.__webglTexture),Me.version!==Me.__currentVersion||!0===ge){t.pixelStorei(37440,z.flipY),t.pixelStorei(37441,z.premultiplyAlpha),t.pixelStorei(3317,z.unpackAlignment),t.pixelStorei(37443,0);const Ne=function b(D){return!o&&(D.wrapS!==Ki||D.wrapT!==Ki||D.minFilter!==Rn&&D.minFilter!==an)}(z)&&!1===S(z.image);let te=g(z.image,Ne,!1,u);te=Gt(z,te);const Be=S(te)||o,Ze=s.convert(z.format,z.encoding);let H,De=s.convert(z.type),we=V(z.internalFormat,Ze,De,z.encoding,z.isVideoTexture);Pe(se,z,Be);const be=z.mipmaps,ve=o&&!0!==z.isVideoTexture,je=void 0===D.__version,ye=j(z,te,Be);if(z.isDepthTexture)we=6402,o?we=z.type===Va?36012:1014===z.type?33190:z.type===T0?35056:33189:z.type===Va&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),z.format===l4&&6402===we&&z.type!==Xl&&1014!==z.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),z.type=Xl,De=s.convert(z.type)),z.format===A0&&6402===we&&(we=34041,z.type!==T0&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),z.type=T0,De=s.convert(z.type))),ve&&je?n.texStorage2D(3553,1,we,te.width,te.height):n.texImage2D(3553,0,we,te.width,te.height,0,Ze,De,null);else if(z.isDataTexture)if(be.length>0&&Be){ve&&je&&n.texStorage2D(3553,ye,we,be[0].width,be[0].height);for(let ce=0,Ue=be.length;ce<Ue;ce++)H=be[ce],ve?n.texSubImage2D(3553,ce,0,0,H.width,H.height,Ze,De,H.data):n.texImage2D(3553,ce,we,H.width,H.height,0,Ze,De,H.data);z.generateMipmaps=!1}else ve?(je&&n.texStorage2D(3553,ye,we,te.width,te.height),n.texSubImage2D(3553,0,0,0,te.width,te.height,Ze,De,te.data)):n.texImage2D(3553,0,we,te.width,te.height,0,Ze,De,te.data);else if(z.isCompressedTexture){ve&&je&&n.texStorage2D(3553,ye,we,be[0].width,be[0].height);for(let ce=0,Ue=be.length;ce<Ue;ce++)H=be[ce],z.format!==Fi?null!==Ze?ve?n.compressedTexSubImage2D(3553,ce,0,0,H.width,H.height,Ze,H.data):n.compressedTexImage2D(3553,ce,we,H.width,H.height,0,H.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ve?n.texSubImage2D(3553,ce,0,0,H.width,H.height,Ze,De,H.data):n.texImage2D(3553,ce,we,H.width,H.height,0,Ze,De,H.data)}else if(z.isDataArrayTexture)ve?(je&&n.texStorage3D(35866,ye,we,te.width,te.height,te.depth),n.texSubImage3D(35866,0,0,0,0,te.width,te.height,te.depth,Ze,De,te.data)):n.texImage3D(35866,0,we,te.width,te.height,te.depth,0,Ze,De,te.data);else if(z.isData3DTexture)ve?(je&&n.texStorage3D(32879,ye,we,te.width,te.height,te.depth),n.texSubImage3D(32879,0,0,0,0,te.width,te.height,te.depth,Ze,De,te.data)):n.texImage3D(32879,0,we,te.width,te.height,te.depth,0,Ze,De,te.data);else if(z.isFramebufferTexture)ve&&je?n.texStorage2D(3553,ye,we,te.width,te.height):n.texImage2D(3553,0,we,te.width,te.height,0,Ze,De,null);else if(be.length>0&&Be){ve&&je&&n.texStorage2D(3553,ye,we,be[0].width,be[0].height);for(let ce=0,Ue=be.length;ce<Ue;ce++)H=be[ce],ve?n.texSubImage2D(3553,ce,0,0,Ze,De,H):n.texImage2D(3553,ce,we,Ze,De,H);z.generateMipmaps=!1}else ve?(je&&n.texStorage2D(3553,ye,we,te.width,te.height),n.texSubImage2D(3553,0,0,0,Ze,De,te)):n.texImage2D(3553,0,we,Ze,De,te);E(z,Be)&&P(se),Me.__currentVersion=Me.version,z.onUpdate&&z.onUpdate(z)}D.__version=z.version}function _e(D,z,J,se,ge){const Me=s.convert(J.format,J.encoding),Ne=s.convert(J.type),te=V(J.internalFormat,Me,Ne,J.encoding);i.get(z).__hasExternalTextures||(32879===ge||35866===ge?n.texImage3D(ge,0,te,z.width,z.height,z.depth,0,Me,Ne,null):n.texImage2D(ge,0,te,z.width,z.height,0,Me,Ne,null)),n.bindFramebuffer(36160,D),Fe(z)?d.framebufferTexture2DMultisampleEXT(36160,se,ge,i.get(J).__webglTexture,0,We(z)):t.framebufferTexture2D(36160,se,ge,i.get(J).__webglTexture,0),n.bindFramebuffer(36160,null)}function oe(D,z,J){if(t.bindRenderbuffer(36161,D),z.depthBuffer&&!z.stencilBuffer){let se=33189;if(J||Fe(z)){const ge=z.depthTexture;ge&&ge.isDepthTexture&&(ge.type===Va?se=36012:1014===ge.type&&(se=33190));const Me=We(z);Fe(z)?d.renderbufferStorageMultisampleEXT(36161,Me,se,z.width,z.height):t.renderbufferStorageMultisample(36161,Me,se,z.width,z.height)}else t.renderbufferStorage(36161,se,z.width,z.height);t.framebufferRenderbuffer(36160,36096,36161,D)}else if(z.depthBuffer&&z.stencilBuffer){const se=We(z);J&&!1===Fe(z)?t.renderbufferStorageMultisample(36161,se,35056,z.width,z.height):Fe(z)?d.renderbufferStorageMultisampleEXT(36161,se,35056,z.width,z.height):t.renderbufferStorage(36161,34041,z.width,z.height),t.framebufferRenderbuffer(36160,33306,36161,D)}else{const se=!0===z.isWebGLMultipleRenderTargets?z.texture[0]:z.texture,ge=s.convert(se.format,se.encoding),Me=s.convert(se.type),Ne=V(se.internalFormat,ge,Me,se.encoding),te=We(z);J&&!1===Fe(z)?t.renderbufferStorageMultisample(36161,te,Ne,z.width,z.height):Fe(z)?d.renderbufferStorageMultisampleEXT(36161,te,Ne,z.width,z.height):t.renderbufferStorage(36161,Ne,z.width,z.height)}t.bindRenderbuffer(36161,null)}function X(D){const z=i.get(D),J=!0===D.isWebGLCubeRenderTarget;if(D.depthTexture&&!z.__autoAllocateDepthBuffer){if(J)throw new Error("target.depthTexture not supported in Cube render targets");!function xe(D,z){if(z&&z.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,D),!z.depthTexture||!z.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(z.depthTexture).__webglTexture||z.depthTexture.image.width!==z.width||z.depthTexture.image.height!==z.height)&&(z.depthTexture.image.width=z.width,z.depthTexture.image.height=z.height,z.depthTexture.needsUpdate=!0),K(z.depthTexture,0);const se=i.get(z.depthTexture).__webglTexture,ge=We(z);if(z.depthTexture.format===l4)Fe(z)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,se,0,ge):t.framebufferTexture2D(36160,36096,3553,se,0);else{if(z.depthTexture.format!==A0)throw new Error("Unknown depthTexture format");Fe(z)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,se,0,ge):t.framebufferTexture2D(36160,33306,3553,se,0)}}(z.__webglFramebuffer,D)}else if(J){z.__webglDepthbuffer=[];for(let se=0;se<6;se++)n.bindFramebuffer(36160,z.__webglFramebuffer[se]),z.__webglDepthbuffer[se]=t.createRenderbuffer(),oe(z.__webglDepthbuffer[se],D,!1)}else n.bindFramebuffer(36160,z.__webglFramebuffer),z.__webglDepthbuffer=t.createRenderbuffer(),oe(z.__webglDepthbuffer,D,!1);n.bindFramebuffer(36160,null)}function We(D){return Math.min(f,D.samples)}function Fe(D){const z=i.get(D);return o&&D.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==z.__useRenderToTexture}function Gt(D,z){const J=D.encoding,se=D.format,ge=D.type;return!0===D.isCompressedTexture||!0===D.isVideoTexture||1035===D.format||J!==Oa&&(J===U1?!1===o?!0===e.has("EXT_sRGB")&&se===Fi?(D.format=1035,D.minFilter=an,D.generateMipmaps=!1):z=f4.sRGBToLinear(z):(se!==Fi||ge!==c4)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",J)),z}this.allocateTextureUnit=function I(){const D=$;return D>=c&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+c),$+=1,D},this.resetTextureUnits=function O(){$=0},this.setTexture2D=K,this.setTexture2DArray=function re(D,z){const J=i.get(D);D.version>0&&J.__version!==D.version?st(J,D,z):(n.activeTexture(33984+z),n.bindTexture(35866,J.__webglTexture))},this.setTexture3D=function ae(D,z){const J=i.get(D);D.version>0&&J.__version!==D.version?st(J,D,z):(n.activeTexture(33984+z),n.bindTexture(32879,J.__webglTexture))},this.setTextureCube=function ue(D,z){const J=i.get(D);D.version>0&&J.__version!==D.version?function ke(D,z,J){if(6!==z.image.length)return;const se=ie(D,z),ge=z.source;if(n.activeTexture(33984+J),n.bindTexture(34067,D.__webglTexture),ge.version!==ge.__currentVersion||!0===se){t.pixelStorei(37440,z.flipY),t.pixelStorei(37441,z.premultiplyAlpha),t.pixelStorei(3317,z.unpackAlignment),t.pixelStorei(37443,0);const Me=z.isCompressedTexture||z.image[0].isCompressedTexture,Ne=z.image[0]&&z.image[0].isDataTexture,te=[];for(let ce=0;ce<6;ce++)te[ce]=Me||Ne?Ne?z.image[ce].image:z.image[ce]:g(z.image[ce],!1,!0,l),te[ce]=Gt(z,te[ce]);const Be=te[0],Ze=S(Be)||o,De=s.convert(z.format,z.encoding),we=s.convert(z.type),H=V(z.internalFormat,De,we,z.encoding),be=o&&!0!==z.isVideoTexture,ve=void 0===D.__version;let ye,je=j(z,Be,Ze);if(Pe(34067,z,Ze),Me){be&&ve&&n.texStorage2D(34067,je,H,Be.width,Be.height);for(let ce=0;ce<6;ce++){ye=te[ce].mipmaps;for(let Ue=0;Ue<ye.length;Ue++){const et=ye[Ue];z.format!==Fi?null!==De?be?n.compressedTexSubImage2D(34069+ce,Ue,0,0,et.width,et.height,De,et.data):n.compressedTexImage2D(34069+ce,Ue,H,et.width,et.height,0,et.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):be?n.texSubImage2D(34069+ce,Ue,0,0,et.width,et.height,De,we,et.data):n.texImage2D(34069+ce,Ue,H,et.width,et.height,0,De,we,et.data)}}}else{ye=z.mipmaps,be&&ve&&(ye.length>0&&je++,n.texStorage2D(34067,je,H,te[0].width,te[0].height));for(let ce=0;ce<6;ce++)if(Ne){be?n.texSubImage2D(34069+ce,0,0,0,te[ce].width,te[ce].height,De,we,te[ce].data):n.texImage2D(34069+ce,0,H,te[ce].width,te[ce].height,0,De,we,te[ce].data);for(let Ue=0;Ue<ye.length;Ue++){const q1=ye[Ue].image[ce].image;be?n.texSubImage2D(34069+ce,Ue+1,0,0,q1.width,q1.height,De,we,q1.data):n.texImage2D(34069+ce,Ue+1,H,q1.width,q1.height,0,De,we,q1.data)}}else{be?n.texSubImage2D(34069+ce,0,0,0,De,we,te[ce]):n.texImage2D(34069+ce,0,H,De,we,te[ce]);for(let Ue=0;Ue<ye.length;Ue++){const et=ye[Ue];be?n.texSubImage2D(34069+ce,Ue+1,0,0,De,we,et.image[ce]):n.texImage2D(34069+ce,Ue+1,H,De,we,et.image[ce])}}}E(z,Ze)&&P(34067),ge.__currentVersion=ge.version,z.onUpdate&&z.onUpdate(z)}D.__version=z.version}(J,D,z):(n.activeTexture(33984+z),n.bindTexture(34067,J.__webglTexture))},this.rebindTextures=function fe(D,z,J){const se=i.get(D);void 0!==z&&_e(se.__webglFramebuffer,D,D.texture,36064,3553),void 0!==J&&X(D)},this.setupRenderTarget=function pe(D){const z=D.texture,J=i.get(D),se=i.get(z);D.addEventListener("dispose",C),!0!==D.isWebGLMultipleRenderTargets&&(void 0===se.__webglTexture&&(se.__webglTexture=t.createTexture()),se.__version=z.version,a.memory.textures++);const ge=!0===D.isWebGLCubeRenderTarget,Me=!0===D.isWebGLMultipleRenderTargets,Ne=S(D)||o;if(ge){J.__webglFramebuffer=[];for(let te=0;te<6;te++)J.__webglFramebuffer[te]=t.createFramebuffer()}else if(J.__webglFramebuffer=t.createFramebuffer(),Me)if(r.drawBuffers){const te=D.texture;for(let Be=0,Ze=te.length;Be<Ze;Be++){const De=i.get(te[Be]);void 0===De.__webglTexture&&(De.__webglTexture=t.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(o&&D.samples>0&&!1===Fe(D)){J.__webglMultisampledFramebuffer=t.createFramebuffer(),J.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,J.__webglColorRenderbuffer);const te=s.convert(z.format,z.encoding),Be=s.convert(z.type),Ze=V(z.internalFormat,te,Be,z.encoding),De=We(D);t.renderbufferStorageMultisample(36161,De,Ze,D.width,D.height),n.bindFramebuffer(36160,J.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,J.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),D.depthBuffer&&(J.__webglDepthRenderbuffer=t.createRenderbuffer(),oe(J.__webglDepthRenderbuffer,D,!0)),n.bindFramebuffer(36160,null)}if(ge){n.bindTexture(34067,se.__webglTexture),Pe(34067,z,Ne);for(let te=0;te<6;te++)_e(J.__webglFramebuffer[te],D,z,36064,34069+te);E(z,Ne)&&P(34067),n.unbindTexture()}else if(Me){const te=D.texture;for(let Be=0,Ze=te.length;Be<Ze;Be++){const De=te[Be],we=i.get(De);n.bindTexture(3553,we.__webglTexture),Pe(3553,De,Ne),_e(J.__webglFramebuffer,D,De,36064+Be,3553),E(De,Ne)&&P(3553)}n.unbindTexture()}else{let te=3553;(D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(o?te=D.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(te,se.__webglTexture),Pe(te,z,Ne),_e(J.__webglFramebuffer,D,z,36064,te),E(z,Ne)&&P(te),n.unbindTexture()}D.depthBuffer&&X(D)},this.updateRenderTargetMipmap=function Te(D){const z=S(D)||o,J=!0===D.isWebGLMultipleRenderTargets?D.texture:[D.texture];for(let se=0,ge=J.length;se<ge;se++){const Me=J[se];if(E(Me,z)){const Ne=D.isWebGLCubeRenderTarget?34067:3553,te=i.get(Me).__webglTexture;n.bindTexture(Ne,te),P(Ne),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function Se(D){if(o&&D.samples>0&&!1===Fe(D)){const z=D.width,J=D.height;let se=16384;const ge=[36064],Me=D.stencilBuffer?33306:36096;D.depthBuffer&&ge.push(Me);const Ne=i.get(D),te=void 0!==Ne.__ignoreDepthValues&&Ne.__ignoreDepthValues;!1===te&&(D.depthBuffer&&(se|=256),D.stencilBuffer&&(se|=1024)),n.bindFramebuffer(36008,Ne.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,Ne.__webglFramebuffer),!0===te&&(t.invalidateFramebuffer(36008,[Me]),t.invalidateFramebuffer(36009,[Me])),t.blitFramebuffer(0,0,z,J,0,0,z,J,se,9728),t.invalidateFramebuffer(36008,ge),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,Ne.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=X,this.setupFrameBufferTexture=_e,this.useMultisampledRTT=Fe}function K1e(t,e,n){const i=n.isWebGL2;return{convert:function r(s,a=null){let o;if(s===c4)return 5121;if(1017===s)return 32819;if(1018===s)return 32820;if(1010===s)return 5120;if(1011===s)return 5122;if(s===Xl)return 5123;if(1013===s)return 5124;if(1014===s)return 5125;if(s===Va)return 5126;if(s===z0)return i?5131:(o=e.get("OES_texture_half_float"),null!==o?o.HALF_FLOAT_OES:null);if(1021===s)return 6406;if(s===Fi)return 6408;if(1024===s)return 6409;if(1025===s)return 6410;if(s===l4)return 6402;if(s===A0)return 34041;if(1028===s)return 6403;if(1022===s)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===s)return o=e.get("EXT_sRGB"),null!==o?o.SRGB_ALPHA_EXT:null;if(1029===s)return 36244;if(1030===s)return 33319;if(1031===s)return 33320;if(1033===s)return 36249;if(33776===s||33777===s||33778===s||33779===s)if(a===U1){if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===o)return null;if(33776===s)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(o=e.get("WEBGL_compressed_texture_s3tc"),null===o)return null;if(33776===s)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(o=e.get("WEBGL_compressed_texture_pvrtc"),null===o)return null;if(35840===s)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return o=e.get("WEBGL_compressed_texture_etc1"),null!==o?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(o=e.get("WEBGL_compressed_texture_etc"),null===o)return null;if(37492===s)return a===U1?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(37496===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(o=e.get("WEBGL_compressed_texture_astc"),null===o)return null;if(37808===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return a===U1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(o=e.get("EXT_texture_compression_bptc"),null===o)return null;if(36492===s)return a===U1?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===T0?i?34042:(o=e.get("WEBGL_depth_texture"),null!==o?o.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Cv.prototype.isMeshDistanceMaterial=!0;class EL extends Zn{constructor(e=[]){super(),this.cameras=e}}EL.prototype.isArrayCamera=!0;class Q0 extends v1{constructor(){super(),this.type="Group"}}Q0.prototype.isGroup=!0;const Q1e={type:"move"};class Ev{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Q0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Q0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new W,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new W),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Q0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new W,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new W),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,a=null;const o=this._targetRay,c=this._grip,l=this._hand;if(e&&"visible-blurred"!==n.session.visibilityState)if(null!==o&&(r=n.getPose(e.targetRaySpace,i),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Q1e))),l&&e.hand){a=!0;for(const _ of e.hand.values()){const M=n.getJointPose(_,i);if(void 0===l.joints[_.jointName]){const g=new Q0;g.matrixAutoUpdate=!1,g.visible=!1,l.joints[_.jointName]=g,l.add(g)}const y=l.joints[_.jointName];null!==M&&(y.matrix.fromArray(M.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=M.radius),y.visible=null!==M}const d=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),m=.02,v=.005;l.inputState.pinching&&d>m+v?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=m-v&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),null!==s&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));return null!==o&&(o.visible=null!==r),null!==c&&(c.visible=null!==s),null!==l&&(l.visible=null!==a),this}}class zL extends Qi{constructor(e,n,i,r,s,a,o,c,l,u){if((u=void 0!==u?u:l4)!==l4&&u!==A0)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===l4&&(i=Xl),void 0===i&&u===A0&&(i=T0),super(null,r,s,a,o,c,u,i,l),this.image={width:e,height:n},this.magFilter=void 0!==o?o:Rn,this.minFilter=void 0!==c?c:Rn,this.flipY=!1,this.generateMipmaps=!1}}zL.prototype.isDepthTexture=!0;class ene extends h4{constructor(e,n){super();const i=this;let r=null,s=1,a=null,o="local-floor",c=null,l=null,u=null,f=null,d=null;const m=n.getContextAttributes();let v=null,_=null;const M=[],y=new Map,g=new Zn;g.layers.enable(1),g.viewport=new _1;const S=new Zn;S.layers.enable(2),S.viewport=new _1;const b=[g,S],E=new EL;E.layers.enable(1),E.layers.enable(2);let P=null,V=null;function j(k){const K=y.get(k.inputSource);K&&K.dispatchEvent({type:k.type,data:k.inputSource})}function Y(){y.forEach(function(k,K){k.disconnect(K)}),y.clear(),P=null,V=null,e.setRenderTarget(v),f=null,u=null,l=null,r=null,_=null,I.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function G(k){const K=r.inputSources;for(let re=0;re<M.length;re++)y.set(K[re],M[re]);for(let re=0;re<k.removed.length;re++){const ae=k.removed[re],ue=y.get(ae);ue&&(ue.dispatchEvent({type:"disconnected",data:ae}),y.delete(ae))}for(let re=0;re<k.added.length;re++){const ae=k.added[re],ue=y.get(ae);ue&&ue.dispatchEvent({type:"connected",data:ae})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(k){let K=M[k];return void 0===K&&(K=new Ev,M[k]=K),K.getTargetRaySpace()},this.getControllerGrip=function(k){let K=M[k];return void 0===K&&(K=new Ev,M[k]=K),K.getGripSpace()},this.getHand=function(k){let K=M[k];return void 0===K&&(K=new Ev,M[k]=K),K.getHandSpace()},this.setFramebufferScaleFactor=function(k){s=k,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(k){o=k,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getBaseLayer=function(){return null!==u?u:f},this.getBinding=function(){return l},this.getFrame=function(){return d},this.getSession=function(){return r},this.setSession=function(){var k=eA(function*(K){if(r=K,null!==r){if(v=e.getRenderTarget(),r.addEventListener("select",j),r.addEventListener("selectstart",j),r.addEventListener("selectend",j),r.addEventListener("squeeze",j),r.addEventListener("squeezestart",j),r.addEventListener("squeezeend",j),r.addEventListener("end",Y),r.addEventListener("inputsourceschange",G),!0!==m.xrCompatible&&(yield n.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)f=new XRWebGLLayer(r,n,{antialias:void 0!==r.renderState.layers||m.antialias,alpha:m.alpha,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:f}),_=new e2(f.framebufferWidth,f.framebufferHeight,{format:Fi,type:c4,encoding:e.outputEncoding});else{let re=null,ae=null,ue=null;m.depth&&(ue=m.stencil?35056:33190,re=m.stencil?A0:l4,ae=m.stencil?T0:Xl);const Le={colorFormat:e.outputEncoding===U1?35907:32856,depthFormat:ue,scaleFactor:s};l=new XRWebGLBinding(r,n),u=l.createProjectionLayer(Le),r.updateRenderState({layers:[u]}),_=new e2(u.textureWidth,u.textureHeight,{format:Fi,type:c4,depthTexture:new zL(u.textureWidth,u.textureHeight,ae,void 0,void 0,void 0,void 0,void 0,void 0,re),stencilBuffer:m.stencil,encoding:e.outputEncoding,samples:m.antialias?4:0}),e.properties.get(_).__ignoreDepthValues=u.ignoreDepthValues}_.isXRRenderTarget=!0,this.setFoveation(1),a=yield r.requestReferenceSpace(o),I.setContext(r),I.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(K){return k.apply(this,arguments)}}();const C=new W,N=new W;function U(k,K){null===K?k.matrixWorld.copy(k.matrix):k.matrixWorld.multiplyMatrices(K.matrixWorld,k.matrix),k.matrixWorldInverse.copy(k.matrixWorld).invert()}this.updateCamera=function(k){if(null===r)return;E.near=S.near=g.near=k.near,E.far=S.far=g.far=k.far,(P!==E.near||V!==E.far)&&(r.updateRenderState({depthNear:E.near,depthFar:E.far}),P=E.near,V=E.far);const K=k.parent,re=E.cameras;U(E,K);for(let ue=0;ue<re.length;ue++)U(re[ue],K);E.matrixWorld.decompose(E.position,E.quaternion,E.scale),k.position.copy(E.position),k.quaternion.copy(E.quaternion),k.scale.copy(E.scale),k.matrix.copy(E.matrix),k.matrixWorld.copy(E.matrixWorld);const ae=k.children;for(let ue=0,Le=ae.length;ue<Le;ue++)ae[ue].updateMatrixWorld(!0);2===re.length?function F(k,K,re){C.setFromMatrixPosition(K.matrixWorld),N.setFromMatrixPosition(re.matrixWorld);const ae=C.distanceTo(N),ue=K.projectionMatrix.elements,Le=re.projectionMatrix.elements,Oe=ue[14]/(ue[10]-1),Pe=ue[14]/(ue[10]+1),ie=(ue[9]+1)/ue[5],st=(ue[9]-1)/ue[5],ke=(ue[8]-1)/ue[0],_e=(Le[8]+1)/Le[0],oe=Oe*ke,xe=Oe*_e,X=ae/(-ke+_e),fe=X*-ke;K.matrixWorld.decompose(k.position,k.quaternion,k.scale),k.translateX(fe),k.translateZ(X),k.matrixWorld.compose(k.position,k.quaternion,k.scale),k.matrixWorldInverse.copy(k.matrixWorld).invert();const pe=Oe+X,Te=Pe+X;k.projectionMatrix.makePerspective(oe-fe,xe+(ae-fe),ie*Pe/Te*pe,st*Pe/Te*pe,pe,Te)}(E,g,S):E.projectionMatrix.copy(g.projectionMatrix)},this.getCamera=function(){return E},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==f?f.fixedFoveation:void 0},this.setFoveation=function(k){null!==u&&(u.fixedFoveation=k),null!==f&&void 0!==f.fixedFoveation&&(f.fixedFoveation=k)};let $=null;const I=new XA;I.setAnimationLoop(function O(k,K){if(c=K.getViewerPose(a),d=K,null!==c){const ae=c.views;null!==f&&(e.setRenderTargetFramebuffer(_,f.framebuffer),e.setRenderTarget(_));let ue=!1;ae.length!==E.cameras.length&&(E.cameras.length=0,ue=!0);for(let Le=0;Le<ae.length;Le++){const Oe=ae[Le];let Pe=null;if(null!==f)Pe=f.getViewport(Oe);else{const st=l.getViewSubImage(u,Oe);Pe=st.viewport,0===Le&&(e.setRenderTargetTextures(_,st.colorTexture,u.ignoreDepthValues?void 0:st.depthStencilTexture),e.setRenderTarget(_))}const ie=b[Le];ie.matrix.fromArray(Oe.transform.matrix),ie.projectionMatrix.fromArray(Oe.projectionMatrix),ie.viewport.set(Pe.x,Pe.y,Pe.width,Pe.height),0===Le&&E.matrix.copy(ie.matrix),!0===ue&&E.cameras.push(ie)}}const re=r.inputSources;for(let ae=0;ae<M.length;ae++)M[ae].update(re[ae],K,a);$&&$(k,K),d=null}),this.setAnimationLoop=function(k){$=k},this.dispose=function(){}}}function tne(t){function i(y,g){y.opacity.value=g.opacity,g.color&&y.diffuse.value.copy(g.color),g.emissive&&y.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(y.map.value=g.map),g.alphaMap&&(y.alphaMap.value=g.alphaMap),g.specularMap&&(y.specularMap.value=g.specularMap),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest);const S=t.get(g).envMap;let b,E;S&&(y.envMap.value=S,y.flipEnvMap.value=S.isCubeTexture&&!1===S.isRenderTargetTexture?-1:1,y.reflectivity.value=g.reflectivity,y.ior.value=g.ior,y.refractionRatio.value=g.refractionRatio),g.lightMap&&(y.lightMap.value=g.lightMap,y.lightMapIntensity.value=g.lightMapIntensity),g.aoMap&&(y.aoMap.value=g.aoMap,y.aoMapIntensity.value=g.aoMapIntensity),g.map?b=g.map:g.specularMap?b=g.specularMap:g.displacementMap?b=g.displacementMap:g.normalMap?b=g.normalMap:g.bumpMap?b=g.bumpMap:g.roughnessMap?b=g.roughnessMap:g.metalnessMap?b=g.metalnessMap:g.alphaMap?b=g.alphaMap:g.emissiveMap?b=g.emissiveMap:g.clearcoatMap?b=g.clearcoatMap:g.clearcoatNormalMap?b=g.clearcoatNormalMap:g.clearcoatRoughnessMap?b=g.clearcoatRoughnessMap:g.specularIntensityMap?b=g.specularIntensityMap:g.specularColorMap?b=g.specularColorMap:g.transmissionMap?b=g.transmissionMap:g.thicknessMap?b=g.thicknessMap:g.sheenColorMap?b=g.sheenColorMap:g.sheenRoughnessMap&&(b=g.sheenRoughnessMap),void 0!==b&&(b.isWebGLRenderTarget&&(b=b.texture),!0===b.matrixAutoUpdate&&b.updateMatrix(),y.uvTransform.value.copy(b.matrix)),g.aoMap?E=g.aoMap:g.lightMap&&(E=g.lightMap),void 0!==E&&(E.isWebGLRenderTarget&&(E=E.texture),!0===E.matrixAutoUpdate&&E.updateMatrix(),y.uv2Transform.value.copy(E.matrix))}function f(y,g){y.roughness.value=g.roughness,y.metalness.value=g.metalness,g.roughnessMap&&(y.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(y.metalnessMap.value=g.metalnessMap),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap),g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias),t.get(g).envMap&&(y.envMapIntensity.value=g.envMapIntensity)}return{refreshFogUniforms:function e(y,g){y.fogColor.value.copy(g.color),g.isFog?(y.fogNear.value=g.near,y.fogFar.value=g.far):g.isFogExp2&&(y.fogDensity.value=g.density)},refreshMaterialUniforms:function n(y,g,S,b,E){g.isMeshBasicMaterial?i(y,g):g.isMeshLambertMaterial?(i(y,g),function c(y,g){g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap)}(y,g)):g.isMeshToonMaterial?(i(y,g),function u(y,g){g.gradientMap&&(y.gradientMap.value=g.gradientMap),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap),g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isMeshPhongMaterial?(i(y,g),function l(y,g){y.specular.value.copy(g.specular),y.shininess.value=Math.max(g.shininess,1e-4),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap),g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isMeshStandardMaterial?(i(y,g),g.isMeshPhysicalMaterial?function d(y,g,S){f(y,g),y.ior.value=g.ior,g.sheen>0&&(y.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),y.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(y.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(y.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(y.clearcoat.value=g.clearcoat,y.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(y.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(y.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),y.clearcoatNormalMap.value=g.clearcoatNormalMap,1===g.side&&y.clearcoatNormalScale.value.negate())),g.transmission>0&&(y.transmission.value=g.transmission,y.transmissionSamplerMap.value=S.texture,y.transmissionSamplerSize.value.set(S.width,S.height),g.transmissionMap&&(y.transmissionMap.value=g.transmissionMap),y.thickness.value=g.thickness,g.thicknessMap&&(y.thicknessMap.value=g.thicknessMap),y.attenuationDistance.value=g.attenuationDistance,y.attenuationColor.value.copy(g.attenuationColor)),y.specularIntensity.value=g.specularIntensity,y.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(y.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(y.specularColorMap.value=g.specularColorMap)}(y,g,E):f(y,g)):g.isMeshMatcapMaterial?(i(y,g),function m(y,g){g.matcap&&(y.matcap.value=g.matcap),g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isMeshDepthMaterial?(i(y,g),function v(y,g){g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isMeshDistanceMaterial?(i(y,g),function _(y,g){g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias),y.referencePosition.value.copy(g.referencePosition),y.nearDistance.value=g.nearDistance,y.farDistance.value=g.farDistance}(y,g)):g.isMeshNormalMaterial?(i(y,g),function M(y,g){g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isLineBasicMaterial?(function r(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity}(y,g),g.isLineDashedMaterial&&function s(y,g){y.dashSize.value=g.dashSize,y.totalSize.value=g.dashSize+g.gapSize,y.scale.value=g.scale}(y,g)):g.isPointsMaterial?function a(y,g,S,b){let E;y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.size.value=g.size*S,y.scale.value=.5*b,g.map&&(y.map.value=g.map),g.alphaMap&&(y.alphaMap.value=g.alphaMap),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest),g.map?E=g.map:g.alphaMap&&(E=g.alphaMap),void 0!==E&&(!0===E.matrixAutoUpdate&&E.updateMatrix(),y.uvTransform.value.copy(E.matrix))}(y,g,S,b):g.isSpriteMaterial?function o(y,g){let S;y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.rotation.value=g.rotation,g.map&&(y.map.value=g.map),g.alphaMap&&(y.alphaMap.value=g.alphaMap),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest),g.map?S=g.map:g.alphaMap&&(S=g.alphaMap),void 0!==S&&(!0===S.matrixAutoUpdate&&S.updateMatrix(),y.uvTransform.value.copy(S.matrix))}(y,g):g.isShadowMaterial?(y.color.value.copy(g.color),y.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function x1(t={}){const e=void 0!==t.canvas?t.canvas:function nne(){const t=e8("canvas");return t.style.display="block",t}(),n=void 0!==t.context?t.context:null,i=void 0===t.depth||t.depth,r=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,o=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",l=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let u;u=void 0!==t.context?n.getContextAttributes().alpha:void 0!==t.alpha&&t.alpha;let f=null,d=null;const m=[],v=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Oa,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const _=this;let M=!1,y=0,g=0,S=null,b=-1,E=null;const P=new _1,V=new _1;let j=null,Y=e.width,G=e.height,C=1,N=null,F=null;const U=new _1(0,0,Y,G),$=new _1(0,0,Y,G);let O=!1;const I=new h7;let k=!1,K=!1,re=null;const ae=new mt,ue=new ze,Le=new W,Oe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Pe(){return null===S?C:1}let ke,_e,oe,xe,X,fe,pe,Te,Se,We,Fe,rt,Gt,D,z,J,se,ge,Me,Ne,te,Be,Ze,ie=n;function st(T,B){for(let Z=0;Z<T.length;Z++){const ne=e.getContext(T[Z],B);if(null!==ne)return ne}return null}try{const T={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:c,failIfMajorPerformanceCaveat:l};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r138"),e.addEventListener("webglcontextlost",H,!1),e.addEventListener("webglcontextrestored",be,!1),null===ie){const B=["webgl2","webgl","experimental-webgl"];if(!0===_.isWebGL1Renderer&&B.shift(),ie=st(B,T),null===ie)throw st(B)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ie.getShaderPrecisionFormat&&(ie.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(T){throw console.error("THREE.WebGLRenderer: "+T.message),T}function De(){ke=new xte(ie),_e=new pte(ie,ke,t),ke.init(_e),Be=new K1e(ie,ke,_e),oe=new Y1e(ie,ke,_e),xe=new wte(ie),X=new k1e,fe=new J1e(ie,ke,oe,X,_e,Be,xe),pe=new gte(_),Te=new _te(_),Se=new mQ(ie,_e),Ze=new fte(ie,ke,Se,_e),We=new Mte(ie,Se,xe,Ze),Fe=new zte(ie,We,Se,xe),Me=new Ete(ie,_e,fe),J=new mte(X),rt=new O1e(_,pe,Te,ke,_e,Ze,J),Gt=new tne(X),D=new B1e,z=new Z1e(ke,_e),ge=new ute(_,pe,oe,Fe,u,a),se=new CL(_,Fe,_e),Ne=new dte(ie,ke,xe,_e),te=new bte(ie,ke,xe,_e),xe.programs=rt.programs,_.capabilities=_e,_.extensions=ke,_.properties=X,_.renderLists=D,_.shadowMap=se,_.state=oe,_.info=xe}De();const we=new ene(_,ie);function H(T){T.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function be(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1;const T=xe.autoReset,B=se.enabled,Z=se.autoUpdate,q=se.needsUpdate,ne=se.type;De(),xe.autoReset=T,se.enabled=B,se.autoUpdate=Z,se.needsUpdate=q,se.type=ne}function ve(T){const B=T.target;B.removeEventListener("dispose",ve),function je(T){(function ye(T){const B=X.get(T).programs;void 0!==B&&(B.forEach(function(Z){rt.releaseProgram(Z)}),T.isShaderMaterial&&rt.releaseShaderCache(T))})(T),X.remove(T)}(B)}this.xr=we,this.getContext=function(){return ie},this.getContextAttributes=function(){return ie.getContextAttributes()},this.forceContextLoss=function(){const T=ke.get("WEBGL_lose_context");T&&T.loseContext()},this.forceContextRestore=function(){const T=ke.get("WEBGL_lose_context");T&&T.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(T){void 0!==T&&(C=T,this.setSize(Y,G,!1))},this.getSize=function(T){return T.set(Y,G)},this.setSize=function(T,B,Z){we.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Y=T,G=B,e.width=Math.floor(T*C),e.height=Math.floor(B*C),!1!==Z&&(e.style.width=T+"px",e.style.height=B+"px"),this.setViewport(0,0,T,B))},this.getDrawingBufferSize=function(T){return T.set(Y*C,G*C).floor()},this.setDrawingBufferSize=function(T,B,Z){Y=T,G=B,C=Z,e.width=Math.floor(T*Z),e.height=Math.floor(B*Z),this.setViewport(0,0,T,B)},this.getCurrentViewport=function(T){return T.copy(P)},this.getViewport=function(T){return T.copy(U)},this.setViewport=function(T,B,Z,q){T.isVector4?U.set(T.x,T.y,T.z,T.w):U.set(T,B,Z,q),oe.viewport(P.copy(U).multiplyScalar(C).floor())},this.getScissor=function(T){return T.copy($)},this.setScissor=function(T,B,Z,q){T.isVector4?$.set(T.x,T.y,T.z,T.w):$.set(T,B,Z,q),oe.scissor(V.copy($).multiplyScalar(C).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(T){oe.setScissorTest(O=T)},this.setOpaqueSort=function(T){N=T},this.setTransparentSort=function(T){F=T},this.getClearColor=function(T){return T.copy(ge.getClearColor())},this.setClearColor=function(){ge.setClearColor.apply(ge,arguments)},this.getClearAlpha=function(){return ge.getClearAlpha()},this.setClearAlpha=function(){ge.setClearAlpha.apply(ge,arguments)},this.clear=function(T=!0,B=!0,Z=!0){let q=0;T&&(q|=16384),B&&(q|=256),Z&&(q|=1024),ie.clear(q)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",H,!1),e.removeEventListener("webglcontextrestored",be,!1),D.dispose(),z.dispose(),X.dispose(),pe.dispose(),Te.dispose(),Fe.dispose(),Ze.dispose(),rt.dispose(),we.dispose(),we.removeEventListener("sessionstart",et),we.removeEventListener("sessionend",q1),re&&(re.dispose(),re=null),vt.stop()},this.renderBufferDirect=function(T,B,Z,q,ne,Re){null===B&&(B=Oe);const $e=ne.isMesh&&ne.matrixWorld.determinant()<0,Ye=function ax(T,B,Z,q,ne){!0!==B.isScene&&(B=Oe),fe.resetTextureUnits();const Re=B.fog,Ye=null===S?_.outputEncoding:!0===S.isXRRenderTarget?S.texture.encoding:Oa,Ke=(q.isMeshStandardMaterial?Te:pe).get(q.envMap||(q.isMeshStandardMaterial?B.environment:null)),_t=!0===q.vertexColors&&!!Z.attributes.color&&4===Z.attributes.color.itemSize,at=!!q.normalMap&&!!Z.attributes.tangent,ct=!!Z.morphAttributes.position,Ft=!!Z.morphAttributes.normal,Gi=!!Z.morphAttributes.color,N2=q.toneMapped?_.toneMapping:0,R2=Z.morphAttributes.position||Z.morphAttributes.normal||Z.morphAttributes.color,vn=void 0!==R2?R2.length:0,ft=X.get(q),H2=d.state.lights;!0!==k||!0!==K&&T===E||J.setState(q,T,T===E&&q.id===b);let N1=!1;q.version===ft.__version?(ft.needsLights&&ft.lightsStateVersion!==H2.state.version||ft.outputEncoding!==Ye||ne.isInstancedMesh&&!1===ft.instancing||!ne.isInstancedMesh&&!0===ft.instancing||ne.isSkinnedMesh&&!1===ft.skinning||!ne.isSkinnedMesh&&!0===ft.skinning||ft.envMap!==Ke||q.fog&&ft.fog!==Re||void 0!==ft.numClippingPlanes&&(ft.numClippingPlanes!==J.numPlanes||ft.numIntersection!==J.numIntersection)||ft.vertexAlphas!==_t||ft.vertexTangents!==at||ft.morphTargets!==ct||ft.morphNormals!==Ft||ft.morphColors!==Gi||ft.toneMapping!==N2||!0===_e.isWebGL2&&ft.morphTargetsCount!==vn)&&(N1=!0):(N1=!0,ft.__version=q.version);let yn=ft.currentProgram;!0===N1&&(yn=W4(q,B,ne));let ui=!1,Vr=!1,j4=!1;const h1=yn.getUniforms(),Or=ft.uniforms;if(oe.useProgram(yn.program)&&(ui=!0,Vr=!0,j4=!0),q.id!==b&&(b=q.id,Vr=!0),ui||E!==T){if(h1.setValue(ie,"projectionMatrix",T.projectionMatrix),_e.logarithmicDepthBuffer&&h1.setValue(ie,"logDepthBufFC",2/(Math.log(T.far+1)/Math.LN2)),E!==T&&(E=T,Vr=!0,j4=!0),q.isShaderMaterial||q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshStandardMaterial||q.envMap){const tn=h1.map.cameraPosition;void 0!==tn&&tn.setValue(ie,Le.setFromMatrixPosition(T.matrixWorld))}(q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshLambertMaterial||q.isMeshBasicMaterial||q.isMeshStandardMaterial||q.isShaderMaterial)&&h1.setValue(ie,"isOrthographic",!0===T.isOrthographicCamera),(q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshLambertMaterial||q.isMeshBasicMaterial||q.isMeshStandardMaterial||q.isShaderMaterial||q.isShadowMaterial||ne.isSkinnedMesh)&&h1.setValue(ie,"viewMatrix",T.matrixWorldInverse)}if(ne.isSkinnedMesh){h1.setOptional(ie,ne,"bindMatrix"),h1.setOptional(ie,ne,"bindMatrixInverse");const tn=ne.skeleton;tn&&(_e.floatVertexTextures?(null===tn.boneTexture&&tn.computeBoneTexture(),h1.setValue(ie,"boneTexture",tn.boneTexture,fe),h1.setValue(ie,"boneTextureSize",tn.boneTextureSize)):h1.setOptional(ie,tn,"boneMatrices"))}const q4=Z.morphAttributes;return(void 0!==q4.position||void 0!==q4.normal||void 0!==q4.color&&!0===_e.isWebGL2)&&Me.update(ne,Z,q,yn),(Vr||ft.receiveShadow!==ne.receiveShadow)&&(ft.receiveShadow=ne.receiveShadow,h1.setValue(ie,"receiveShadow",ne.receiveShadow)),Vr&&(h1.setValue(ie,"toneMappingExposure",_.toneMappingExposure),ft.needsLights&&function ox(T,B){T.ambientLightColor.needsUpdate=B,T.lightProbe.needsUpdate=B,T.directionalLights.needsUpdate=B,T.directionalLightShadows.needsUpdate=B,T.pointLights.needsUpdate=B,T.pointLightShadows.needsUpdate=B,T.spotLights.needsUpdate=B,T.spotLightShadows.needsUpdate=B,T.rectAreaLights.needsUpdate=B,T.hemisphereLights.needsUpdate=B}(Or,j4),Re&&q.fog&&Gt.refreshFogUniforms(Or,Re),Gt.refreshMaterialUniforms(Or,q,C,G,re),Za.upload(ie,ft.uniformsList,Or,fe)),q.isShaderMaterial&&!0===q.uniformsNeedUpdate&&(Za.upload(ie,ft.uniformsList,Or,fe),q.uniformsNeedUpdate=!1),q.isSpriteMaterial&&h1.setValue(ie,"center",ne.center),h1.setValue(ie,"modelViewMatrix",ne.modelViewMatrix),h1.setValue(ie,"normalMatrix",ne.normalMatrix),h1.setValue(ie,"modelMatrix",ne.matrixWorld),yn}(T,B,Z,q,ne);oe.setMaterial(q,$e);let Ke=Z.index;const _t=Z.attributes.position;if(null===Ke){if(void 0===_t||0===_t.count)return}else if(0===Ke.count)return;let at=1;!0===q.wireframe&&(Ke=We.getWireframeAttribute(Z),at=2),Ze.setup(ne,q,Ye,Z,Ke);let ct,Ft=Ne;null!==Ke&&(ct=Se.get(Ke),Ft=te,Ft.setIndex(ct));const Gi=null!==Ke?Ke.count:_t.count,N2=Z.drawRange.start*at,R2=Z.drawRange.count*at,vn=null!==Re?Re.start*at:0,ft=null!==Re?Re.count*at:1/0,H2=Math.max(N2,vn),N1=Math.min(Gi,N2+R2,vn+ft)-1,yn=Math.max(0,N1-H2+1);if(0!==yn){if(ne.isMesh)!0===q.wireframe?(oe.setLineWidth(q.wireframeLinewidth*Pe()),Ft.setMode(1)):Ft.setMode(4);else if(ne.isLine){let ui=q.linewidth;void 0===ui&&(ui=1),oe.setLineWidth(ui*Pe()),Ft.setMode(ne.isLineSegments?1:ne.isLineLoop?2:3)}else ne.isPoints?Ft.setMode(0):ne.isSprite&&Ft.setMode(4);if(ne.isInstancedMesh)Ft.renderInstances(H2,yn,ne.count);else if(Z.isInstancedBufferGeometry){const ui=Math.min(Z.instanceCount,Z._maxInstanceCount);Ft.renderInstances(H2,yn,ui)}else Ft.render(H2,yn)}},this.compile=function(T,B){d=z.get(T),d.init(),v.push(d),T.traverseVisible(function(Z){Z.isLight&&Z.layers.test(B.layers)&&(d.pushLight(Z),Z.castShadow&&d.pushShadow(Z))}),d.setupLights(_.physicallyCorrectLights),T.traverse(function(Z){const q=Z.material;if(q)if(Array.isArray(q))for(let ne=0;ne<q.length;ne++)W4(q[ne],T,Z);else W4(q,T,Z)}),v.pop(),d=null};let ce=null;function et(){vt.stop()}function q1(){vt.start()}const vt=new XA;function mn(T,B,Z,q){if(!1===T.visible)return;if(T.layers.test(B.layers))if(T.isGroup)Z=T.renderOrder;else if(T.isLOD)!0===T.autoUpdate&&T.update(B);else if(T.isLight)d.pushLight(T),T.castShadow&&d.pushShadow(T);else if(T.isSprite){if(!T.frustumCulled||I.intersectsSprite(T)){q&&Le.setFromMatrixPosition(T.matrixWorld).applyMatrix4(ae);const $e=Fe.update(T),Ye=T.material;Ye.visible&&f.push(T,$e,Ye,Z,Le.z,null)}}else if((T.isMesh||T.isLine||T.isPoints)&&(T.isSkinnedMesh&&T.skeleton.frame!==xe.render.frame&&(T.skeleton.update(),T.skeleton.frame=xe.render.frame),!T.frustumCulled||I.intersectsObject(T))){q&&Le.setFromMatrixPosition(T.matrixWorld).applyMatrix4(ae);const $e=Fe.update(T),Ye=T.material;if(Array.isArray(Ye)){const Ke=$e.groups;for(let _t=0,at=Ke.length;_t<at;_t++){const ct=Ke[_t],Ft=Ye[ct.materialIndex];Ft&&Ft.visible&&f.push(T,$e,Ft,Z,Le.z,ct)}}else Ye.visible&&f.push(T,$e,Ye,Z,Le.z,null)}const Re=T.children;for(let $e=0,Ye=Re.length;$e<Ye;$e++)mn(Re[$e],B,Z,q)}function gn(T,B,Z,q){const ne=T.opaque,Re=T.transmissive,$e=T.transparent;d.setupLightsView(Z),Re.length>0&&function rx(T,B,Z){const q=_e.isWebGL2;null===re&&(re=new e2(1,1,{generateMipmaps:!0,type:null!==Be.convert(z0)?z0:c4,minFilter:1008,samples:q&&!0===s?4:0})),_.getDrawingBufferSize(ue),q?re.setSize(ue.x,ue.y):re.setSize(Gu(ue.x),Gu(ue.y));const ne=_.getRenderTarget();_.setRenderTarget(re),_.clear();const Re=_.toneMapping;_.toneMapping=0,aa(T,B,Z),_.toneMapping=Re,fe.updateMultisampleRenderTarget(re),fe.updateRenderTargetMipmap(re),_.setRenderTarget(ne)}(ne,B,Z),q&&oe.viewport(P.copy(q)),ne.length>0&&aa(ne,B,Z),Re.length>0&&aa(Re,B,Z),$e.length>0&&aa($e,B,Z),oe.buffers.depth.setTest(!0),oe.buffers.depth.setMask(!0),oe.buffers.color.setMask(!0),oe.setPolygonOffset(!1)}function aa(T,B,Z){const q=!0===B.isScene?B.overrideMaterial:null;for(let ne=0,Re=T.length;ne<Re;ne++){const $e=T[ne],Ye=$e.object,Ke=$e.geometry,_t=null===q?$e.material:q,at=$e.group;Ye.layers.test(Z.layers)&&sx(Ye,B,Z,Ke,_t,at)}}function sx(T,B,Z,q,ne,Re){T.onBeforeRender(_,B,Z,q,ne,Re),T.modelViewMatrix.multiplyMatrices(Z.matrixWorldInverse,T.matrixWorld),T.normalMatrix.getNormalMatrix(T.modelViewMatrix),ne.onBeforeRender(_,B,Z,q,T,Re),!0===ne.transparent&&2===ne.side?(ne.side=1,ne.needsUpdate=!0,_.renderBufferDirect(Z,B,q,ne,T,Re),ne.side=0,ne.needsUpdate=!0,_.renderBufferDirect(Z,B,q,ne,T,Re),ne.side=2):_.renderBufferDirect(Z,B,q,ne,T,Re),T.onAfterRender(_,B,Z,q,ne,Re)}function W4(T,B,Z){!0!==B.isScene&&(B=Oe);const q=X.get(T),ne=d.state.lights,$e=ne.state.version,Ye=rt.getParameters(T,ne.state,d.state.shadowsArray,B,Z),Ke=rt.getProgramCacheKey(Ye);let _t=q.programs;q.environment=T.isMeshStandardMaterial?B.environment:null,q.fog=B.fog,q.envMap=(T.isMeshStandardMaterial?Te:pe).get(T.envMap||q.environment),void 0===_t&&(T.addEventListener("dispose",ve),_t=new Map,q.programs=_t);let at=_t.get(Ke);if(void 0!==at){if(q.currentProgram===at&&q.lightsStateVersion===$e)return K8(T,Ye),at}else Ye.uniforms=rt.getUniforms(T),T.onBuild(Z,Ye,_),T.onBeforeCompile(Ye,_),at=rt.acquireProgram(Ye,Ke),_t.set(Ke,at),q.uniforms=Ye.uniforms;const ct=q.uniforms;(!T.isShaderMaterial&&!T.isRawShaderMaterial||!0===T.clipping)&&(ct.clippingPlanes=J.uniform),K8(T,Ye),q.needsLights=function cx(T){return T.isMeshLambertMaterial||T.isMeshToonMaterial||T.isMeshPhongMaterial||T.isMeshStandardMaterial||T.isShadowMaterial||T.isShaderMaterial&&!0===T.lights}(T),q.lightsStateVersion=$e,q.needsLights&&(ct.ambientLightColor.value=ne.state.ambient,ct.lightProbe.value=ne.state.probe,ct.directionalLights.value=ne.state.directional,ct.directionalLightShadows.value=ne.state.directionalShadow,ct.spotLights.value=ne.state.spot,ct.spotLightShadows.value=ne.state.spotShadow,ct.rectAreaLights.value=ne.state.rectArea,ct.ltc_1.value=ne.state.rectAreaLTC1,ct.ltc_2.value=ne.state.rectAreaLTC2,ct.pointLights.value=ne.state.point,ct.pointLightShadows.value=ne.state.pointShadow,ct.hemisphereLights.value=ne.state.hemi,ct.directionalShadowMap.value=ne.state.directionalShadowMap,ct.directionalShadowMatrix.value=ne.state.directionalShadowMatrix,ct.spotShadowMap.value=ne.state.spotShadowMap,ct.spotShadowMatrix.value=ne.state.spotShadowMatrix,ct.pointShadowMap.value=ne.state.pointShadowMap,ct.pointShadowMatrix.value=ne.state.pointShadowMatrix);const Ft=at.getUniforms(),Gi=Za.seqWithValue(Ft.seq,ct);return q.currentProgram=at,q.uniformsList=Gi,at}function K8(T,B){const Z=X.get(T);Z.outputEncoding=B.outputEncoding,Z.instancing=B.instancing,Z.skinning=B.skinning,Z.morphTargets=B.morphTargets,Z.morphNormals=B.morphNormals,Z.morphColors=B.morphColors,Z.morphTargetsCount=B.morphTargetsCount,Z.numClippingPlanes=B.numClippingPlanes,Z.numIntersection=B.numClipIntersection,Z.vertexAlphas=B.vertexAlphas,Z.vertexTangents=B.vertexTangents,Z.toneMapping=B.toneMapping}vt.setAnimationLoop(function Ue(T){ce&&ce(T)}),"undefined"!=typeof window&&vt.setContext(window),this.setAnimationLoop=function(T){ce=T,we.setAnimationLoop(T),null===T?vt.stop():vt.start()},we.addEventListener("sessionstart",et),we.addEventListener("sessionend",q1),this.render=function(T,B){if(void 0===B||!0===B.isCamera){if(!0!==M){if(!0===T.autoUpdate&&T.updateMatrixWorld(),null===B.parent&&B.updateMatrixWorld(),!0===we.enabled&&!0===we.isPresenting&&(!0===we.cameraAutoUpdate&&we.updateCamera(B),B=we.getCamera()),!0===T.isScene&&T.onBeforeRender(_,T,B,S),d=z.get(T,v.length),d.init(),v.push(d),ae.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse),I.setFromProjectionMatrix(ae),K=this.localClippingEnabled,k=J.init(this.clippingPlanes,K,B),f=D.get(T,m.length),f.init(),m.push(f),mn(T,B,0,_.sortObjects),f.finish(),!0===_.sortObjects&&f.sort(N,F),!0===k&&J.beginShadows(),se.render(d.state.shadowsArray,T,B),!0===k&&J.endShadows(),!0===this.info.autoReset&&this.info.reset(),ge.render(f,T),d.setupLights(_.physicallyCorrectLights),B.isArrayCamera){const q=B.cameras;for(let ne=0,Re=q.length;ne<Re;ne++){const $e=q[ne];gn(f,T,$e,$e.viewport)}}else gn(f,T,B);null!==S&&(fe.updateMultisampleRenderTarget(S),fe.updateRenderTargetMipmap(S)),!0===T.isScene&&T.onAfterRender(_,T,B),Ze.resetDefaultState(),b=-1,E=null,v.pop(),d=v.length>0?v[v.length-1]:null,m.pop(),f=m.length>0?m[m.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return g},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(T,B,Z){X.get(T.texture).__webglTexture=B,X.get(T.depthTexture).__webglTexture=Z;const q=X.get(T);q.__hasExternalTextures=!0,q.__hasExternalTextures&&(q.__autoAllocateDepthBuffer=void 0===Z,q.__autoAllocateDepthBuffer||!0===ke.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),q.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(T,B){const Z=X.get(T);Z.__webglFramebuffer=B,Z.__useDefaultFramebuffer=void 0===B},this.setRenderTarget=function(T,B=0,Z=0){S=T,y=B,g=Z;let q=!0;if(T){const Ke=X.get(T);void 0!==Ke.__useDefaultFramebuffer?(oe.bindFramebuffer(36160,null),q=!1):void 0===Ke.__webglFramebuffer?fe.setupRenderTarget(T):Ke.__hasExternalTextures&&fe.rebindTextures(T,X.get(T.texture).__webglTexture,X.get(T.depthTexture).__webglTexture)}let ne=null,Re=!1,$e=!1;if(T){const Ke=T.texture;(Ke.isData3DTexture||Ke.isDataArrayTexture)&&($e=!0);const _t=X.get(T).__webglFramebuffer;T.isWebGLCubeRenderTarget?(ne=_t[B],Re=!0):ne=_e.isWebGL2&&T.samples>0&&!1===fe.useMultisampledRTT(T)?X.get(T).__webglMultisampledFramebuffer:_t,P.copy(T.viewport),V.copy(T.scissor),j=T.scissorTest}else P.copy(U).multiplyScalar(C).floor(),V.copy($).multiplyScalar(C).floor(),j=O;if(oe.bindFramebuffer(36160,ne)&&_e.drawBuffers&&q&&oe.drawBuffers(T,ne),oe.viewport(P),oe.scissor(V),oe.setScissorTest(j),Re){const Ke=X.get(T.texture);ie.framebufferTexture2D(36160,36064,34069+B,Ke.__webglTexture,Z)}else if($e){const Ke=X.get(T.texture);ie.framebufferTextureLayer(36160,36064,Ke.__webglTexture,Z||0,B||0)}b=-1},this.readRenderTargetPixels=function(T,B,Z,q,ne,Re,$e){if(!T||!T.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ye=X.get(T).__webglFramebuffer;if(T.isWebGLCubeRenderTarget&&void 0!==$e&&(Ye=Ye[$e]),Ye){oe.bindFramebuffer(36160,Ye);try{const Ke=T.texture,_t=Ke.format,at=Ke.type;if(_t!==Fi&&Be.convert(_t)!==ie.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ct=at===z0&&(ke.has("EXT_color_buffer_half_float")||_e.isWebGL2&&ke.has("EXT_color_buffer_float"));if(!(at===c4||Be.convert(at)===ie.getParameter(35738)||at===Va&&(_e.isWebGL2||ke.has("OES_texture_float")||ke.has("WEBGL_color_buffer_float"))||ct))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ie.checkFramebufferStatus(36160)?B>=0&&B<=T.width-q&&Z>=0&&Z<=T.height-ne&&ie.readPixels(B,Z,q,ne,Be.convert(_t),Be.convert(at),Re):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Ke=null!==S?X.get(S).__webglFramebuffer:null;oe.bindFramebuffer(36160,Ke)}}},this.copyFramebufferToTexture=function(T,B,Z=0){if(!0!==B.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const q=Math.pow(2,-Z),ne=Math.floor(B.image.width*q),Re=Math.floor(B.image.height*q);fe.setTexture2D(B,0),ie.copyTexSubImage2D(3553,Z,0,0,T.x,T.y,ne,Re),oe.unbindTexture()},this.copyTextureToTexture=function(T,B,Z,q=0){const ne=B.image.width,Re=B.image.height,$e=Be.convert(Z.format),Ye=Be.convert(Z.type);fe.setTexture2D(Z,0),ie.pixelStorei(37440,Z.flipY),ie.pixelStorei(37441,Z.premultiplyAlpha),ie.pixelStorei(3317,Z.unpackAlignment),B.isDataTexture?ie.texSubImage2D(3553,q,T.x,T.y,ne,Re,$e,Ye,B.image.data):B.isCompressedTexture?ie.compressedTexSubImage2D(3553,q,T.x,T.y,B.mipmaps[0].width,B.mipmaps[0].height,$e,B.mipmaps[0].data):ie.texSubImage2D(3553,q,T.x,T.y,$e,Ye,B.image),0===q&&Z.generateMipmaps&&ie.generateMipmap(3553),oe.unbindTexture()},this.copyTextureToTexture3D=function(T,B,Z,q,ne=0){if(_.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Re=T.max.x-T.min.x+1,$e=T.max.y-T.min.y+1,Ye=T.max.z-T.min.z+1,Ke=Be.convert(q.format),_t=Be.convert(q.type);let at;if(q.isData3DTexture)fe.setTexture3D(q,0),at=32879;else{if(!q.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");fe.setTexture2DArray(q,0),at=35866}ie.pixelStorei(37440,q.flipY),ie.pixelStorei(37441,q.premultiplyAlpha),ie.pixelStorei(3317,q.unpackAlignment);const ct=ie.getParameter(3314),Ft=ie.getParameter(32878),Gi=ie.getParameter(3316),N2=ie.getParameter(3315),R2=ie.getParameter(32877),vn=Z.isCompressedTexture?Z.mipmaps[0]:Z.image;ie.pixelStorei(3314,vn.width),ie.pixelStorei(32878,vn.height),ie.pixelStorei(3316,T.min.x),ie.pixelStorei(3315,T.min.y),ie.pixelStorei(32877,T.min.z),Z.isDataTexture||Z.isData3DTexture?ie.texSubImage3D(at,ne,B.x,B.y,B.z,Re,$e,Ye,Ke,_t,vn.data):Z.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ie.compressedTexSubImage3D(at,ne,B.x,B.y,B.z,Re,$e,Ye,Ke,vn.data)):ie.texSubImage3D(at,ne,B.x,B.y,B.z,Re,$e,Ye,Ke,_t,vn),ie.pixelStorei(3314,ct),ie.pixelStorei(32878,Ft),ie.pixelStorei(3316,Gi),ie.pixelStorei(3315,N2),ie.pixelStorei(32877,R2),0===ne&&q.generateMipmaps&&ie.generateMipmap(at),oe.unbindTexture()},this.initTexture=function(T){fe.setTexture2D(T,0),oe.unbindTexture()},this.resetState=function(){y=0,g=0,S=null,oe.reset(),Ze.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}x1.prototype.isWebGLRenderer=!0,class ine extends x1{}.prototype.isWebGL1Renderer=!0;class d7{constructor(e,n=25e-5){this.name="",this.color=new it(e),this.density=n}clone(){return new d7(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}d7.prototype.isFogExp2=!0;class p7{constructor(e,n=1,i=1e3){this.name="",this.color=new it(e),this.near=n,this.far=i}clone(){return new p7(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}p7.prototype.isFog=!0;class m7 extends v1{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return null!==this.fog&&(n.object.fog=this.fog.toJSON()),n}}m7.prototype.isScene=!0;class ec{constructor(e,n){this.array=e,this.stride=n,this.count=void 0!==e?e.length/n:0,this.usage=Yl,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=C2()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=C2()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=C2()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}ec.prototype.isInterleavedBuffer=!0;const fn=new W;class M4{constructor(e,n,i,r=!1){this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)fn.x=this.getX(n),fn.y=this.getY(n),fn.z=this.getZ(n),fn.applyMatrix4(e),this.setXYZ(n,fn.x,fn.y,fn.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)fn.x=this.getX(n),fn.y=this.getY(n),fn.z=this.getZ(n),fn.applyNormalMatrix(e),this.setXYZ(n,fn.x,fn.y,fn.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)fn.x=this.getX(n),fn.y=this.getY(n),fn.z=this.getZ(n),fn.transformDirection(e),this.setXYZ(n,fn.x,fn.y,fn.z);return this}setX(e,n){return this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,n,i){return this.data.array[(e=e*this.data.stride+this.offset)+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new z1(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new M4(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}M4.prototype.isInterleavedBufferAttribute=!0;class zv extends En{constructor(e){super(),this.type="SpriteMaterial",this.color=new it(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let tc;zv.prototype.isSpriteMaterial=!0;const l8=new W,nc=new W,ic=new W,rc=new ze,h8=new ze,TL=new mt,g7=new W,u8=new W,v7=new W,AL=new ze,Tv=new ze,LL=new ze;function y7(t,e,n,i,r,s){rc.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(h8.x=s*rc.x-r*rc.y,h8.y=r*rc.x+s*rc.y):h8.copy(rc),t.copy(e),t.x+=h8.x,t.y+=h8.y,t.applyMatrix4(TL)}(class Av extends v1{constructor(e){if(super(),this.type="Sprite",void 0===tc){tc=new St;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new ec(n,5);tc.setIndex([0,1,2,0,2,3]),tc.setAttribute("position",new M4(i,3,0,!1)),tc.setAttribute("uv",new M4(i,2,3,!1))}this.geometry=tc,this.material=void 0!==e?e:new zv,this.center=new ze(.5,.5)}raycast(e,n){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),nc.setFromMatrixScale(this.matrixWorld),TL.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ic.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&nc.multiplyScalar(-ic.z);const i=this.material.rotation;let r,s;0!==i&&(s=Math.cos(i),r=Math.sin(i));const a=this.center;y7(g7.set(-.5,-.5,0),ic,a,nc,r,s),y7(u8.set(.5,-.5,0),ic,a,nc,r,s),y7(v7.set(.5,.5,0),ic,a,nc,r,s),AL.set(0,0),Tv.set(1,0),LL.set(1,1);let o=e.ray.intersectTriangle(g7,u8,v7,!1,l8);if(null===o&&(y7(u8.set(-.5,.5,0),ic,a,nc,r,s),Tv.set(0,1),o=e.ray.intersectTriangle(g7,v7,u8,!1,l8),null===o))return;const c=e.ray.origin.distanceTo(l8);c<e.near||c>e.far||n.push({distance:c,point:l8.clone(),uv:Cn.getUV(l8,g7,u8,v7,AL,Tv,LL,new ze),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}).prototype.isSprite=!0;const PL=new W,NL=new _1,RL=new _1,sne=new W,HL=new mt;class Lv extends zn{constructor(e,n){super(e,n),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new mt,this.bindMatrixInverse=new mt}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,n){this.skeleton=e,void 0===n&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new _1,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.x=n.getX(i),e.y=n.getY(i),e.z=n.getZ(i),e.w=n.getW(i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,n){const i=this.skeleton,r=this.geometry;NL.fromBufferAttribute(r.attributes.skinIndex,e),RL.fromBufferAttribute(r.attributes.skinWeight,e),PL.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const a=RL.getComponent(s);if(0!==a){const o=NL.getComponent(s);HL.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),n.addScaledVector(sne.copy(PL).applyMatrix4(HL),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}Lv.prototype.isSkinnedMesh=!0;(class Dv extends v1{constructor(){super(),this.type="Bone"}}).prototype.isBone=!0;(class sc extends Qi{constructor(e=null,n=1,i=1,r,s,a,o,c,l=Rn,u=Rn,f,d){super(null,a,o,c,l,u,r,s,f,d),this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}).prototype.isDataTexture=!0;class ac extends z1{constructor(e,n,i,r=1){"number"==typeof i&&(r=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,n,i),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}ac.prototype.isInstancedBufferAttribute=!0;const VL=new mt,OL=new mt,x7=[],f8=new zn;(class kL extends zn{constructor(e,n,i){super(e,n),this.instanceMatrix=new ac(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,n){n.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,16*e)}raycast(e,n){const i=this.matrixWorld,r=this.count;if(f8.geometry=this.geometry,f8.material=this.material,void 0!==f8.material)for(let s=0;s<r;s++){this.getMatrixAt(s,VL),OL.multiplyMatrices(i,VL),f8.matrixWorld=OL,f8.raycast(e,x7);for(let a=0,o=x7.length;a<o;a++){const c=x7[a];c.instanceId=s,c.object=this,n.push(c)}x7.length=0}}setColorAt(e,n){null===this.instanceColor&&(this.instanceColor=new ac(new Float32Array(3*this.instanceMatrix.count),3)),n.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class oi extends En{constructor(e){super(),this.type="LineBasicMaterial",this.color=new it(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}oi.prototype.isLineBasicMaterial=!0;const FL=new W,BL=new W,UL=new mt,Nv=new v4,M7=new g4;class b4 extends v1{constructor(e=new St,n=new oi){super(),this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)FL.fromBufferAttribute(n,r-1),BL.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=FL.distanceTo(BL);e.setAttribute("lineDistance",new ut(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),M7.copy(i.boundingSphere),M7.applyMatrix4(r),M7.radius+=s,!1===e.ray.intersectsSphere(M7))return;UL.copy(r).invert(),Nv.copy(e.ray).applyMatrix4(UL);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,l=new W,u=new W,f=new W,d=new W,m=this.isLineSegments?2:1;if(i.isBufferGeometry){const v=i.index,M=i.attributes.position;if(null!==v)for(let S=Math.max(0,a.start),b=Math.min(v.count,a.start+a.count)-1;S<b;S+=m){const E=v.getX(S),P=v.getX(S+1);if(l.fromBufferAttribute(M,E),u.fromBufferAttribute(M,P),Nv.distanceSqToSegment(l,u,d,f)>c)continue;d.applyMatrix4(this.matrixWorld);const j=e.ray.origin.distanceTo(d);j<e.near||j>e.far||n.push({distance:j,point:f.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}else for(let S=Math.max(0,a.start),b=Math.min(M.count,a.start+a.count)-1;S<b;S+=m){if(l.fromBufferAttribute(M,S),u.fromBufferAttribute(M,S+1),Nv.distanceSqToSegment(l,u,d,f)>c)continue;d.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(d);P<e.near||P>e.far||n.push({distance:P,point:f.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else i.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const n=e.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}else{const n=e.morphTargets;void 0!==n&&n.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}b4.prototype.isLine=!0;const GL=new W,WL=new W;class $a extends b4{constructor(e,n){super(e,n),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)GL.fromBufferAttribute(n,r),WL.fromBufferAttribute(n,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+GL.distanceTo(WL);e.setAttribute("lineDistance",new ut(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}$a.prototype.isLineSegments=!0;(class jL extends b4{constructor(e,n){super(e,n),this.type="LineLoop"}}).prototype.isLineLoop=!0;class oc extends En{constructor(e){super(),this.type="PointsMaterial",this.color=new it(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}oc.prototype.isPointsMaterial=!0;const qL=new mt,Rv=new v4,b7=new g4,w7=new W;function ZL(t,e,n,i,r,s,a){const o=Rv.distanceSqToPoint(t);if(o<n){const c=new W;Rv.closestPointToPoint(t,c),c.applyMatrix4(i);const l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(o),point:c,index:e,face:null,object:a})}}(class S7 extends v1{constructor(e=new St,n=new oc){super(),this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),b7.copy(i.boundingSphere),b7.applyMatrix4(r),b7.radius+=s,!1===e.ray.intersectsSphere(b7))return;qL.copy(r).invert(),Rv.copy(e.ray).applyMatrix4(qL);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o;if(i.isBufferGeometry){const l=i.index,f=i.attributes.position;if(null!==l)for(let v=Math.max(0,a.start),_=Math.min(l.count,a.start+a.count);v<_;v++){const M=l.getX(v);w7.fromBufferAttribute(f,M),ZL(w7,M,c,r,e,n,this)}else for(let v=Math.max(0,a.start),_=Math.min(f.count,a.start+a.count);v<_;v++)w7.fromBufferAttribute(f,v),ZL(w7,v,c,r,e,n,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const n=e.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}else{const n=e.morphTargets;void 0!==n&&n.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class one extends Qi{constructor(e,n,i,r,s,a,o,c,l){super(e,n,i,r,s,a,o,c,l),this.minFilter=void 0!==a?a:an,this.magFilter=void 0!==s?s:an,this.generateMipmaps=!1;const u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function f(){u.needsUpdate=!0,e.requestVideoFrameCallback(f)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e==0&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class cne extends Qi{constructor(e,n,i){super({width:e,height:n}),this.format=i,this.magFilter=Rn,this.minFilter=Rn,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class $L extends Qi{constructor(e,n,i,r,s,a,o,c,l,u,f,d){super(null,a,o,c,l,u,r,s,f,d),this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class lne extends Qi{constructor(e,n,i,r,s,a,o,c,l){super(e,n,i,r,s,a,o,c,l),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0;class cc extends St{constructor(e=1,n=1,i=1,r=8,s=1,a=!1,o=0,c=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:c};const l=this;r=Math.floor(r),s=Math.floor(s);const u=[],f=[],d=[],m=[];let v=0;const _=[],M=i/2;let y=0;function S(b){const E=v,P=new ze,V=new W;let j=0;const Y=!0===b?e:n,G=!0===b?1:-1;for(let N=1;N<=r;N++)f.push(0,M*G,0),d.push(0,G,0),m.push(.5,.5),v++;const C=v;for(let N=0;N<=r;N++){const U=N/r*c+o,$=Math.cos(U),O=Math.sin(U);V.x=Y*O,V.y=M*G,V.z=Y*$,f.push(V.x,V.y,V.z),d.push(0,G,0),P.x=.5*$+.5,P.y=.5*O*G+.5,m.push(P.x,P.y),v++}for(let N=0;N<r;N++){const F=E+N,U=C+N;!0===b?u.push(U,U+1,F):u.push(U+1,U,F),j+=3}l.addGroup(y,j,!0===b?1:2),y+=j}(function g(){const b=new W,E=new W;let P=0;const V=(n-e)/i;for(let j=0;j<=s;j++){const Y=[],G=j/s,C=G*(n-e)+e;for(let N=0;N<=r;N++){const F=N/r,U=F*c+o,$=Math.sin(U),O=Math.cos(U);E.x=C*$,E.y=-G*i+M,E.z=C*O,f.push(E.x,E.y,E.z),b.set($,V,O).normalize(),d.push(b.x,b.y,b.z),m.push(F,1-G),Y.push(v++)}_.push(Y)}for(let j=0;j<r;j++)for(let Y=0;Y<s;Y++){const C=_[Y+1][j],N=_[Y+1][j+1],F=_[Y][j+1];u.push(_[Y][j],C,F),u.push(C,N,F),P+=6}l.addGroup(y,P,0),y+=P})(),!1===a&&(e>0&&S(!0),n>0&&S(!1)),this.setIndex(u),this.setAttribute("position",new ut(f,3)),this.setAttribute("normal",new ut(d,3)),this.setAttribute("uv",new ut(m,2))}static fromJSON(e){return new cc(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class d8 extends cc{constructor(e=1,n=1,i=8,r=1,s=!1,a=0,o=2*Math.PI){super(0,e,n,i,r,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new d8(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}new W,new W,new W,new Cn;class J2{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let r=0;const s=i.length;let a;a=n||e*i[s-1];let l,o=0,c=s-1;for(;o<=c;)if(r=Math.floor(o+(c-o)/2),l=i[r]-a,l<0)o=r+1;else{if(!(l>0)){c=r;break}c=r-1}if(r=c,i[r]===a)return r/(s-1);const u=i[r];return(r+(a-u)/(i[r+1]-u))/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),o=this.getPoint(s),c=n||(a.isVector2?new ze:new W);return c.copy(o).sub(a).normalize(),c}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new W,r=[],s=[],a=[],o=new W,c=new mt;for(let m=0;m<=e;m++)r[m]=this.getTangentAt(m/e,new W);s[0]=new W,a[0]=new W;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),f=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),f<=l&&(l=f,i.set(0,1,0)),d<=l&&i.set(0,0,1),o.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],o),a[0].crossVectors(r[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),a[m]=a[m-1].clone(),o.crossVectors(r[m-1],r[m]),o.length()>Number.EPSILON){o.normalize();const v=Math.acos(ai(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(c.makeRotationAxis(o,v))}a[m].crossVectors(r[m],s[m])}if(!0===n){let m=Math.acos(ai(s[0].dot(s[e]),-1,1));m/=e,r[0].dot(o.crossVectors(s[0],s[e]))>0&&(m=-m);for(let v=1;v<=e;v++)s[v].applyMatrix4(c.makeRotationAxis(r[v],m*v)),a[v].crossVectors(r[v],s[v])}return{tangents:r,normals:s,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class L7 extends J2{constructor(e=0,n=0,i=1,r=1,s=0,a=2*Math.PI,o=!1,c=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=c}getPoint(e,n){const i=n||new ze,r=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(s=a?0:r),!0===this.aClockwise&&!a&&(s===r?s=-r:s-=r);const o=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const u=Math.cos(this.aRotation),f=Math.sin(this.aRotation),d=c-this.aX,m=l-this.aY;c=d*u-m*f+this.aX,l=d*f+m*u+this.aY}return i.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}L7.prototype.isEllipseCurve=!0;class YL extends L7{constructor(e,n,i,r,s,a){super(e,n,i,i,r,s,a),this.type="ArcCurve"}}function Iv(){let t=0,e=0,n=0,i=0;function r(s,a,o,c){t=s,e=o,n=-3*s+3*a-2*o-c,i=2*s-2*a+o+c}return{initCatmullRom:function(s,a,o,c,l){r(a,o,l*(o-s),l*(c-a))},initNonuniformCatmullRom:function(s,a,o,c,l,u,f){let d=(a-s)/l-(o-s)/(l+u)+(o-a)/u,m=(o-a)/u-(c-a)/(u+f)+(c-o)/f;d*=u,m*=u,r(a,o,d,m)},calc:function(s){const a=s*s;return t+e*s+n*a+i*(a*s)}}}YL.prototype.isArcCurve=!0;const D7=new W,Vv=new Iv,Ov=new Iv,kv=new Iv;class JL extends J2{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new W){const i=n,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let l,u,o=Math.floor(a),c=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:0===c&&o===s-1&&(o=s-2,c=1),this.closed||o>0?l=r[(o-1)%s]:(D7.subVectors(r[0],r[1]).add(r[0]),l=D7);const f=r[o%s],d=r[(o+1)%s];if(this.closed||o+2<s?u=r[(o+2)%s]:(D7.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=D7),"centripetal"===this.curveType||"chordal"===this.curveType){const m="chordal"===this.curveType?.5:.25;let v=Math.pow(l.distanceToSquared(f),m),_=Math.pow(f.distanceToSquared(d),m),M=Math.pow(d.distanceToSquared(u),m);_<1e-4&&(_=1),v<1e-4&&(v=_),M<1e-4&&(M=_),Vv.initNonuniformCatmullRom(l.x,f.x,d.x,u.x,v,_,M),Ov.initNonuniformCatmullRom(l.y,f.y,d.y,u.y,v,_,M),kv.initNonuniformCatmullRom(l.z,f.z,d.z,u.z,v,_,M)}else"catmullrom"===this.curveType&&(Vv.initCatmullRom(l.x,f.x,d.x,u.x,this.tension),Ov.initCatmullRom(l.y,f.y,d.y,u.y,this.tension),kv.initCatmullRom(l.z,f.z,d.z,u.z,this.tension));return i.set(Vv.calc(c),Ov.calc(c),kv.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++)this.points.push(e.points[n].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++)e.points.push(this.points[n].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push((new W).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function KL(t,e,n,i,r){const s=.5*(i-e),a=.5*(r-n),o=t*t;return(2*n-2*i+s+a)*(t*o)+(-3*n+3*i-2*s-a)*o+s*t+n}function p8(t,e,n,i){return function hne(t,e){const n=1-t;return n*n*e}(t,e)+function une(t,e){return 2*(1-t)*t*e}(t,n)+function fne(t,e){return t*t*e}(t,i)}function m8(t,e,n,i,r){return function dne(t,e){const n=1-t;return n*n*n*e}(t,e)+function pne(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function mne(t,e){return 3*(1-t)*t*t*e}(t,i)+function gne(t,e){return t*t*t*e}(t,r)}JL.prototype.isCatmullRomCurve3=!0;class Fv extends J2{constructor(e=new ze,n=new ze,i=new ze,r=new ze){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new ze){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(m8(e,r.x,s.x,a.x,o.x),m8(e,r.y,s.y,a.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Fv.prototype.isCubicBezierCurve=!0;class QL extends J2{constructor(e=new W,n=new W,i=new W,r=new W){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new W){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(m8(e,r.x,s.x,a.x,o.x),m8(e,r.y,s.y,a.y,o.y),m8(e,r.z,s.z,a.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}QL.prototype.isCubicBezierCurve3=!0;class P7 extends J2{constructor(e=new ze,n=new ze){super(),this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new ze){const i=n;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n){const i=n||new ze;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}P7.prototype.isLineCurve=!0;class Bv extends J2{constructor(e=new ze,n=new ze,i=new ze){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new ze){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(p8(e,r.x,s.x,a.x),p8(e,r.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Bv.prototype.isQuadraticBezierCurve=!0;class Uv extends J2{constructor(e=new W,n=new W,i=new W){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new W){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(p8(e,r.x,s.x,a.x),p8(e,r.y,s.y,a.y),p8(e,r.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Uv.prototype.isQuadraticBezierCurve3=!0;class Gv extends J2{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,n=new ze){const i=n,r=this.points,s=(r.length-1)*e,a=Math.floor(s),o=s-a,c=r[0===a?a:a-1],l=r[a],u=r[a>r.length-2?r.length-1:a+1],f=r[a>r.length-3?r.length-1:a+2];return i.set(KL(o,c.x,l.x,u.x,f.x),KL(o,c.y,l.y,u.y,f.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++)this.points.push(e.points[n].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++)e.points.push(this.points[n].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push((new ze).fromArray(r))}return this}}Gv.prototype.isSplineCurve=!0;var Wv=Object.freeze({__proto__:null,ArcCurve:YL,CatmullRomCurve3:JL,CubicBezierCurve:Fv,CubicBezierCurve3:QL,EllipseCurve:L7,LineCurve:P7,LineCurve3:class vne extends J2{constructor(e=new W,n=new W){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=n}getPoint(e,n=new W){const i=n;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},QuadraticBezierCurve:Bv,QuadraticBezierCurve3:Uv,SplineCurve:Gv});class yne extends J2{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);e.equals(n)||this.curves.push(new P7(n,e))}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const a=r[s]-i,o=this.curves[s],c=o.getLength();return o.getPointAt(0===c?0:1-a/c,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],c=a.getPoints(a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e);for(let l=0;l<c.length;l++){const u=c[l];i&&i.equals(u)||(n.push(u),i=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++)this.curves.push(e.curves[n].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++)e.curves.push(this.curves[n].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push((new Wv[r.type]).fromJSON(r))}return this}}class N7 extends yne{constructor(e){super(),this.type="Path",this.currentPoint=new ze,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new P7(this.currentPoint.clone(),new ze(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new Bv(this.currentPoint.clone(),new ze(e,n),new ze(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,a){const o=new Fv(this.currentPoint.clone(),new ze(e,n),new ze(i,r),new ze(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new Gv(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,a){return this.absarc(e+this.currentPoint.x,n+this.currentPoint.y,i,r,s,a),this}absarc(e,n,i,r,s,a){return this.absellipse(e,n,i,i,r,s,a),this}ellipse(e,n,i,r,s,a,o,c){return this.absellipse(e+this.currentPoint.x,n+this.currentPoint.y,i,r,s,a,o,c),this}absellipse(e,n,i,r,s,a,o,c){const l=new L7(e,n,i,r,s,a,o,c);if(this.curves.length>0){const f=l.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Xs extends N7{constructor(e){super(e),this.uuid=C2(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++)this.holes.push(e.holes[n].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++)e.holes.push(this.holes[n].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push((new N7).fromJSON(r))}return this}}function eD(t,e,n,i,r){let s,a;if(r===function Hne(t,e,n,i){let r=0;for(let s=e,a=n-i;s<n;s+=i)r+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return r}(t,e,n,i)>0)for(s=e;s<n;s+=i)a=iD(s,t[s],t[s+1],a);else for(s=n-i;s>=e;s-=i)a=iD(s,t[s],t[s+1],a);return a&&R7(a,a.next)&&(y8(a),a=a.next),a}function Ya(t,e){if(!t)return t;e||(e=t);let i,n=t;do{if(i=!1,n.steiner||!R7(n,n.next)&&0!==K1(n.prev,n,n.next))n=n.next;else{if(y8(n),n=e=n.prev,n===n.next)break;i=!0}}while(i||n!==e);return e}function g8(t,e,n,i,r,s,a){if(!t)return;!a&&s&&function Ane(t,e,n,i){let r=t;do{null===r.z&&(r.z=jv(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function Lne(t){let e,n,i,r,s,a,o,c,l=1;do{for(n=t,t=null,s=null,a=0;n;){for(a++,i=n,o=0,e=0;e<l&&(o++,i=i.nextZ,i);e++);for(c=l;o>0||c>0&&i;)0!==o&&(0===c||!i||n.z<=i.z)?(r=n,n=n.nextZ,o--):(r=i,i=i.nextZ,c--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,l*=2}while(a>1)}(r)}(t,i,r,s);let c,l,o=t;for(;t.prev!==t.next;)if(c=t.prev,l=t.next,s?Mne(t,i,r,s):xne(t))e.push(c.i/n),e.push(t.i/n),e.push(l.i/n),y8(t),t=l.next,o=l.next;else if((t=l)===o){a?1===a?g8(t=bne(Ya(t),e,n),e,n,i,r,s,2):2===a&&wne(t,e,n,i,r,s):g8(Ya(t),e,n,i,r,s,1);break}}function xne(t){const e=t.prev,n=t,i=t.next;if(K1(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(lc(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&K1(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Mne(t,e,n,i){const r=t.prev,s=t,a=t.next;if(K1(r,s,a)>=0)return!1;const l=r.x>s.x?r.x>a.x?r.x:a.x:s.x>a.x?s.x:a.x,u=r.y>s.y?r.y>a.y?r.y:a.y:s.y>a.y?s.y:a.y,f=jv(r.x<s.x?r.x<a.x?r.x:a.x:s.x<a.x?s.x:a.x,r.y<s.y?r.y<a.y?r.y:a.y:s.y<a.y?s.y:a.y,e,n,i),d=jv(l,u,e,n,i);let m=t.prevZ,v=t.nextZ;for(;m&&m.z>=f&&v&&v.z<=d;){if(m!==t.prev&&m!==t.next&&lc(r.x,r.y,s.x,s.y,a.x,a.y,m.x,m.y)&&K1(m.prev,m,m.next)>=0||(m=m.prevZ,v!==t.prev&&v!==t.next&&lc(r.x,r.y,s.x,s.y,a.x,a.y,v.x,v.y)&&K1(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;m&&m.z>=f;){if(m!==t.prev&&m!==t.next&&lc(r.x,r.y,s.x,s.y,a.x,a.y,m.x,m.y)&&K1(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;v&&v.z<=d;){if(v!==t.prev&&v!==t.next&&lc(r.x,r.y,s.x,s.y,a.x,a.y,v.x,v.y)&&K1(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function bne(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!R7(r,s)&&tD(r,i,i.next,s)&&v8(r,s)&&v8(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),y8(i),y8(i.next),i=t=s),i=i.next}while(i!==t);return Ya(i)}function wne(t,e,n,i,r,s){let a=t;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&Pne(a,o)){let c=nD(a,o);return a=Ya(a,a.next),c=Ya(c,c.next),g8(a,e,n,i,r,s),void g8(c,e,n,i,r,s)}o=o.next}a=a.next}while(a!==t)}function Cne(t,e){return t.x-e.x}function Ene(t,e){if(e=function zne(t,e){let n=e;const i=t.x,r=t.y;let a,s=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const d=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=i&&d>s){if(s=d,d===i){if(r===n.y)return n;if(r===n.next.y)return n.next}a=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!a)return null;if(i===s)return a;const o=a,c=a.x,l=a.y;let f,u=1/0;n=a;do{i>=n.x&&n.x>=c&&i!==n.x&&lc(r<l?i:s,r,c,l,r<l?s:i,r,n.x,n.y)&&(f=Math.abs(r-n.y)/(i-n.x),v8(n,t)&&(f<u||f===u&&(n.x>a.x||n.x===a.x&&Tne(a,n)))&&(a=n,u=f)),n=n.next}while(n!==o);return a}(t,e),e){const n=nD(e,t);Ya(e,e.next),Ya(n,n.next)}}function Tne(t,e){return K1(t.prev,t,e.prev)<0&&K1(e.next,t,t.next)<0}function jv(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Dne(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function lc(t,e,n,i,r,s,a,o){return(r-a)*(e-o)-(t-a)*(s-o)>=0&&(t-a)*(i-o)-(n-a)*(e-o)>=0&&(n-a)*(s-o)-(r-a)*(i-o)>=0}function Pne(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function Nne(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&tD(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(v8(t,e)&&v8(e,t)&&function Rne(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(K1(t.prev,t,e.prev)||K1(t,e.prev,e))||R7(t,e)&&K1(t.prev,t,t.next)>0&&K1(e.prev,e,e.next)>0)}function K1(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function R7(t,e){return t.x===e.x&&t.y===e.y}function tD(t,e,n,i){const r=I7(K1(t,e,n)),s=I7(K1(t,e,i)),a=I7(K1(n,i,t)),o=I7(K1(n,i,e));return!!(r!==s&&a!==o||0===r&&H7(t,n,e)||0===s&&H7(t,i,e)||0===a&&H7(n,t,i)||0===o&&H7(n,e,i))}function H7(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function I7(t){return t>0?1:t<0?-1:0}function v8(t,e){return K1(t.prev,t,t.next)<0?K1(t,e,t.next)>=0&&K1(t,t.prev,e)>=0:K1(t,e,t.prev)<0||K1(t,t.next,e)<0}function nD(t,e){const n=new qv(t.i,t.x,t.y),i=new qv(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function iD(t,e,n,i){const r=new qv(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function y8(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function qv(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ys{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return.5*i}static isClockWise(e){return Ys.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];rD(e),sD(i,e);let a=e.length;n.forEach(rD);for(let c=0;c<n.length;c++)r.push(a),a+=n[c].length,sD(i,n[c]);const o=function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=eD(t,0,r,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,c,l,u,f,d,m;if(i&&(s=function Sne(t,e,n,i){const r=[];let s,a,o,c,l;for(s=0,a=e.length;s<a;s++)o=e[s]*i,c=s<a-1?e[s+1]*i:t.length,l=eD(t,o,c,i,!1),l===l.next&&(l.steiner=!0),r.push(Dne(l));for(r.sort(Cne),s=0;s<r.length;s++)Ene(r[s],n),n=Ya(n,n.next);return n}(t,e,s,n)),t.length>80*n){o=l=t[0],c=u=t[1];for(let v=n;v<r;v+=n)f=t[v],d=t[v+1],f<o&&(o=f),d<c&&(c=d),f>l&&(l=f),d>u&&(u=d);m=Math.max(l-o,u-c),m=0!==m?1/m:0}return g8(s,a,n,o,c,m),a}(i,r);for(let c=0;c<o.length;c+=3)s.push(o.slice(c,c+3));return s}}function rD(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function sD(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class Ja extends St{constructor(e=new Xs([new ze(.5,.5),new ze(-.5,.5),new ze(-.5,-.5),new ze(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let o=0,c=e.length;o<c;o++)a(e[o]);function a(o){const c=[],l=void 0!==n.curveSegments?n.curveSegments:12,u=void 0!==n.steps?n.steps:1;let f=void 0!==n.depth?n.depth:1,d=void 0===n.bevelEnabled||n.bevelEnabled,m=void 0!==n.bevelThickness?n.bevelThickness:.2,v=void 0!==n.bevelSize?n.bevelSize:m-.1,_=void 0!==n.bevelOffset?n.bevelOffset:0,M=void 0!==n.bevelSegments?n.bevelSegments:3;const y=n.extrudePath,g=void 0!==n.UVGenerator?n.UVGenerator:Ine;void 0!==n.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),f=n.amount);let S,E,P,V,j,b=!1;y&&(S=y.getSpacedPoints(u),b=!0,d=!1,E=y.computeFrenetFrames(u,!1),P=new W,V=new W,j=new W),d||(M=0,m=0,v=0,_=0);const Y=o.extractPoints(l);let G=Y.shape;const C=Y.holes;if(!Ys.isClockWise(G)){G=G.reverse();for(let X=0,fe=C.length;X<fe;X++){const pe=C[X];Ys.isClockWise(pe)&&(C[X]=pe.reverse())}}const F=Ys.triangulateShape(G,C),U=G;for(let X=0,fe=C.length;X<fe;X++)G=G.concat(C[X]);function $(X,fe,pe){return fe||console.error("THREE.ExtrudeGeometry: vec does not exist"),fe.clone().multiplyScalar(pe).add(X)}const O=G.length,I=F.length;function k(X,fe,pe){let Te,Se,We;const Fe=X.x-fe.x,rt=X.y-fe.y,Gt=pe.x-X.x,D=pe.y-X.y,z=Fe*Fe+rt*rt;if(Math.abs(Fe*D-rt*Gt)>Number.EPSILON){const se=Math.sqrt(z),ge=Math.sqrt(Gt*Gt+D*D),Me=fe.x-rt/se,Ne=fe.y+Fe/se,Ze=((pe.x-D/ge-Me)*D-(pe.y+Gt/ge-Ne)*Gt)/(Fe*D-rt*Gt);Te=Me+Fe*Ze-X.x,Se=Ne+rt*Ze-X.y;const De=Te*Te+Se*Se;if(De<=2)return new ze(Te,Se);We=Math.sqrt(De/2)}else{let se=!1;Fe>Number.EPSILON?Gt>Number.EPSILON&&(se=!0):Fe<-Number.EPSILON?Gt<-Number.EPSILON&&(se=!0):Math.sign(rt)===Math.sign(D)&&(se=!0),se?(Te=-rt,Se=Fe,We=Math.sqrt(z)):(Te=Fe,Se=rt,We=Math.sqrt(z/2))}return new ze(Te/We,Se/We)}const K=[];for(let X=0,fe=U.length,pe=fe-1,Te=X+1;X<fe;X++,pe++,Te++)pe===fe&&(pe=0),Te===fe&&(Te=0),K[X]=k(U[X],U[pe],U[Te]);const re=[];let ae,ue=K.concat();for(let X=0,fe=C.length;X<fe;X++){const pe=C[X];ae=[];for(let Te=0,Se=pe.length,We=Se-1,Fe=Te+1;Te<Se;Te++,We++,Fe++)We===Se&&(We=0),Fe===Se&&(Fe=0),ae[Te]=k(pe[Te],pe[We],pe[Fe]);re.push(ae),ue=ue.concat(ae)}for(let X=0;X<M;X++){const fe=X/M,pe=m*Math.cos(fe*Math.PI/2),Te=v*Math.sin(fe*Math.PI/2)+_;for(let Se=0,We=U.length;Se<We;Se++){const Fe=$(U[Se],K[Se],Te);st(Fe.x,Fe.y,-pe)}for(let Se=0,We=C.length;Se<We;Se++){const Fe=C[Se];ae=re[Se];for(let rt=0,Gt=Fe.length;rt<Gt;rt++){const D=$(Fe[rt],ae[rt],Te);st(D.x,D.y,-pe)}}}const Le=v+_;for(let X=0;X<O;X++){const fe=d?$(G[X],ue[X],Le):G[X];b?(V.copy(E.normals[0]).multiplyScalar(fe.x),P.copy(E.binormals[0]).multiplyScalar(fe.y),j.copy(S[0]).add(V).add(P),st(j.x,j.y,j.z)):st(fe.x,fe.y,0)}for(let X=1;X<=u;X++)for(let fe=0;fe<O;fe++){const pe=d?$(G[fe],ue[fe],Le):G[fe];b?(V.copy(E.normals[X]).multiplyScalar(pe.x),P.copy(E.binormals[X]).multiplyScalar(pe.y),j.copy(S[X]).add(V).add(P),st(j.x,j.y,j.z)):st(pe.x,pe.y,f/u*X)}for(let X=M-1;X>=0;X--){const fe=X/M,pe=m*Math.cos(fe*Math.PI/2),Te=v*Math.sin(fe*Math.PI/2)+_;for(let Se=0,We=U.length;Se<We;Se++){const Fe=$(U[Se],K[Se],Te);st(Fe.x,Fe.y,f+pe)}for(let Se=0,We=C.length;Se<We;Se++){const Fe=C[Se];ae=re[Se];for(let rt=0,Gt=Fe.length;rt<Gt;rt++){const D=$(Fe[rt],ae[rt],Te);b?st(D.x,D.y+S[u-1].y,S[u-1].x+pe):st(D.x,D.y,f+pe)}}}function ie(X,fe){let pe=X.length;for(;--pe>=0;){const Te=pe;let Se=pe-1;Se<0&&(Se=X.length-1);for(let We=0,Fe=u+2*M;We<Fe;We++){const rt=O*We,Gt=O*(We+1);_e(fe+Te+rt,fe+Se+rt,fe+Se+Gt,fe+Te+Gt)}}}function st(X,fe,pe){c.push(X),c.push(fe),c.push(pe)}function ke(X,fe,pe){oe(X),oe(fe),oe(pe);const Te=r.length/3,Se=g.generateTopUV(i,r,Te-3,Te-2,Te-1);xe(Se[0]),xe(Se[1]),xe(Se[2])}function _e(X,fe,pe,Te){oe(X),oe(fe),oe(Te),oe(fe),oe(pe),oe(Te);const Se=r.length/3,We=g.generateSideWallUV(i,r,Se-6,Se-3,Se-2,Se-1);xe(We[0]),xe(We[1]),xe(We[3]),xe(We[1]),xe(We[2]),xe(We[3])}function oe(X){r.push(c[3*X+0]),r.push(c[3*X+1]),r.push(c[3*X+2])}function xe(X){s.push(X.x),s.push(X.y)}(function Oe(){const X=r.length/3;if(d){let fe=0,pe=O*fe;for(let Te=0;Te<I;Te++){const Se=F[Te];ke(Se[2]+pe,Se[1]+pe,Se[0]+pe)}fe=u+2*M,pe=O*fe;for(let Te=0;Te<I;Te++){const Se=F[Te];ke(Se[0]+pe,Se[1]+pe,Se[2]+pe)}}else{for(let fe=0;fe<I;fe++){const pe=F[fe];ke(pe[2],pe[1],pe[0])}for(let fe=0;fe<I;fe++){const pe=F[fe];ke(pe[0]+O*u,pe[1]+O*u,pe[2]+O*u)}}i.addGroup(X,r.length/3-X,0)})(),function Pe(){const X=r.length/3;let fe=0;ie(U,fe),fe+=U.length;for(let pe=0,Te=C.length;pe<Te;pe++){const Se=C[pe];ie(Se,fe),fe+=Se.length}i.addGroup(X,r.length/3-X,1)}()}this.setAttribute("position",new ut(r,3)),this.setAttribute("uv",new ut(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function Vne(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++)n.shapes.push(t[i].uuid);else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,n){const i=[];for(let s=0,a=e.shapes.length;s<a;s++)i.push(n[e.shapes[s]]);const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new Wv[r.type]).fromJSON(r)),new Ja(i,e.options)}}const Ine={generateTopUV:function(t,e,n,i,r){const o=e[3*i],c=e[3*i+1],l=e[3*r],u=e[3*r+1];return[new ze(e[3*n],e[3*n+1]),new ze(o,c),new ze(l,u)]},generateSideWallUV:function(t,e,n,i,r,s){const a=e[3*n],o=e[3*n+1],c=e[3*n+2],l=e[3*i],u=e[3*i+1],f=e[3*i+2],d=e[3*r],m=e[3*r+1],v=e[3*r+2],_=e[3*s],M=e[3*s+1],y=e[3*s+2];return Math.abs(o-u)<Math.abs(a-l)?[new ze(a,1-c),new ze(l,1-f),new ze(d,1-v),new ze(_,1-y)]:[new ze(o,1-c),new ze(u,1-f),new ze(m,1-v),new ze(M,1-y)]}};class x8 extends St{constructor(e=new Xs([new ze(0,.5),new ze(-.5,-.5),new ze(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],a=[];let o=0,c=0;if(!1===Array.isArray(e))l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(o,c,u),o+=c,c=0;function l(u){const f=r.length/3,d=u.extractPoints(n);let m=d.shape;const v=d.holes;!1===Ys.isClockWise(m)&&(m=m.reverse());for(let M=0,y=v.length;M<y;M++){const g=v[M];!0===Ys.isClockWise(g)&&(v[M]=g.reverse())}const _=Ys.triangulateShape(m,v);for(let M=0,y=v.length;M<y;M++)m=m.concat(v[M]);for(let M=0,y=m.length;M<y;M++){const g=m[M];r.push(g.x,g.y,0),s.push(0,0,1),a.push(g.x,g.y)}for(let M=0,y=_.length;M<y;M++){const g=_[M];i.push(g[0]+f,g[1]+f,g[2]+f),c+=3}}this.setIndex(i),this.setAttribute("position",new ut(r,3)),this.setAttribute("normal",new ut(s,3)),this.setAttribute("uv",new ut(a,2))}toJSON(){const e=super.toJSON();return function One(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++)e.shapes.push(t[n].uuid);else e.shapes.push(t.uuid);return e}(this.parameters.shapes,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++)i.push(n[e.shapes[r]]);return new x8(i,e.curveSegments)}}class lD extends En{constructor(e){super(),this.type="ShadowMaterial",this.color=new it(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}lD.prototype.isShadowMaterial=!0;class hD extends Tr{constructor(e){super(e),this.type="RawShaderMaterial"}}hD.prototype.isRawShaderMaterial=!0;class Zv extends En{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new it(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new it(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Zv.prototype.isMeshStandardMaterial=!0;class uD extends Zv{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ze(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ai(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.sheenColor=new it(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new it(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new it(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}uD.prototype.isMeshPhysicalMaterial=!0;class fD extends En{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new it(16777215),this.specular=new it(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new it(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}fD.prototype.isMeshPhongMaterial=!0;class dD extends En{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new it(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new it(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}dD.prototype.isMeshToonMaterial=!0;class pD extends En{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}pD.prototype.isMeshNormalMaterial=!0;class mD extends En{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new it(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new it(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}mD.prototype.isMeshLambertMaterial=!0;class gD extends En{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new it(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ze(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}gD.prototype.isMeshMatcapMaterial=!0;class vD extends oi{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}vD.prototype.isLineDashedMaterial=!0;const kne={ShadowMaterial:lD,SpriteMaterial:zv,RawShaderMaterial:hD,ShaderMaterial:Tr,PointsMaterial:oc,MeshPhysicalMaterial:uD,MeshStandardMaterial:Zv,MeshPhongMaterial:fD,MeshToonMaterial:dD,MeshNormalMaterial:pD,MeshLambertMaterial:mD,MeshDepthMaterial:Sv,MeshDistanceMaterial:Cv,MeshBasicMaterial:X2,MeshMatcapMaterial:gD,LineDashedMaterial:vD,LineBasicMaterial:oi,Material:En};En.fromType=function(t){return new kne[t]};const G1={arraySlice:function(t,e,n){return G1.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(function e(r,s){return t[r]-t[s]}),i},sortedArray:function(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,a=0;a!==i;++s){const o=n[s]*e;for(let c=0;c!==e;++c)r[a++]=t[o+c]}return r},flattenJSON:function(t,e,n,i){let r=1,s=t[0];for(;void 0!==s&&void 0===s[i];)s=t[r++];if(void 0===s)return;let a=s[i];if(void 0!==a)if(Array.isArray(a))do{a=s[i],void 0!==a&&(e.push(s.time),n.push.apply(n,a)),s=t[r++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[i],void 0!==a&&(e.push(s.time),a.toArray(n,n.length)),s=t[r++]}while(void 0!==s);else do{a=s[i],void 0!==a&&(e.push(s.time),n.push(a)),s=t[r++]}while(void 0!==s)},subclip:function(t,e,n,i,r=30){const s=t.clone();s.name=e;const a=[];for(let c=0;c<s.tracks.length;++c){const l=s.tracks[c],u=l.getValueSize(),f=[],d=[];for(let m=0;m<l.times.length;++m){const v=l.times[m]*r;if(!(v<n||v>=i)){f.push(l.times[m]);for(let _=0;_<u;++_)d.push(l.values[m*u+_])}}0!==f.length&&(l.times=G1.convertArray(f,l.times.constructor),l.values=G1.convertArray(d,l.values.constructor),a.push(l))}s.tracks=a;let o=1/0;for(let c=0;c<s.tracks.length;++c)o>s.tracks[c].times[0]&&(o=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*o);return s.resetDuration(),s},makeClipAdditive:function(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let a=0;a<r;++a){const o=n.tracks[a],c=o.ValueTypeName;if("bool"===c||"string"===c)continue;const l=t.tracks.find(function(y){return y.name===o.name&&y.ValueTypeName===c});if(void 0===l)continue;let u=0;const f=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=f/3);let d=0;const m=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=m/3);const v=o.times.length-1;let _;if(s<=o.times[0])_=G1.arraySlice(o.values,u,f-u);else if(s>=o.times[v]){const y=v*f+u;_=G1.arraySlice(o.values,y,y+f-u)}else{const y=o.createInterpolant(),g=u,S=f-u;y.evaluate(s),_=G1.arraySlice(y.resultBuffer,g,S)}"quaternion"===c&&(new wi).fromArray(_).normalize().conjugate().toArray(_);const M=l.times.length;for(let y=0;y<M;++y){const g=y*m+d;if("quaternion"===c)wi.multiplyQuaternionsFlat(l.values,g,_,0,l.values,g);else{const S=m-2*d;for(let b=0;b<S;++b)l.values[g+b]-=_[b]}}}return t.blendMode=2501,t}};class Ka{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let a;n:{i:if(!(e<r)){for(let o=i+2;;){if(void 0===r){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.afterEnd_(i-1,e,s)}if(i===o)break;if(s=r,r=n[++i],e<r)break t}a=n.length;break n}if(e>=s)break e;{const o=n[1];e<o&&(i=2,s=o);for(let c=i-2;;){if(void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(i===c)break;if(r=s,s=n[--i-1],e>=s)break t}a=i,i=0}}for(;i<a;){const o=i+a>>>1;e<n[o]?a=o:i=o+1}if(r=n[i],s=n[i-1],void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return i=n.length,this._cachedIndex=i,this.afterEnd_(i-1,s,e)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)n[a]=i[s+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Ka.prototype.beforeStart_=Ka.prototype.copySampleValue_,Ka.prototype.afterEnd_=Ka.prototype.copySampleValue_;class Fne extends Ka{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:L0,endingEnd:L0}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,a=e+1,o=r[s],c=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case D0:s=e,o=2*n-i;break;case 2402:s=r.length-2,o=n+r[s]-r[s+1];break;default:s=e,o=i}if(void 0===c)switch(this.getSettings_().endingEnd){case D0:a=e,c=2*i-n;break;case 2402:a=1,c=i+r[1]-r[0];break;default:a=e-1,c=n}const l=.5*(i-n),u=this.valueSize;this._weightPrev=l/(n-o),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=a*u}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,l=c-o,u=this._offsetPrev,f=this._offsetNext,d=this._weightPrev,m=this._weightNext,v=(i-n)/(r-n),_=v*v,M=_*v,y=-d*M+2*d*_-d*v,g=(1+d)*M+(-1.5-2*d)*_+(-.5+d)*v+1,S=(-1-m)*M+(1.5+m)*_+.5*v,b=m*M-m*_;for(let E=0;E!==o;++E)s[E]=y*a[u+E]+g*a[l+E]+S*a[c+E]+b*a[f+E];return s}}class yD extends Ka{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,l=c-o,u=(i-n)/(r-n),f=1-u;for(let d=0;d!==o;++d)s[d]=a[l+d]*f+a[c+d]*u;return s}}class Bne extends Ka{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ls{constructor(e,n,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=G1.convertArray(n,this.TimeBufferType),this.values=G1.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:G1.convertArray(e.times,Array),values:G1.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Bne(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new yD(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Fne(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case 2300:n=this.InterpolantFactoryMethodDiscrete;break;case 2301:n=this.InterpolantFactoryMethodLinear;break;case 2302:n=this.InterpolantFactoryMethodSmooth}if(void 0===n){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(1!==e){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,a=r-1;for(;s!==r&&i[s]<e;)++s;for(;-1!==a&&i[a]>n;)--a;if(++a,0!==s||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=G1.arraySlice(i,s,a),this.values=G1.arraySlice(this.values,s*o,a*o)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const c=i[o];if("number"==typeof c&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,c),e=!1;break}if(null!==a&&a>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,c,a),e=!1;break}a=c}if(void 0!==r&&G1.isTypedArray(r))for(let o=0,c=r.length;o!==c;++o){const l=r[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),e=!1;break}}return e}optimize(){const e=G1.arraySlice(this.times),n=G1.arraySlice(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let a=1;for(let o=1;o<s;++o){let c=!1;const l=e[o];if(l!==e[o+1]&&(1!==o||l!==e[0]))if(r)c=!0;else{const f=o*i,d=f-i,m=f+i;for(let v=0;v!==i;++v){const _=n[f+v];if(_!==n[d+v]||_!==n[m+v]){c=!0;break}}}if(c){if(o!==a){e[a]=e[o];const f=o*i,d=a*i;for(let m=0;m!==i;++m)n[d+m]=n[f+m]}++a}}if(s>0){e[a]=e[s];for(let o=s*i,c=a*i,l=0;l!==i;++l)n[c+l]=n[o+l];++a}return a!==e.length?(this.times=G1.arraySlice(e,0,a),this.values=G1.arraySlice(n,0,a*i)):(this.times=e,this.values=n),this}clone(){const e=G1.arraySlice(this.times,0),n=G1.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}ls.prototype.TimeBufferType=Float32Array,ls.prototype.ValueBufferType=Float32Array,ls.prototype.DefaultInterpolation=2301;class hc extends ls{}hc.prototype.ValueTypeName="bool",hc.prototype.ValueBufferType=Array,hc.prototype.DefaultInterpolation=2300,hc.prototype.InterpolantFactoryMethodLinear=void 0,hc.prototype.InterpolantFactoryMethodSmooth=void 0;class _D extends ls{}_D.prototype.ValueTypeName="color";class W7 extends ls{}W7.prototype.ValueTypeName="number";class Une extends Ka{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=(i-n)/(r-n);let l=e*o;for(let u=l+o;l!==u;l+=4)wi.slerpFlat(s,0,a,l-o,a,l,c);return s}}class b8 extends ls{InterpolantFactoryMethodLinear(e){return new Une(this.times,this.values,this.getValueSize(),e)}}b8.prototype.ValueTypeName="quaternion",b8.prototype.DefaultInterpolation=2301,b8.prototype.InterpolantFactoryMethodSmooth=void 0;class uc extends ls{}uc.prototype.ValueTypeName="string",uc.prototype.ValueBufferType=Array,uc.prototype.DefaultInterpolation=2300,uc.prototype.InterpolantFactoryMethodLinear=void 0,uc.prototype.InterpolantFactoryMethodSmooth=void 0;class j7 extends ls{}j7.prototype.ValueTypeName="vector";class q7{constructor(e,n=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=C2(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let a=0,o=i.length;a!==o;++a)n.push(Wne(i[a]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=i.length;s!==a;++s)n.push(ls.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,a=[];for(let o=0;o<s;o++){let c=[],l=[];c.push((o+s-1)%s,o,(o+1)%s),l.push(0,1,0);const u=G1.getKeyframeOrder(c);c=G1.sortedArray(c,1,u),l=G1.sortedArray(l,1,u),!r&&0===c[0]&&(c.push(s),l.push(l[0])),a.push(new W7(".morphTargetInfluences["+n[o].name+"]",c,l).scale(1/i))}return new this(e,-1,a)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,c=e.length;o<c;o++){const l=e[o],u=l.name.match(s);if(u&&u.length>1){const f=u[1];let d=r[f];d||(r[f]=d=[]),d.push(l)}}const a=[];for(const o in r)a.push(this.CreateFromMorphTargetSequence(o,r[o],n,i));return a}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(f,d,m,v,_){if(0!==m.length){const M=[],y=[];G1.flattenJSON(m,M,y,v),0!==M.length&&_.push(new f(d,M,y))}},r=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let f=0;f<l.length;f++){const d=l[f].keys;if(d&&0!==d.length)if(d[0].morphTargets){const m={};let v;for(v=0;v<d.length;v++)if(d[v].morphTargets)for(let _=0;_<d[v].morphTargets.length;_++)m[d[v].morphTargets[_]]=-1;for(const _ in m){const M=[],y=[];for(let g=0;g!==d[v].morphTargets.length;++g){const S=d[v];M.push(S.time),y.push(S.morphTarget===_?1:0)}r.push(new W7(".morphTargetInfluence["+_+"]",M,y))}c=m.length*a}else{const m=".bones["+n[f].name+"]";i(j7,m+".position",d,"pos",r),i(b8,m+".quaternion",d,"rot",r),i(j7,m+".scale",d,"scl",r)}}return 0===r.length?null:new this(s,c,r,o)}resetDuration(){let n=0;for(let i=0,r=this.tracks.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Wne(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function Gne(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return W7;case"vector":case"vector2":case"vector3":case"vector4":return j7;case"color":return _D;case"quaternion":return b8;case"bool":case"boolean":return hc;case"string":return uc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const n=[],i=[];G1.flattenJSON(t.keys,n,i,"value"),t.times=n,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const fc={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};const jne=new class xD{constructor(e,n,i){const r=this;let c,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(u){o++,!1===s&&void 0!==r.onStart&&r.onStart(u,a,o),s=!0},this.itemEnd=function(u){a++,void 0!==r.onProgress&&r.onProgress(u,a,o),a===o&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,f){return l.push(u,f),this},this.removeHandler=function(u){const f=l.indexOf(u);return-1!==f&&l.splice(f,2),this},this.getHandler=function(u){for(let f=0,d=l.length;f<d;f+=2){const m=l[f],v=l[f+1];if(m.global&&(m.lastIndex=0),m.test(u))return v}return null}}};class Qa{constructor(e){this.manager=void 0!==e?e:jne,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Js={};class Ks extends Qa{constructor(e){super(e)}load(e,n,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=fc.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(void 0!==Js[e])return void Js[e].push({onLoad:n,onProgress:i,onError:r});Js[e]=[],Js[e].push({onLoad:n,onProgress:i,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,c=this.responseType;fetch(a).then(l=>{if(200===l.status||0===l.status){if(0===l.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===l.body||void 0===l.body.getReader)return l;const u=Js[e],f=l.body.getReader(),d=l.headers.get("Content-Length"),m=d?parseInt(d):0,v=0!==m;let _=0;const M=new ReadableStream({start(y){!function g(){f.read().then(({done:S,value:b})=>{if(S)y.close();else{_+=b.byteLength;const E=new ProgressEvent("progress",{lengthComputable:v,loaded:_,total:m});for(let P=0,V=u.length;P<V;P++){const j=u[P];j.onProgress&&j.onProgress(E)}y.enqueue(b),g()}})}()}});return new Response(M)}throw Error(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>(new DOMParser).parseFromString(u,o));case"json":return l.json();default:if(void 0===o)return l.text();{const f=/charset="?([^;"\s]*)"?/i.exec(o),d=f&&f[1]?f[1].toLowerCase():void 0,m=new TextDecoder(d);return l.arrayBuffer().then(v=>m.decode(v))}}}).then(l=>{fc.add(e,l);const u=Js[e];delete Js[e];for(let f=0,d=u.length;f<d;f++){const m=u[f];m.onLoad&&m.onLoad(l)}}).catch(l=>{const u=Js[e];if(void 0===u)throw this.manager.itemError(e),l;delete Js[e];for(let f=0,d=u.length;f<d;f++){const m=u[f];m.onError&&m.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Z7 extends Qa{constructor(e){super(e)}load(e,n,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=fc.get(e);if(void 0!==a)return s.manager.itemStart(e),setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a;const o=e8("img");function c(){u(),fc.add(e,this),n&&n(this),s.manager.itemEnd(e)}function l(f){u(),r&&r(f),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){o.removeEventListener("load",c,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",c,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class qne extends Qa{constructor(e){super(e)}load(e,n,i,r){const s=new s8,a=new Z7(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function c(l){a.load(e[l],function(u){s.images[l]=u,o++,6===o&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let l=0;l<e.length;++l)c(l);return s}}class MD extends Qa{constructor(e){super(e)}load(e,n,i,r){const s=new Qi,a=new Z7(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,void 0!==n&&n(s)},i,r),s}}class hs extends v1{constructor(e,n=1){super(),this.type="Light",this.color=new it(e),this.intensity=n}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,void 0!==this.groundColor&&(n.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(n.object.distance=this.distance),void 0!==this.angle&&(n.object.angle=this.angle),void 0!==this.decay&&(n.object.decay=this.decay),void 0!==this.penumbra&&(n.object.penumbra=this.penumbra),void 0!==this.shadow&&(n.object.shadow=this.shadow.toJSON()),n}}hs.prototype.isLight=!0;(class bD extends hs{constructor(e,n,i){super(e,i),this.type="HemisphereLight",this.position.copy(v1.DefaultUp),this.updateMatrix(),this.groundColor=new it(n)}copy(e){return hs.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}).prototype.isHemisphereLight=!0;const wD=new mt,SD=new W,CD=new W;class $v{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ze(512,512),this.map=null,this.mapPass=null,this.matrix=new mt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new h7,this._frameExtents=new ze(1,1),this._viewportCount=1,this._viewports=[new _1(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;SD.setFromMatrixPosition(e.matrixWorld),n.position.copy(SD),CD.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(CD),n.updateMatrixWorld(),wD.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(wD),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(n.projectionMatrix),i.multiply(n.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class ED extends $v{constructor(){super(new Zn(50,1,.5,500)),this.focus=1}updateMatrices(e){const n=this.camera,i=2*Kl*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}ED.prototype.isSpotLightShadow=!0;(class zD extends hs{constructor(e,n,i=0,r=Math.PI/3,s=0,a=1){super(e,n),this.type="SpotLight",this.position.copy(v1.DefaultUp),this.updateMatrix(),this.target=new v1,this.distance=i,this.angle=r,this.penumbra=s,this.decay=a,this.shadow=new ED}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isSpotLight=!0;const TD=new mt,w8=new W,Xv=new W;class AD extends $v{constructor(){super(new Zn(90,1,.5,500)),this._frameExtents=new ze(4,2),this._viewportCount=6,this._viewports=[new _1(2,1,1,1),new _1(0,1,1,1),new _1(3,1,1,1),new _1(1,1,1,1),new _1(3,0,1,1),new _1(1,0,1,1)],this._cubeDirections=[new W(1,0,0),new W(-1,0,0),new W(0,0,1),new W(0,0,-1),new W(0,1,0),new W(0,-1,0)],this._cubeUps=[new W(0,1,0),new W(0,1,0),new W(0,1,0),new W(0,1,0),new W(0,0,1),new W(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),w8.setFromMatrixPosition(e.matrixWorld),i.position.copy(w8),Xv.copy(i.position),Xv.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(Xv),i.updateMatrixWorld(),r.makeTranslation(-w8.x,-w8.y,-w8.z),TD.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(TD)}}AD.prototype.isPointLightShadow=!0;(class LD extends hs{constructor(e,n,i=0,r=1){super(e,n),this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new AD}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}).prototype.isPointLight=!0;class DD extends $v{constructor(){super(new o8(-5,5,5,-5,.5,500))}}DD.prototype.isDirectionalLightShadow=!0;(class PD extends hs{constructor(e,n){super(e,n),this.type="DirectionalLight",this.position.copy(v1.DefaultUp),this.updateMatrix(),this.target=new v1,this.shadow=new DD}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}).prototype.isDirectionalLight=!0;(class ND extends hs{constructor(e,n){super(e,n),this.type="AmbientLight"}}).prototype.isAmbientLight=!0;(class RD extends hs{constructor(e,n,i=10,r=10){super(e,n),this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}).prototype.isRectAreaLight=!0;class HD{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new W)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*r),n.addScaledVector(a[2],.488603*s),n.addScaledVector(a[3],.488603*i),n.addScaledVector(a[4],i*r*1.092548),n.addScaledVector(a[5],r*s*1.092548),n.addScaledVector(a[6],.315392*(3*s*s-1)),n.addScaledVector(a[7],i*s*1.092548),n.addScaledVector(a[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],1.023328*r),n.addScaledVector(a[2],1.023328*s),n.addScaledVector(a[3],1.023328*i),n.addScaledVector(a[4],.858086*i*r),n.addScaledVector(a[5],.858086*r*s),n.addScaledVector(a[6],.743125*s*s-.247708),n.addScaledVector(a[7],.858086*i*s),n.addScaledVector(a[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+3*r);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+3*r);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}HD.prototype.isSphericalHarmonics3=!0;class $7 extends hs{constructor(e=new HD,n=1){super(void 0,n),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}$7.prototype.isLightProbe=!0;let X7;(class ID extends St{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}).prototype.isInstancedBufferGeometry=!0,class Jne extends Qa{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=fc.get(e);if(void 0!==a)return s.manager.itemStart(e),setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){fc.add(e,c),n&&n(c),s.manager.itemEnd(e)}).catch(function(c){r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}.prototype.isImageBitmapLoader=!0;class Kne extends Qa{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new Ks(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{const c=o.slice(0);(void 0===X7&&(X7=new(window.AudioContext||window.webkitAudioContext)),X7).decodeAudioData(c,function(u){n(u)})}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}}(class Qne extends $7{constructor(e,n,i=1){super(void 0,i);const r=(new it).set(e),s=(new it).set(n),a=new W(r.r,r.g,r.b),o=new W(s.r,s.g,s.b),c=Math.sqrt(Math.PI),l=c*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(c),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0,class eie extends $7{constructor(e,n=1){super(void 0,n);const i=(new it).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class aie{constructor(e,n,i){let r,s,a;switch(this.binding=e,this.valueSize=i,n){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(0===a){for(let o=0;o!==r;++o)i[s+o]=i[o];a=n}else a+=n,this._mixBufferRegion(i,s,0,n/a,r);this.cumulativeWeight=a}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1&&this._mixBufferRegion(i,r,n*this._origIndex,1-s,n),a>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let c=n,l=n+n;c!==l;++c)if(i[c]!==i[c+n]){o.setValue(i,r);break}}saveOriginalState(){const n=this.buffer,i=this.valueSize,r=i*this._origIndex;this.binding.getValue(n,r);for(let s=i,a=r;s!==a;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[n+a]=e[i+a]}_slerp(e,n,i,r){wi.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const a=this._workIndex*s;wi.multiplyQuaternionsFlat(e,a,e,n,e,i),wi.slerpFlat(e,n,e,n,e,a,r)}_lerp(e,n,i,r,s){const a=1-r;for(let o=0;o!==s;++o){const c=n+o;e[c]=e[c]*a+e[i+o]*r}}_lerpAdditive(e,n,i,r,s){for(let a=0;a!==s;++a){const o=n+a;e[o]=e[o]+e[i+a]*r}}}const Jv="\\[\\]\\.:\\/",oie=new RegExp("["+Jv+"]","g"),Kv="[^"+Jv+"]",cie="[^"+Jv.replace("\\.","")+"]",lie=/((?:WC+[\/:])*)/.source.replace("WC",Kv),hie=/(WCOD+)?/.source.replace("WCOD",cie),uie=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Kv),fie=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Kv),die=new RegExp("^"+lie+hie+uie+fie+"$"),pie=["material","materials","bones"];class mie{constructor(e,n,i){const r=i||V1.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}let V1=(()=>{class t{constructor(n,i,r){this.path=i,this.parsedPath=r||t.parseTrackName(i),this.node=t.findNode(n,this.parsedPath.nodeName)||n,this.rootNode=n,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(n,i,r){return n&&n.isAnimationObjectGroup?new t.Composite(n,i,r):new t(n,i,r)}static sanitizeNodeName(n){return n.replace(/\s/g,"_").replace(oie,"")}static parseTrackName(n){const i=die.exec(n);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+n);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const a=r.nodeName.substring(s+1);-1!==pie.indexOf(a)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=a)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+n);return r}static findNode(n,i){if(void 0===i||""===i||"."===i||-1===i||i===n.name||i===n.uuid)return n;if(n.skeleton){const r=n.skeleton.getBoneByName(i);if(void 0!==r)return r}if(n.children){const r=function(a){for(let o=0;o<a.length;o++){const c=a[o];if(c.name===i||c.uuid===i)return c;const l=r(c.children);if(l)return l}return null},s=r(n.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(n,i){n[i]=this.targetObject[this.propertyName]}_getValue_array(n,i){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)n[i++]=r[s]}_getValue_arrayElement(n,i){n[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(n,i){this.resolvedProperty.toArray(n,i)}_setValue_direct(n,i){this.targetObject[this.propertyName]=n[i]}_setValue_direct_setNeedsUpdate(n,i){this.targetObject[this.propertyName]=n[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(n,i){this.targetObject[this.propertyName]=n[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(n,i){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=n[i++]}_setValue_array_setNeedsUpdate(n,i){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=n[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(n,i){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=n[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(n,i){this.resolvedProperty[this.propertyIndex]=n[i]}_setValue_arrayElement_setNeedsUpdate(n,i){this.resolvedProperty[this.propertyIndex]=n[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(n,i){this.resolvedProperty[this.propertyIndex]=n[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(n,i){this.resolvedProperty.fromArray(n,i)}_setValue_fromArray_setNeedsUpdate(n,i){this.resolvedProperty.fromArray(n,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(n,i){this.resolvedProperty.fromArray(n,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(n,i){this.bind(),this.getValue(n,i)}_setValue_unbound(n,i){this.bind(),this.setValue(n,i)}bind(){let n=this.node;const i=this.parsedPath,r=i.objectName,s=i.propertyName;let a=i.propertyIndex;if(n||(n=t.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=n),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!n)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=i.objectIndex;switch(r){case"materials":if(!n.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!n.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);n=n.material.materials;break;case"bones":if(!n.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);n=n.skeleton.bones;for(let f=0;f<n.length;f++)if(n[f].name===u){u=f;break}break;default:if(void 0===n[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);n=n[r]}if(void 0!==u){if(void 0===n[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,n);n=n[u]}}const o=n[s];if(void 0===o)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+s+" but it wasn't found.",n);let c=this.Versioning.None;this.targetObject=n,void 0!==n.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==n.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===s){if(!n.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!n.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!n.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==n.morphTargetDictionary[a]&&(a=n.morphTargetDictionary[a])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else void 0!==o.fromArray&&void 0!==o.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return t.Composite=mie,t})();V1.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},V1.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},V1.prototype.GetterByBindingType=[V1.prototype._getValue_direct,V1.prototype._getValue_array,V1.prototype._getValue_arrayElement,V1.prototype._getValue_toArray],V1.prototype.SetterByBindingTypeAndVersioning=[[V1.prototype._setValue_direct,V1.prototype._setValue_direct_setNeedsUpdate,V1.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[V1.prototype._setValue_array,V1.prototype._setValue_array_setNeedsUpdate,V1.prototype._setValue_array_setMatrixWorldNeedsUpdate],[V1.prototype._setValue_arrayElement,V1.prototype._setValue_arrayElement_setNeedsUpdate,V1.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[V1.prototype._setValue_fromArray,V1.prototype._setValue_fromArray_setNeedsUpdate,V1.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class vie{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,a=s.length,o=new Array(a),c={endingStart:L0,endingEnd:L0};for(let l=0;l!==a;++l){const u=s[l].createInterpolant(null);o[l]=u,u.settings=c}this._interpolantSettings=c,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i){if(e.fadeOut(n),this.fadeIn(n),i){const r=this._clip.duration,s=e._clip.duration,o=r/s;e.warp(1,s/r,n),this.warp(o,1,n)}return this}crossFadeTo(e,n,i){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const c=o.parameterPositions,l=o.sampleValues;return c[0]=s,c[1]=s+i,l[0]=e/a,l[1]=n/a,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const c=(e-s)*i;if(c<0||0===i)return;this._startTime=null,n=i*c}n*=this._updateTimeScale(e);const a=this._updateTime(n),o=this._updateWeight(e);if(o>0){const c=this._interpolants,l=this._propertyBindings;if(2501===this.blendMode)for(let u=0,f=c.length;u!==f;++u)c[u].evaluate(a),l[u].accumulateAdditive(o);else for(let u=0,f=c.length;u!==f;++u)c[u].evaluate(a),l[u].accumulate(r,o)}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(null!==i){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;null!==i&&(n*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===n?this.paused=!0:this.timeScale=n))}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const a=2202===i;if(0===e)return-1===s?r:a&&1==(1&s)?n-r:r;if(2200===i){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=n||r<0){const o=Math.floor(r/n);r-=n*o,s+=Math.abs(o);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===c){const l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&1==(1&s))return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=D0,r.endingEnd=D0):(r.endingStart=e?this.zeroSlopeAtStart?D0:L0:2402,r.endingEnd=n?this.zeroSlopeAtEnd?D0:L0:2402)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,c=a.sampleValues;return o[0]=s,c[0]=n,o[1]=s+e,c[1]=i,this}}(class yie extends h4{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,o=e._interpolants,c=i.uuid,l=this._bindingsByRootAndName;let u=l[c];void 0===u&&(u={},l[c]=u);for(let f=0;f!==s;++f){const d=r[f],m=d.name;let v=u[m];if(void 0!==v)++v.referenceCount,a[f]=v;else{if(v=a[f],void 0!==v){null===v._cacheIndex&&(++v.referenceCount,this._addInactiveBinding(v,c,m));continue}v=new aie(V1.create(i,m,n&&n._propertyBindings[f].binding.parsedPath),d.ValueTypeName,d.getValueSize()),++v.referenceCount,this._addInactiveBinding(v,c,m),a[f]=v}o[f].resultBuffer=v.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];0==--s.useCount&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return null!==n&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let a=s[n];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],c=o.knownActions,l=c[c.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,c[u]=l,c.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===c.length&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];0==--s.referenceCount&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[n];void 0===a&&(a={},r[n]=a),a[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,a=this._bindingsByRootAndName,o=a[r],c=n[n.length-1],l=e._cacheIndex;c._cacheIndex=l,n[l]=c,n.pop(),delete o[s],0===Object.keys(o).length&&delete a[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return void 0===i&&(i=new yD(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let a="string"==typeof e?q7.findByName(r,e):e;const o=null!==a?a.uuid:e,c=this._actionsByClip[o];let l=null;if(void 0===i&&(i=null!==a?a.blendMode:2500),void 0!==c){const f=c.actionByRoot[s];if(void 0!==f&&f.blendMode===i)return f;l=c.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;const u=new vie(this,a,n,i);return this._bindAction(u,l),this._addInactiveAction(u,o,s),u}existingAction(e,n){const i=n||this._root,r=i.uuid,s="string"==typeof e?q7.findByName(i,e):e,o=this._actionsByClip[s?s.uuid:e];return void 0!==o&&o.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let i=this._nActiveActions-1;i>=0;--i)e[i].stop();return this}update(e){const n=this._actions,i=this._nActiveActions,r=this.time+=e*=this.timeScale,s=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==i;++l)n[l]._update(r,e,s,a);const o=this._bindings,c=this._nActiveBindings;for(let l=0;l!==c;++l)o[l].apply(a);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(void 0!==s){const a=s.knownActions;for(let o=0,c=a.length;o!==c;++o){const l=a[o];this._deactivateAction(l);const u=l._cacheIndex,f=n[n.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,f._cacheIndex=u,n[u]=f,n.pop(),this._removeInactiveBindingsForAction(l)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const a in i){const c=i[a].actionByRoot[n];void 0!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}const s=this._bindingsByRootAndName[n];if(void 0!==s)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,n){const i=this.existingAction(e,n);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Qv{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Qv(void 0===this.value.clone?this.value:this.value.clone())}}(class _ie extends ec{constructor(e,n,i=1){super(e,n),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}).prototype.isInstancedInterleavedBuffer=!0;const qD=new ze;class S8{constructor(e=new ze(1/0,1/0),n=new ze(-1/0,-1/0)){this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=qD.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qD.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}S8.prototype.isBox2=!0;const eo=new W,J7=new mt,ty=new mt;function XD(t){const e=[];!0===t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,XD(t.children[n]));return e}const tP=new Float32Array(1);new Int32Array(tP.buffer),J2.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(J2.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},N7.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)},class Sie extends $a{constructor(e=10,n=10,i=4473924,r=8947848){i=new it(i),r=new it(r);const s=n/2,a=e/n,o=e/2,c=[],l=[];for(let d=0,m=0,v=-o;d<=n;d++,v+=a){c.push(-o,0,v,o,0,v),c.push(v,0,-o,v,0,o);const _=d===s?i:r;_.toArray(l,m),m+=3,_.toArray(l,m),m+=3,_.toArray(l,m),m+=3,_.toArray(l,m),m+=3}const u=new St;u.setAttribute("position",new ut(c,3)),u.setAttribute("color",new ut(l,3)),super(u,new oi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class bie extends $a{constructor(e){const n=XD(e),i=new St,r=[],s=[],a=new it(0,0,1),o=new it(0,1,0);for(let l=0;l<n.length;l++){const u=n[l];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}i.setAttribute("position",new ut(r,3)),i.setAttribute("color",new ut(s,3)),super(i,new oi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");ty.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<n.length;s++){const o=n[s];o.parent&&o.parent.isBone&&(J7.multiplyMatrices(ty,o.matrixWorld),eo.setFromMatrixPosition(J7),r.setXYZ(a,eo.x,eo.y,eo.z),J7.multiplyMatrices(ty,o.parent.matrixWorld),eo.setFromMatrixPosition(J7),r.setXYZ(a+1,eo.x,eo.y,eo.z),a+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Qa.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class Yv{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let n="";for(let i=0,r=e.length;i<r;i++)n+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(n))}catch(i){return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return-1===n?"./":e.slice(0,n+1)}static resolveURL(e,n){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}.extractUrlBase(t)},Qa.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},S8.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},S8.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},S8.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},S8.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},$2.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},$2.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},$2.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},$2.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},$2.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},y4.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},g4.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},h7.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},jn.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},jn.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},jn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},jn.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},jn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},jn.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},mt.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},mt.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},mt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new W).setFromMatrixColumn(this,3)},mt.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},mt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},mt.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},mt.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},mt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},mt.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},mt.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},mt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},mt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},mt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},mt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},mt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},mt.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},mt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},mt.prototype.makeFrustum=function(t,e,n,i,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,i,n,r,s)},mt.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},$s.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},wi.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},wi.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},v4.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},v4.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},v4.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},Cn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Cn.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},Cn.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},Cn.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},Cn.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},Cn.barycoordFromPoint=function(t,e,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Cn.getBarycoord(t,e,n,i,r)},Cn.normal=function(t,e,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Cn.getNormal(t,e,n,i)},Xs.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},Xs.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ja(this,t)},Xs.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new x8(this,t)},ze.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},ze.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},ze.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},W.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},W.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},W.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},W.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},W.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},W.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},W.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},W.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},W.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},_1.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},_1.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},v1.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},v1.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},v1.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},v1.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},v1.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(v1.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),zn.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(zn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Lv.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Zn.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(hs.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(z1.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Jl},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Jl)}}}),z1.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Jl:Yl),this},z1.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},z1.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},St.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},St.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new z1(arguments[1],arguments[2])))},St.prototype.addDrawCall=function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},St.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},St.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},St.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},St.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(St.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),ec.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Jl:Yl),this},ec.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ja.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ja.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ja.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},m7.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Qv.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(En.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new it}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Tr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),x1.prototype.clearTarget=function(t,e,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,i)},x1.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},x1.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},x1.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},x1.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},x1.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},x1.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},x1.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},x1.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},x1.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},x1.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},x1.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},x1.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},x1.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},x1.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},x1.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},x1.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},x1.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},x1.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},x1.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},x1.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},x1.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},x1.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},x1.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},x1.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(x1.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?U1:Oa}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(CL.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(e2.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),class iie extends v1{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Kne).load(t,function(i){e.setBuffer(i)}),this},mv.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},mv.prototype.clear=function(t,e,n,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,i)},f4.crossOrigin=void 0,f4.loadTexture=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new MD;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s},f4.loadTextureCube=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new qne;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s},f4.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},f4.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"138"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="138");var Ar=1001,$n=1003,Ei=1006,T4=1009,z8=1012,A4=1015,yc=1016,_c=1020,t2=1023,L4=1026,xc=1027,Mc=2400,bc=2401,io=3e3,W1=3001,T8=35044,hf=35048,D4=class{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});let n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;let n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;let n=this._listeners[t];if(void 0!==n){let i=n.indexOf(e);-1!==i&&n.splice(i,1)}}dispatchEvent(t){if(void 0===this._listeners)return;let e=this._listeners[t.type];if(void 0!==e){t.target=this;let n=e.slice(0);for(let i=0,r=n.length;i<r;i++)n[i].call(this,t);t.target=null}}},ci=[];for(let t=0;t<256;t++)ci[t]=(t<16?"0":"")+t.toString(16);var yy=Math.PI/180,_y=180/Math.PI;function Lr(){let t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(ci[255&t]+ci[t>>8&255]+ci[t>>16&255]+ci[t>>24&255]+"-"+ci[255&e]+ci[e>>8&255]+"-"+ci[e>>16&15|64]+ci[e>>24&255]+"-"+ci[63&n|128]+ci[n>>8&255]+"-"+ci[n>>16&255]+ci[n>>24&255]+ci[255&i]+ci[i>>8&255]+ci[i>>16&255]+ci[i>>24&255]).toUpperCase()}function n2(t,e,n){return Math.max(e,Math.min(n,t))}function xy(t,e,n){return(1-n)*t+n*e}function OP(t){return 0==(t&t-1)&&0!==t}function My(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}var Ie=class{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){let e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){let n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*n-s*i+t.x,this.y=r*i+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};Ie.prototype.isVector2=!0;var li=class{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,s,a,o,c){let l=this.elements;return l[0]=t,l[1]=i,l[2]=a,l[3]=e,l[4]=r,l[5]=o,l[6]=n,l[7]=s,l[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){let e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){let e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[3],o=n[6],c=n[1],l=n[4],u=n[7],f=n[2],d=n[5],m=n[8],v=i[0],_=i[3],M=i[6],y=i[1],g=i[4],S=i[7],b=i[2],E=i[5],P=i[8];return r[0]=s*v+a*y+o*b,r[3]=s*_+a*g+o*E,r[6]=s*M+a*S+o*P,r[1]=c*v+l*y+u*b,r[4]=c*_+l*g+u*E,r[7]=c*M+l*S+u*P,r[2]=f*v+d*y+m*b,r[5]=f*_+d*g+m*E,r[8]=f*M+d*S+m*P,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){let t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],c=t[7],l=t[8];return e*s*l-e*a*c-n*r*l+n*a*o+i*r*c-i*s*o}invert(){let t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],c=t[7],l=t[8],u=l*s-a*c,f=a*o-l*r,d=c*r-s*o,m=e*u+n*f+i*d;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);let v=1/m;return t[0]=u*v,t[1]=(i*c-l*n)*v,t[2]=(a*n-i*s)*v,t[3]=f*v,t[4]=(l*e-i*o)*v,t[5]=(i*r-a*e)*v,t[6]=d*v,t[7]=(n*o-c*e)*v,t[8]=(s*e-n*r)*v,this}transpose(){let t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){let e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,s,a){let o=Math.cos(r),c=Math.sin(r);return this.set(n*o,n*c,-n*(o*s+c*a)+s+t,-i*c,i*o,-i*(-c*s+o*a)+a+e,0,0,1),this}scale(t,e){let n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){let e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],s=i[3],a=i[6],o=i[1],c=i[4],l=i[7];return i[0]=e*r+n*o,i[3]=e*s+n*c,i[6]=e*a+n*l,i[1]=-n*r+e*o,i[4]=-n*s+e*c,i[7]=-n*a+e*l,this}translate(t,e){let n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){let e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){let n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}};function kP(t){for(let e=t.length-1;e>=0;--e)if(t[e]>65535)return!0;return!1}function A8(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}li.prototype.isMatrix3=!0;var FP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Dr={h:0,s:0,l:0},uf={h:0,s:0,l:0};function by(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Sc(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function wy(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var gt=class{constructor(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=function z2e(t,e){return(t%e+e)%e}(t,1),e=n2(e,0,1),n=n2(n,0,1),0===e)this.r=this.g=this.b=n;else{let i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=by(r,i,t+1/3),this.g=by(r,i,t),this.b=by(r,i,t-1/3)}return this}setStyle(t){function e(i){void 0!==i&&parseFloat(i)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let i,s=n[2];switch(n[1]){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,e(i[4]),this;if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,e(i[4]),this;break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){let a=parseFloat(i[1])/360,o=parseInt(i[2],10)/100,c=parseInt(i[3],10)/100;return e(i[4]),this.setHSL(a,o,c)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){let i=n[1],r=i.length;if(3===r)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(6===r)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){let e=FP[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Sc(t.r),this.g=Sc(t.g),this.b=Sc(t.b),this}copyLinearToSRGB(t){return this.r=wy(t.r),this.g=wy(t.g),this.b=wy(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){let a,o,e=this.r,n=this.g,i=this.b,r=Math.max(e,n,i),s=Math.min(e,n,i),c=(s+r)/2;if(s===r)a=0,o=0;else{let l=r-s;switch(o=c<=.5?l/(r+s):l/(2-r-s),r){case e:a=(n-i)/l+(n<i?6:0);break;case n:a=(i-e)/l+2;break;case i:a=(e-n)/l+4}a/=6}return t.h=a,t.s=o,t.l=c,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(Dr),Dr.h+=t,Dr.s+=e,Dr.l+=n,this.setHSL(Dr.h,Dr.s,Dr.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Dr),t.getHSL(uf);let n=xy(Dr.h,uf.h,e),i=xy(Dr.s,uf.s,e),r=xy(Dr.l,uf.l,e);return this.setHSL(n,i,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}};gt.NAMES=FP,gt.prototype.isColor=!0,gt.prototype.r=1,gt.prototype.g=1,gt.prototype.b=1;var Cc,P4=class{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Cc&&(Cc=A8("canvas")),Cc.width=t.width,Cc.height=t.height;let n=Cc.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Cc}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){let e=A8("canvas");e.width=t.width,e.height=t.height;let n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);let i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let s=0;s<r.length;s++)r[s]=255*Sc(r[s]/255);return n.putImageData(i,0,0),e}if(t.data){let e=t.data.slice(0);for(let n=0;n<e.length;n++)e[n]=e instanceof Uint8Array||e instanceof Uint8ClampedArray?Math.floor(255*Sc(e[n]/255)):Sc(e[n]);return{data:e,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}},BP=class{constructor(t=null){this.uuid=Lr(),this.data=t,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){let e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];let n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let r;if(Array.isArray(i)){r=[];for(let s=0,a=i.length;s<a;s++)r.push(Sy(i[s].isDataTexture?i[s].image:i[s]))}else r=Sy(i);n.url=r}return e||(t.images[this.uuid]=n),n}};function Sy(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?P4.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}BP.prototype.isSource=!0;var T2e=0,hi=class extends D4{constructor(t=hi.DEFAULT_IMAGE,e=hi.DEFAULT_MAPPING,n=Ar,i=Ar,r=Ei,s=1008,a=t2,o=T4,c=1,l=io){super(),Object.defineProperty(this,"id",{value:T2e++}),this.uuid=Lr(),this.name="",this.source=new BP(t),this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=o,this.offset=new Ie(0,0),this.repeat=new Ie(1,1),this.center=new Ie(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new li,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=l,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){let e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];let n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case Ar:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case Ar:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}};hi.DEFAULT_IMAGE=null,hi.DEFAULT_MAPPING=300,hi.prototype.isTexture=!0;var b1=class{constructor(t=0,e=0,n=0,i=1){this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){let e=this.x,n=this.y,i=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);let e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r,s=t.elements,a=s[0],o=s[4],c=s[8],l=s[1],u=s[5],f=s[9],d=s[2],m=s[6],v=s[10];if(Math.abs(o-l)<.01&&Math.abs(c-d)<.01&&Math.abs(f-m)<.01){if(Math.abs(o+l)<.1&&Math.abs(c+d)<.1&&Math.abs(f+m)<.1&&Math.abs(a+u+v-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;let M=(a+1)/2,y=(u+1)/2,g=(v+1)/2,S=(o+l)/4,b=(c+d)/4,E=(f+m)/4;return M>y&&M>g?M<.01?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(M),i=S/n,r=b/n):y>g?y<.01?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(y),n=S/i,r=E/i):g<.01?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(g),n=b/r,i=E/r),this.set(n,i,r,e),this}let _=Math.sqrt((m-f)*(m-f)+(c-d)*(c-d)+(l-o)*(l-o));return Math.abs(_)<.001&&(_=1),this.x=(m-f)/_,this.y=(c-d)/_,this.z=(l-o)/_,this.w=Math.acos((a+u+v-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};b1.prototype.isVector4=!0;var T2=class extends D4{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new b1(0,0,t,e),this.scissorTest=!1,this.viewport=new b1(0,0,t,e),this.texture=new hi({width:t,height:e,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Ei,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(t,e,n=1){(this.width!==t||this.height!==e||this.depth!==n)&&(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image=Object.assign({},t.texture.image),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}};T2.prototype.isWebGLRenderTarget=!0;var ff=class extends hi{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=$n,this.minFilter=$n,this.wrapR=Ar,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};ff.prototype.isDataArrayTexture=!0,class extends T2{constructor(t,e,n){super(t,e),this.depth=n,this.texture=new ff(null,t,e,n),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGLArrayRenderTarget=!0;var Cy=class extends hi{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=$n,this.minFilter=$n,this.wrapR=Ar,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};Cy.prototype.isData3DTexture=!0,class extends T2{constructor(t,e,n){super(t,e),this.depth=n,this.texture=new Cy(null,t,e,n),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGL3DRenderTarget=!0,class extends T2{constructor(t,e,n,i={}){super(t,e,i);let r=this.texture;this.texture=[];for(let s=0;s<n;s++)this.texture[s]=r.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=t,this.texture[i].image.height=e,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;var r2=class{constructor(t=0,e=0,n=0,i=1){this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,i)}static slerpFlat(t,e,n,i,r,s,a){let o=n[i+0],c=n[i+1],l=n[i+2],u=n[i+3],f=r[s+0],d=r[s+1],m=r[s+2],v=r[s+3];if(0===a)return t[e+0]=o,t[e+1]=c,t[e+2]=l,void(t[e+3]=u);if(1===a)return t[e+0]=f,t[e+1]=d,t[e+2]=m,void(t[e+3]=v);if(u!==v||o!==f||c!==d||l!==m){let _=1-a,M=o*f+c*d+l*m+u*v,y=M>=0?1:-1,g=1-M*M;if(g>Number.EPSILON){let b=Math.sqrt(g),E=Math.atan2(b,M*y);_=Math.sin(_*E)/b,a=Math.sin(a*E)/b}let S=a*y;if(o=o*_+f*S,c=c*_+d*S,l=l*_+m*S,u=u*_+v*S,_===1-a){let b=1/Math.sqrt(o*o+c*c+l*l+u*u);o*=b,c*=b,l*=b,u*=b}}t[e]=o,t[e+1]=c,t[e+2]=l,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,i,r,s){let a=n[i],o=n[i+1],c=n[i+2],l=n[i+3],u=r[s],f=r[s+1],d=r[s+2],m=r[s+3];return t[e]=a*m+l*u+o*d-c*f,t[e+1]=o*m+l*f+c*u-a*d,t[e+2]=c*m+l*d+a*f-o*u,t[e+3]=l*m-a*u-o*f-c*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");let n=t._x,i=t._y,r=t._z,s=t._order,a=Math.cos,o=Math.sin,c=a(n/2),l=a(i/2),u=a(r/2),f=o(n/2),d=o(i/2),m=o(r/2);switch(s){case"XYZ":this._x=f*l*u+c*d*m,this._y=c*d*u-f*l*m,this._z=c*l*m+f*d*u,this._w=c*l*u-f*d*m;break;case"YXZ":this._x=f*l*u+c*d*m,this._y=c*d*u-f*l*m,this._z=c*l*m-f*d*u,this._w=c*l*u+f*d*m;break;case"ZXY":this._x=f*l*u-c*d*m,this._y=c*d*u+f*l*m,this._z=c*l*m+f*d*u,this._w=c*l*u-f*d*m;break;case"ZYX":this._x=f*l*u-c*d*m,this._y=c*d*u+f*l*m,this._z=c*l*m-f*d*u,this._w=c*l*u+f*d*m;break;case"YZX":this._x=f*l*u+c*d*m,this._y=c*d*u+f*l*m,this._z=c*l*m-f*d*u,this._w=c*l*u-f*d*m;break;case"XZY":this._x=f*l*u-c*d*m,this._y=c*d*u-f*l*m,this._z=c*l*m+f*d*u,this._w=c*l*u+f*d*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){let n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){let e=t.elements,n=e[0],i=e[4],r=e[8],s=e[1],a=e[5],o=e[9],c=e[2],l=e[6],u=e[10],f=n+a+u;if(f>0){let d=.5/Math.sqrt(f+1);this._w=.25/d,this._x=(l-o)*d,this._y=(r-c)*d,this._z=(s-i)*d}else if(n>a&&n>u){let d=2*Math.sqrt(1+n-a-u);this._w=(l-o)/d,this._x=.25*d,this._y=(i+s)/d,this._z=(r+c)/d}else if(a>u){let d=2*Math.sqrt(1+a-n-u);this._w=(r-c)/d,this._x=(i+s)/d,this._y=.25*d,this._z=(o+l)/d}else{let d=2*Math.sqrt(1+u-n-a);this._w=(s-i)/d,this._x=(r+c)/d,this._y=(o+l)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(n2(this.dot(t),-1,1)))}rotateTowards(t,e){let n=this.angleTo(t);if(0===n)return this;let i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){let n=t._x,i=t._y,r=t._z,s=t._w,a=e._x,o=e._y,c=e._z,l=e._w;return this._x=n*l+s*a+i*c-r*o,this._y=i*l+s*o+r*a-n*c,this._z=r*l+s*c+n*o-i*a,this._w=s*l-n*a-i*o-r*c,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);let n=this._x,i=this._y,r=this._z,s=this._w,a=s*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;let o=1-a*a;if(o<=Number.EPSILON){let d=1-e;return this._w=d*s+e*this._w,this._x=d*n+e*this._x,this._y=d*i+e*this._y,this._z=d*r+e*this._z,this.normalize(),this._onChangeCallback(),this}let c=Math.sqrt(o),l=Math.atan2(c,a),u=Math.sin((1-e)*l)/c,f=Math.sin(e*l)/c;return this._w=s*u+this._w*f,this._x=n*u+this._x*f,this._y=i*u+this._y*f,this._z=r*u+this._z*f,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){let t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}};r2.prototype.isQuaternion=!0;var ee=class{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(UP.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(UP.setFromAxisAngle(t,e))}applyMatrix3(t){let e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){let e=this.x,n=this.y,i=this.z,r=t.elements,s=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(t){let e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,a=t.z,o=t.w,c=o*e+s*i-a*n,l=o*n+a*e-r*i,u=o*i+r*n-s*e,f=-r*e-s*n-a*i;return this.x=c*o+f*-r+l*-a-u*-s,this.y=l*o+f*-s+u*-r-c*-a,this.z=u*o+f*-a+c*-s-l*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){let e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){let n=t.x,i=t.y,r=t.z,s=e.x,a=e.y,o=e.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(t){let e=t.lengthSq();if(0===e)return this.set(0,0,0);let n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Ey.copy(this).projectOnVector(t),this.sub(Ey)}reflect(t){return this.sub(Ey.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){let e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;let n=this.dot(t)/e;return Math.acos(n2(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){let i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){let e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){let e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};ee.prototype.isVector3=!0;var Ey=new ee,UP=new r2,Pr=class{constructor(t=new ee(1/0,1/0,1/0),e=new ee(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,a=-1/0;for(let o=0,c=t.length;o<c;o+=3){let l=t[o],u=t[o+1],f=t[o+2];l<e&&(e=l),u<n&&(n=u),f<i&&(i=f),l>r&&(r=l),u>s&&(s=u),f>a&&(a=f)}return this.min.set(e,n,i),this.max.set(r,s,a),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,a=-1/0;for(let o=0,c=t.count;o<c;o++){let l=t.getX(o),u=t.getY(o),f=t.getZ(o);l<e&&(e=l),u<n&&(n=u),f<i&&(i=f),l>r&&(r=l),u>s&&(s=u),f>a&&(a=f)}return this.min.set(e,n,i),this.max.set(r,s,a),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let n=N4.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);let n=t.geometry;if(void 0!==n)if(e&&null!=n.attributes&&void 0!==n.attributes.position){let r=n.attributes.position;for(let s=0,a=r.count;s<a;s++)N4.fromBufferAttribute(r,s).applyMatrix4(t.matrixWorld),this.expandByPoint(N4)}else null===n.boundingBox&&n.computeBoundingBox(),zy.copy(n.boundingBox),zy.applyMatrix4(t.matrixWorld),this.union(zy);let i=t.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,N4),N4.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(L8),df.subVectors(this.max,L8),Ec.subVectors(t.a,L8),zc.subVectors(t.b,L8),Tc.subVectors(t.c,L8),ro.subVectors(zc,Ec),so.subVectors(Tc,zc),R4.subVectors(Ec,Tc);let e=[0,-ro.z,ro.y,0,-so.z,so.y,0,-R4.z,R4.y,ro.z,0,-ro.x,so.z,0,-so.x,R4.z,0,-R4.x,-ro.y,ro.x,0,-so.y,so.x,0,-R4.y,R4.x,0];return!(!Ty(e,Ec,zc,Tc,df)||(e=[1,0,0,0,1,0,0,0,1],!Ty(e,Ec,zc,Tc,df)))&&(pf.crossVectors(ro,so),e=[pf.x,pf.y,pf.z],Ty(e,Ec,zc,Tc,df))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return N4.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(N4).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(Qs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Qs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Qs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Qs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Qs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Qs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Qs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Qs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Qs)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}};Pr.prototype.isBox3=!0;var Qs=[new ee,new ee,new ee,new ee,new ee,new ee,new ee,new ee],N4=new ee,zy=new Pr,Ec=new ee,zc=new ee,Tc=new ee,ro=new ee,so=new ee,R4=new ee,L8=new ee,df=new ee,pf=new ee,H4=new ee;function Ty(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){H4.fromArray(t,s);let o=r.x*Math.abs(H4.x)+r.y*Math.abs(H4.y)+r.z*Math.abs(H4.z),c=e.dot(H4),l=n.dot(H4),u=i.dot(H4);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>o)return!1}return!0}var P2e=new Pr,GP=new ee,mf=new ee,Ay=new ee,Ac=class{constructor(t=new ee,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){let n=this.center;void 0!==e?n.copy(e):P2e.setFromPoints(t).getCenter(n);let i=0;for(let r=0,s=t.length;r<s;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){let e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){let n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){Ay.subVectors(t,this.center);let e=Ay.lengthSq();if(e>this.radius*this.radius){let n=Math.sqrt(e),i=.5*(n-this.radius);this.center.add(Ay.multiplyScalar(i/n)),this.radius+=i}return this}union(t){return!0===this.center.equals(t.center)?mf.set(0,0,1).multiplyScalar(t.radius):mf.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(GP.copy(t.center).add(mf)),this.expandByPoint(GP.copy(t.center).sub(mf)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}},ea=new ee,Ly=new ee,gf=new ee,ao=new ee,Dy=new ee,vf=new ee,Py=new ee,I4=class{constructor(t=new ee,e=new ee(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,ea)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);let n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){let e=ea.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(ea.copy(this.direction).multiplyScalar(e).add(this.origin),ea.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){Ly.copy(t).add(e).multiplyScalar(.5),gf.copy(e).sub(t).normalize(),ao.copy(this.origin).sub(Ly);let u,f,d,m,r=.5*t.distanceTo(e),s=-this.direction.dot(gf),a=ao.dot(this.direction),o=-ao.dot(gf),c=ao.lengthSq(),l=Math.abs(1-s*s);if(l>0)if(u=s*o-a,f=s*a-o,m=r*l,u>=0)if(f>=-m)if(f<=m){let v=1/l;u*=v,f*=v,d=u*(u+s*f+2*a)+f*(s*u+f+2*o)+c}else f=r,u=Math.max(0,-(s*f+a)),d=-u*u+f*(f+2*o)+c;else f=-r,u=Math.max(0,-(s*f+a)),d=-u*u+f*(f+2*o)+c;else f<=-m?(u=Math.max(0,-(-s*r+a)),f=u>0?-r:Math.min(Math.max(-r,-o),r),d=-u*u+f*(f+2*o)+c):f<=m?(u=0,f=Math.min(Math.max(-r,-o),r),d=f*(f+2*o)+c):(u=Math.max(0,-(s*r+a)),f=u>0?r:Math.min(Math.max(-r,-o),r),d=-u*u+f*(f+2*o)+c);else f=s>0?-r:r,u=Math.max(0,-(s*f+a)),d=-u*u+f*(f+2*o)+c;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(gf).multiplyScalar(f).add(Ly),d}intersectSphere(t,e){ea.subVectors(t.center,this.origin);let n=ea.dot(this.direction),i=ea.dot(ea)-n*n,r=t.radius*t.radius;if(i>r)return null;let s=Math.sqrt(r-i),a=n-s,o=n+s;return a<0&&o<0?null:this.at(a<0?o:a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){let e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;let n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){let n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){let e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,s,a,o,c=1/this.direction.x,l=1/this.direction.y,u=1/this.direction.z,f=this.origin;return c>=0?(n=(t.min.x-f.x)*c,i=(t.max.x-f.x)*c):(n=(t.max.x-f.x)*c,i=(t.min.x-f.x)*c),l>=0?(r=(t.min.y-f.y)*l,s=(t.max.y-f.y)*l):(r=(t.max.y-f.y)*l,s=(t.min.y-f.y)*l),n>s||r>i||((r>n||n!=n)&&(n=r),(s<i||i!=i)&&(i=s),u>=0?(a=(t.min.z-f.z)*u,o=(t.max.z-f.z)*u):(a=(t.max.z-f.z)*u,o=(t.min.z-f.z)*u),n>o||a>i)||((a>n||n!=n)&&(n=a),(o<i||i!=i)&&(i=o),i<0)?null:this.at(n>=0?n:i,e)}intersectsBox(t){return null!==this.intersectBox(t,ea)}intersectTriangle(t,e,n,i,r){Dy.subVectors(e,t),vf.subVectors(n,t),Py.crossVectors(Dy,vf);let a,s=this.direction.dot(Py);if(s>0){if(i)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}ao.subVectors(this.origin,t);let o=a*this.direction.dot(vf.crossVectors(ao,vf));if(o<0)return null;let c=a*this.direction.dot(Dy.cross(ao));if(c<0||o+c>s)return null;let l=-a*ao.dot(Py);return l<0?null:this.at(l/s,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}},Ct=class{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,s,a,o,c,l,u,f,d,m,v,_){let M=this.elements;return M[0]=t,M[4]=e,M[8]=n,M[12]=i,M[1]=r,M[5]=s,M[9]=a,M[13]=o,M[2]=c,M[6]=l,M[10]=u,M[14]=f,M[3]=d,M[7]=m,M[11]=v,M[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ct).fromArray(this.elements)}copy(t){let e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){let e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){let e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){let e=this.elements,n=t.elements,i=1/Lc.setFromMatrixColumn(t,0).length(),r=1/Lc.setFromMatrixColumn(t,1).length(),s=1/Lc.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");let e=this.elements,n=t.x,i=t.y,r=t.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),c=Math.sin(i),l=Math.cos(r),u=Math.sin(r);if("XYZ"===t.order){let f=s*l,d=s*u,m=a*l,v=a*u;e[0]=o*l,e[4]=-o*u,e[8]=c,e[1]=d+m*c,e[5]=f-v*c,e[9]=-a*o,e[2]=v-f*c,e[6]=m+d*c,e[10]=s*o}else if("YXZ"===t.order){let f=o*l,d=o*u,m=c*l,v=c*u;e[0]=f+v*a,e[4]=m*a-d,e[8]=s*c,e[1]=s*u,e[5]=s*l,e[9]=-a,e[2]=d*a-m,e[6]=v+f*a,e[10]=s*o}else if("ZXY"===t.order){let f=o*l,d=o*u,m=c*l,v=c*u;e[0]=f-v*a,e[4]=-s*u,e[8]=m+d*a,e[1]=d+m*a,e[5]=s*l,e[9]=v-f*a,e[2]=-s*c,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){let f=s*l,d=s*u,m=a*l,v=a*u;e[0]=o*l,e[4]=m*c-d,e[8]=f*c+v,e[1]=o*u,e[5]=v*c+f,e[9]=d*c-m,e[2]=-c,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){let f=s*o,d=s*c,m=a*o,v=a*c;e[0]=o*l,e[4]=v-f*u,e[8]=m*u+d,e[1]=u,e[5]=s*l,e[9]=-a*l,e[2]=-c*l,e[6]=d*u+m,e[10]=f-v*u}else if("XZY"===t.order){let f=s*o,d=s*c,m=a*o,v=a*c;e[0]=o*l,e[4]=-u,e[8]=c*l,e[1]=f*u+v,e[5]=s*l,e[9]=d*u-m,e[2]=m*u-d,e[6]=a*l,e[10]=v*u+f}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(N2e,t,R2e)}lookAt(t,e,n){let i=this.elements;return A2.subVectors(t,e),0===A2.lengthSq()&&(A2.z=1),A2.normalize(),oo.crossVectors(n,A2),0===oo.lengthSq()&&(1===Math.abs(n.z)?A2.x+=1e-4:A2.z+=1e-4,A2.normalize(),oo.crossVectors(n,A2)),oo.normalize(),yf.crossVectors(A2,oo),i[0]=oo.x,i[4]=yf.x,i[8]=A2.x,i[1]=oo.y,i[5]=yf.y,i[9]=A2.y,i[2]=oo.z,i[6]=yf.z,i[10]=A2.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[4],o=n[8],c=n[12],l=n[1],u=n[5],f=n[9],d=n[13],m=n[2],v=n[6],_=n[10],M=n[14],y=n[3],g=n[7],S=n[11],b=n[15],E=i[0],P=i[4],V=i[8],j=i[12],Y=i[1],G=i[5],C=i[9],N=i[13],F=i[2],U=i[6],$=i[10],O=i[14],I=i[3],k=i[7],K=i[11],re=i[15];return r[0]=s*E+a*Y+o*F+c*I,r[4]=s*P+a*G+o*U+c*k,r[8]=s*V+a*C+o*$+c*K,r[12]=s*j+a*N+o*O+c*re,r[1]=l*E+u*Y+f*F+d*I,r[5]=l*P+u*G+f*U+d*k,r[9]=l*V+u*C+f*$+d*K,r[13]=l*j+u*N+f*O+d*re,r[2]=m*E+v*Y+_*F+M*I,r[6]=m*P+v*G+_*U+M*k,r[10]=m*V+v*C+_*$+M*K,r[14]=m*j+v*N+_*O+M*re,r[3]=y*E+g*Y+S*F+b*I,r[7]=y*P+g*G+S*U+b*k,r[11]=y*V+g*C+S*$+b*K,r[15]=y*j+g*N+S*O+b*re,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){let t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],s=t[1],a=t[5],o=t[9],c=t[13],l=t[2],u=t[6],f=t[10],d=t[14];return t[3]*(+r*o*u-i*c*u-r*a*f+n*c*f+i*a*d-n*o*d)+t[7]*(+e*o*d-e*c*f+r*s*f-i*s*d+i*c*l-r*o*l)+t[11]*(+e*c*u-e*a*d-r*s*u+n*s*d+r*a*l-n*c*l)+t[15]*(-i*a*l-e*o*u+e*a*f+i*s*u-n*s*f+n*o*l)}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){let i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){let t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],c=t[7],l=t[8],u=t[9],f=t[10],d=t[11],m=t[12],v=t[13],_=t[14],M=t[15],y=u*_*c-v*f*c+v*o*d-a*_*d-u*o*M+a*f*M,g=m*f*c-l*_*c-m*o*d+s*_*d+l*o*M-s*f*M,S=l*v*c-m*u*c+m*a*d-s*v*d-l*a*M+s*u*M,b=m*u*o-l*v*o-m*a*f+s*v*f+l*a*_-s*u*_,E=e*y+n*g+i*S+r*b;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let P=1/E;return t[0]=y*P,t[1]=(v*f*r-u*_*r-v*i*d+n*_*d+u*i*M-n*f*M)*P,t[2]=(a*_*r-v*o*r+v*i*c-n*_*c-a*i*M+n*o*M)*P,t[3]=(u*o*r-a*f*r-u*i*c+n*f*c+a*i*d-n*o*d)*P,t[4]=g*P,t[5]=(l*_*r-m*f*r+m*i*d-e*_*d-l*i*M+e*f*M)*P,t[6]=(m*o*r-s*_*r-m*i*c+e*_*c+s*i*M-e*o*M)*P,t[7]=(s*f*r-l*o*r+l*i*c-e*f*c-s*i*d+e*o*d)*P,t[8]=S*P,t[9]=(m*u*r-l*v*r-m*n*d+e*v*d+l*n*M-e*u*M)*P,t[10]=(s*v*r-m*a*r+m*n*c-e*v*c-s*n*M+e*a*M)*P,t[11]=(l*a*r-s*u*r-l*n*c+e*u*c+s*n*d-e*a*d)*P,t[12]=b*P,t[13]=(l*v*i-m*u*i+m*n*f-e*v*f-l*n*_+e*u*_)*P,t[14]=(m*a*i-s*v*i-m*n*o+e*v*o+s*n*_-e*a*_)*P,t[15]=(s*u*i-l*a*i+l*n*o-e*u*o-s*n*f+e*a*f)*P,this}scale(t){let e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){let t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){let e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){let e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){let e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){let n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,a=t.y,o=t.z,c=r*s,l=r*a;return this.set(c*s+n,c*a-i*o,c*o+i*a,0,c*a+i*o,l*a+n,l*o-i*s,0,c*o-i*a,l*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,s){return this.set(1,n,r,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){let i=this.elements,r=e._x,s=e._y,a=e._z,o=e._w,c=r+r,l=s+s,u=a+a,f=r*c,d=r*l,m=r*u,v=s*l,_=s*u,M=a*u,y=o*c,g=o*l,S=o*u,b=n.x,E=n.y,P=n.z;return i[0]=(1-(v+M))*b,i[1]=(d+S)*b,i[2]=(m-g)*b,i[3]=0,i[4]=(d-S)*E,i[5]=(1-(f+M))*E,i[6]=(_+y)*E,i[7]=0,i[8]=(m+g)*P,i[9]=(_-y)*P,i[10]=(1-(f+v))*P,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){let i=this.elements,r=Lc.set(i[0],i[1],i[2]).length(),s=Lc.set(i[4],i[5],i[6]).length(),a=Lc.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],Nr.copy(this);let o=1/r,c=1/s,l=1/a;return Nr.elements[0]*=o,Nr.elements[1]*=o,Nr.elements[2]*=o,Nr.elements[4]*=c,Nr.elements[5]*=c,Nr.elements[6]*=c,Nr.elements[8]*=l,Nr.elements[9]*=l,Nr.elements[10]*=l,e.setFromRotationMatrix(Nr),n.x=r,n.y=s,n.z=a,this}makePerspective(t,e,n,i,r,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");let a=this.elements,c=2*r/(n-i),l=(e+t)/(e-t),u=(n+i)/(n-i),f=-(s+r)/(s-r),d=-2*s*r/(s-r);return a[0]=2*r/(e-t),a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=f,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(t,e,n,i,r,s){let a=this.elements,o=1/(e-t),c=1/(n-i),l=1/(s-r),u=(e+t)*o,f=(n+i)*c,d=(s+r)*l;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-f,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(t){let e=this.elements,n=t.elements;for(let i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){let n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}};Ct.prototype.isMatrix4=!0;var Lc=new ee,Nr=new Ct,N2e=new ee(0,0,0),R2e=new ee(1,1,1),oo=new ee,yf=new ee,A2=new ee,WP=new Ct,jP=new r2,Dc=class{constructor(t=0,e=0,n=0,i=Dc.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){let i=t.elements,r=i[0],s=i[4],a=i[8],o=i[1],c=i[5],l=i[9],u=i[2],f=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(n2(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(f,c),this._z=0);break;case"YXZ":this._x=Math.asin(-n2(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,c)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(n2(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,c)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-n2(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,c));break;case"YZX":this._z=Math.asin(n2(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-n2(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-l,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return WP.makeRotationFromQuaternion(t),this.setFromRotationMatrix(WP,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return jP.setFromEuler(this),this.setFromQuaternion(jP,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}};Dc.prototype.isEuler=!0,Dc.DefaultOrder="XYZ",Dc.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var Ny=class{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}},H2e=0,qP=new ee,Pc=new r2,ta=new Ct,_f=new ee,D8=new ee,I2e=new ee,V2e=new r2,ZP=new ee(1,0,0),$P=new ee(0,1,0),XP=new ee(0,0,1),O2e={type:"added"},YP={type:"removed"},w1=class extends D4{constructor(){super(),Object.defineProperty(this,"id",{value:H2e++}),this.uuid=Lr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=w1.DefaultUp.clone();let t=new ee,e=new Dc,n=new r2,i=new ee(1,1,1);e._onChange(function r(){n.setFromEuler(e,!1)}),n._onChange(function s(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ct},normalMatrix:{value:new li}}),this.matrix=new Ct,this.matrixWorld=new Ct,this.matrixAutoUpdate=w1.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ny,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Pc.setFromAxisAngle(t,e),this.quaternion.multiply(Pc),this}rotateOnWorldAxis(t,e){return Pc.setFromAxisAngle(t,e),this.quaternion.premultiply(Pc),this}rotateX(t){return this.rotateOnAxis(ZP,t)}rotateY(t){return this.rotateOnAxis($P,t)}rotateZ(t){return this.rotateOnAxis(XP,t)}translateOnAxis(t,e){return qP.copy(t).applyQuaternion(this.quaternion),this.position.add(qP.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(ZP,t)}translateY(t){return this.translateOnAxis($P,t)}translateZ(t){return this.translateOnAxis(XP,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(ta.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?_f.copy(t):_f.set(t,e,n);let i=this.parent;this.updateWorldMatrix(!0,!1),D8.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ta.lookAt(D8,_f,this.up):ta.lookAt(_f,D8,this.up),this.quaternion.setFromRotationMatrix(ta),i&&(ta.extractRotation(i.matrixWorld),Pc.setFromRotationMatrix(ta),this.quaternion.premultiply(Pc.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(O2e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}let e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(YP)),this}removeFromParent(){let t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){let e=this.children[t];e.parent=null,e.dispatchEvent(YP)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),ta.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),ta.multiply(t.parent.matrixWorld)),t.applyMatrix4(ta),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){let r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(D8,t,I2e),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(D8,V2e,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);let e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);let e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){let e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){let n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){let i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].updateWorldMatrix(!1,!0)}}toJSON(t){let e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};function r(a,o){return void 0===a[o.uuid]&&(a[o.uuid]=o.toJSON(t)),o.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);let a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){let o=a.shapes;if(Array.isArray(o))for(let c=0,l=o.length;c<l;c++)r(t.shapes,o[c]);else r(t.shapes,o)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){let a=[];for(let o=0,c=this.material.length;o<c;o++)a.push(r(t.materials,this.material[o]));i.material=a}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++)i.animations.push(r(t.animations,this.animations[a]))}if(e){let a=s(t.geometries),o=s(t.materials),c=s(t.textures),l=s(t.images),u=s(t.shapes),f=s(t.skeletons),d=s(t.animations),m=s(t.nodes);a.length>0&&(n.geometries=a),o.length>0&&(n.materials=o),c.length>0&&(n.textures=c),l.length>0&&(n.images=l),u.length>0&&(n.shapes=u),f.length>0&&(n.skeletons=f),d.length>0&&(n.animations=d),m.length>0&&(n.nodes=m)}return n.object=i,n;function s(a){let o=[];for(let c in a){let l=a[c];delete l.metadata,o.push(l)}return o}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}};w1.DefaultUp=new ee(0,1,0),w1.DefaultMatrixAutoUpdate=!0,w1.prototype.isObject3D=!0;var Rr=new ee,na=new ee,Ry=new ee,ia=new ee,Nc=new ee,Rc=new ee,JP=new ee,Hy=new ee,Iy=new ee,Vy=new ee,In=class{constructor(t=new ee,e=new ee,n=new ee){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),Rr.subVectors(t,e),i.cross(Rr);let r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){Rr.subVectors(i,e),na.subVectors(n,e),Ry.subVectors(t,e);let s=Rr.dot(Rr),a=Rr.dot(na),o=Rr.dot(Ry),c=na.dot(na),l=na.dot(Ry),u=s*c-a*a;if(0===u)return r.set(-2,-1,-1);let f=1/u,d=(c*o-a*l)*f,m=(s*l-a*o)*f;return r.set(1-d-m,m,d)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,ia),ia.x>=0&&ia.y>=0&&ia.x+ia.y<=1}static getUV(t,e,n,i,r,s,a,o){return this.getBarycoord(t,e,n,i,ia),o.set(0,0),o.addScaledVector(r,ia.x),o.addScaledVector(s,ia.y),o.addScaledVector(a,ia.z),o}static isFrontFacing(t,e,n,i){return Rr.subVectors(n,e),na.subVectors(t,e),Rr.cross(na).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Rr.subVectors(this.c,this.b),na.subVectors(this.a,this.b),.5*Rr.cross(na).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return In.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return In.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return In.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return In.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return In.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){let s,a,n=this.a,i=this.b,r=this.c;Nc.subVectors(i,n),Rc.subVectors(r,n),Hy.subVectors(t,n);let o=Nc.dot(Hy),c=Rc.dot(Hy);if(o<=0&&c<=0)return e.copy(n);Iy.subVectors(t,i);let l=Nc.dot(Iy),u=Rc.dot(Iy);if(l>=0&&u<=l)return e.copy(i);let f=o*u-l*c;if(f<=0&&o>=0&&l<=0)return s=o/(o-l),e.copy(n).addScaledVector(Nc,s);Vy.subVectors(t,r);let d=Nc.dot(Vy),m=Rc.dot(Vy);if(m>=0&&d<=m)return e.copy(r);let v=d*c-o*m;if(v<=0&&c>=0&&m<=0)return a=c/(c-m),e.copy(n).addScaledVector(Rc,a);let _=l*m-d*u;if(_<=0&&u-l>=0&&d-m>=0)return JP.subVectors(r,i),a=(u-l)/(u-l+(d-m)),e.copy(i).addScaledVector(JP,a);let M=1/(_+v+f);return s=v*M,a=f*M,e.copy(n).addScaledVector(Nc,s).addScaledVector(Rc,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},k2e=0,Vn=class extends D4{constructor(){super(),Object.defineProperty(this,"id",{value:k2e++}),this.uuid=Lr(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(let e in t){let n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}let i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){let e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});let n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(r){let s=[];for(let a in r){let o=r[a];delete o.metadata,s.push(o)}return s}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){let r=i(t.textures),s=i(t.images);r.length>0&&(n.textures=r),s.length>0&&(n.images=s)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;let e=t.clippingPlanes,n=null;if(null!==e){let i=e.length;n=new Array(i);for(let r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}};Vn.prototype.isMaterial=!0,Vn.fromType=function(){return null};var xf=class extends Vn{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new gt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}};xf.prototype.isMeshBasicMaterial=!0;var P1=new ee,Mf=new Ie,On=class{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=T8,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new gt),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this}copyVector2sArray(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new Ie),e[n++]=s.x,e[n++]=s.y}return this}copyVector3sArray(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new ee),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this}copyVector4sArray(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new b1),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Mf.fromBufferAttribute(this,e),Mf.applyMatrix3(t),this.setXY(e,Mf.x,Mf.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)P1.fromBufferAttribute(this,e),P1.applyMatrix3(t),this.setXYZ(e,P1.x,P1.y,P1.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)P1.x=this.getX(e),P1.y=this.getY(e),P1.z=this.getZ(e),P1.applyMatrix4(t),this.setXYZ(e,P1.x,P1.y,P1.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)P1.x=this.getX(e),P1.y=this.getY(e),P1.z=this.getZ(e),P1.applyNormalMatrix(t),this.setXYZ(e,P1.x,P1.y,P1.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)P1.x=this.getX(e),P1.y=this.getY(e),P1.z=this.getZ(e),P1.transformDirection(t),this.setXYZ(e,P1.x,P1.y,P1.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==T8&&(t.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(t.updateRange=this.updateRange),t}};On.prototype.isBufferAttribute=!0;var KP=class extends On{constructor(t,e,n){super(new Uint16Array(t),e,n)}},QP=class extends On{constructor(t,e,n){super(new Uint32Array(t),e,n)}};(class extends On{constructor(t,e,n){super(new Uint16Array(t),e,n)}}).prototype.isFloat16BufferAttribute=!0;var Xn=class extends On{constructor(t,e,n){super(new Float32Array(t),e,n)}},B2e=0,K2=new Ct,Oy=new w1,Hc=new ee,L2=new Pr,P8=new Pr,Yn=new ee,Q1=class extends D4{constructor(){super(),Object.defineProperty(this,"id",{value:B2e++}),this.uuid=Lr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return this.index=Array.isArray(t)?new(kP(t)?QP:KP)(t,1):t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){let e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);let n=this.attributes.normal;if(void 0!==n){let r=(new li).getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}let i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return K2.makeRotationFromQuaternion(t),this.applyMatrix4(K2),this}rotateX(t){return K2.makeRotationX(t),this.applyMatrix4(K2),this}rotateY(t){return K2.makeRotationY(t),this.applyMatrix4(K2),this}rotateZ(t){return K2.makeRotationZ(t),this.applyMatrix4(K2),this}translate(t,e,n){return K2.makeTranslation(t,e,n),this.applyMatrix4(K2),this}scale(t,e,n){return K2.makeScale(t,e,n),this.applyMatrix4(K2),this}lookAt(t){return Oy.lookAt(t),Oy.updateMatrix(),this.applyMatrix4(Oy.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Hc).negate(),this.translate(Hc.x,Hc.y,Hc.z),this}setFromPoints(t){let e=[];for(let n=0,i=t.length;n<i;n++){let r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Xn(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Pr);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ee(-1/0,-1/0,-1/0),new ee(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,i=e.length;n<i;n++)L2.setFromBufferAttribute(e[n]),this.morphTargetsRelative?(Yn.addVectors(this.boundingBox.min,L2.min),this.boundingBox.expandByPoint(Yn),Yn.addVectors(this.boundingBox.max,L2.max),this.boundingBox.expandByPoint(Yn)):(this.boundingBox.expandByPoint(L2.min),this.boundingBox.expandByPoint(L2.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Ac);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ee,1/0);if(t){let n=this.boundingSphere.center;if(L2.setFromBufferAttribute(t),e)for(let r=0,s=e.length;r<s;r++)P8.setFromBufferAttribute(e[r]),this.morphTargetsRelative?(Yn.addVectors(L2.min,P8.min),L2.expandByPoint(Yn),Yn.addVectors(L2.max,P8.max),L2.expandByPoint(Yn)):(L2.expandByPoint(P8.min),L2.expandByPoint(P8.max));L2.getCenter(n);let i=0;for(let r=0,s=t.count;r<s;r++)Yn.fromBufferAttribute(t,r),i=Math.max(i,n.distanceToSquared(Yn));if(e)for(let r=0,s=e.length;r<s;r++){let a=e[r],o=this.morphTargetsRelative;for(let c=0,l=a.count;c<l;c++)Yn.fromBufferAttribute(a,c),o&&(Hc.fromBufferAttribute(t,c),Yn.add(Hc)),i=Math.max(i,n.distanceToSquared(Yn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");let n=t.array,i=e.position.array,r=e.normal.array,s=e.uv.array,a=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new On(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,c=[],l=[];for(let Y=0;Y<a;Y++)c[Y]=new ee,l[Y]=new ee;let u=new ee,f=new ee,d=new ee,m=new Ie,v=new Ie,_=new Ie,M=new ee,y=new ee;function g(Y,G,C){u.fromArray(i,3*Y),f.fromArray(i,3*G),d.fromArray(i,3*C),m.fromArray(s,2*Y),v.fromArray(s,2*G),_.fromArray(s,2*C),f.sub(u),d.sub(u),v.sub(m),_.sub(m);let N=1/(v.x*_.y-_.x*v.y);!isFinite(N)||(M.copy(f).multiplyScalar(_.y).addScaledVector(d,-v.y).multiplyScalar(N),y.copy(d).multiplyScalar(v.x).addScaledVector(f,-_.x).multiplyScalar(N),c[Y].add(M),c[G].add(M),c[C].add(M),l[Y].add(y),l[G].add(y),l[C].add(y))}let S=this.groups;0===S.length&&(S=[{start:0,count:n.length}]);for(let Y=0,G=S.length;Y<G;++Y){let C=S[Y],N=C.start;for(let U=N,$=N+C.count;U<$;U+=3)g(n[U+0],n[U+1],n[U+2])}let b=new ee,E=new ee,P=new ee,V=new ee;function j(Y){P.fromArray(r,3*Y),V.copy(P);let G=c[Y];b.copy(G),b.sub(P.multiplyScalar(P.dot(G))).normalize(),E.crossVectors(V,G);let C=E.dot(l[Y])<0?-1:1;o[4*Y]=b.x,o[4*Y+1]=b.y,o[4*Y+2]=b.z,o[4*Y+3]=C}for(let Y=0,G=S.length;Y<G;++Y){let C=S[Y],N=C.start;for(let U=N,$=N+C.count;U<$;U+=3)j(n[U+0]),j(n[U+1]),j(n[U+2])}}computeVertexNormals(){let t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new On(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let f=0,d=n.count;f<d;f++)n.setXYZ(f,0,0,0);let i=new ee,r=new ee,s=new ee,a=new ee,o=new ee,c=new ee,l=new ee,u=new ee;if(t)for(let f=0,d=t.count;f<d;f+=3){let m=t.getX(f+0),v=t.getX(f+1),_=t.getX(f+2);i.fromBufferAttribute(e,m),r.fromBufferAttribute(e,v),s.fromBufferAttribute(e,_),l.subVectors(s,r),u.subVectors(i,r),l.cross(u),a.fromBufferAttribute(n,m),o.fromBufferAttribute(n,v),c.fromBufferAttribute(n,_),a.add(l),o.add(l),c.add(l),n.setXYZ(m,a.x,a.y,a.z),n.setXYZ(v,o.x,o.y,o.z),n.setXYZ(_,c.x,c.y,c.z)}else for(let f=0,d=e.count;f<d;f+=3)i.fromBufferAttribute(e,f+0),r.fromBufferAttribute(e,f+1),s.fromBufferAttribute(e,f+2),l.subVectors(s,r),u.subVectors(i,r),l.cross(u),n.setXYZ(f+0,l.x,l.y,l.z),n.setXYZ(f+1,l.x,l.y,l.z),n.setXYZ(f+2,l.x,l.y,l.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));let n=this.attributes;for(let i in n){if(void 0===t.attributes[i])continue;let r=n[i].array,s=t.attributes[i],a=s.array,o=s.itemSize*e,c=Math.min(a.length,r.length-o);for(let l=0,u=o;l<c;l++,u++)r[u]=a[l]}return this}normalizeNormals(){let t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Yn.fromBufferAttribute(t,e),Yn.normalize(),t.setXYZ(e,Yn.x,Yn.y,Yn.z)}toNonIndexed(){function t(a,o){let c=a.array,l=a.itemSize,u=a.normalized,f=new c.constructor(o.length*l),d=0,m=0;for(let v=0,_=o.length;v<_;v++){d=a.isInterleavedBufferAttribute?o[v]*a.data.stride+a.offset:o[v]*l;for(let M=0;M<l;M++)f[m++]=c[d++]}return new On(f,l,u)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let e=new Q1,n=this.index.array,i=this.attributes;for(let a in i){let c=t(i[a],n);e.setAttribute(a,c)}let r=this.morphAttributes;for(let a in r){let o=[],c=r[a];for(let l=0,u=c.length;l<u;l++){let d=t(c[l],n);o.push(d)}e.morphAttributes[a]=o}e.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let c=s[a];e.addGroup(c.start,c.count,c.materialIndex)}return e}toJSON(){let t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){let o=this.parameters;for(let c in o)void 0!==o[c]&&(t[c]=o[c]);return t}t.data={attributes:{}};let e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});let n=this.attributes;for(let o in n)t.data.attributes[o]=n[o].toJSON(t.data);let i={},r=!1;for(let o in this.morphAttributes){let c=this.morphAttributes[o],l=[];for(let u=0,f=c.length;u<f;u++)l.push(c[u].toJSON(t.data));l.length>0&&(i[o]=l,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let e={};this.name=t.name;let n=t.index;null!==n&&this.setIndex(n.clone(e));let i=t.attributes;for(let c in i)this.setAttribute(c,i[c].clone(e));let r=t.morphAttributes;for(let c in r){let l=[],u=r[c];for(let f=0,d=u.length;f<d;f++)l.push(u[f].clone(e));this.morphAttributes[c]=l}this.morphTargetsRelative=t.morphTargetsRelative;let s=t.groups;for(let c=0,l=s.length;c<l;c++){let u=s[c];this.addGroup(u.start,u.count,u.materialIndex)}let a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());let o=t.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}};Q1.prototype.isBufferGeometry=!0;var eN=new Ct,Ic=new I4,ky=new Ac,co=new ee,lo=new ee,ho=new ee,Fy=new ee,By=new ee,Uy=new ee,bf=new ee,wf=new ee,Sf=new ee,Cf=new Ie,Ef=new Ie,zf=new Ie,Gy=new ee,Tf=new ee,s2=class extends w1{constructor(t=new Q1,e=new xf){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){let t=this.geometry;if(t.isBufferGeometry){let e=t.morphAttributes,n=Object.keys(e);if(n.length>0){let i=e[n[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){let a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}else{let e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){let s,n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i&&(null===n.boundingSphere&&n.computeBoundingSphere(),ky.copy(n.boundingSphere),ky.applyMatrix4(r),!1!==t.ray.intersectsSphere(ky))&&(eN.copy(r).invert(),Ic.copy(t.ray).applyMatrix4(eN),null===n.boundingBox||!1!==Ic.intersectsBox(n.boundingBox)))if(n.isBufferGeometry){let a=n.index,o=n.attributes.position,c=n.morphAttributes.position,l=n.morphTargetsRelative,u=n.attributes.uv,f=n.attributes.uv2,d=n.groups,m=n.drawRange;if(null!==a)if(Array.isArray(i))for(let v=0,_=d.length;v<_;v++){let M=d[v],y=i[M.materialIndex];for(let b=Math.max(M.start,m.start),E=Math.min(a.count,Math.min(M.start+M.count,m.start+m.count));b<E;b+=3){let P=a.getX(b),V=a.getX(b+1),j=a.getX(b+2);s=Af(this,y,t,Ic,o,c,l,u,f,P,V,j),s&&(s.faceIndex=Math.floor(b/3),s.face.materialIndex=M.materialIndex,e.push(s))}}else for(let M=Math.max(0,m.start),y=Math.min(a.count,m.start+m.count);M<y;M+=3){let g=a.getX(M),S=a.getX(M+1),b=a.getX(M+2);s=Af(this,i,t,Ic,o,c,l,u,f,g,S,b),s&&(s.faceIndex=Math.floor(M/3),e.push(s))}else if(void 0!==o)if(Array.isArray(i))for(let v=0,_=d.length;v<_;v++){let M=d[v],y=i[M.materialIndex];for(let b=Math.max(M.start,m.start),E=Math.min(o.count,Math.min(M.start+M.count,m.start+m.count));b<E;b+=3)s=Af(this,y,t,Ic,o,c,l,u,f,b,b+1,b+2),s&&(s.faceIndex=Math.floor(b/3),s.face.materialIndex=M.materialIndex,e.push(s))}else for(let M=Math.max(0,m.start),y=Math.min(o.count,m.start+m.count);M<y;M+=3)s=Af(this,i,t,Ic,o,c,l,u,f,M,M+1,M+2),s&&(s.faceIndex=Math.floor(M/3),e.push(s))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}};function Af(t,e,n,i,r,s,a,o,c,l,u,f){co.fromBufferAttribute(r,l),lo.fromBufferAttribute(r,u),ho.fromBufferAttribute(r,f);let d=t.morphTargetInfluences;if(s&&d){bf.set(0,0,0),wf.set(0,0,0),Sf.set(0,0,0);for(let v=0,_=s.length;v<_;v++){let M=d[v],y=s[v];0!==M&&(Fy.fromBufferAttribute(y,l),By.fromBufferAttribute(y,u),Uy.fromBufferAttribute(y,f),a?(bf.addScaledVector(Fy,M),wf.addScaledVector(By,M),Sf.addScaledVector(Uy,M)):(bf.addScaledVector(Fy.sub(co),M),wf.addScaledVector(By.sub(lo),M),Sf.addScaledVector(Uy.sub(ho),M)))}co.add(bf),lo.add(wf),ho.add(Sf)}t.isSkinnedMesh&&(t.boneTransform(l,co),t.boneTransform(u,lo),t.boneTransform(f,ho));let m=function U2e(t,e,n,i,r,s,a,o){let c;if(c=1===e.side?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,2!==e.side,o),null===c)return null;Tf.copy(o),Tf.applyMatrix4(t.matrixWorld);let l=n.ray.origin.distanceTo(Tf);return l<n.near||l>n.far?null:{distance:l,point:Tf.clone(),object:t}}(t,e,n,i,co,lo,ho,Gy);if(m){o&&(Cf.fromBufferAttribute(o,l),Ef.fromBufferAttribute(o,u),zf.fromBufferAttribute(o,f),m.uv=In.getUV(Gy,co,lo,ho,Cf,Ef,zf,new Ie)),c&&(Cf.fromBufferAttribute(c,l),Ef.fromBufferAttribute(c,u),zf.fromBufferAttribute(c,f),m.uv2=In.getUV(Gy,co,lo,ho,Cf,Ef,zf,new Ie));let v={a:l,b:u,c:f,normal:new ee,materialIndex:0};In.getNormal(co,lo,ho,v.normal),m.face=v}return m}s2.prototype.isMesh=!0;var Lf=class extends Q1{constructor(t=1,e=1,n=1,i=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};let a=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);let o=[],c=[],l=[],u=[],f=0,d=0;function m(v,_,M,y,g,S,b,E,P,V,j){let Y=S/P,G=b/V,C=S/2,N=b/2,F=E/2,U=P+1,$=V+1,O=0,I=0,k=new ee;for(let K=0;K<$;K++){let re=K*G-N;for(let ae=0;ae<U;ae++)k[v]=(ae*Y-C)*y,k[_]=re*g,k[M]=F,c.push(k.x,k.y,k.z),k[v]=0,k[_]=0,k[M]=E>0?1:-1,l.push(k.x,k.y,k.z),u.push(ae/P),u.push(1-K/V),O+=1}for(let K=0;K<V;K++)for(let re=0;re<P;re++){let ue=f+re+U*(K+1),Le=f+(re+1)+U*(K+1),Oe=f+(re+1)+U*K;o.push(f+re+U*K,ue,Oe),o.push(ue,Le,Oe),I+=6}a.addGroup(d,I,j),d+=I,f+=O}m("z","y","x",-1,-1,n,e,t,s,r,0),m("z","y","x",1,-1,n,e,-t,s,r,1),m("x","z","y",1,1,t,n,e,i,s,2),m("x","z","y",1,-1,t,n,-e,i,s,3),m("x","y","z",1,-1,t,e,n,i,r,4),m("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(o),this.setAttribute("position",new Xn(c,3)),this.setAttribute("normal",new Xn(l,3)),this.setAttribute("uv",new Xn(u,2))}static fromJSON(t){return new Lf(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}};function Vc(t){let e={};for(let n in t){e[n]={};for(let i in t[n]){let r=t[n][i];e[n][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function zi(t){let e={};for(let n=0;n<t.length;n++){let i=Vc(t[n]);for(let r in i)e[r]=i[r]}return e}var G2e={clone:Vc,merge:zi},Hr=class extends Vn{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Vc(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){let e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(let i in this.uniforms){let r=this.uniforms[i].value;e.uniforms[i]=r&&r.isTexture?{type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?{type:"c",value:r.getHex()}:r&&r.isVector2?{type:"v2",value:r.toArray()}:r&&r.isVector3?{type:"v3",value:r.toArray()}:r&&r.isVector4?{type:"v4",value:r.toArray()}:r&&r.isMatrix3?{type:"m3",value:r.toArray()}:r&&r.isMatrix4?{type:"m4",value:r.toArray()}:{value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;let n={};for(let i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}};Hr.prototype.isShaderMaterial=!0;var Wy=class extends w1{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Ct,this.projectionMatrix=new Ct,this.projectionMatrixInverse=new Ct}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}};Wy.prototype.isCamera=!0;var a2=class extends Wy{constructor(t=50,e=1,n=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){let e=.5*this.getFilmHeight()/t;this.fov=2*_y*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){let t=Math.tan(.5*yy*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*_y*Math.atan(Math.tan(.5*yy*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,i,r,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=this.near,e=t*Math.tan(.5*yy*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i,s=this.view;if(null!==this.view&&this.view.enabled){let o=s.fullWidth,c=s.fullHeight;r+=s.offsetX*i/o,e-=s.offsetY*n/c,i*=s.width/o,n*=s.height/c}let a=this.filmOffset;0!==a&&(r+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}};a2.prototype.isPerspectiveCamera=!0;var jy=class extends w1{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;let i=new a2(90,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new ee(1,0,0)),this.add(i);let r=new a2(90,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new ee(-1,0,0)),this.add(r);let s=new a2(90,1,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new ee(0,1,0)),this.add(s);let a=new a2(90,1,t,e);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new ee(0,-1,0)),this.add(a);let o=new a2(90,1,t,e);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new ee(0,0,1)),this.add(o);let c=new a2(90,1,t,e);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new ee(0,0,-1)),this.add(c)}update(t,e){null===this.parent&&this.updateMatrixWorld();let n=this.renderTarget,[i,r,s,a,o,c]=this.children,l=t.xr.enabled,u=t.getRenderTarget();t.xr.enabled=!1;let f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,r),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,a),t.setRenderTarget(n,4),t.render(e,o),n.texture.generateMipmaps=f,t.setRenderTarget(n,5),t.render(e,c),t.setRenderTarget(u),t.xr.enabled=l,n.texture.needsPMREMUpdate=!0}},Df=class extends hi{constructor(t,e,n,i,r,s,a,o,c,l){super(t=void 0!==t?t:[],e=void 0!==e?e:301,n,i,r,s,a,o,c,l),this.flipY=!1}get images(){return this.image}set images(t){this.image=t}};Df.prototype.isCubeTexture=!0;var tN=class extends T2{constructor(t,e={}){super(t,t,e);let n={width:t,height:t,depth:1};this.texture=new Df([n,n,n,n,n,n],e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:Ei}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=t2,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;let n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",i=new Lf(5,5,5),r=new Hr({name:"CubemapFromEquirect",uniforms:Vc(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=e;let s=new s2(i,r),a=e.minFilter;return 1008===e.minFilter&&(e.minFilter=Ei),new jy(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,i){let r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,i);t.setRenderTarget(r)}};tN.prototype.isWebGLCubeRenderTarget=!0;var qy=new ee,q2e=new ee,Z2e=new li,ra=class{constructor(t=new ee(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){let i=qy.subVectors(n,e).cross(q2e.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){let t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){let n=t.delta(qy),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;let r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(n).multiplyScalar(r).add(t.start)}intersectsLine(t){let e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){let n=e||Z2e.getNormalMatrix(t),i=this.coplanarPoint(qy).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}};ra.prototype.isPlane=!0;var Fc=new Ac,Pf=new ee,Nf=class{constructor(t=new ra,e=new ra,n=new ra,i=new ra,r=new ra,s=new ra){this.planes=[t,e,n,i,r,s]}set(t,e,n,i,r,s){let a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(s),this}copy(t){let e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){let e=this.planes,n=t.elements,i=n[0],r=n[1],s=n[2],a=n[3],o=n[4],c=n[5],l=n[6],u=n[7],f=n[8],d=n[9],m=n[10],v=n[11],_=n[12],M=n[13],y=n[14],g=n[15];return e[0].setComponents(a-i,u-o,v-f,g-_).normalize(),e[1].setComponents(a+i,u+o,v+f,g+_).normalize(),e[2].setComponents(a+r,u+c,v+d,g+M).normalize(),e[3].setComponents(a-r,u-c,v-d,g-M).normalize(),e[4].setComponents(a-s,u-l,v-m,g-y).normalize(),e[5].setComponents(a+s,u+l,v+m,g+y).normalize(),this}intersectsObject(t){let e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Fc.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Fc)}intersectsSprite(t){return Fc.center.set(0,0,0),Fc.radius=.7071067811865476,Fc.applyMatrix4(t.matrixWorld),this.intersectsSphere(Fc)}intersectsSphere(t){let e=this.planes,n=t.center,i=-t.radius;for(let r=0;r<6;r++)if(e[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(t){let e=this.planes;for(let n=0;n<6;n++){let i=e[n];if(Pf.x=i.normal.x>0?t.max.x:t.min.x,Pf.y=i.normal.y>0?t.max.y:t.min.y,Pf.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(Pf)<0)return!1}return!0}containsPoint(t){let e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}};function nN(){let t=null,e=!1,n=null,i=null;function r(s,a){n(s,a),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function $2e(t,e){let n=e.isWebGL2,i=new WeakMap;return{get:function a(l){return l.isInterleavedBufferAttribute&&(l=l.data),i.get(l)},remove:function o(l){l.isInterleavedBufferAttribute&&(l=l.data);let u=i.get(l);u&&(t.deleteBuffer(u.buffer),i.delete(l))},update:function c(l,u){if(l.isGLBufferAttribute){let d=i.get(l);return void((!d||d.version<l.version)&&i.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version}))}l.isInterleavedBufferAttribute&&(l=l.data);let f=i.get(l);void 0===f?i.set(l,function r(l,u){let v,f=l.array,d=l.usage,m=t.createBuffer();if(t.bindBuffer(u,m),t.bufferData(u,f,d),l.onUploadCallback(),f instanceof Float32Array)v=5126;else if(f instanceof Uint16Array)if(l.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");v=5131}else v=5123;else if(f instanceof Int16Array)v=5122;else if(f instanceof Uint32Array)v=5125;else if(f instanceof Int32Array)v=5124;else if(f instanceof Int8Array)v=5120;else if(f instanceof Uint8Array)v=5121;else{if(!(f instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);v=5121}return{buffer:m,type:v,bytesPerElement:f.BYTES_PER_ELEMENT,version:l.version}}(l,u)):f.version<l.version&&(function s(l,u,f){let d=u.array,m=u.updateRange;t.bindBuffer(f,l),-1===m.count?t.bufferSubData(f,0,d):(n?t.bufferSubData(f,m.offset*d.BYTES_PER_ELEMENT,d,m.offset,m.count):t.bufferSubData(f,m.offset*d.BYTES_PER_ELEMENT,d.subarray(m.offset,m.offset+m.count)),m.count=-1)}(f.buffer,l,u),f.version=l.version)}}}var iN=class extends Q1{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};let r=t/2,s=e/2,a=Math.floor(n),o=Math.floor(i),c=a+1,l=o+1,u=t/a,f=e/o,d=[],m=[],v=[],_=[];for(let M=0;M<l;M++){let y=M*f-s;for(let g=0;g<c;g++)m.push(g*u-r,-y,0),v.push(0,0,1),_.push(g/a),_.push(1-M/o)}for(let M=0;M<o;M++)for(let y=0;y<a;y++){let S=y+c*(M+1),b=y+1+c*(M+1),E=y+1+c*M;d.push(y+c*M,S,E),d.push(S,b,E)}this.setIndex(d),this.setAttribute("position",new Xn(m,3)),this.setAttribute("normal",new Xn(v,3)),this.setAttribute("uv",new Xn(_,2))}static fromJSON(t){return new iN(t.width,t.height,t.widthSegments,t.heightSegments)}},Xt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ]\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tfloat texelIndex = float( vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Qe={common:{diffuse:{value:new gt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new li},uv2Transform:{value:new li},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ie(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new gt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new gt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new li}},sprite:{diffuse:{value:new gt(16777215)},opacity:{value:1},center:{value:new Ie(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new li}}},us={basic:{uniforms:zi([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.fog]),vertexShader:Xt.meshbasic_vert,fragmentShader:Xt.meshbasic_frag},lambert:{uniforms:zi([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.fog,Qe.lights,{emissive:{value:new gt(0)}}]),vertexShader:Xt.meshlambert_vert,fragmentShader:Xt.meshlambert_frag},phong:{uniforms:zi([Qe.common,Qe.specularmap,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.fog,Qe.lights,{emissive:{value:new gt(0)},specular:{value:new gt(1118481)},shininess:{value:30}}]),vertexShader:Xt.meshphong_vert,fragmentShader:Xt.meshphong_frag},standard:{uniforms:zi([Qe.common,Qe.envmap,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.roughnessmap,Qe.metalnessmap,Qe.fog,Qe.lights,{emissive:{value:new gt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Xt.meshphysical_vert,fragmentShader:Xt.meshphysical_frag},toon:{uniforms:zi([Qe.common,Qe.aomap,Qe.lightmap,Qe.emissivemap,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.gradientmap,Qe.fog,Qe.lights,{emissive:{value:new gt(0)}}]),vertexShader:Xt.meshtoon_vert,fragmentShader:Xt.meshtoon_frag},matcap:{uniforms:zi([Qe.common,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,Qe.fog,{matcap:{value:null}}]),vertexShader:Xt.meshmatcap_vert,fragmentShader:Xt.meshmatcap_frag},points:{uniforms:zi([Qe.points,Qe.fog]),vertexShader:Xt.points_vert,fragmentShader:Xt.points_frag},dashed:{uniforms:zi([Qe.common,Qe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Xt.linedashed_vert,fragmentShader:Xt.linedashed_frag},depth:{uniforms:zi([Qe.common,Qe.displacementmap]),vertexShader:Xt.depth_vert,fragmentShader:Xt.depth_frag},normal:{uniforms:zi([Qe.common,Qe.bumpmap,Qe.normalmap,Qe.displacementmap,{opacity:{value:1}}]),vertexShader:Xt.meshnormal_vert,fragmentShader:Xt.meshnormal_frag},sprite:{uniforms:zi([Qe.sprite,Qe.fog]),vertexShader:Xt.sprite_vert,fragmentShader:Xt.sprite_frag},background:{uniforms:{uvTransform:{value:new li},t2D:{value:null}},vertexShader:Xt.background_vert,fragmentShader:Xt.background_frag},cube:{uniforms:zi([Qe.envmap,{opacity:{value:1}}]),vertexShader:Xt.cube_vert,fragmentShader:Xt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Xt.equirect_vert,fragmentShader:Xt.equirect_frag},distanceRGBA:{uniforms:zi([Qe.common,Qe.displacementmap,{referencePosition:{value:new ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Xt.distanceRGBA_vert,fragmentShader:Xt.distanceRGBA_frag},shadow:{uniforms:zi([Qe.lights,Qe.fog,{color:{value:new gt(0)},opacity:{value:1}}]),vertexShader:Xt.shadow_vert,fragmentShader:Xt.shadow_frag}};function bae(t,e,n,i,r,s){let c,l,a=new gt(0),o=!0===r?0:1,u=null,f=0,d=null;function v(_,M){n.buffers.color.setClear(_.r,_.g,_.b,M,s)}return{getClearColor:function(){return a},setClearColor:function(_,M=1){a.set(_),o=M,v(a,o)},getClearAlpha:function(){return o},setClearAlpha:function(_){o=_,v(a,o)},render:function m(_,M){let y=!1,g=!0===M.isScene?M.background:null;g&&g.isTexture&&(g=e.get(g));let S=t.xr,b=S.getSession&&S.getSession();b&&"additive"===b.environmentBlendMode&&(g=null),null===g?v(a,o):g&&g.isColor&&(v(g,1),y=!0),(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),g&&(g.isCubeTexture||306===g.mapping)?(void 0===l&&(l=new s2(new Lf(1,1,1),new Hr({name:"BackgroundCubeMaterial",uniforms:Vc(us.cube.uniforms),vertexShader:us.cube.vertexShader,fragmentShader:us.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(E,P,V){this.matrixWorld.copyPosition(V.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1,(u!==g||f!==g.version||d!==t.toneMapping)&&(l.material.needsUpdate=!0,u=g,f=g.version,d=t.toneMapping),_.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(void 0===c&&(c=new s2(new iN(2,2),new Hr({name:"BackgroundMaterial",uniforms:Vc(us.background.uniforms),vertexShader:us.background.vertexShader,fragmentShader:us.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=g,!0===g.matrixAutoUpdate&&g.updateMatrix(),c.material.uniforms.uvTransform.value.copy(g.matrix),(u!==g||f!==g.version||d!==t.toneMapping)&&(c.material.needsUpdate=!0,u=g,f=g.version,d=t.toneMapping),_.unshift(c,c.geometry,c.material,0,0,null))}}}function wae(t,e,n,i){let r=t.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),a=i.isWebGL2||null!==s,o={},c=_(null),l=c;function d(F){return i.isWebGL2?t.bindVertexArray(F):s.bindVertexArrayOES(F)}function m(F){return i.isWebGL2?t.deleteVertexArray(F):s.deleteVertexArrayOES(F)}function _(F){let U=[],$=[],O=[];for(let I=0;I<r;I++)U[I]=0,$[I]=0,O[I]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:$,attributeDivisors:O,object:F,attributes:{},index:null}}function g(){let F=l.newAttributes;for(let U=0,$=F.length;U<$;U++)F[U]=0}function S(F){b(F,0)}function b(F,U){let O=l.enabledAttributes,I=l.attributeDivisors;l.newAttributes[F]=1,0===O[F]&&(t.enableVertexAttribArray(F),O[F]=1),I[F]!==U&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](F,U),I[F]=U)}function E(){let F=l.newAttributes,U=l.enabledAttributes;for(let $=0,O=U.length;$<O;$++)U[$]!==F[$]&&(t.disableVertexAttribArray($),U[$]=0)}function P(F,U,$,O,I,k){!0!==i.isWebGL2||5124!==$&&5125!==$?t.vertexAttribPointer(F,U,$,O,I,k):t.vertexAttribIPointer(F,U,$,I,k)}function C(){N(),l!==c&&(l=c,d(l.object))}function N(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function u(F,U,$,O,I){let k=!1;if(a){let K=function v(F,U,$){let O=!0===$.wireframe,I=o[F.id];void 0===I&&(I={},o[F.id]=I);let k=I[U.id];void 0===k&&(k={},I[U.id]=k);let K=k[O];return void 0===K&&(K=_(function f(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}()),k[O]=K),K}(O,$,U);l!==K&&(l=K,d(l.object)),k=function M(F,U){let $=l.attributes,O=F.attributes,I=0;for(let k in O){let K=$[k],re=O[k];if(void 0===K||K.attribute!==re||K.data!==re.data)return!0;I++}return l.attributesNum!==I||l.index!==U}(O,I),k&&function y(F,U){let $={},O=F.attributes,I=0;for(let k in O){let K=O[k],re={};re.attribute=K,K.data&&(re.data=K.data),$[k]=re,I++}l.attributes=$,l.attributesNum=I,l.index=U}(O,I)}else{let K=!0===U.wireframe;(l.geometry!==O.id||l.program!==$.id||l.wireframe!==K)&&(l.geometry=O.id,l.program=$.id,l.wireframe=K,k=!0)}!0===F.isInstancedMesh&&(k=!0),null!==I&&n.update(I,34963),k&&(function V(F,U,$,O){if(!1===i.isWebGL2&&(F.isInstancedMesh||O.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;g();let I=O.attributes,k=$.getAttributes(),K=U.defaultAttributeValues;for(let re in k){let ae=k[re];if(ae.location>=0){let ue=I[re];if(void 0===ue&&("instanceMatrix"===re&&F.instanceMatrix&&(ue=F.instanceMatrix),"instanceColor"===re&&F.instanceColor&&(ue=F.instanceColor)),void 0!==ue){let Le=ue.normalized,Oe=ue.itemSize,Pe=n.get(ue);if(void 0===Pe)continue;let ie=Pe.buffer,st=Pe.type,ke=Pe.bytesPerElement;if(ue.isInterleavedBufferAttribute){let _e=ue.data,oe=_e.stride,xe=ue.offset;if(_e.isInstancedInterleavedBuffer){for(let X=0;X<ae.locationSize;X++)b(ae.location+X,_e.meshPerAttribute);!0!==F.isInstancedMesh&&void 0===O._maxInstanceCount&&(O._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let X=0;X<ae.locationSize;X++)S(ae.location+X);t.bindBuffer(34962,ie);for(let X=0;X<ae.locationSize;X++)P(ae.location+X,Oe/ae.locationSize,st,Le,oe*ke,(xe+Oe/ae.locationSize*X)*ke)}else{if(ue.isInstancedBufferAttribute){for(let _e=0;_e<ae.locationSize;_e++)b(ae.location+_e,ue.meshPerAttribute);!0!==F.isInstancedMesh&&void 0===O._maxInstanceCount&&(O._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let _e=0;_e<ae.locationSize;_e++)S(ae.location+_e);t.bindBuffer(34962,ie);for(let _e=0;_e<ae.locationSize;_e++)P(ae.location+_e,Oe/ae.locationSize,st,Le,Oe*ke,Oe/ae.locationSize*_e*ke)}}else if(void 0!==K){let Le=K[re];if(void 0!==Le)switch(Le.length){case 2:t.vertexAttrib2fv(ae.location,Le);break;case 3:t.vertexAttrib3fv(ae.location,Le);break;case 4:t.vertexAttrib4fv(ae.location,Le);break;default:t.vertexAttrib1fv(ae.location,Le)}}}}E()}(F,U,$,O),null!==I&&t.bindBuffer(34963,n.get(I).buffer))},reset:C,resetDefaultState:N,dispose:function j(){C();for(let F in o){let U=o[F];for(let $ in U){let O=U[$];for(let I in O)m(O[I].object),delete O[I];delete U[$]}delete o[F]}},releaseStatesOfGeometry:function Y(F){if(void 0===o[F.id])return;let U=o[F.id];for(let $ in U){let O=U[$];for(let I in O)m(O[I].object),delete O[I];delete U[$]}delete o[F.id]},releaseStatesOfProgram:function G(F){for(let U in o){let $=o[U];if(void 0===$[F.id])continue;let O=$[F.id];for(let I in O)m(O[I].object),delete O[I];delete $[F.id]}},initAttributes:g,enableAttribute:S,disableUnusedAttributes:E}}function Sae(t,e,n,i){let s,r=i.isWebGL2;this.setMode=function a(l){s=l},this.render=function o(l,u){t.drawArrays(s,l,u),n.update(u,s,1)},this.renderInstances=function c(l,u,f){if(0===f)return;let d,m;if(r)d=t,m="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[m](s,l,u,f),n.update(u,s,f)}}function Cae(t,e,n){let i;function s(V){if("highp"===V){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";V="mediump"}return"mediump"===V&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&t instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",c=s(o);c!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",c,"instead."),o=c);let l=a||e.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,f=t.getParameter(34930),d=t.getParameter(35660),m=t.getParameter(3379),v=t.getParameter(34076),_=t.getParameter(34921),M=t.getParameter(36347),y=t.getParameter(36348),g=t.getParameter(36349),S=d>0,b=a||e.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){let V=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(V.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:f,maxVertexTextures:d,maxTextureSize:m,maxCubemapSize:v,maxAttributes:_,maxVertexUniforms:M,maxVaryings:y,maxFragmentUniforms:g,vertexTextures:S,floatFragmentTextures:b,floatVertexTextures:S&&b,maxSamples:a?t.getParameter(36183):0}}function Eae(t){let e=this,n=null,i=0,r=!1,s=!1,a=new ra,o=new li,c={value:null,needsUpdate:!1};function l(){c.value!==n&&(c.value=n,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(f,d,m,v){let _=null!==f?f.length:0,M=null;if(0!==_){if(M=c.value,!0!==v||null===M){let y=m+4*_,g=d.matrixWorldInverse;o.getNormalMatrix(g),(null===M||M.length<y)&&(M=new Float32Array(y));for(let S=0,b=m;S!==_;++S,b+=4)a.copy(f[S]).applyMatrix4(g,o),a.normal.toArray(M,b),M[b+3]=a.constant}c.value=M,c.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,M}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(f,d,m){let v=0!==f.length||d||0!==i||r;return r=d,n=u(f,m,0),i=f.length,v},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,l()},this.setState=function(f,d,m){let v=f.clippingPlanes,_=f.clipIntersection,M=f.clipShadows,y=t.get(f);if(!r||null===v||0===v.length||s&&!M)s?u(null):l();else{let g=s?0:i,S=4*g,b=y.clippingState||null;c.value=b,b=u(v,d,S,m);for(let E=0;E!==S;++E)b[E]=n[E];y.clippingState=b,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=g}}}function zae(t){let e=new WeakMap;function n(a,o){return 303===o?a.mapping=301:304===o&&(a.mapping=302),a}function r(a){let o=a.target;o.removeEventListener("dispose",r);let c=e.get(o);void 0!==c&&(e.delete(o),c.dispose())}return{get:function i(a){if(a&&a.isTexture&&!1===a.isRenderTargetTexture){let o=a.mapping;if(303===o||304===o){if(e.has(a))return n(e.get(a).texture,a.mapping);{let c=a.image;if(c&&c.height>0){let l=new tN(c.height/2);return l.fromEquirectangularTexture(t,a),e.set(a,l),a.addEventListener("dispose",r),n(l.texture,a.mapping)}return null}}}return a},dispose:function s(){e=new WeakMap}}}us.physical={uniforms:zi([us.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ie(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new gt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ie},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new gt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new gt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Xt.meshphysical_vert,fragmentShader:Xt.meshphysical_frag};var Zy=class extends Wy{constructor(t=-1,e=1,n=1,i=-1,r=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-t,s=n+t,a=i+e,o=i-e;if(null!==this.view&&this.view.enabled){let c=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=c*this.view.offsetX,s=r+c*this.view.width,a-=l*this.view.offsetY,o=a-l*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}};Zy.prototype.isOrthographicCamera=!0;var rN=[.125,.215,.35,.446,.526,.582],$y=new Zy,sN=new gt,Xy=null,O4=(1+Math.sqrt(5))/2,Uc=1/O4,aN=[new ee(1,1,1),new ee(-1,1,1),new ee(1,1,-1),new ee(-1,1,-1),new ee(0,O4,Uc),new ee(0,O4,-Uc),new ee(Uc,0,O4),new ee(-Uc,0,O4),new ee(O4,Uc,0),new ee(-O4,Uc,0)],oN=class{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){Xy=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=hN(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=lN(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(Xy),t.scissorTest=!1,Rf(t,0,0,t.width,t.height)}_fromTexture(t,e){this._setSize(301===t.mapping||302===t.mapping?0===t.image.length?16:t.image[0].width||t.image[0].image.width:t.image.width/4),Xy=this._renderer.getRenderTarget();let n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize-32,n={magFilter:Ei,minFilter:Ei,generateMipmaps:!1,type:yc,format:t2,encoding:io,depthBuffer:!1},i=cN(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=cN(t,e,n);let{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Tae(t){let e=[],n=[],i=[],r=t,s=t-4+1+rN.length;for(let a=0;a<s;a++){let o=Math.pow(2,r);n.push(o);let c=1/o;a>t-4?c=rN[a-t+4-1]:0===a&&(c=0),i.push(c);let l=1/(o-1),u=-l/2,f=1+l/2,d=[u,u,f,u,f,f,u,u,f,f,u,f],m=6,v=6,_=3,M=2,y=1,g=new Float32Array(_*v*m),S=new Float32Array(M*v*m),b=new Float32Array(y*v*m);for(let P=0;P<m;P++){let V=P%3*2/3-1,j=P>2?0:-1;g.set([V,j,0,V+2/3,j,0,V+2/3,j+1,0,V,j,0,V+2/3,j+1,0,V,j+1,0],_*v*P),S.set(d,M*v*P),b.set([P,P,P,P,P,P],y*v*P)}let E=new Q1;E.setAttribute("position",new On(g,_)),E.setAttribute("uv",new On(S,M)),E.setAttribute("faceIndex",new On(b,y)),e.push(E),r>4&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}(r)),this._blurMaterial=function Aae(t,e,n){let i=new Float32Array(20),r=new ee(0,1,0);return new Hr({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(r,t,e)}return i}_compileMaterial(t){let e=new s2(this._lodPlanes[0],t);this._renderer.compile(e,$y)}_sceneToCubeUV(t,e,n,i){let r=new a2(90,1,e,n),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,c=o.autoClear,l=o.toneMapping;o.getClearColor(sN),o.toneMapping=0,o.autoClear=!1;let u=new xf({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),f=new s2(new Lf,u),d=!1,m=t.background;m?m.isColor&&(u.color.copy(m),t.background=null,d=!0):(u.color.copy(sN),d=!0);for(let v=0;v<6;v++){let _=v%3;0===_?(r.up.set(0,s[v],0),r.lookAt(a[v],0,0)):1===_?(r.up.set(0,0,s[v]),r.lookAt(0,a[v],0)):(r.up.set(0,s[v],0),r.lookAt(0,0,a[v]));let M=this._cubeSize;Rf(i,_*M,v>2?M:0,M,M),o.setRenderTarget(i),d&&o.render(f,r),o.render(t,r)}f.geometry.dispose(),f.material.dispose(),o.toneMapping=l,o.autoClear=c,t.background=m}_textureToCubeUV(t,e){let n=this._renderer,i=301===t.mapping||302===t.mapping;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=hN()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=lN());let r=i?this._cubemapMaterial:this._equirectMaterial,s=new s2(this._lodPlanes[0],r);r.uniforms.envMap.value=t;let o=this._cubeSize;Rf(e,0,0,3*o,2*o),n.setRenderTarget(e),n.render(s,$y)}_applyPMREM(t){let e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let r=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]);this._blur(t,i-1,i,r,aN[(i-1)%aN.length])}e.autoClear=n}_blur(t,e,n,i,r){let s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,i,"latitudinal",r),this._halfBlur(s,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,s,a){let o=this._renderer,c=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");let u=new s2(this._lodPlanes[i],c),f=c.uniforms,d=this._sizeLods[n]-1,m=isFinite(r)?Math.PI/(2*d):2*Math.PI/39,v=r/m,_=isFinite(r)?1+Math.floor(3*v):20;_>20&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${_} samples when the maximum is set to 20`);let M=[],y=0;for(let P=0;P<20;++P){let V=P/v,j=Math.exp(-V*V/2);M.push(j),0===P?y+=j:P<_&&(y+=2*j)}for(let P=0;P<M.length;P++)M[P]=M[P]/y;f.envMap.value=t.texture,f.samples.value=_,f.weights.value=M,f.latitudinal.value="latitudinal"===s,a&&(f.poleAxis.value=a);let{_lodMax:g}=this;f.dTheta.value=m,f.mipInt.value=g-n;let S=this._sizeLods[i];Rf(e,3*S*(i>g-4?i-g+4:0),4*(this._cubeSize-S),3*S,2*S),o.setRenderTarget(e),o.render(u,$y)}};function cN(t,e,n){let i=new T2(t,e,n);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Rf(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function lN(){return new Hr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function hN(){return new Hr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Lae(t){let e=new WeakMap,n=null;function s(o){let c=o.target;c.removeEventListener("dispose",s);let l=e.get(c);void 0!==l&&(e.delete(c),l.dispose())}return{get:function i(o){if(o&&o.isTexture){let c=o.mapping,l=303===c||304===c,u=301===c||302===c;if(l||u){if(o.isRenderTargetTexture&&!0===o.needsPMREMUpdate){o.needsPMREMUpdate=!1;let f=e.get(o);return null===n&&(n=new oN(t)),f=l?n.fromEquirectangular(o,f):n.fromCubemap(o,f),e.set(o,f),f.texture}if(e.has(o))return e.get(o).texture;{let f=o.image;if(l&&f&&f.height>0||u&&f&&function r(o){let c=0;for(let u=0;u<6;u++)void 0!==o[u]&&c++;return 6===c}(f)){null===n&&(n=new oN(t));let d=l?n.fromEquirectangular(o):n.fromCubemap(o);return e.set(o,d),o.addEventListener("dispose",s),d.texture}return null}}}return o},dispose:function a(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Dae(t){let e={};function n(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==n(i)},init:function(i){i.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){let r=n(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Pae(t,e,n,i){let r={},s=new WeakMap;function a(f){let d=f.target;null!==d.index&&e.remove(d.index);for(let v in d.attributes)e.remove(d.attributes[v]);d.removeEventListener("dispose",a),delete r[d.id];let m=s.get(d);m&&(e.remove(m),s.delete(d)),i.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,n.memory.geometries--}function l(f){let d=[],m=f.index,v=f.attributes.position,_=0;if(null!==m){let g=m.array;_=m.version;for(let S=0,b=g.length;S<b;S+=3){let E=g[S+0],P=g[S+1],V=g[S+2];d.push(E,P,P,V,V,E)}}else{_=v.version;for(let S=0,b=v.array.length/3-1;S<b;S+=3){let E=S+0,P=S+1,V=S+2;d.push(E,P,P,V,V,E)}}let M=new(kP(d)?QP:KP)(d,1);M.version=_;let y=s.get(f);y&&e.remove(y),s.set(f,M)}return{get:function o(f,d){return!0===r[d.id]||(d.addEventListener("dispose",a),r[d.id]=!0,n.memory.geometries++),d},update:function c(f){let d=f.attributes;for(let v in d)e.update(d[v],34962);let m=f.morphAttributes;for(let v in m){let _=m[v];for(let M=0,y=_.length;M<y;M++)e.update(_[M],34962)}},getWireframeAttribute:function u(f){let d=s.get(f);if(d){let m=f.index;null!==m&&d.version<m.version&&l(f)}else l(f);return s.get(f)}}}function Nae(t,e,n,i){let s,o,c,r=i.isWebGL2;this.setMode=function a(d){s=d},this.setIndex=function l(d){o=d.type,c=d.bytesPerElement},this.render=function u(d,m){t.drawElements(s,m,o,d*c),n.update(m,s,1)},this.renderInstances=function f(d,m,v){if(0===v)return;let _,M;if(r)_=t,M="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),M="drawElementsInstancedANGLE",null===_)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");_[M](s,m,o,d*c,v),n.update(m,s,v)}}function Rae(t){let n={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:n,programs:null,autoReset:!0,reset:function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0},update:function i(s,a,o){switch(n.calls++,a){case 4:n.triangles+=o*(s/3);break;case 1:n.lines+=o*(s/2);break;case 3:n.lines+=o*(s-1);break;case 2:n.lines+=o*s;break;case 0:n.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}function Hae(t,e){return t[0]-e[0]}function Iae(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Jy(t,e){let n=1,i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?n=127:i instanceof Int16Array?n=32767:i instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),t.divideScalar(n)}function Vae(t,e,n){let i={},r=new Float32Array(8),s=new WeakMap,a=new b1,o=[];for(let l=0;l<8;l++)o[l]=[l,0];return{update:function c(l,u,f,d){let m=l.morphTargetInfluences;if(!0===e.isWebGL2){let v=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,_=void 0!==v?v.length:0,M=s.get(u);if(void 0===M||M.count!==_){let S=function(){U.dispose(),s.delete(u),u.removeEventListener("dispose",S)};void 0!==M&&M.texture.dispose();let b=void 0!==u.morphAttributes.position,E=void 0!==u.morphAttributes.normal,P=void 0!==u.morphAttributes.color,V=u.morphAttributes.position||[],j=u.morphAttributes.normal||[],Y=u.morphAttributes.color||[],G=0;!0===b&&(G=1),!0===E&&(G=2),!0===P&&(G=3);let C=u.attributes.position.count*G,N=1;C>e.maxTextureSize&&(N=Math.ceil(C/e.maxTextureSize),C=e.maxTextureSize);let F=new Float32Array(C*N*4*_),U=new ff(F,C,N,_);U.format=t2,U.type=A4,U.needsUpdate=!0;let $=4*G;for(let O=0;O<_;O++){let I=V[O],k=j[O],K=Y[O],re=C*N*4*O;for(let ae=0;ae<I.count;ae++){let ue=ae*$;!0===b&&(a.fromBufferAttribute(I,ae),!0===I.normalized&&Jy(a,I),F[re+ue+0]=a.x,F[re+ue+1]=a.y,F[re+ue+2]=a.z,F[re+ue+3]=0),!0===E&&(a.fromBufferAttribute(k,ae),!0===k.normalized&&Jy(a,k),F[re+ue+4]=a.x,F[re+ue+5]=a.y,F[re+ue+6]=a.z,F[re+ue+7]=0),!0===P&&(a.fromBufferAttribute(K,ae),!0===K.normalized&&Jy(a,k),F[re+ue+8]=a.x,F[re+ue+9]=a.y,F[re+ue+10]=a.z,F[re+ue+11]=4===K.itemSize?a.w:1)}}M={count:_,texture:U,size:new Ie(C,N)},s.set(u,M),u.addEventListener("dispose",S)}let y=0;for(let S=0;S<m.length;S++)y+=m[S];let g=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(t,"morphTargetBaseInfluence",g),d.getUniforms().setValue(t,"morphTargetInfluences",m),d.getUniforms().setValue(t,"morphTargetsTexture",M.texture,n),d.getUniforms().setValue(t,"morphTargetsTextureSize",M.size)}else{let v=void 0===m?0:m.length,_=i[u.id];if(void 0===_||_.length!==v){_=[];for(let b=0;b<v;b++)_[b]=[b,0];i[u.id]=_}for(let b=0;b<v;b++){let E=_[b];E[0]=b,E[1]=m[b]}_.sort(Iae);for(let b=0;b<8;b++)b<v&&_[b][1]?(o[b][0]=_[b][0],o[b][1]=_[b][1]):(o[b][0]=Number.MAX_SAFE_INTEGER,o[b][1]=0);o.sort(Hae);let M=u.morphAttributes.position,y=u.morphAttributes.normal,g=0;for(let b=0;b<8;b++){let E=o[b],P=E[0],V=E[1];P!==Number.MAX_SAFE_INTEGER&&V?(M&&u.getAttribute("morphTarget"+b)!==M[P]&&u.setAttribute("morphTarget"+b,M[P]),y&&u.getAttribute("morphNormal"+b)!==y[P]&&u.setAttribute("morphNormal"+b,y[P]),r[b]=V,g+=V):(M&&!0===u.hasAttribute("morphTarget"+b)&&u.deleteAttribute("morphTarget"+b),y&&!0===u.hasAttribute("morphNormal"+b)&&u.deleteAttribute("morphNormal"+b),r[b]=0)}let S=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(t,"morphTargetBaseInfluence",S),d.getUniforms().setValue(t,"morphTargetInfluences",r)}}}}function Oae(t,e,n,i){let r=new WeakMap;function o(c){let l=c.target;l.removeEventListener("dispose",o),n.remove(l.instanceMatrix),null!==l.instanceColor&&n.remove(l.instanceColor)}return{update:function s(c){let l=i.render.frame,f=e.get(c,c.geometry);return r.get(f)!==l&&(e.update(f),r.set(f,l)),c.isInstancedMesh&&(!1===c.hasEventListener("dispose",o)&&c.addEventListener("dispose",o),n.update(c.instanceMatrix,34962),null!==c.instanceColor&&n.update(c.instanceColor,34962)),f},dispose:function a(){r=new WeakMap}}}var uN=new hi,fN=new ff,dN=new Cy,pN=new Df,mN=[],gN=[],vN=new Float32Array(16),yN=new Float32Array(9),_N=new Float32Array(4);function Gc(t,e,n){let i=t[0];if(i<=0||i>0)return t;let r=e*n,s=mN[r];if(void 0===s&&(s=new Float32Array(r),mN[r]=s),0!==e){i.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=n,t[a].toArray(s,o)}return s}function Ui(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Ti(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function Hf(t,e){let n=gN[e];void 0===n&&(n=new Int32Array(e),gN[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function kae(t,e){let n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Fae(t,e){let n=this.cache;if(void 0!==e.x)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Ui(n,e))return;t.uniform2fv(this.addr,e),Ti(n,e)}}function Bae(t,e){let n=this.cache;if(void 0!==e.x)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Ui(n,e))return;t.uniform3fv(this.addr,e),Ti(n,e)}}function Uae(t,e){let n=this.cache;if(void 0!==e.x)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Ui(n,e))return;t.uniform4fv(this.addr,e),Ti(n,e)}}function Gae(t,e){let n=this.cache,i=e.elements;if(void 0===i){if(Ui(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Ti(n,e)}else{if(Ui(n,i))return;_N.set(i),t.uniformMatrix2fv(this.addr,!1,_N),Ti(n,i)}}function Wae(t,e){let n=this.cache,i=e.elements;if(void 0===i){if(Ui(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Ti(n,e)}else{if(Ui(n,i))return;yN.set(i),t.uniformMatrix3fv(this.addr,!1,yN),Ti(n,i)}}function jae(t,e){let n=this.cache,i=e.elements;if(void 0===i){if(Ui(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Ti(n,e)}else{if(Ui(n,i))return;vN.set(i),t.uniformMatrix4fv(this.addr,!1,vN),Ti(n,i)}}function qae(t,e){let n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Zae(t,e){let n=this.cache;Ui(n,e)||(t.uniform2iv(this.addr,e),Ti(n,e))}function $ae(t,e){let n=this.cache;Ui(n,e)||(t.uniform3iv(this.addr,e),Ti(n,e))}function Xae(t,e){let n=this.cache;Ui(n,e)||(t.uniform4iv(this.addr,e),Ti(n,e))}function Yae(t,e){let n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Jae(t,e){let n=this.cache;Ui(n,e)||(t.uniform2uiv(this.addr,e),Ti(n,e))}function Kae(t,e){let n=this.cache;Ui(n,e)||(t.uniform3uiv(this.addr,e),Ti(n,e))}function Qae(t,e){let n=this.cache;Ui(n,e)||(t.uniform4uiv(this.addr,e),Ti(n,e))}function eoe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||uN,r)}function toe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||dN,r)}function noe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||pN,r)}function ioe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||fN,r)}function soe(t,e){t.uniform1fv(this.addr,e)}function aoe(t,e){let n=Gc(e,this.size,2);t.uniform2fv(this.addr,n)}function ooe(t,e){let n=Gc(e,this.size,3);t.uniform3fv(this.addr,n)}function coe(t,e){let n=Gc(e,this.size,4);t.uniform4fv(this.addr,n)}function loe(t,e){let n=Gc(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function hoe(t,e){let n=Gc(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function uoe(t,e){let n=Gc(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function foe(t,e){t.uniform1iv(this.addr,e)}function doe(t,e){t.uniform2iv(this.addr,e)}function poe(t,e){t.uniform3iv(this.addr,e)}function moe(t,e){t.uniform4iv(this.addr,e)}function goe(t,e){t.uniform1uiv(this.addr,e)}function voe(t,e){t.uniform2uiv(this.addr,e)}function yoe(t,e){t.uniform3uiv(this.addr,e)}function _oe(t,e){t.uniform4uiv(this.addr,e)}function xoe(t,e,n){let i=e.length,r=Hf(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTexture2D(e[s]||uN,r[s])}function Moe(t,e,n){let i=e.length,r=Hf(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTexture3D(e[s]||dN,r[s])}function boe(t,e,n){let i=e.length,r=Hf(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTextureCube(e[s]||pN,r[s])}function woe(t,e,n){let i=e.length,r=Hf(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.setTexture2DArray(e[s]||fN,r[s])}function Coe(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function roe(t){switch(t){case 5126:return kae;case 35664:return Fae;case 35665:return Bae;case 35666:return Uae;case 35674:return Gae;case 35675:return Wae;case 35676:return jae;case 5124:case 35670:return qae;case 35667:case 35671:return Zae;case 35668:case 35672:return $ae;case 35669:case 35673:return Xae;case 5125:return Yae;case 36294:return Jae;case 36295:return Kae;case 36296:return Qae;case 35678:case 36198:case 36298:case 36306:case 35682:return eoe;case 35679:case 36299:case 36307:return toe;case 35680:case 36300:case 36308:case 36293:return noe;case 36289:case 36303:case 36311:case 36292:return ioe}}(e.type)}function xN(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function Soe(t){switch(t){case 5126:return soe;case 35664:return aoe;case 35665:return ooe;case 35666:return coe;case 35674:return loe;case 35675:return hoe;case 35676:return uoe;case 5124:case 35670:return foe;case 35667:case 35671:return doe;case 35668:case 35672:return poe;case 35669:case 35673:return moe;case 5125:return goe;case 36294:return voe;case 36295:return yoe;case 36296:return _oe;case 35678:case 36198:case 36298:case 36306:case 35682:return xoe;case 35679:case 36299:case 36307:return Moe;case 35680:case 36300:case 36308:case 36293:return boe;case 36289:case 36303:case 36311:case 36292:return woe}}(e.type)}function MN(t){this.id=t,this.seq=[],this.map={}}xN.prototype.updateCache=function(t){let e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),Ti(e,t)},MN.prototype.setValue=function(t,e,n){let i=this.seq;for(let r=0,s=i.length;r!==s;++r){let a=i[r];a.setValue(t,e[a.id],n)}};var Ky=/(\w+)(\])?(\[|\.)?/g;function bN(t,e){t.seq.push(e),t.map[e.id]=e}function Eoe(t,e,n){let i=t.name,r=i.length;for(Ky.lastIndex=0;;){let s=Ky.exec(i),a=Ky.lastIndex,o=s[1],l=s[3];if("]"===s[2]&&(o|=0),void 0===l||"["===l&&a+2===r){bN(n,void 0===l?new Coe(o,t,e):new xN(o,t,e));break}{let u=n.map[o];void 0===u&&(u=new MN(o),bN(n,u)),n=u}}}function uo(t,e){this.seq=[],this.map={};let n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){let r=t.getActiveUniform(e,i);Eoe(r,t.getUniformLocation(e,r.name),this)}}function wN(t,e,n){let i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}uo.prototype.setValue=function(t,e,n,i){let r=this.map[e];void 0!==r&&r.setValue(t,n,i)},uo.prototype.setOptional=function(t,e,n){let i=e[n];void 0!==i&&this.setValue(t,n,i)},uo.upload=function(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){let a=e[r],o=n[a.id];!1!==o.needsUpdate&&a.setValue(t,o.value,i)}},uo.seqWithValue=function(t,e){let n=[];for(let i=0,r=t.length;i!==r;++i){let s=t[i];s.id in e&&n.push(s)}return n};var zoe=0;function SN(t,e,n){let i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();return i&&""===r?"":n.toUpperCase()+"\n\n"+r+"\n\n"+function Toe(t){let e=t.split("\n");for(let n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function Loe(t,e){let n=function Aoe(t){switch(t){case io:return["Linear","( value )"];case W1:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Doe(t,e){let n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function N8(t){return""!==t}function CN(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function EN(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var Hoe=/^[ \t]*#include +<([\w\d./]+)>/gm;function Qy(t){return t.replace(Hoe,Ioe)}function Ioe(t,e){let n=Xt[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Qy(n)}var Voe=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ooe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function zN(t){return t.replace(Ooe,TN).replace(Voe,koe)}function koe(t,e,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),TN(0,e,n,i)}function TN(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function AN(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function joe(t,e,n,i){let M,y,r=t.getContext(),s=n.defines,a=n.vertexShader,o=n.fragmentShader,c=function Foe(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),l=function Boe(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),u=function Uoe(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(n),f=function Goe(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),d=function Woe(t){let e=t.envMapCubeUVHeight;if(null===e)return null;let n=Math.log2(e/32+1)+3,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),m=n.isWebGL2?"":function Poe(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(N8).join("\n")}(n),v=function Noe(t){let e=[];for(let n in t){let i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(s),_=r.createProgram(),g=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(M=[v].filter(N8).join("\n"),M.length>0&&(M+="\n"),y=[m,v].filter(N8).join("\n"),y.length>0&&(y+="\n")):(M=[AN(n),"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(N8).join("\n"),y=[m,AN(n),"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+u:"",n.envMap?"#define "+f:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Xt.tonemapping_pars_fragment:"",0!==n.toneMapping?Doe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Xt.encodings_pars_fragment,Loe("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(N8).join("\n")),a=Qy(a),a=CN(a,n),a=EN(a,n),o=Qy(o),o=CN(o,n),o=EN(o,n),a=zN(a),o=zN(o),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(g="#version 300 es\n",M=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+M,y=["#define varying in","300 es"===n.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===n.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);let V,j,b=g+y+o,E=wN(r,35633,g+M+a),P=wN(r,35632,b);if(r.attachShader(_,E),r.attachShader(_,P),void 0!==n.index0AttributeName?r.bindAttribLocation(_,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_),t.debug.checkShaderErrors){let Y=r.getProgramInfoLog(_).trim(),G=r.getShaderInfoLog(E).trim(),C=r.getShaderInfoLog(P).trim(),N=!0,F=!0;if(!1===r.getProgramParameter(_,35714)){N=!1;let U=SN(r,E,"vertex"),$=SN(r,P,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,35715)+"\n\nProgram Info Log: "+Y+"\n"+U+"\n"+$)}else""!==Y?console.warn("THREE.WebGLProgram: Program Info Log:",Y):(""===G||""===C)&&(F=!1);F&&(this.diagnostics={runnable:N,programLog:Y,vertexShader:{log:G,prefix:M},fragmentShader:{log:C,prefix:y}})}return r.deleteShader(E),r.deleteShader(P),this.getUniforms=function(){return void 0===V&&(V=new uo(r,_)),V},this.getAttributes=function(){return void 0===j&&(j=function Roe(t,e){let n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){let s=t.getActiveAttrib(e,r),a=s.name,o=1;35674===s.type&&(o=2),35675===s.type&&(o=3),35676===s.type&&(o=4),n[a]={type:s.type,location:t.getAttribLocation(e,a),locationSize:o}}return n}(r,_)),j},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.name=n.shaderName,this.id=zoe++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=E,this.fragmentShader=P,this}var qoe=0;function Xoe(t,e,n,i,r,s,a){let o=new Ny,c=new class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){let n=t.fragmentShader,i=this._getShaderStage(t.vertexShader),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(t){let e=this.materialCache.get(t);for(let n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){let e=this.materialCache;return!1===e.has(t)&&e.set(t,new Set),e.get(t)}_getShaderStage(t){let e=this.shaderCache;if(!1===e.has(t)){let n=new class{constructor(){this.id=qoe++,this.usedTimes=0}};e.set(t,n)}return e.get(t)}},l=[],u=r.isWebGL2,f=r.logarithmicDepthBuffer,d=r.floatVertexTextures,m=r.maxVertexUniforms,v=r.vertexTextures,_=r.precision,M={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function g(C,N,F,U,$){let O=U.fog,I=$.geometry,K=(C.isMeshStandardMaterial?n:e).get(C.envMap||(C.isMeshStandardMaterial?U.environment:null)),re=!K||306!==K.mapping&&307!==K.mapping?null:K.image.height,ae=M[C.type],ue=$.isSkinnedMesh?function y(C){let N=C.skeleton.bones;if(d)return 1024;{let F=Math.floor((m-20)/4),U=Math.min(F,N.length);return U<N.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+N.length+" bones. This GPU supports "+U+"."),0):U}}($):0;null!==C.precision&&(_=r.getMaxPrecision(C.precision),_!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",_,"instead."));let ie,st,ke,_e,Le=I.morphAttributes.position||I.morphAttributes.normal||I.morphAttributes.color,Oe=void 0!==Le?Le.length:0,Pe=0;if(void 0!==I.morphAttributes.position&&(Pe=1),void 0!==I.morphAttributes.normal&&(Pe=2),void 0!==I.morphAttributes.color&&(Pe=3),ae){let fe=us[ae];ie=fe.vertexShader,st=fe.fragmentShader}else ie=C.vertexShader,st=C.fragmentShader,c.update(C),ke=c.getVertexShaderID(C),_e=c.getFragmentShaderID(C);let oe=t.getRenderTarget(),X=C.clearcoat>0;return{isWebGL2:u,shaderID:ae,shaderName:C.type,vertexShader:ie,fragmentShader:st,defines:C.defines,customVertexShaderID:ke,customFragmentShaderID:_e,isRawShaderMaterial:!0===C.isRawShaderMaterial,glslVersion:C.glslVersion,precision:_,instancing:!0===$.isInstancedMesh,instancingColor:!0===$.isInstancedMesh&&null!==$.instanceColor,supportsVertexTextures:v,outputEncoding:null===oe?t.outputEncoding:!0===oe.isXRRenderTarget?oe.texture.encoding:io,map:!!C.map,matcap:!!C.matcap,envMap:!!K,envMapMode:K&&K.mapping,envMapCubeUVHeight:re,lightMap:!!C.lightMap,aoMap:!!C.aoMap,emissiveMap:!!C.emissiveMap,bumpMap:!!C.bumpMap,normalMap:!!C.normalMap,objectSpaceNormalMap:1===C.normalMapType,tangentSpaceNormalMap:0===C.normalMapType,decodeVideoTexture:!!C.map&&!0===C.map.isVideoTexture&&C.map.encoding===W1,clearcoat:X,clearcoatMap:X&&!!C.clearcoatMap,clearcoatRoughnessMap:X&&!!C.clearcoatRoughnessMap,clearcoatNormalMap:X&&!!C.clearcoatNormalMap,displacementMap:!!C.displacementMap,roughnessMap:!!C.roughnessMap,metalnessMap:!!C.metalnessMap,specularMap:!!C.specularMap,specularIntensityMap:!!C.specularIntensityMap,specularColorMap:!!C.specularColorMap,opaque:!1===C.transparent&&1===C.blending,alphaMap:!!C.alphaMap,alphaTest:C.alphaTest>0,gradientMap:!!C.gradientMap,sheen:C.sheen>0,sheenColorMap:!!C.sheenColorMap,sheenRoughnessMap:!!C.sheenRoughnessMap,transmission:C.transmission>0,transmissionMap:!!C.transmissionMap,thicknessMap:!!C.thicknessMap,combine:C.combine,vertexTangents:!!C.normalMap&&!!I.attributes.tangent,vertexColors:C.vertexColors,vertexAlphas:!0===C.vertexColors&&!!I.attributes.color&&4===I.attributes.color.itemSize,vertexUvs:!!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatMap||C.clearcoatRoughnessMap||C.clearcoatNormalMap||C.displacementMap||C.transmissionMap||C.thicknessMap||C.specularIntensityMap||C.specularColorMap||C.sheenColorMap||C.sheenRoughnessMap),uvsVertexOnly:!(C.map||C.bumpMap||C.normalMap||C.specularMap||C.alphaMap||C.emissiveMap||C.roughnessMap||C.metalnessMap||C.clearcoatNormalMap||C.transmission>0||C.transmissionMap||C.thicknessMap||C.specularIntensityMap||C.specularColorMap||C.sheen>0||C.sheenColorMap||C.sheenRoughnessMap||!C.displacementMap),fog:!!O,useFog:C.fog,fogExp2:O&&O.isFogExp2,flatShading:!!C.flatShading,sizeAttenuation:C.sizeAttenuation,logarithmicDepthBuffer:f,skinning:!0===$.isSkinnedMesh&&ue>0,maxBones:ue,useVertexTexture:d,morphTargets:void 0!==I.morphAttributes.position,morphNormals:void 0!==I.morphAttributes.normal,morphColors:void 0!==I.morphAttributes.color,morphTargetsCount:Oe,morphTextureStride:Pe,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:C.dithering,shadowMapEnabled:t.shadowMap.enabled&&F.length>0,shadowMapType:t.shadowMap.type,toneMapping:C.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:C.premultipliedAlpha,doubleSided:2===C.side,flipSided:1===C.side,depthPacking:void 0!==C.depthPacking&&C.depthPacking,index0AttributeName:C.index0AttributeName,extensionDerivatives:C.extensions&&C.extensions.derivatives,extensionFragDepth:C.extensions&&C.extensions.fragDepth,extensionDrawBuffers:C.extensions&&C.extensions.drawBuffers,extensionShaderTextureLOD:C.extensions&&C.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}},getProgramCacheKey:function S(C){let N=[];if(C.shaderID?N.push(C.shaderID):(N.push(C.customVertexShaderID),N.push(C.customFragmentShaderID)),void 0!==C.defines)for(let F in C.defines)N.push(F),N.push(C.defines[F]);return!1===C.isRawShaderMaterial&&(function b(C,N){C.push(N.precision),C.push(N.outputEncoding),C.push(N.envMapMode),C.push(N.envMapCubeUVHeight),C.push(N.combine),C.push(N.vertexUvs),C.push(N.fogExp2),C.push(N.sizeAttenuation),C.push(N.maxBones),C.push(N.morphTargetsCount),C.push(N.morphAttributeCount),C.push(N.numDirLights),C.push(N.numPointLights),C.push(N.numSpotLights),C.push(N.numHemiLights),C.push(N.numRectAreaLights),C.push(N.numDirLightShadows),C.push(N.numPointLightShadows),C.push(N.numSpotLightShadows),C.push(N.shadowMapType),C.push(N.toneMapping),C.push(N.numClippingPlanes),C.push(N.numClipIntersection)}(N,C),function E(C,N){o.disableAll(),N.isWebGL2&&o.enable(0),N.supportsVertexTextures&&o.enable(1),N.instancing&&o.enable(2),N.instancingColor&&o.enable(3),N.map&&o.enable(4),N.matcap&&o.enable(5),N.envMap&&o.enable(6),N.lightMap&&o.enable(7),N.aoMap&&o.enable(8),N.emissiveMap&&o.enable(9),N.bumpMap&&o.enable(10),N.normalMap&&o.enable(11),N.objectSpaceNormalMap&&o.enable(12),N.tangentSpaceNormalMap&&o.enable(13),N.clearcoat&&o.enable(14),N.clearcoatMap&&o.enable(15),N.clearcoatRoughnessMap&&o.enable(16),N.clearcoatNormalMap&&o.enable(17),N.displacementMap&&o.enable(18),N.specularMap&&o.enable(19),N.roughnessMap&&o.enable(20),N.metalnessMap&&o.enable(21),N.gradientMap&&o.enable(22),N.alphaMap&&o.enable(23),N.alphaTest&&o.enable(24),N.vertexColors&&o.enable(25),N.vertexAlphas&&o.enable(26),N.vertexUvs&&o.enable(27),N.vertexTangents&&o.enable(28),N.uvsVertexOnly&&o.enable(29),N.fog&&o.enable(30),C.push(o.mask),o.disableAll(),N.useFog&&o.enable(0),N.flatShading&&o.enable(1),N.logarithmicDepthBuffer&&o.enable(2),N.skinning&&o.enable(3),N.useVertexTexture&&o.enable(4),N.morphTargets&&o.enable(5),N.morphNormals&&o.enable(6),N.morphColors&&o.enable(7),N.premultipliedAlpha&&o.enable(8),N.shadowMapEnabled&&o.enable(9),N.physicallyCorrectLights&&o.enable(10),N.doubleSided&&o.enable(11),N.flipSided&&o.enable(12),N.depthPacking&&o.enable(13),N.dithering&&o.enable(14),N.specularIntensityMap&&o.enable(15),N.specularColorMap&&o.enable(16),N.transmission&&o.enable(17),N.transmissionMap&&o.enable(18),N.thicknessMap&&o.enable(19),N.sheen&&o.enable(20),N.sheenColorMap&&o.enable(21),N.sheenRoughnessMap&&o.enable(22),N.decodeVideoTexture&&o.enable(23),N.opaque&&o.enable(24),C.push(o.mask)}(N,C),N.push(t.outputEncoding)),N.push(C.customProgramCacheKey),N.join()},getUniforms:function P(C){let F,N=M[C.type];return F=N?G2e.clone(us[N].uniforms):C.uniforms,F},acquireProgram:function V(C,N){let F;for(let U=0,$=l.length;U<$;U++){let O=l[U];if(O.cacheKey===N){F=O,++F.usedTimes;break}}return void 0===F&&(F=new joe(t,N,C,s),l.push(F)),F},releaseProgram:function j(C){if(0==--C.usedTimes){let N=l.indexOf(C);l[N]=l[l.length-1],l.pop(),C.destroy()}},releaseShaderCache:function Y(C){c.remove(C)},programs:l,dispose:function G(){c.dispose()}}}function Yoe(){let t=new WeakMap;return{get:function e(s){let a=t.get(s);return void 0===a&&(a={},t.set(s,a)),a},remove:function n(s){t.delete(s)},update:function i(s,a,o){t.get(s)[a]=o},dispose:function r(){t=new WeakMap}}}function Joe(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function LN(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function DN(){let t=[],e=0,n=[],i=[],r=[];function a(f,d,m,v,_,M){let y=t[e];return void 0===y?(y={id:f.id,object:f,geometry:d,material:m,groupOrder:v,renderOrder:f.renderOrder,z:_,group:M},t[e]=y):(y.id=f.id,y.object=f,y.geometry=d,y.material=m,y.groupOrder=v,y.renderOrder=f.renderOrder,y.z=_,y.group=M),e++,y}return{opaque:n,transmissive:i,transparent:r,init:function s(){e=0,n.length=0,i.length=0,r.length=0},push:function o(f,d,m,v,_,M){let y=a(f,d,m,v,_,M);m.transmission>0?i.push(y):!0===m.transparent?r.push(y):n.push(y)},unshift:function c(f,d,m,v,_,M){let y=a(f,d,m,v,_,M);m.transmission>0?i.unshift(y):!0===m.transparent?r.unshift(y):n.unshift(y)},finish:function u(){for(let f=e,d=t.length;f<d;f++){let m=t[f];if(null===m.id)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}},sort:function l(f,d){n.length>1&&n.sort(f||Joe),i.length>1&&i.sort(d||LN),r.length>1&&r.sort(d||LN)}}}function Koe(){let t=new WeakMap;return{get:function e(i,r){let s;return!1===t.has(i)?(s=new DN,t.set(i,[s])):r>=t.get(i).length?(s=new DN,t.get(i).push(s)):s=t.get(i)[r],s},dispose:function n(){t=new WeakMap}}}function Qoe(){let t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new ee,color:new gt};break;case"SpotLight":n={position:new ee,direction:new ee,color:new gt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ee,color:new gt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ee,skyColor:new gt,groundColor:new gt};break;case"RectAreaLight":n={color:new gt,position:new ee,halfWidth:new ee,halfHeight:new ee}}return t[e.id]=n,n}}}var t4e=0;function n4e(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function i4e(t,e){let n=new Qoe,i=function e4e(){let t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new ee);let s=new ee,a=new Ct,o=new Ct;return{setup:function c(u,f){let d=0,m=0,v=0;for(let Y=0;Y<9;Y++)r.probe[Y].set(0,0,0);let _=0,M=0,y=0,g=0,S=0,b=0,E=0,P=0;u.sort(n4e);let V=!0!==f?Math.PI:1;for(let Y=0,G=u.length;Y<G;Y++){let C=u[Y],N=C.color,F=C.intensity,U=C.distance,$=C.shadow&&C.shadow.map?C.shadow.map.texture:null;if(C.isAmbientLight)d+=N.r*F*V,m+=N.g*F*V,v+=N.b*F*V;else if(C.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(C.sh.coefficients[O],F);else if(C.isDirectionalLight){let O=n.get(C);if(O.color.copy(C.color).multiplyScalar(C.intensity*V),C.castShadow){let I=C.shadow,k=i.get(C);k.shadowBias=I.bias,k.shadowNormalBias=I.normalBias,k.shadowRadius=I.radius,k.shadowMapSize=I.mapSize,r.directionalShadow[_]=k,r.directionalShadowMap[_]=$,r.directionalShadowMatrix[_]=C.shadow.matrix,b++}r.directional[_]=O,_++}else if(C.isSpotLight){let O=n.get(C);if(O.position.setFromMatrixPosition(C.matrixWorld),O.color.copy(N).multiplyScalar(F*V),O.distance=U,O.coneCos=Math.cos(C.angle),O.penumbraCos=Math.cos(C.angle*(1-C.penumbra)),O.decay=C.decay,C.castShadow){let I=C.shadow,k=i.get(C);k.shadowBias=I.bias,k.shadowNormalBias=I.normalBias,k.shadowRadius=I.radius,k.shadowMapSize=I.mapSize,r.spotShadow[y]=k,r.spotShadowMap[y]=$,r.spotShadowMatrix[y]=C.shadow.matrix,P++}r.spot[y]=O,y++}else if(C.isRectAreaLight){let O=n.get(C);O.color.copy(N).multiplyScalar(F),O.halfWidth.set(.5*C.width,0,0),O.halfHeight.set(0,.5*C.height,0),r.rectArea[g]=O,g++}else if(C.isPointLight){let O=n.get(C);if(O.color.copy(C.color).multiplyScalar(C.intensity*V),O.distance=C.distance,O.decay=C.decay,C.castShadow){let I=C.shadow,k=i.get(C);k.shadowBias=I.bias,k.shadowNormalBias=I.normalBias,k.shadowRadius=I.radius,k.shadowMapSize=I.mapSize,k.shadowCameraNear=I.camera.near,k.shadowCameraFar=I.camera.far,r.pointShadow[M]=k,r.pointShadowMap[M]=$,r.pointShadowMatrix[M]=C.shadow.matrix,E++}r.point[M]=O,M++}else if(C.isHemisphereLight){let O=n.get(C);O.skyColor.copy(C.color).multiplyScalar(F*V),O.groundColor.copy(C.groundColor).multiplyScalar(F*V),r.hemi[S]=O,S++}}g>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=Qe.LTC_FLOAT_1,r.rectAreaLTC2=Qe.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Qe.LTC_HALF_1,r.rectAreaLTC2=Qe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=m,r.ambient[2]=v;let j=r.hash;(j.directionalLength!==_||j.pointLength!==M||j.spotLength!==y||j.rectAreaLength!==g||j.hemiLength!==S||j.numDirectionalShadows!==b||j.numPointShadows!==E||j.numSpotShadows!==P)&&(r.directional.length=_,r.spot.length=y,r.rectArea.length=g,r.point.length=M,r.hemi.length=S,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=E,r.pointShadowMap.length=E,r.spotShadow.length=P,r.spotShadowMap.length=P,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=E,r.spotShadowMatrix.length=P,j.directionalLength=_,j.pointLength=M,j.spotLength=y,j.rectAreaLength=g,j.hemiLength=S,j.numDirectionalShadows=b,j.numPointShadows=E,j.numSpotShadows=P,r.version=t4e++)},setupView:function l(u,f){let d=0,m=0,v=0,_=0,M=0,y=f.matrixWorldInverse;for(let g=0,S=u.length;g<S;g++){let b=u[g];if(b.isDirectionalLight){let E=r.directional[d];E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(y),d++}else if(b.isSpotLight){let E=r.spot[v];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(y),E.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(y),v++}else if(b.isRectAreaLight){let E=r.rectArea[_];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(y),o.identity(),a.copy(b.matrixWorld),a.premultiply(y),o.extractRotation(a),E.halfWidth.set(.5*b.width,0,0),E.halfHeight.set(0,.5*b.height,0),E.halfWidth.applyMatrix4(o),E.halfHeight.applyMatrix4(o),_++}else if(b.isPointLight){let E=r.point[m];E.position.setFromMatrixPosition(b.matrixWorld),E.position.applyMatrix4(y),m++}else if(b.isHemisphereLight){let E=r.hemi[M];E.direction.setFromMatrixPosition(b.matrixWorld),E.direction.transformDirection(y),E.direction.normalize(),M++}}},state:r}}function PN(t,e){let n=new i4e(t,e),i=[],r=[];return{init:function s(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function c(u){n.setup(i,u)},setupLightsView:function l(u){n.setupView(i,u)},pushLight:function a(u){i.push(u)},pushShadow:function o(u){r.push(u)}}}function r4e(t,e){let n=new WeakMap;return{get:function i(s,a=0){let o;return!1===n.has(s)?(o=new PN(t,e),n.set(s,[o])):a>=n.get(s).length?(o=new PN(t,e),n.get(s).push(o)):o=n.get(s)[a],o},dispose:function r(){n=new WeakMap}}}var e_=class extends Vn{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}};e_.prototype.isMeshDepthMaterial=!0;var t_=class extends Vn{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new ee,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}};function NN(t,e,n){let i=new Nf,r=new Ie,s=new Ie,a=new b1,o=new e_({depthPacking:3201}),c=new t_,l={},u=n.maxTextureSize,f={0:1,1:0,2:2},d=new Hr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ie},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),m=d.clone();m.defines.HORIZONTAL_PASS=1;let v=new Q1;v.setAttribute("position",new On(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let _=new s2(v,d),M=this;function y(b,E){let P=e.update(_);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,m.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,m.needsUpdate=!0),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,t.setRenderTarget(b.mapPass),t.clear(),t.renderBufferDirect(E,null,P,d,_,null),m.uniforms.shadow_pass.value=b.mapPass.texture,m.uniforms.resolution.value=b.mapSize,m.uniforms.radius.value=b.radius,t.setRenderTarget(b.map),t.clear(),t.renderBufferDirect(E,null,P,m,_,null)}function g(b,E,P,V,j,Y){let G=null,C=!0===P.isPointLight?b.customDistanceMaterial:b.customDepthMaterial;if(G=void 0!==C?C:!0===P.isPointLight?c:o,t.localClippingEnabled&&!0===E.clipShadows&&0!==E.clippingPlanes.length||E.displacementMap&&0!==E.displacementScale||E.alphaMap&&E.alphaTest>0){let N=G.uuid,F=E.uuid,U=l[N];void 0===U&&(U={},l[N]=U);let $=U[F];void 0===$&&($=G.clone(),U[F]=$),G=$}return G.visible=E.visible,G.wireframe=E.wireframe,G.side=3===Y?null!==E.shadowSide?E.shadowSide:E.side:null!==E.shadowSide?E.shadowSide:f[E.side],G.alphaMap=E.alphaMap,G.alphaTest=E.alphaTest,G.clipShadows=E.clipShadows,G.clippingPlanes=E.clippingPlanes,G.clipIntersection=E.clipIntersection,G.displacementMap=E.displacementMap,G.displacementScale=E.displacementScale,G.displacementBias=E.displacementBias,G.wireframeLinewidth=E.wireframeLinewidth,G.linewidth=E.linewidth,!0===P.isPointLight&&!0===G.isMeshDistanceMaterial&&(G.referencePosition.setFromMatrixPosition(P.matrixWorld),G.nearDistance=V,G.farDistance=j),G}function S(b,E,P,V,j){if(!1===b.visible)return;if(b.layers.test(E.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&3===j)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,b.matrixWorld);let G=e.update(b),C=b.material;if(Array.isArray(C)){let N=G.groups;for(let F=0,U=N.length;F<U;F++){let $=N[F],O=C[$.materialIndex];if(O&&O.visible){let I=g(b,O,V,P.near,P.far,j);t.renderBufferDirect(P,null,G,I,b,$)}}}else if(C.visible){let N=g(b,C,V,P.near,P.far,j);t.renderBufferDirect(P,null,G,N,b,null)}}let Y=b.children;for(let G=0,C=Y.length;G<C;G++)S(Y[G],E,P,V,j)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(b,E,P){if(!1===M.enabled||!1===M.autoUpdate&&!1===M.needsUpdate||0===b.length)return;let V=t.getRenderTarget(),j=t.getActiveCubeFace(),Y=t.getActiveMipmapLevel(),G=t.state;G.setBlending(0),G.buffers.color.setClear(1,1,1,1),G.buffers.depth.setTest(!0),G.setScissorTest(!1);for(let C=0,N=b.length;C<N;C++){let F=b[C],U=F.shadow;if(void 0===U){console.warn("THREE.WebGLShadowMap:",F,"has no shadow.");continue}if(!1===U.autoUpdate&&!1===U.needsUpdate)continue;r.copy(U.mapSize);let $=U.getFrameExtents();if(r.multiply($),s.copy(U.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/$.x),r.x=s.x*$.x,U.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/$.y),r.y=s.y*$.y,U.mapSize.y=s.y)),null===U.map&&!U.isPointLightShadow&&3===this.type){let I={minFilter:Ei,magFilter:Ei,format:t2};U.map=new T2(r.x,r.y,I),U.map.texture.name=F.name+".shadowMap",U.mapPass=new T2(r.x,r.y,I),U.camera.updateProjectionMatrix()}null===U.map&&(U.map=new T2(r.x,r.y,{minFilter:$n,magFilter:$n,format:t2}),U.map.texture.name=F.name+".shadowMap",U.camera.updateProjectionMatrix()),t.setRenderTarget(U.map),t.clear();let O=U.getViewportCount();for(let I=0;I<O;I++){let k=U.getViewport(I);a.set(s.x*k.x,s.y*k.y,s.x*k.z,s.y*k.w),G.viewport(a),U.updateMatrices(F,I),i=U.getFrustum(),S(E,P,U.camera,F,this.type)}!U.isPointLightShadow&&3===this.type&&y(U,P),U.needsUpdate=!1}M.needsUpdate=!1,t.setRenderTarget(V,j,Y)}}function o4e(t,e,n){let i=n.isWebGL2,o=new function r(){let H=!1,be=new b1,ve=null,je=new b1(0,0,0,0);return{setMask:function(ye){ve!==ye&&!H&&(t.colorMask(ye,ye,ye,ye),ve=ye)},setLocked:function(ye){H=ye},setClear:function(ye,ce,Ue,et,q1){!0===q1&&(ye*=et,ce*=et,Ue*=et),be.set(ye,ce,Ue,et),!1===je.equals(be)&&(t.clearColor(ye,ce,Ue,et),je.copy(be))},reset:function(){H=!1,ve=null,je.set(-1,0,0,0)}}},c=new function s(){let H=!1,be=null,ve=null,je=null;return{setTest:function(ye){ye?Pe(2929):ie(2929)},setMask:function(ye){be!==ye&&!H&&(t.depthMask(ye),be=ye)},setFunc:function(ye){if(ve!==ye){if(ye)switch(ye){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:default:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517)}else t.depthFunc(515);ve=ye}},setLocked:function(ye){H=ye},setClear:function(ye){je!==ye&&(t.clearDepth(ye),je=ye)},reset:function(){H=!1,be=null,ve=null,je=null}}},l=new function a(){let H=!1,be=null,ve=null,je=null,ye=null,ce=null,Ue=null,et=null,q1=null;return{setTest:function(vt){H||(vt?Pe(2960):ie(2960))},setMask:function(vt){be!==vt&&!H&&(t.stencilMask(vt),be=vt)},setFunc:function(vt,mn,gn){(ve!==vt||je!==mn||ye!==gn)&&(t.stencilFunc(vt,mn,gn),ve=vt,je=mn,ye=gn)},setOp:function(vt,mn,gn){(ce!==vt||Ue!==mn||et!==gn)&&(t.stencilOp(vt,mn,gn),ce=vt,Ue=mn,et=gn)},setLocked:function(vt){H=vt},setClear:function(vt){q1!==vt&&(t.clearStencil(vt),q1=vt)},reset:function(){H=!1,be=null,ve=null,je=null,ye=null,ce=null,Ue=null,et=null,q1=null}}},u={},f={},d=new WeakMap,m=[],v=null,_=!1,M=null,y=null,g=null,S=null,b=null,E=null,P=null,V=!1,j=null,Y=null,G=null,C=null,N=null,F=t.getParameter(35661),U=!1,$=0,O=t.getParameter(7938);-1!==O.indexOf("WebGL")?($=parseFloat(/^WebGL (\d)/.exec(O)[1]),U=$>=1):-1!==O.indexOf("OpenGL ES")&&($=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),U=$>=2);let I=null,k={},K=t.getParameter(3088),re=t.getParameter(2978),ae=(new b1).fromArray(K),ue=(new b1).fromArray(re);function Le(H,be,ve){let je=new Uint8Array(4),ye=t.createTexture();t.bindTexture(H,ye),t.texParameteri(H,10241,9728),t.texParameteri(H,10240,9728);for(let ce=0;ce<ve;ce++)t.texImage2D(be+ce,0,6408,1,1,0,6408,5121,je);return ye}let Oe={};function Pe(H){!0!==u[H]&&(t.enable(H),u[H]=!0)}function ie(H){!1!==u[H]&&(t.disable(H),u[H]=!1)}Oe[3553]=Le(3553,3553,1),Oe[34067]=Le(34067,34069,6),o.setClear(0,0,0,1),c.setClear(1),l.setClear(0),Pe(2929),c.setFunc(3),pe(!1),Te(1),Pe(2884),X(0);let oe={100:32774,101:32778,102:32779};if(i)oe[103]=32775,oe[104]=32776;else{let H=e.get("EXT_blend_minmax");null!==H&&(oe[103]=H.MIN_EXT,oe[104]=H.MAX_EXT)}let xe={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function X(H,be,ve,je,ye,ce,Ue,et){if(0!==H){if(!1===_&&(Pe(3042),_=!0),5===H)ye=ye||be,ce=ce||ve,Ue=Ue||je,(be!==y||ye!==b)&&(t.blendEquationSeparate(oe[be],oe[ye]),y=be,b=ye),(ve!==g||je!==S||ce!==E||Ue!==P)&&(t.blendFuncSeparate(xe[ve],xe[je],xe[ce],xe[Ue]),g=ve,S=je,E=ce,P=Ue),M=H,V=null;else if(H!==M||et!==V){if((100!==y||100!==b)&&(t.blendEquation(32774),y=100,b=100),et)switch(H){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",H)}else switch(H){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",H)}g=null,S=null,E=null,P=null,M=H,V=et}}else!0===_&&(ie(3042),_=!1)}function pe(H){j!==H&&(t.frontFace(H?2304:2305),j=H)}function Te(H){0!==H?(Pe(2884),H!==Y&&t.cullFace(1===H?1029:2===H?1028:1032)):ie(2884),Y=H}function We(H,be,ve){H?(Pe(32823),(C!==be||N!==ve)&&(t.polygonOffset(be,ve),C=be,N=ve)):ie(32823)}function rt(H){void 0===H&&(H=33984+F-1),I!==H&&(t.activeTexture(H),I=H)}return{buffers:{color:o,depth:c,stencil:l},enable:Pe,disable:ie,bindFramebuffer:function st(H,be){return f[H]!==be&&(t.bindFramebuffer(H,be),f[H]=be,i&&(36009===H&&(f[36160]=be),36160===H&&(f[36009]=be)),!0)},drawBuffers:function ke(H,be){let ve=m,je=!1;if(H)if(ve=d.get(be),void 0===ve&&(ve=[],d.set(be,ve)),H.isWebGLMultipleRenderTargets){let ye=H.texture;if(ve.length!==ye.length||36064!==ve[0]){for(let ce=0,Ue=ye.length;ce<Ue;ce++)ve[ce]=36064+ce;ve.length=ye.length,je=!0}}else 36064!==ve[0]&&(ve[0]=36064,je=!0);else 1029!==ve[0]&&(ve[0]=1029,je=!0);je&&(n.isWebGL2?t.drawBuffers(ve):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ve))},useProgram:function _e(H){return v!==H&&(t.useProgram(H),v=H,!0)},setBlending:X,setMaterial:function fe(H,be){2===H.side?ie(2884):Pe(2884);let ve=1===H.side;be&&(ve=!ve),pe(ve),1===H.blending&&!1===H.transparent?X(0):X(H.blending,H.blendEquation,H.blendSrc,H.blendDst,H.blendEquationAlpha,H.blendSrcAlpha,H.blendDstAlpha,H.premultipliedAlpha),c.setFunc(H.depthFunc),c.setTest(H.depthTest),c.setMask(H.depthWrite),o.setMask(H.colorWrite);let je=H.stencilWrite;l.setTest(je),je&&(l.setMask(H.stencilWriteMask),l.setFunc(H.stencilFunc,H.stencilRef,H.stencilFuncMask),l.setOp(H.stencilFail,H.stencilZFail,H.stencilZPass)),We(H.polygonOffset,H.polygonOffsetFactor,H.polygonOffsetUnits),!0===H.alphaToCoverage?Pe(32926):ie(32926)},setFlipSided:pe,setCullFace:Te,setLineWidth:function Se(H){H!==G&&(U&&t.lineWidth(H),G=H)},setPolygonOffset:We,setScissorTest:function Fe(H){H?Pe(3089):ie(3089)},activeTexture:rt,bindTexture:function Gt(H,be){null===I&&rt();let ve=k[I];void 0===ve&&(ve={type:void 0,texture:void 0},k[I]=ve),(ve.type!==H||ve.texture!==be)&&(t.bindTexture(H,be||Oe[H]),ve.type=H,ve.texture=be)},unbindTexture:function D(){let H=k[I];void 0!==H&&void 0!==H.type&&(t.bindTexture(H.type,null),H.type=void 0,H.texture=void 0)},compressedTexImage2D:function z(){try{t.compressedTexImage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage2D:function te(){try{t.texImage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texImage3D:function Be(){try{t.texImage3D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texStorage2D:function Me(){try{t.texStorage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texStorage3D:function Ne(){try{t.texStorage3D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texSubImage2D:function J(){try{t.texSubImage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},texSubImage3D:function se(){try{t.texSubImage3D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},compressedTexSubImage2D:function ge(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(H){console.error("THREE.WebGLState:",H)}},scissor:function Ze(H){!1===ae.equals(H)&&(t.scissor(H.x,H.y,H.z,H.w),ae.copy(H))},viewport:function De(H){!1===ue.equals(H)&&(t.viewport(H.x,H.y,H.z,H.w),ue.copy(H))},reset:function we(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===i&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},I=null,k={},f={},d=new WeakMap,m=[],v=null,_=!1,M=null,y=null,g=null,S=null,b=null,E=null,P=null,V=!1,j=null,Y=null,G=null,C=null,N=null,ae.set(0,0,t.canvas.width,t.canvas.height),ue.set(0,0,t.canvas.width,t.canvas.height),o.reset(),c.reset(),l.reset()}}}function c4e(t,e,n,i,r,s,a){let v,o=r.isWebGL2,c=r.maxTextures,l=r.maxCubemapSize,u=r.maxTextureSize,f=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=new WeakMap,_=new WeakMap,M=!1;try{M=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(D){}function y(D,z){return M?new OffscreenCanvas(D,z):A8("canvas")}function g(D,z,J,se){let ge=1;if((D.width>se||D.height>se)&&(ge=se/Math.max(D.width,D.height)),ge<1||!0===z){if(typeof HTMLImageElement<"u"&&D instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&D instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&D instanceof ImageBitmap){let Me=z?My:Math.floor,Ne=Me(ge*D.width),te=Me(ge*D.height);void 0===v&&(v=y(Ne,te));let Be=J?y(Ne,te):v;return Be.width=Ne,Be.height=te,Be.getContext("2d").drawImage(D,0,0,Ne,te),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+D.width+"x"+D.height+") to ("+Ne+"x"+te+")."),Be}return"data"in D&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+D.width+"x"+D.height+")."),D}return D}function S(D){return OP(D.width)&&OP(D.height)}function E(D,z){return D.generateMipmaps&&z&&D.minFilter!==$n&&D.minFilter!==Ei}function P(D){t.generateMipmap(D)}function V(D,z,J,se,ge=!1){if(!1===o)return z;if(null!==D){if(void 0!==t[D])return t[D];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+D+"'")}let Me=z;return 6403===z&&(5126===J&&(Me=33326),5131===J&&(Me=33325),5121===J&&(Me=33321)),33319===z&&(5126===J&&(Me=33328),5131===J&&(Me=33327),5121===J&&(Me=33323)),6408===z&&(5126===J&&(Me=34836),5131===J&&(Me=34842),5121===J&&(Me=se===W1&&!1===ge?35907:32856),32819===J&&(Me=32854),32820===J&&(Me=32855)),(33325===Me||33326===Me||33327===Me||33328===Me||34842===Me||34836===Me)&&e.get("EXT_color_buffer_float"),Me}function j(D,z,J){return!0===E(D,J)||D.isFramebufferTexture&&D.minFilter!==$n&&D.minFilter!==Ei?Math.log2(Math.max(z.width,z.height))+1:void 0!==D.mipmaps&&D.mipmaps.length>0?D.mipmaps.length:D.isCompressedTexture&&Array.isArray(D.image)?z.mipmaps.length:1}function Y(D){return D===$n||1004===D||1005===D?9728:9729}function G(D){let z=D.target;z.removeEventListener("dispose",G),function N(D){let z=i.get(D);if(void 0===z.__webglInit)return;let J=D.source,se=_.get(J);if(se){let ge=se[z.__cacheKey];ge.usedTimes--,0===ge.usedTimes&&F(D),0===Object.keys(se).length&&_.delete(J)}i.remove(D)}(z),z.isVideoTexture&&m.delete(z)}function C(D){let z=D.target;z.removeEventListener("dispose",C),function U(D){let z=D.texture,J=i.get(D),se=i.get(z);if(void 0!==se.__webglTexture&&(t.deleteTexture(se.__webglTexture),a.memory.textures--),D.depthTexture&&D.depthTexture.dispose(),D.isWebGLCubeRenderTarget)for(let ge=0;ge<6;ge++)t.deleteFramebuffer(J.__webglFramebuffer[ge]),J.__webglDepthbuffer&&t.deleteRenderbuffer(J.__webglDepthbuffer[ge]);else t.deleteFramebuffer(J.__webglFramebuffer),J.__webglDepthbuffer&&t.deleteRenderbuffer(J.__webglDepthbuffer),J.__webglMultisampledFramebuffer&&t.deleteFramebuffer(J.__webglMultisampledFramebuffer),J.__webglColorRenderbuffer&&t.deleteRenderbuffer(J.__webglColorRenderbuffer),J.__webglDepthRenderbuffer&&t.deleteRenderbuffer(J.__webglDepthRenderbuffer);if(D.isWebGLMultipleRenderTargets)for(let ge=0,Me=z.length;ge<Me;ge++){let Ne=i.get(z[ge]);Ne.__webglTexture&&(t.deleteTexture(Ne.__webglTexture),a.memory.textures--),i.remove(z[ge])}i.remove(z),i.remove(D)}(z)}function F(D){let z=i.get(D);t.deleteTexture(z.__webglTexture),delete _.get(D.source)[z.__cacheKey],a.memory.textures--}let $=0;function K(D,z){let J=i.get(D);if(D.isVideoTexture&&function rt(D){let z=a.render.frame;m.get(D)!==z&&(m.set(D,z),D.update())}(D),D.version>0&&J.__version!==D.version){let se=D.image;if(null===se)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==se.complete)return void st(J,D,z);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+z),n.bindTexture(3553,J.__webglTexture)}let Le={1e3:10497,[Ar]:33071,1002:33648},Oe={[$n]:9728,1004:9984,1005:9986,[Ei]:9729,1007:9985,1008:9987};function Pe(D,z,J){if(J?(t.texParameteri(D,10242,Le[z.wrapS]),t.texParameteri(D,10243,Le[z.wrapT]),(32879===D||35866===D)&&t.texParameteri(D,32882,Le[z.wrapR]),t.texParameteri(D,10240,Oe[z.magFilter]),t.texParameteri(D,10241,Oe[z.minFilter])):(t.texParameteri(D,10242,33071),t.texParameteri(D,10243,33071),(32879===D||35866===D)&&t.texParameteri(D,32882,33071),(z.wrapS!==Ar||z.wrapT!==Ar)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(D,10240,Y(z.magFilter)),t.texParameteri(D,10241,Y(z.minFilter)),z.minFilter!==$n&&z.minFilter!==Ei&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){let se=e.get("EXT_texture_filter_anisotropic");if(z.type===A4&&!1===e.has("OES_texture_float_linear")||!1===o&&z.type===yc&&!1===e.has("OES_texture_half_float_linear"))return;(z.anisotropy>1||i.get(z).__currentAnisotropy)&&(t.texParameterf(D,se.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(z.anisotropy,r.getMaxAnisotropy())),i.get(z).__currentAnisotropy=z.anisotropy)}}function ie(D,z){let J=!1;void 0===D.__webglInit&&(D.__webglInit=!0,z.addEventListener("dispose",G));let se=z.source,ge=_.get(se);void 0===ge&&(ge={},_.set(se,ge));let Me=function k(D){let z=[];return z.push(D.wrapS),z.push(D.wrapT),z.push(D.magFilter),z.push(D.minFilter),z.push(D.anisotropy),z.push(D.internalFormat),z.push(D.format),z.push(D.type),z.push(D.generateMipmaps),z.push(D.premultiplyAlpha),z.push(D.flipY),z.push(D.unpackAlignment),z.push(D.encoding),z.join()}(z);if(Me!==D.__cacheKey){void 0===ge[Me]&&(ge[Me]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,J=!0),ge[Me].usedTimes++;let Ne=ge[D.__cacheKey];void 0!==Ne&&(ge[D.__cacheKey].usedTimes--,0===Ne.usedTimes&&F(z)),D.__cacheKey=Me,D.__webglTexture=ge[Me].texture}return J}function st(D,z,J){let se=3553;z.isDataArrayTexture&&(se=35866),z.isData3DTexture&&(se=32879);let ge=ie(D,z),Me=z.source;if(n.activeTexture(33984+J),n.bindTexture(se,D.__webglTexture),Me.version!==Me.__currentVersion||!0===ge){t.pixelStorei(37440,z.flipY),t.pixelStorei(37441,z.premultiplyAlpha),t.pixelStorei(3317,z.unpackAlignment),t.pixelStorei(37443,0);let Ne=function b(D){return!o&&(D.wrapS!==Ar||D.wrapT!==Ar||D.minFilter!==$n&&D.minFilter!==Ei)}(z)&&!1===S(z.image),te=g(z.image,Ne,!1,u);te=Gt(z,te);let Be=S(te)||o,Ze=s.convert(z.format,z.encoding),De=s.convert(z.type),we=V(z.internalFormat,Ze,De,z.encoding,z.isVideoTexture);Pe(se,z,Be);let H,be=z.mipmaps,ve=o&&!0!==z.isVideoTexture,je=void 0===D.__version,ye=j(z,te,Be);if(z.isDepthTexture)we=6402,o?we=z.type===A4?36012:1014===z.type?33190:z.type===_c?35056:33189:z.type===A4&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),z.format===L4&&6402===we&&z.type!==z8&&1014!==z.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),z.type=z8,De=s.convert(z.type)),z.format===xc&&6402===we&&(we=34041,z.type!==_c&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),z.type=_c,De=s.convert(z.type))),ve&&je?n.texStorage2D(3553,1,we,te.width,te.height):n.texImage2D(3553,0,we,te.width,te.height,0,Ze,De,null);else if(z.isDataTexture)if(be.length>0&&Be){ve&&je&&n.texStorage2D(3553,ye,we,be[0].width,be[0].height);for(let ce=0,Ue=be.length;ce<Ue;ce++)H=be[ce],ve?n.texSubImage2D(3553,ce,0,0,H.width,H.height,Ze,De,H.data):n.texImage2D(3553,ce,we,H.width,H.height,0,Ze,De,H.data);z.generateMipmaps=!1}else ve?(je&&n.texStorage2D(3553,ye,we,te.width,te.height),n.texSubImage2D(3553,0,0,0,te.width,te.height,Ze,De,te.data)):n.texImage2D(3553,0,we,te.width,te.height,0,Ze,De,te.data);else if(z.isCompressedTexture){ve&&je&&n.texStorage2D(3553,ye,we,be[0].width,be[0].height);for(let ce=0,Ue=be.length;ce<Ue;ce++)H=be[ce],z.format!==t2?null!==Ze?ve?n.compressedTexSubImage2D(3553,ce,0,0,H.width,H.height,Ze,H.data):n.compressedTexImage2D(3553,ce,we,H.width,H.height,0,H.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ve?n.texSubImage2D(3553,ce,0,0,H.width,H.height,Ze,De,H.data):n.texImage2D(3553,ce,we,H.width,H.height,0,Ze,De,H.data)}else if(z.isDataArrayTexture)ve?(je&&n.texStorage3D(35866,ye,we,te.width,te.height,te.depth),n.texSubImage3D(35866,0,0,0,0,te.width,te.height,te.depth,Ze,De,te.data)):n.texImage3D(35866,0,we,te.width,te.height,te.depth,0,Ze,De,te.data);else if(z.isData3DTexture)ve?(je&&n.texStorage3D(32879,ye,we,te.width,te.height,te.depth),n.texSubImage3D(32879,0,0,0,0,te.width,te.height,te.depth,Ze,De,te.data)):n.texImage3D(32879,0,we,te.width,te.height,te.depth,0,Ze,De,te.data);else if(z.isFramebufferTexture)ve&&je?n.texStorage2D(3553,ye,we,te.width,te.height):n.texImage2D(3553,0,we,te.width,te.height,0,Ze,De,null);else if(be.length>0&&Be){ve&&je&&n.texStorage2D(3553,ye,we,be[0].width,be[0].height);for(let ce=0,Ue=be.length;ce<Ue;ce++)H=be[ce],ve?n.texSubImage2D(3553,ce,0,0,Ze,De,H):n.texImage2D(3553,ce,we,Ze,De,H);z.generateMipmaps=!1}else ve?(je&&n.texStorage2D(3553,ye,we,te.width,te.height),n.texSubImage2D(3553,0,0,0,Ze,De,te)):n.texImage2D(3553,0,we,Ze,De,te);E(z,Be)&&P(se),Me.__currentVersion=Me.version,z.onUpdate&&z.onUpdate(z)}D.__version=z.version}function _e(D,z,J,se,ge){let Me=s.convert(J.format,J.encoding),Ne=s.convert(J.type),te=V(J.internalFormat,Me,Ne,J.encoding);i.get(z).__hasExternalTextures||(32879===ge||35866===ge?n.texImage3D(ge,0,te,z.width,z.height,z.depth,0,Me,Ne,null):n.texImage2D(ge,0,te,z.width,z.height,0,Me,Ne,null)),n.bindFramebuffer(36160,D),Fe(z)?d.framebufferTexture2DMultisampleEXT(36160,se,ge,i.get(J).__webglTexture,0,We(z)):t.framebufferTexture2D(36160,se,ge,i.get(J).__webglTexture,0),n.bindFramebuffer(36160,null)}function oe(D,z,J){if(t.bindRenderbuffer(36161,D),z.depthBuffer&&!z.stencilBuffer){let se=33189;if(J||Fe(z)){let ge=z.depthTexture;ge&&ge.isDepthTexture&&(ge.type===A4?se=36012:1014===ge.type&&(se=33190));let Me=We(z);Fe(z)?d.renderbufferStorageMultisampleEXT(36161,Me,se,z.width,z.height):t.renderbufferStorageMultisample(36161,Me,se,z.width,z.height)}else t.renderbufferStorage(36161,se,z.width,z.height);t.framebufferRenderbuffer(36160,36096,36161,D)}else if(z.depthBuffer&&z.stencilBuffer){let se=We(z);J&&!1===Fe(z)?t.renderbufferStorageMultisample(36161,se,35056,z.width,z.height):Fe(z)?d.renderbufferStorageMultisampleEXT(36161,se,35056,z.width,z.height):t.renderbufferStorage(36161,34041,z.width,z.height),t.framebufferRenderbuffer(36160,33306,36161,D)}else{let se=!0===z.isWebGLMultipleRenderTargets?z.texture[0]:z.texture,ge=s.convert(se.format,se.encoding),Me=s.convert(se.type),Ne=V(se.internalFormat,ge,Me,se.encoding),te=We(z);J&&!1===Fe(z)?t.renderbufferStorageMultisample(36161,te,Ne,z.width,z.height):Fe(z)?d.renderbufferStorageMultisampleEXT(36161,te,Ne,z.width,z.height):t.renderbufferStorage(36161,Ne,z.width,z.height)}t.bindRenderbuffer(36161,null)}function X(D){let z=i.get(D),J=!0===D.isWebGLCubeRenderTarget;if(D.depthTexture&&!z.__autoAllocateDepthBuffer){if(J)throw new Error("target.depthTexture not supported in Cube render targets");!function xe(D,z){if(z&&z.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,D),!z.depthTexture||!z.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(z.depthTexture).__webglTexture||z.depthTexture.image.width!==z.width||z.depthTexture.image.height!==z.height)&&(z.depthTexture.image.width=z.width,z.depthTexture.image.height=z.height,z.depthTexture.needsUpdate=!0),K(z.depthTexture,0);let J=i.get(z.depthTexture).__webglTexture,se=We(z);if(z.depthTexture.format===L4)Fe(z)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,J,0,se):t.framebufferTexture2D(36160,36096,3553,J,0);else{if(z.depthTexture.format!==xc)throw new Error("Unknown depthTexture format");Fe(z)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,J,0,se):t.framebufferTexture2D(36160,33306,3553,J,0)}}(z.__webglFramebuffer,D)}else if(J){z.__webglDepthbuffer=[];for(let se=0;se<6;se++)n.bindFramebuffer(36160,z.__webglFramebuffer[se]),z.__webglDepthbuffer[se]=t.createRenderbuffer(),oe(z.__webglDepthbuffer[se],D,!1)}else n.bindFramebuffer(36160,z.__webglFramebuffer),z.__webglDepthbuffer=t.createRenderbuffer(),oe(z.__webglDepthbuffer,D,!1);n.bindFramebuffer(36160,null)}function We(D){return Math.min(f,D.samples)}function Fe(D){let z=i.get(D);return o&&D.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==z.__useRenderToTexture}function Gt(D,z){let J=D.encoding,se=D.format,ge=D.type;return!0===D.isCompressedTexture||!0===D.isVideoTexture||1035===D.format||J!==io&&(J===W1?!1===o?!0===e.has("EXT_sRGB")&&se===t2?(D.format=1035,D.minFilter=Ei,D.generateMipmaps=!1):z=P4.sRGBToLinear(z):(se!==t2||ge!==T4)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",J)),z}this.allocateTextureUnit=function I(){let D=$;return D>=c&&console.warn("THREE.WebGLTextures: Trying to use "+D+" texture units while this GPU supports only "+c),$+=1,D},this.resetTextureUnits=function O(){$=0},this.setTexture2D=K,this.setTexture2DArray=function re(D,z){let J=i.get(D);D.version>0&&J.__version!==D.version?st(J,D,z):(n.activeTexture(33984+z),n.bindTexture(35866,J.__webglTexture))},this.setTexture3D=function ae(D,z){let J=i.get(D);D.version>0&&J.__version!==D.version?st(J,D,z):(n.activeTexture(33984+z),n.bindTexture(32879,J.__webglTexture))},this.setTextureCube=function ue(D,z){let J=i.get(D);D.version>0&&J.__version!==D.version?function ke(D,z,J){if(6!==z.image.length)return;let se=ie(D,z),ge=z.source;if(n.activeTexture(33984+J),n.bindTexture(34067,D.__webglTexture),ge.version!==ge.__currentVersion||!0===se){t.pixelStorei(37440,z.flipY),t.pixelStorei(37441,z.premultiplyAlpha),t.pixelStorei(3317,z.unpackAlignment),t.pixelStorei(37443,0);let Me=z.isCompressedTexture||z.image[0].isCompressedTexture,Ne=z.image[0]&&z.image[0].isDataTexture,te=[];for(let ce=0;ce<6;ce++)te[ce]=Me||Ne?Ne?z.image[ce].image:z.image[ce]:g(z.image[ce],!1,!0,l),te[ce]=Gt(z,te[ce]);let ye,Be=te[0],Ze=S(Be)||o,De=s.convert(z.format,z.encoding),we=s.convert(z.type),H=V(z.internalFormat,De,we,z.encoding),be=o&&!0!==z.isVideoTexture,ve=void 0===D.__version,je=j(z,Be,Ze);if(Pe(34067,z,Ze),Me){be&&ve&&n.texStorage2D(34067,je,H,Be.width,Be.height);for(let ce=0;ce<6;ce++){ye=te[ce].mipmaps;for(let Ue=0;Ue<ye.length;Ue++){let et=ye[Ue];z.format!==t2?null!==De?be?n.compressedTexSubImage2D(34069+ce,Ue,0,0,et.width,et.height,De,et.data):n.compressedTexImage2D(34069+ce,Ue,H,et.width,et.height,0,et.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):be?n.texSubImage2D(34069+ce,Ue,0,0,et.width,et.height,De,we,et.data):n.texImage2D(34069+ce,Ue,H,et.width,et.height,0,De,we,et.data)}}}else{ye=z.mipmaps,be&&ve&&(ye.length>0&&je++,n.texStorage2D(34067,je,H,te[0].width,te[0].height));for(let ce=0;ce<6;ce++)if(Ne){be?n.texSubImage2D(34069+ce,0,0,0,te[ce].width,te[ce].height,De,we,te[ce].data):n.texImage2D(34069+ce,0,H,te[ce].width,te[ce].height,0,De,we,te[ce].data);for(let Ue=0;Ue<ye.length;Ue++){let et=ye[Ue].image[ce].image;be?n.texSubImage2D(34069+ce,Ue+1,0,0,et.width,et.height,De,we,et.data):n.texImage2D(34069+ce,Ue+1,H,et.width,et.height,0,De,we,et.data)}}else{be?n.texSubImage2D(34069+ce,0,0,0,De,we,te[ce]):n.texImage2D(34069+ce,0,H,De,we,te[ce]);for(let Ue=0;Ue<ye.length;Ue++){let et=ye[Ue];be?n.texSubImage2D(34069+ce,Ue+1,0,0,De,we,et.image[ce]):n.texImage2D(34069+ce,Ue+1,H,De,we,et.image[ce])}}}E(z,Ze)&&P(34067),ge.__currentVersion=ge.version,z.onUpdate&&z.onUpdate(z)}D.__version=z.version}(J,D,z):(n.activeTexture(33984+z),n.bindTexture(34067,J.__webglTexture))},this.rebindTextures=function fe(D,z,J){let se=i.get(D);void 0!==z&&_e(se.__webglFramebuffer,D,D.texture,36064,3553),void 0!==J&&X(D)},this.setupRenderTarget=function pe(D){let z=D.texture,J=i.get(D),se=i.get(z);D.addEventListener("dispose",C),!0!==D.isWebGLMultipleRenderTargets&&(void 0===se.__webglTexture&&(se.__webglTexture=t.createTexture()),se.__version=z.version,a.memory.textures++);let ge=!0===D.isWebGLCubeRenderTarget,Me=!0===D.isWebGLMultipleRenderTargets,Ne=S(D)||o;if(ge){J.__webglFramebuffer=[];for(let te=0;te<6;te++)J.__webglFramebuffer[te]=t.createFramebuffer()}else if(J.__webglFramebuffer=t.createFramebuffer(),Me)if(r.drawBuffers){let te=D.texture;for(let Be=0,Ze=te.length;Be<Ze;Be++){let De=i.get(te[Be]);void 0===De.__webglTexture&&(De.__webglTexture=t.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(o&&D.samples>0&&!1===Fe(D)){J.__webglMultisampledFramebuffer=t.createFramebuffer(),J.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,J.__webglColorRenderbuffer);let te=s.convert(z.format,z.encoding),Be=s.convert(z.type),Ze=V(z.internalFormat,te,Be,z.encoding),De=We(D);t.renderbufferStorageMultisample(36161,De,Ze,D.width,D.height),n.bindFramebuffer(36160,J.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,J.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),D.depthBuffer&&(J.__webglDepthRenderbuffer=t.createRenderbuffer(),oe(J.__webglDepthRenderbuffer,D,!0)),n.bindFramebuffer(36160,null)}if(ge){n.bindTexture(34067,se.__webglTexture),Pe(34067,z,Ne);for(let te=0;te<6;te++)_e(J.__webglFramebuffer[te],D,z,36064,34069+te);E(z,Ne)&&P(34067),n.unbindTexture()}else if(Me){let te=D.texture;for(let Be=0,Ze=te.length;Be<Ze;Be++){let De=te[Be],we=i.get(De);n.bindTexture(3553,we.__webglTexture),Pe(3553,De,Ne),_e(J.__webglFramebuffer,D,De,36064+Be,3553),E(De,Ne)&&P(3553)}n.unbindTexture()}else{let te=3553;(D.isWebGL3DRenderTarget||D.isWebGLArrayRenderTarget)&&(o?te=D.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(te,se.__webglTexture),Pe(te,z,Ne),_e(J.__webglFramebuffer,D,z,36064,te),E(z,Ne)&&P(te),n.unbindTexture()}D.depthBuffer&&X(D)},this.updateRenderTargetMipmap=function Te(D){let z=S(D)||o,J=!0===D.isWebGLMultipleRenderTargets?D.texture:[D.texture];for(let se=0,ge=J.length;se<ge;se++){let Me=J[se];if(E(Me,z)){let Ne=D.isWebGLCubeRenderTarget?34067:3553,te=i.get(Me).__webglTexture;n.bindTexture(Ne,te),P(Ne),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function Se(D){if(o&&D.samples>0&&!1===Fe(D)){let z=D.width,J=D.height,se=16384,ge=[36064],Me=D.stencilBuffer?33306:36096;D.depthBuffer&&ge.push(Me);let Ne=i.get(D),te=void 0===Ne.__ignoreDepthValues||Ne.__ignoreDepthValues;!1===te&&(D.depthBuffer&&(se|=256),D.stencilBuffer&&(se|=1024)),n.bindFramebuffer(36008,Ne.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,Ne.__webglFramebuffer),!0===te&&(t.invalidateFramebuffer(36008,[Me]),t.invalidateFramebuffer(36009,[Me])),t.blitFramebuffer(0,0,z,J,0,0,z,J,se,9728),t.invalidateFramebuffer(36008,ge),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,Ne.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=X,this.setupFrameBufferTexture=_e,this.useMultisampledRTT=Fe}function l4e(t,e,n){let i=n.isWebGL2;return{convert:function r(s,a=null){let o;if(s===T4)return 5121;if(1017===s)return 32819;if(1018===s)return 32820;if(1010===s)return 5120;if(1011===s)return 5122;if(s===z8)return 5123;if(1013===s)return 5124;if(1014===s)return 5125;if(s===A4)return 5126;if(s===yc)return i?5131:(o=e.get("OES_texture_half_float"),null!==o?o.HALF_FLOAT_OES:null);if(1021===s)return 6406;if(s===t2)return 6408;if(1024===s)return 6409;if(1025===s)return 6410;if(s===L4)return 6402;if(s===xc)return 34041;if(1028===s)return 6403;if(1022===s)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===s)return o=e.get("EXT_sRGB"),null!==o?o.SRGB_ALPHA_EXT:null;if(1029===s)return 36244;if(1030===s)return 33319;if(1031===s)return 33320;if(1033===s)return 36249;if(33776===s||33777===s||33778===s||33779===s)if(a===W1){if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===o)return null;if(33776===s)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(o=e.get("WEBGL_compressed_texture_s3tc"),null===o)return null;if(33776===s)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(o=e.get("WEBGL_compressed_texture_pvrtc"),null===o)return null;if(35840===s)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return o=e.get("WEBGL_compressed_texture_etc1"),null!==o?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(o=e.get("WEBGL_compressed_texture_etc"),null===o)return null;if(37492===s)return a===W1?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(37496===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(o=e.get("WEBGL_compressed_texture_astc"),null===o)return null;if(37808===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return a===W1?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(o=e.get("EXT_texture_compression_bptc"),null===o)return null;if(36492===s)return a===W1?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===_c?i?34042:(o=e.get("WEBGL_depth_texture"),null!==o?o.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}t_.prototype.isMeshDistanceMaterial=!0;var RN=class extends a2{constructor(t=[]){super(),this.cameras=t}};RN.prototype.isArrayCamera=!0;var R8=class extends w1{constructor(){super(),this.type="Group"}};R8.prototype.isGroup=!0;var h4e={type:"move"},n_=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new R8,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new R8,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ee,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ee),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new R8,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ee,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ee),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,s=null,a=this._targetRay,o=this._grip,c=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==a&&(i=e.getPose(t.targetRaySpace,n),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(h4e))),c&&t.hand){s=!0;for(let v of t.hand.values()){let _=e.getJointPose(v,n);if(void 0===c.joints[v.jointName]){let y=new R8;y.matrixAutoUpdate=!1,y.visible=!1,c.joints[v.jointName]=y,c.add(y)}let M=c.joints[v.jointName];null!==_&&(M.matrix.fromArray(_.transform.matrix),M.matrix.decompose(M.position,M.rotation,M.scale),M.jointRadius=_.radius),M.visible=null!==_}let f=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),d=.02,m=.005;c.inputState.pinching&&f>d+m?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!c.inputState.pinching&&f<=d-m&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));return null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==r),null!==c&&(c.visible=null!==s),this}},HN=class extends hi{constructor(t,e,n,i,r,s,a,o,c,l){if((l=void 0!==l?l:L4)!==L4&&l!==xc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===L4&&(n=z8),void 0===n&&l===xc&&(n=_c),super(null,i,r,s,a,o,l,n,c),this.image={width:t,height:e},this.magFilter=void 0!==a?a:$n,this.minFilter=void 0!==o?o:$n,this.flipY=!1,this.generateMipmaps=!1}};HN.prototype.isDepthTexture=!0;var u4e=class extends D4{constructor(t,e){super();let n=this,i=null,r=1,s=null,a="local-floor",o=null,c=null,l=null,u=null,f=null,d=e.getContextAttributes(),m=null,v=null,_=[],M=new Map,y=new a2;y.layers.enable(1),y.viewport=new b1;let g=new a2;g.layers.enable(2),g.viewport=new b1;let S=[y,g],b=new RN;b.layers.enable(1),b.layers.enable(2);let E=null,P=null;function V(I){let k=M.get(I.inputSource);k&&k.dispatchEvent({type:I.type,data:I.inputSource})}function j(){M.forEach(function(I,k){I.disconnect(k)}),M.clear(),E=null,P=null,t.setRenderTarget(m),u=null,l=null,c=null,i=null,v=null,O.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function Y(I){let k=i.inputSources;for(let K=0;K<_.length;K++)M.set(k[K],_[K]);for(let K=0;K<I.removed.length;K++){let re=I.removed[K],ae=M.get(re);ae&&(ae.dispatchEvent({type:"disconnected",data:re}),M.delete(re))}for(let K=0;K<I.added.length;K++){let re=I.added[K],ae=M.get(re);ae&&ae.dispatchEvent({type:"connected",data:re})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(I){let k=_[I];return void 0===k&&(k=new n_,_[I]=k),k.getTargetRaySpace()},this.getControllerGrip=function(I){let k=_[I];return void 0===k&&(k=new n_,_[I]=k),k.getGripSpace()},this.getHand=function(I){let k=_[I];return void 0===k&&(k=new n_,_[I]=k),k.getHandSpace()},this.setFramebufferScaleFactor=function(I){r=I,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(I){a=I,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return s},this.getBaseLayer=function(){return null!==l?l:u},this.getBinding=function(){return c},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=function(){var I=eA(function*(k){if(i=k,null!==i){if(m=t.getRenderTarget(),i.addEventListener("select",V),i.addEventListener("selectstart",V),i.addEventListener("selectend",V),i.addEventListener("squeeze",V),i.addEventListener("squeezestart",V),i.addEventListener("squeezeend",V),i.addEventListener("end",j),i.addEventListener("inputsourceschange",Y),!0!==d.xrCompatible&&(yield e.makeXRCompatible()),void 0===i.renderState.layers||!1===t.capabilities.isWebGL2)u=new XRWebGLLayer(i,e,{antialias:void 0!==i.renderState.layers||d.antialias,alpha:d.alpha,depth:d.depth,stencil:d.stencil,framebufferScaleFactor:r}),i.updateRenderState({baseLayer:u}),v=new T2(u.framebufferWidth,u.framebufferHeight,{format:t2,type:T4,encoding:t.outputEncoding});else{let K=null,re=null,ae=null;d.depth&&(ae=d.stencil?35056:33190,K=d.stencil?xc:L4,re=d.stencil?_c:z8);let ue={colorFormat:t.outputEncoding===W1?35907:32856,depthFormat:ae,scaleFactor:r};c=new XRWebGLBinding(i,e),l=c.createProjectionLayer(ue),i.updateRenderState({layers:[l]}),v=new T2(l.textureWidth,l.textureHeight,{format:t2,type:T4,depthTexture:new HN(l.textureWidth,l.textureHeight,re,void 0,void 0,void 0,void 0,void 0,void 0,K),stencilBuffer:d.stencil,encoding:t.outputEncoding,samples:d.antialias?4:0}),t.properties.get(v).__ignoreDepthValues=l.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(1),s=yield i.requestReferenceSpace(a),O.setContext(i),O.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(k){return I.apply(this,arguments)}}();let G=new ee,C=new ee;function F(I,k){null===k?I.matrixWorld.copy(I.matrix):I.matrixWorld.multiplyMatrices(k.matrixWorld,I.matrix),I.matrixWorldInverse.copy(I.matrixWorld).invert()}this.updateCamera=function(I){if(null===i)return;b.near=g.near=y.near=I.near,b.far=g.far=y.far=I.far,(E!==b.near||P!==b.far)&&(i.updateRenderState({depthNear:b.near,depthFar:b.far}),E=b.near,P=b.far);let k=I.parent,K=b.cameras;F(b,k);for(let ae=0;ae<K.length;ae++)F(K[ae],k);b.matrixWorld.decompose(b.position,b.quaternion,b.scale),I.position.copy(b.position),I.quaternion.copy(b.quaternion),I.scale.copy(b.scale),I.matrix.copy(b.matrix),I.matrixWorld.copy(b.matrixWorld);let re=I.children;for(let ae=0,ue=re.length;ae<ue;ae++)re[ae].updateMatrixWorld(!0);2===K.length?function N(I,k,K){G.setFromMatrixPosition(k.matrixWorld),C.setFromMatrixPosition(K.matrixWorld);let re=G.distanceTo(C),ae=k.projectionMatrix.elements,ue=K.projectionMatrix.elements,Le=ae[14]/(ae[10]-1),Oe=ae[14]/(ae[10]+1),Pe=(ae[9]+1)/ae[5],ie=(ae[9]-1)/ae[5],st=(ae[8]-1)/ae[0],ke=(ue[8]+1)/ue[0],_e=Le*st,oe=Le*ke,xe=re/(-st+ke),X=xe*-st;k.matrixWorld.decompose(I.position,I.quaternion,I.scale),I.translateX(X),I.translateZ(xe),I.matrixWorld.compose(I.position,I.quaternion,I.scale),I.matrixWorldInverse.copy(I.matrixWorld).invert();let fe=Le+xe,pe=Oe+xe;I.projectionMatrix.makePerspective(_e-X,oe+(re-X),Pe*Oe/pe*fe,ie*Oe/pe*fe,fe,pe)}(b,y,g):b.projectionMatrix.copy(y.projectionMatrix)},this.getCamera=function(){return b},this.getFoveation=function(){return null!==l?l.fixedFoveation:null!==u?u.fixedFoveation:void 0},this.setFoveation=function(I){null!==l&&(l.fixedFoveation=I),null!==u&&void 0!==u.fixedFoveation&&(u.fixedFoveation=I)};let U=null,O=new nN;O.setAnimationLoop(function $(I,k){if(o=k.getViewerPose(s),f=k,null!==o){let re=o.views;null!==u&&(t.setRenderTargetFramebuffer(v,u.framebuffer),t.setRenderTarget(v));let ae=!1;re.length!==b.cameras.length&&(b.cameras.length=0,ae=!0);for(let ue=0;ue<re.length;ue++){let Le=re[ue],Oe=null;if(null!==u)Oe=u.getViewport(Le);else{let ie=c.getViewSubImage(l,Le);Oe=ie.viewport,0===ue&&(t.setRenderTargetTextures(v,ie.colorTexture,l.ignoreDepthValues?void 0:ie.depthStencilTexture),t.setRenderTarget(v))}let Pe=S[ue];Pe.matrix.fromArray(Le.transform.matrix),Pe.projectionMatrix.fromArray(Le.projectionMatrix),Pe.viewport.set(Oe.x,Oe.y,Oe.width,Oe.height),0===ue&&b.matrix.copy(Pe.matrix),!0===ae&&b.cameras.push(Pe)}}let K=i.inputSources;for(let re=0;re<_.length;re++)_[re].update(K[re],k,s);U&&U(I,k),f=null}),this.setAnimationLoop=function(I){U=I},this.dispose=function(){}}};function f4e(t){function i(y,g){y.opacity.value=g.opacity,g.color&&y.diffuse.value.copy(g.color),g.emissive&&y.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(y.map.value=g.map),g.alphaMap&&(y.alphaMap.value=g.alphaMap),g.specularMap&&(y.specularMap.value=g.specularMap),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest);let b,E,S=t.get(g).envMap;S&&(y.envMap.value=S,y.flipEnvMap.value=S.isCubeTexture&&!1===S.isRenderTargetTexture?-1:1,y.reflectivity.value=g.reflectivity,y.ior.value=g.ior,y.refractionRatio.value=g.refractionRatio),g.lightMap&&(y.lightMap.value=g.lightMap,y.lightMapIntensity.value=g.lightMapIntensity),g.aoMap&&(y.aoMap.value=g.aoMap,y.aoMapIntensity.value=g.aoMapIntensity),g.map?b=g.map:g.specularMap?b=g.specularMap:g.displacementMap?b=g.displacementMap:g.normalMap?b=g.normalMap:g.bumpMap?b=g.bumpMap:g.roughnessMap?b=g.roughnessMap:g.metalnessMap?b=g.metalnessMap:g.alphaMap?b=g.alphaMap:g.emissiveMap?b=g.emissiveMap:g.clearcoatMap?b=g.clearcoatMap:g.clearcoatNormalMap?b=g.clearcoatNormalMap:g.clearcoatRoughnessMap?b=g.clearcoatRoughnessMap:g.specularIntensityMap?b=g.specularIntensityMap:g.specularColorMap?b=g.specularColorMap:g.transmissionMap?b=g.transmissionMap:g.thicknessMap?b=g.thicknessMap:g.sheenColorMap?b=g.sheenColorMap:g.sheenRoughnessMap&&(b=g.sheenRoughnessMap),void 0!==b&&(b.isWebGLRenderTarget&&(b=b.texture),!0===b.matrixAutoUpdate&&b.updateMatrix(),y.uvTransform.value.copy(b.matrix)),g.aoMap?E=g.aoMap:g.lightMap&&(E=g.lightMap),void 0!==E&&(E.isWebGLRenderTarget&&(E=E.texture),!0===E.matrixAutoUpdate&&E.updateMatrix(),y.uv2Transform.value.copy(E.matrix))}function f(y,g){y.roughness.value=g.roughness,y.metalness.value=g.metalness,g.roughnessMap&&(y.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(y.metalnessMap.value=g.metalnessMap),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap),g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias),t.get(g).envMap&&(y.envMapIntensity.value=g.envMapIntensity)}return{refreshFogUniforms:function e(y,g){y.fogColor.value.copy(g.color),g.isFog?(y.fogNear.value=g.near,y.fogFar.value=g.far):g.isFogExp2&&(y.fogDensity.value=g.density)},refreshMaterialUniforms:function n(y,g,S,b,E){g.isMeshBasicMaterial?i(y,g):g.isMeshLambertMaterial?(i(y,g),function c(y,g){g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap)}(y,g)):g.isMeshToonMaterial?(i(y,g),function u(y,g){g.gradientMap&&(y.gradientMap.value=g.gradientMap),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap),g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isMeshPhongMaterial?(i(y,g),function l(y,g){y.specular.value.copy(g.specular),y.shininess.value=Math.max(g.shininess,1e-4),g.emissiveMap&&(y.emissiveMap.value=g.emissiveMap),g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isMeshStandardMaterial?(i(y,g),g.isMeshPhysicalMaterial?function d(y,g,S){f(y,g),y.ior.value=g.ior,g.sheen>0&&(y.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),y.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(y.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(y.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(y.clearcoat.value=g.clearcoat,y.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(y.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(y.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),y.clearcoatNormalMap.value=g.clearcoatNormalMap,1===g.side&&y.clearcoatNormalScale.value.negate())),g.transmission>0&&(y.transmission.value=g.transmission,y.transmissionSamplerMap.value=S.texture,y.transmissionSamplerSize.value.set(S.width,S.height),g.transmissionMap&&(y.transmissionMap.value=g.transmissionMap),y.thickness.value=g.thickness,g.thicknessMap&&(y.thicknessMap.value=g.thicknessMap),y.attenuationDistance.value=g.attenuationDistance,y.attenuationColor.value.copy(g.attenuationColor)),y.specularIntensity.value=g.specularIntensity,y.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(y.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(y.specularColorMap.value=g.specularColorMap)}(y,g,E):f(y,g)):g.isMeshMatcapMaterial?(i(y,g),function m(y,g){g.matcap&&(y.matcap.value=g.matcap),g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isMeshDepthMaterial?(i(y,g),function v(y,g){g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isMeshDistanceMaterial?(i(y,g),function _(y,g){g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias),y.referencePosition.value.copy(g.referencePosition),y.nearDistance.value=g.nearDistance,y.farDistance.value=g.farDistance}(y,g)):g.isMeshNormalMaterial?(i(y,g),function M(y,g){g.bumpMap&&(y.bumpMap.value=g.bumpMap,y.bumpScale.value=g.bumpScale,1===g.side&&(y.bumpScale.value*=-1)),g.normalMap&&(y.normalMap.value=g.normalMap,y.normalScale.value.copy(g.normalScale),1===g.side&&y.normalScale.value.negate()),g.displacementMap&&(y.displacementMap.value=g.displacementMap,y.displacementScale.value=g.displacementScale,y.displacementBias.value=g.displacementBias)}(y,g)):g.isLineBasicMaterial?(function r(y,g){y.diffuse.value.copy(g.color),y.opacity.value=g.opacity}(y,g),g.isLineDashedMaterial&&function s(y,g){y.dashSize.value=g.dashSize,y.totalSize.value=g.dashSize+g.gapSize,y.scale.value=g.scale}(y,g)):g.isPointsMaterial?function a(y,g,S,b){let E;y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.size.value=g.size*S,y.scale.value=.5*b,g.map&&(y.map.value=g.map),g.alphaMap&&(y.alphaMap.value=g.alphaMap),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest),g.map?E=g.map:g.alphaMap&&(E=g.alphaMap),void 0!==E&&(!0===E.matrixAutoUpdate&&E.updateMatrix(),y.uvTransform.value.copy(E.matrix))}(y,g,S,b):g.isSpriteMaterial?function o(y,g){let S;y.diffuse.value.copy(g.color),y.opacity.value=g.opacity,y.rotation.value=g.rotation,g.map&&(y.map.value=g.map),g.alphaMap&&(y.alphaMap.value=g.alphaMap),g.alphaTest>0&&(y.alphaTest.value=g.alphaTest),g.map?S=g.map:g.alphaMap&&(S=g.alphaMap),void 0!==S&&(!0===S.matrixAutoUpdate&&S.updateMatrix(),y.uvTransform.value.copy(S.matrix))}(y,g):g.isShadowMaterial?(y.color.value.copy(g.color),y.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function S1(t={}){let u,e=void 0!==t.canvas?t.canvas:function d4e(){let t=A8("canvas");return t.style.display="block",t}(),n=void 0!==t.context?t.context:null,i=void 0===t.depth||t.depth,r=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,o=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",l=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;u=void 0!==t.context?n.getContextAttributes().alpha:void 0!==t.alpha&&t.alpha;let f=null,d=null,m=[],v=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=io,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;let _=this,M=!1,y=0,g=0,S=null,b=-1,E=null,P=new b1,V=new b1,j=null,Y=e.width,G=e.height,C=1,N=null,F=null,U=new b1(0,0,Y,G),$=new b1(0,0,Y,G),O=!1,I=new Nf,k=!1,K=!1,re=null,ae=new Ct,ue=new Ie,Le=new ee,Oe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Pe(){return null===S?C:1}let ke,_e,oe,xe,X,fe,pe,Te,Se,We,Fe,rt,Gt,D,z,J,se,ge,Me,Ne,te,Be,Ze,ie=n;function st(T,B){for(let Z=0;Z<T.length;Z++){let ne=e.getContext(T[Z],B);if(null!==ne)return ne}return null}try{let T={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:c,failIfMajorPerformanceCaveat:l};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r138"),e.addEventListener("webglcontextlost",H,!1),e.addEventListener("webglcontextrestored",be,!1),null===ie){let B=["webgl2","webgl","experimental-webgl"];if(!0===_.isWebGL1Renderer&&B.shift(),ie=st(B,T),null===ie)throw st(B)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ie.getShaderPrecisionFormat&&(ie.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(T){throw console.error("THREE.WebGLRenderer: "+T.message),T}function De(){ke=new Dae(ie),_e=new Cae(ie,ke,t),ke.init(_e),Be=new l4e(ie,ke,_e),oe=new o4e(ie,ke,_e),xe=new Rae(ie),X=new Yoe,fe=new c4e(ie,ke,oe,X,_e,Be,xe),pe=new zae(_),Te=new Lae(_),Se=new $2e(ie,_e),Ze=new wae(ie,ke,Se,_e),We=new Pae(ie,Se,xe,Ze),Fe=new Oae(ie,We,Se,xe),Me=new Vae(ie,_e,fe),J=new Eae(X),rt=new Xoe(_,pe,Te,ke,_e,Ze,J),Gt=new f4e(X),D=new Koe,z=new r4e(ke,_e),ge=new bae(_,pe,oe,Fe,u,a),se=new NN(_,Fe,_e),Ne=new Sae(ie,ke,xe,_e),te=new Nae(ie,ke,xe,_e),xe.programs=rt.programs,_.capabilities=_e,_.extensions=ke,_.properties=X,_.renderLists=D,_.shadowMap=se,_.state=oe,_.info=xe}De();let we=new u4e(_,ie);function H(T){T.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function be(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1;let T=xe.autoReset,B=se.enabled,Z=se.autoUpdate,q=se.needsUpdate,ne=se.type;De(),xe.autoReset=T,se.enabled=B,se.autoUpdate=Z,se.needsUpdate=q,se.type=ne}function ve(T){let B=T.target;B.removeEventListener("dispose",ve),function je(T){(function ye(T){let B=X.get(T).programs;void 0!==B&&(B.forEach(function(Z){rt.releaseProgram(Z)}),T.isShaderMaterial&&rt.releaseShaderCache(T))})(T),X.remove(T)}(B)}this.xr=we,this.getContext=function(){return ie},this.getContextAttributes=function(){return ie.getContextAttributes()},this.forceContextLoss=function(){let T=ke.get("WEBGL_lose_context");T&&T.loseContext()},this.forceContextRestore=function(){let T=ke.get("WEBGL_lose_context");T&&T.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(T){void 0!==T&&(C=T,this.setSize(Y,G,!1))},this.getSize=function(T){return T.set(Y,G)},this.setSize=function(T,B,Z){we.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Y=T,G=B,e.width=Math.floor(T*C),e.height=Math.floor(B*C),!1!==Z&&(e.style.width=T+"px",e.style.height=B+"px"),this.setViewport(0,0,T,B))},this.getDrawingBufferSize=function(T){return T.set(Y*C,G*C).floor()},this.setDrawingBufferSize=function(T,B,Z){Y=T,G=B,C=Z,e.width=Math.floor(T*Z),e.height=Math.floor(B*Z),this.setViewport(0,0,T,B)},this.getCurrentViewport=function(T){return T.copy(P)},this.getViewport=function(T){return T.copy(U)},this.setViewport=function(T,B,Z,q){T.isVector4?U.set(T.x,T.y,T.z,T.w):U.set(T,B,Z,q),oe.viewport(P.copy(U).multiplyScalar(C).floor())},this.getScissor=function(T){return T.copy($)},this.setScissor=function(T,B,Z,q){T.isVector4?$.set(T.x,T.y,T.z,T.w):$.set(T,B,Z,q),oe.scissor(V.copy($).multiplyScalar(C).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(T){oe.setScissorTest(O=T)},this.setOpaqueSort=function(T){N=T},this.setTransparentSort=function(T){F=T},this.getClearColor=function(T){return T.copy(ge.getClearColor())},this.setClearColor=function(){ge.setClearColor.apply(ge,arguments)},this.getClearAlpha=function(){return ge.getClearAlpha()},this.setClearAlpha=function(){ge.setClearAlpha.apply(ge,arguments)},this.clear=function(T=!0,B=!0,Z=!0){let q=0;T&&(q|=16384),B&&(q|=256),Z&&(q|=1024),ie.clear(q)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",H,!1),e.removeEventListener("webglcontextrestored",be,!1),D.dispose(),z.dispose(),X.dispose(),pe.dispose(),Te.dispose(),Fe.dispose(),Ze.dispose(),rt.dispose(),we.dispose(),we.removeEventListener("sessionstart",et),we.removeEventListener("sessionend",q1),re&&(re.dispose(),re=null),vt.stop()},this.renderBufferDirect=function(T,B,Z,q,ne,Re){null===B&&(B=Oe);let $e=ne.isMesh&&ne.matrixWorld.determinant()<0,Ye=function ax(T,B,Z,q,ne){!0!==B.isScene&&(B=Oe),fe.resetTextureUnits();let Re=B.fog,Ye=null===S?_.outputEncoding:!0===S.isXRRenderTarget?S.texture.encoding:io,Ke=(q.isMeshStandardMaterial?Te:pe).get(q.envMap||(q.isMeshStandardMaterial?B.environment:null)),_t=!0===q.vertexColors&&!!Z.attributes.color&&4===Z.attributes.color.itemSize,at=!!q.normalMap&&!!Z.attributes.tangent,ct=!!Z.morphAttributes.position,Ft=!!Z.morphAttributes.normal,Gi=!!Z.morphAttributes.color,N2=q.toneMapped?_.toneMapping:0,R2=Z.morphAttributes.position||Z.morphAttributes.normal||Z.morphAttributes.color,vn=void 0!==R2?R2.length:0,ft=X.get(q),H2=d.state.lights;!0!==k||!0!==K&&T===E||J.setState(q,T,T===E&&q.id===b);let N1=!1;q.version===ft.__version?(ft.needsLights&&ft.lightsStateVersion!==H2.state.version||ft.outputEncoding!==Ye||ne.isInstancedMesh&&!1===ft.instancing||!ne.isInstancedMesh&&!0===ft.instancing||ne.isSkinnedMesh&&!1===ft.skinning||!ne.isSkinnedMesh&&!0===ft.skinning||ft.envMap!==Ke||q.fog&&ft.fog!==Re||void 0!==ft.numClippingPlanes&&(ft.numClippingPlanes!==J.numPlanes||ft.numIntersection!==J.numIntersection)||ft.vertexAlphas!==_t||ft.vertexTangents!==at||ft.morphTargets!==ct||ft.morphNormals!==Ft||ft.morphColors!==Gi||ft.toneMapping!==N2||!0===_e.isWebGL2&&ft.morphTargetsCount!==vn)&&(N1=!0):(N1=!0,ft.__version=q.version);let yn=ft.currentProgram;!0===N1&&(yn=W4(q,B,ne));let ui=!1,Vr=!1,j4=!1,h1=yn.getUniforms(),Or=ft.uniforms;if(oe.useProgram(yn.program)&&(ui=!0,Vr=!0,j4=!0),q.id!==b&&(b=q.id,Vr=!0),ui||E!==T){if(h1.setValue(ie,"projectionMatrix",T.projectionMatrix),_e.logarithmicDepthBuffer&&h1.setValue(ie,"logDepthBufFC",2/(Math.log(T.far+1)/Math.LN2)),E!==T&&(E=T,Vr=!0,j4=!0),q.isShaderMaterial||q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshStandardMaterial||q.envMap){let tn=h1.map.cameraPosition;void 0!==tn&&tn.setValue(ie,Le.setFromMatrixPosition(T.matrixWorld))}(q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshLambertMaterial||q.isMeshBasicMaterial||q.isMeshStandardMaterial||q.isShaderMaterial)&&h1.setValue(ie,"isOrthographic",!0===T.isOrthographicCamera),(q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshLambertMaterial||q.isMeshBasicMaterial||q.isMeshStandardMaterial||q.isShaderMaterial||q.isShadowMaterial||ne.isSkinnedMesh)&&h1.setValue(ie,"viewMatrix",T.matrixWorldInverse)}if(ne.isSkinnedMesh){h1.setOptional(ie,ne,"bindMatrix"),h1.setOptional(ie,ne,"bindMatrixInverse");let tn=ne.skeleton;tn&&(_e.floatVertexTextures?(null===tn.boneTexture&&tn.computeBoneTexture(),h1.setValue(ie,"boneTexture",tn.boneTexture,fe),h1.setValue(ie,"boneTextureSize",tn.boneTextureSize)):h1.setOptional(ie,tn,"boneMatrices"))}let q4=Z.morphAttributes;return(void 0!==q4.position||void 0!==q4.normal||void 0!==q4.color&&!0===_e.isWebGL2)&&Me.update(ne,Z,q,yn),(Vr||ft.receiveShadow!==ne.receiveShadow)&&(ft.receiveShadow=ne.receiveShadow,h1.setValue(ie,"receiveShadow",ne.receiveShadow)),Vr&&(h1.setValue(ie,"toneMappingExposure",_.toneMappingExposure),ft.needsLights&&function ox(T,B){T.ambientLightColor.needsUpdate=B,T.lightProbe.needsUpdate=B,T.directionalLights.needsUpdate=B,T.directionalLightShadows.needsUpdate=B,T.pointLights.needsUpdate=B,T.pointLightShadows.needsUpdate=B,T.spotLights.needsUpdate=B,T.spotLightShadows.needsUpdate=B,T.rectAreaLights.needsUpdate=B,T.hemisphereLights.needsUpdate=B,T.directionalShadowMap.needsUpdate=B,T.directionalShadowMatrix.needsUpdate=B,T.spotShadowMap.needsUpdate=B,T.spotShadowMatrix.needsUpdate=B,T.pointShadowMap.needsUpdate=B,T.pointShadowMatrix.needsUpdate=B}(Or,j4),Re&&q.fog&&Gt.refreshFogUniforms(Or,Re),Gt.refreshMaterialUniforms(Or,q,C,G,re),uo.upload(ie,ft.uniformsList,Or,fe)),q.isShaderMaterial&&!0===q.uniformsNeedUpdate&&(uo.upload(ie,ft.uniformsList,Or,fe),q.uniformsNeedUpdate=!1),q.isSpriteMaterial&&h1.setValue(ie,"center",ne.center),h1.setValue(ie,"modelViewMatrix",ne.modelViewMatrix),h1.setValue(ie,"normalMatrix",ne.normalMatrix),h1.setValue(ie,"modelMatrix",ne.matrixWorld),yn}(T,B,Z,q,ne);oe.setMaterial(q,$e);let Ke=Z.index,_t=Z.attributes.position;if(null===Ke){if(void 0===_t||0===_t.count)return}else if(0===Ke.count)return;let at=1;!0===q.wireframe&&(Ke=We.getWireframeAttribute(Z),at=2),Ze.setup(ne,q,Ye,Z,Ke);let ct,Ft=Ne;null!==Ke&&(ct=Se.get(Ke),Ft=te,Ft.setIndex(ct));let Gi=null!==Ke?Ke.count:_t.count,N2=Z.drawRange.start*at,R2=Z.drawRange.count*at,vn=null!==Re?Re.start*at:0,ft=null!==Re?Re.count*at:1/0,H2=Math.max(N2,vn),N1=Math.min(Gi,N2+R2,vn+ft)-1,yn=Math.max(0,N1-H2+1);if(0!==yn){if(ne.isMesh)!0===q.wireframe?(oe.setLineWidth(q.wireframeLinewidth*Pe()),Ft.setMode(1)):Ft.setMode(4);else if(ne.isLine){let ui=q.linewidth;void 0===ui&&(ui=1),oe.setLineWidth(ui*Pe()),Ft.setMode(ne.isLineSegments?1:ne.isLineLoop?2:3)}else ne.isPoints?Ft.setMode(0):ne.isSprite&&Ft.setMode(4);if(ne.isInstancedMesh)Ft.renderInstances(H2,yn,ne.count);else if(Z.isInstancedBufferGeometry){let ui=Math.min(Z.instanceCount,Z._maxInstanceCount);Ft.renderInstances(H2,yn,ui)}else Ft.render(H2,yn)}},this.compile=function(T,B){d=z.get(T),d.init(),v.push(d),T.traverseVisible(function(Z){Z.isLight&&Z.layers.test(B.layers)&&(d.pushLight(Z),Z.castShadow&&d.pushShadow(Z))}),d.setupLights(_.physicallyCorrectLights),T.traverse(function(Z){let q=Z.material;if(q)if(Array.isArray(q))for(let ne=0;ne<q.length;ne++)W4(q[ne],T,Z);else W4(q,T,Z)}),v.pop(),d=null};let ce=null;function et(){vt.stop()}function q1(){vt.start()}let vt=new nN;function mn(T,B,Z,q){if(!1===T.visible)return;if(T.layers.test(B.layers))if(T.isGroup)Z=T.renderOrder;else if(T.isLOD)!0===T.autoUpdate&&T.update(B);else if(T.isLight)d.pushLight(T),T.castShadow&&d.pushShadow(T);else if(T.isSprite){if(!T.frustumCulled||I.intersectsSprite(T)){q&&Le.setFromMatrixPosition(T.matrixWorld).applyMatrix4(ae);let Re=Fe.update(T),$e=T.material;$e.visible&&f.push(T,Re,$e,Z,Le.z,null)}}else if((T.isMesh||T.isLine||T.isPoints)&&(T.isSkinnedMesh&&T.skeleton.frame!==xe.render.frame&&(T.skeleton.update(),T.skeleton.frame=xe.render.frame),!T.frustumCulled||I.intersectsObject(T))){q&&Le.setFromMatrixPosition(T.matrixWorld).applyMatrix4(ae);let Re=Fe.update(T),$e=T.material;if(Array.isArray($e)){let Ye=Re.groups;for(let Ke=0,_t=Ye.length;Ke<_t;Ke++){let at=Ye[Ke],ct=$e[at.materialIndex];ct&&ct.visible&&f.push(T,Re,ct,Z,Le.z,at)}}else $e.visible&&f.push(T,Re,$e,Z,Le.z,null)}let ne=T.children;for(let Re=0,$e=ne.length;Re<$e;Re++)mn(ne[Re],B,Z,q)}function gn(T,B,Z,q){let ne=T.opaque,Re=T.transmissive,$e=T.transparent;d.setupLightsView(Z),Re.length>0&&function rx(T,B,Z){let q=_e.isWebGL2;null===re&&(re=new T2(1,1,{generateMipmaps:!0,type:null!==Be.convert(yc)?yc:T4,minFilter:1008,samples:q&&!0===s?4:0})),_.getDrawingBufferSize(ue),q?re.setSize(ue.x,ue.y):re.setSize(My(ue.x),My(ue.y));let ne=_.getRenderTarget();_.setRenderTarget(re),_.clear();let Re=_.toneMapping;_.toneMapping=0,aa(T,B,Z),_.toneMapping=Re,fe.updateMultisampleRenderTarget(re),fe.updateRenderTargetMipmap(re),_.setRenderTarget(ne)}(ne,B,Z),q&&oe.viewport(P.copy(q)),ne.length>0&&aa(ne,B,Z),Re.length>0&&aa(Re,B,Z),$e.length>0&&aa($e,B,Z),oe.buffers.depth.setTest(!0),oe.buffers.depth.setMask(!0),oe.buffers.color.setMask(!0),oe.setPolygonOffset(!1)}function aa(T,B,Z){let q=!0===B.isScene?B.overrideMaterial:null;for(let ne=0,Re=T.length;ne<Re;ne++){let $e=T[ne],Ye=$e.object,Ke=$e.geometry,_t=null===q?$e.material:q,at=$e.group;Ye.layers.test(Z.layers)&&sx(Ye,B,Z,Ke,_t,at)}}function sx(T,B,Z,q,ne,Re){T.onBeforeRender(_,B,Z,q,ne,Re),T.modelViewMatrix.multiplyMatrices(Z.matrixWorldInverse,T.matrixWorld),T.normalMatrix.getNormalMatrix(T.modelViewMatrix),ne.onBeforeRender(_,B,Z,q,T,Re),!0===ne.transparent&&2===ne.side?(ne.side=1,ne.needsUpdate=!0,_.renderBufferDirect(Z,B,q,ne,T,Re),ne.side=0,ne.needsUpdate=!0,_.renderBufferDirect(Z,B,q,ne,T,Re),ne.side=2):_.renderBufferDirect(Z,B,q,ne,T,Re),T.onAfterRender(_,B,Z,q,ne,Re)}function W4(T,B,Z){!0!==B.isScene&&(B=Oe);let q=X.get(T),ne=d.state.lights,$e=ne.state.version,Ye=rt.getParameters(T,ne.state,d.state.shadowsArray,B,Z),Ke=rt.getProgramCacheKey(Ye),_t=q.programs;q.environment=T.isMeshStandardMaterial?B.environment:null,q.fog=B.fog,q.envMap=(T.isMeshStandardMaterial?Te:pe).get(T.envMap||q.environment),void 0===_t&&(T.addEventListener("dispose",ve),_t=new Map,q.programs=_t);let at=_t.get(Ke);if(void 0!==at){if(q.currentProgram===at&&q.lightsStateVersion===$e)return K8(T,Ye),at}else Ye.uniforms=rt.getUniforms(T),T.onBuild(Z,Ye,_),T.onBeforeCompile(Ye,_),at=rt.acquireProgram(Ye,Ke),_t.set(Ke,at),q.uniforms=Ye.uniforms;let ct=q.uniforms;(!T.isShaderMaterial&&!T.isRawShaderMaterial||!0===T.clipping)&&(ct.clippingPlanes=J.uniform),K8(T,Ye),q.needsLights=function cx(T){return T.isMeshLambertMaterial||T.isMeshToonMaterial||T.isMeshPhongMaterial||T.isMeshStandardMaterial||T.isShadowMaterial||T.isShaderMaterial&&!0===T.lights}(T),q.lightsStateVersion=$e,q.needsLights&&(ct.ambientLightColor.value=ne.state.ambient,ct.lightProbe.value=ne.state.probe,ct.directionalLights.value=ne.state.directional,ct.directionalLightShadows.value=ne.state.directionalShadow,ct.spotLights.value=ne.state.spot,ct.spotLightShadows.value=ne.state.spotShadow,ct.rectAreaLights.value=ne.state.rectArea,ct.ltc_1.value=ne.state.rectAreaLTC1,ct.ltc_2.value=ne.state.rectAreaLTC2,ct.pointLights.value=ne.state.point,ct.pointLightShadows.value=ne.state.pointShadow,ct.hemisphereLights.value=ne.state.hemi,ct.directionalShadowMap.value=ne.state.directionalShadowMap,ct.directionalShadowMatrix.value=ne.state.directionalShadowMatrix,ct.spotShadowMap.value=ne.state.spotShadowMap,ct.spotShadowMatrix.value=ne.state.spotShadowMatrix,ct.pointShadowMap.value=ne.state.pointShadowMap,ct.pointShadowMatrix.value=ne.state.pointShadowMatrix);let Ft=at.getUniforms(),Gi=uo.seqWithValue(Ft.seq,ct);return q.currentProgram=at,q.uniformsList=Gi,at}function K8(T,B){let Z=X.get(T);Z.outputEncoding=B.outputEncoding,Z.instancing=B.instancing,Z.skinning=B.skinning,Z.morphTargets=B.morphTargets,Z.morphNormals=B.morphNormals,Z.morphColors=B.morphColors,Z.morphTargetsCount=B.morphTargetsCount,Z.numClippingPlanes=B.numClippingPlanes,Z.numIntersection=B.numClipIntersection,Z.vertexAlphas=B.vertexAlphas,Z.vertexTangents=B.vertexTangents,Z.toneMapping=B.toneMapping}vt.setAnimationLoop(function Ue(T){ce&&ce(T)}),typeof window<"u"&&vt.setContext(window),this.setAnimationLoop=function(T){ce=T,we.setAnimationLoop(T),null===T?vt.stop():vt.start()},we.addEventListener("sessionstart",et),we.addEventListener("sessionend",q1),this.render=function(T,B){if(void 0===B||!0===B.isCamera){if(!0!==M){if(!0===T.autoUpdate&&T.updateMatrixWorld(),null===B.parent&&B.updateMatrixWorld(),!0===we.enabled&&!0===we.isPresenting&&(!0===we.cameraAutoUpdate&&we.updateCamera(B),B=we.getCamera()),!0===T.isScene&&T.onBeforeRender(_,T,B,S),d=z.get(T,v.length),d.init(),v.push(d),ae.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse),I.setFromProjectionMatrix(ae),K=this.localClippingEnabled,k=J.init(this.clippingPlanes,K,B),f=D.get(T,m.length),f.init(),m.push(f),mn(T,B,0,_.sortObjects),f.finish(),!0===_.sortObjects&&f.sort(N,F),!0===k&&J.beginShadows(),se.render(d.state.shadowsArray,T,B),!0===k&&J.endShadows(),!0===this.info.autoReset&&this.info.reset(),ge.render(f,T),d.setupLights(_.physicallyCorrectLights),B.isArrayCamera){let q=B.cameras;for(let ne=0,Re=q.length;ne<Re;ne++){let $e=q[ne];gn(f,T,$e,$e.viewport)}}else gn(f,T,B);null!==S&&(fe.updateMultisampleRenderTarget(S),fe.updateRenderTargetMipmap(S)),!0===T.isScene&&T.onAfterRender(_,T,B),Ze.resetDefaultState(),b=-1,E=null,v.pop(),d=v.length>0?v[v.length-1]:null,m.pop(),f=m.length>0?m[m.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return g},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(T,B,Z){X.get(T.texture).__webglTexture=B,X.get(T.depthTexture).__webglTexture=Z;let q=X.get(T);q.__hasExternalTextures=!0,q.__hasExternalTextures&&(q.__autoAllocateDepthBuffer=void 0===Z,q.__autoAllocateDepthBuffer||!0===ke.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),T.useRenderToTexture=!1,T.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(T,B){let Z=X.get(T);Z.__webglFramebuffer=B,Z.__useDefaultFramebuffer=void 0===B},this.setRenderTarget=function(T,B=0,Z=0){S=T,y=B,g=Z;let q=!0;if(T){let Ye=X.get(T);void 0!==Ye.__useDefaultFramebuffer?(oe.bindFramebuffer(36160,null),q=!1):void 0===Ye.__webglFramebuffer?fe.setupRenderTarget(T):Ye.__hasExternalTextures&&fe.rebindTextures(T,X.get(T.texture).__webglTexture,X.get(T.depthTexture).__webglTexture)}let ne=null,Re=!1,$e=!1;if(T){let Ye=T.texture;(Ye.isData3DTexture||Ye.isDataArrayTexture)&&($e=!0);let Ke=X.get(T).__webglFramebuffer;T.isWebGLCubeRenderTarget?(ne=Ke[B],Re=!0):ne=_e.isWebGL2&&T.samples>0&&!1===fe.useMultisampledRTT(T)?X.get(T).__webglMultisampledFramebuffer:Ke,P.copy(T.viewport),V.copy(T.scissor),j=T.scissorTest}else P.copy(U).multiplyScalar(C).floor(),V.copy($).multiplyScalar(C).floor(),j=O;if(oe.bindFramebuffer(36160,ne)&&_e.drawBuffers&&q&&oe.drawBuffers(T,ne),oe.viewport(P),oe.scissor(V),oe.setScissorTest(j),Re){let Ye=X.get(T.texture);ie.framebufferTexture2D(36160,36064,34069+B,Ye.__webglTexture,Z)}else if($e){let Ye=X.get(T.texture);ie.framebufferTextureLayer(36160,36064,Ye.__webglTexture,Z||0,B||0)}b=-1},this.readRenderTargetPixels=function(T,B,Z,q,ne,Re,$e){if(!T||!T.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ye=X.get(T).__webglFramebuffer;if(T.isWebGLCubeRenderTarget&&void 0!==$e&&(Ye=Ye[$e]),Ye){oe.bindFramebuffer(36160,Ye);try{let Ke=T.texture,_t=Ke.format,at=Ke.type;if(_t!==t2&&Be.convert(_t)!==ie.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");let ct=at===yc&&(ke.has("EXT_color_buffer_half_float")||_e.isWebGL2&&ke.has("EXT_color_buffer_float"));if(!(at===T4||Be.convert(at)===ie.getParameter(35738)||at===A4&&(_e.isWebGL2||ke.has("OES_texture_float")||ke.has("WEBGL_color_buffer_float"))||ct))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ie.checkFramebufferStatus(36160)?B>=0&&B<=T.width-q&&Z>=0&&Z<=T.height-ne&&ie.readPixels(B,Z,q,ne,Be.convert(_t),Be.convert(at),Re):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{let Ke=null!==S?X.get(S).__webglFramebuffer:null;oe.bindFramebuffer(36160,Ke)}}},this.copyFramebufferToTexture=function(T,B,Z=0){if(!0!==B.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");let q=Math.pow(2,-Z),ne=Math.floor(B.image.width*q),Re=Math.floor(B.image.height*q);fe.setTexture2D(B,0),ie.copyTexSubImage2D(3553,Z,0,0,T.x,T.y,ne,Re),oe.unbindTexture()},this.copyTextureToTexture=function(T,B,Z,q=0){let ne=B.image.width,Re=B.image.height,$e=Be.convert(Z.format),Ye=Be.convert(Z.type);fe.setTexture2D(Z,0),ie.pixelStorei(37440,Z.flipY),ie.pixelStorei(37441,Z.premultiplyAlpha),ie.pixelStorei(3317,Z.unpackAlignment),B.isDataTexture?ie.texSubImage2D(3553,q,T.x,T.y,ne,Re,$e,Ye,B.image.data):B.isCompressedTexture?ie.compressedTexSubImage2D(3553,q,T.x,T.y,B.mipmaps[0].width,B.mipmaps[0].height,$e,B.mipmaps[0].data):ie.texSubImage2D(3553,q,T.x,T.y,$e,Ye,B.image),0===q&&Z.generateMipmaps&&ie.generateMipmap(3553),oe.unbindTexture()},this.copyTextureToTexture3D=function(T,B,Z,q,ne=0){if(_.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");let at,Re=T.max.x-T.min.x+1,$e=T.max.y-T.min.y+1,Ye=T.max.z-T.min.z+1,Ke=Be.convert(q.format),_t=Be.convert(q.type);if(q.isData3DTexture)fe.setTexture3D(q,0),at=32879;else{if(!q.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");fe.setTexture2DArray(q,0),at=35866}ie.pixelStorei(37440,q.flipY),ie.pixelStorei(37441,q.premultiplyAlpha),ie.pixelStorei(3317,q.unpackAlignment);let ct=ie.getParameter(3314),Ft=ie.getParameter(32878),Gi=ie.getParameter(3316),N2=ie.getParameter(3315),R2=ie.getParameter(32877),vn=Z.isCompressedTexture?Z.mipmaps[0]:Z.image;ie.pixelStorei(3314,vn.width),ie.pixelStorei(32878,vn.height),ie.pixelStorei(3316,T.min.x),ie.pixelStorei(3315,T.min.y),ie.pixelStorei(32877,T.min.z),Z.isDataTexture||Z.isData3DTexture?ie.texSubImage3D(at,ne,B.x,B.y,B.z,Re,$e,Ye,Ke,_t,vn.data):Z.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ie.compressedTexSubImage3D(at,ne,B.x,B.y,B.z,Re,$e,Ye,Ke,vn.data)):ie.texSubImage3D(at,ne,B.x,B.y,B.z,Re,$e,Ye,Ke,_t,vn),ie.pixelStorei(3314,ct),ie.pixelStorei(32878,Ft),ie.pixelStorei(3316,Gi),ie.pixelStorei(3315,N2),ie.pixelStorei(32877,R2),0===ne&&q.generateMipmaps&&ie.generateMipmap(at),oe.unbindTexture()},this.initTexture=function(T){fe.setTexture2D(T,0),oe.unbindTexture()},this.resetState=function(){y=0,g=0,S=null,oe.reset(),Ze.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}S1.prototype.isWebGLRenderer=!0,class extends S1{}.prototype.isWebGL1Renderer=!0;var IN=class{constructor(t,e=25e-5){this.name="",this.color=new gt(t),this.density=e}clone(){return new IN(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}};IN.prototype.isFogExp2=!0;var VN=class{constructor(t,e=1,n=1e3){this.name="",this.color=new gt(t),this.near=e,this.far=n}clone(){return new VN(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}};VN.prototype.isFog=!0;var ON=class extends w1{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){let e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}};ON.prototype.isScene=!0;var H8=class{constructor(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=T8,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Lr()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Lr()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Lr()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};H8.prototype.isInterleavedBuffer=!0;var pn=new ee,If=class{constructor(t,e,n,i=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)pn.x=this.getX(e),pn.y=this.getY(e),pn.z=this.getZ(e),pn.applyMatrix4(t),this.setXYZ(e,pn.x,pn.y,pn.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)pn.x=this.getX(e),pn.y=this.getY(e),pn.z=this.getZ(e),pn.applyNormalMatrix(t),this.setXYZ(e,pn.x,pn.y,pn.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)pn.x=this.getX(e),pn.y=this.getY(e),pn.z=this.getZ(e),pn.transformDirection(t),this.setXYZ(e,pn.x,pn.y,pn.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,r){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");let e=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return new On(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new If(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");let e=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};If.prototype.isInterleavedBufferAttribute=!0;var i_=class extends Vn{constructor(t){super(),this.type="SpriteMaterial",this.color=new gt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}};i_.prototype.isSpriteMaterial=!0;var Wc,I8=new ee,jc=new ee,qc=new ee,Zc=new Ie,V8=new Ie,kN=new Ct,Vf=new ee,O8=new ee,Of=new ee,FN=new Ie,r_=new Ie,BN=new Ie;function kf(t,e,n,i,r,s){Zc.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(V8.x=s*Zc.x-r*Zc.y,V8.y=r*Zc.x+s*Zc.y):V8.copy(Zc),t.copy(e),t.x+=V8.x,t.y+=V8.y,t.applyMatrix4(kN)}(class extends w1{constructor(t){if(super(),this.type="Sprite",void 0===Wc){Wc=new Q1;let e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new H8(e,5);Wc.setIndex([0,1,2,0,2,3]),Wc.setAttribute("position",new If(n,3,0,!1)),Wc.setAttribute("uv",new If(n,2,3,!1))}this.geometry=Wc,this.material=void 0!==t?t:new i_,this.center=new Ie(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),jc.setFromMatrixScale(this.matrixWorld),kN.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),qc.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&jc.multiplyScalar(-qc.z);let i,r,n=this.material.rotation;0!==n&&(r=Math.cos(n),i=Math.sin(n));let s=this.center;kf(Vf.set(-.5,-.5,0),qc,s,jc,i,r),kf(O8.set(.5,-.5,0),qc,s,jc,i,r),kf(Of.set(.5,.5,0),qc,s,jc,i,r),FN.set(0,0),r_.set(1,0),BN.set(1,1);let a=t.ray.intersectTriangle(Vf,O8,Of,!1,I8);if(null===a&&(kf(O8.set(-.5,.5,0),qc,s,jc,i,r),r_.set(0,1),a=t.ray.intersectTriangle(Vf,Of,O8,!1,I8),null===a))return;let o=t.ray.origin.distanceTo(I8);o<t.near||o>t.far||e.push({distance:o,point:I8.clone(),uv:In.getUV(I8,Vf,O8,Of,FN,r_,BN,new Ie),face:null,object:this})}copy(t){return super.copy(t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}).prototype.isSprite=!0;var UN=new ee,GN=new b1,WN=new b1,g4e=new ee,jN=new Ct,qN=class extends s2{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ct,this.bindMatrixInverse=new Ct}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let t=new b1,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);let r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){let n=this.skeleton,i=this.geometry;GN.fromBufferAttribute(i.attributes.skinIndex,t),WN.fromBufferAttribute(i.attributes.skinWeight,t),UN.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let r=0;r<4;r++){let s=WN.getComponent(r);if(0!==s){let a=GN.getComponent(r);jN.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),e.addScaledVector(g4e.copy(UN).applyMatrix4(jN),s)}}return e.applyMatrix4(this.bindMatrixInverse)}};qN.prototype.isSkinnedMesh=!0,class extends w1{constructor(){super(),this.type="Bone"}}.prototype.isBone=!0,class extends hi{constructor(t=null,e=1,n=1,i,r,s,a,o,c=$n,l=$n,u,f){super(null,s,a,o,c,l,i,r,u,f),this.image={data:t,width:e,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}.prototype.isDataTexture=!0;var s_=class extends On{constructor(t,e,n,i=1){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){let t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}};s_.prototype.isInstancedBufferAttribute=!0;var ZN=new Ct,$N=new Ct,Ff=[],k8=new s2;(class extends s2{constructor(t,e,n){super(t,e),this.instanceMatrix=new s_(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){let n=this.matrixWorld,i=this.count;if(k8.geometry=this.geometry,k8.material=this.material,void 0!==k8.material)for(let r=0;r<i;r++){this.getMatrixAt(r,ZN),$N.multiplyMatrices(n,ZN),k8.matrixWorld=$N,k8.raycast(t,Ff);for(let s=0,a=Ff.length;s<a;s++){let o=Ff[s];o.instanceId=r,o.object=this,e.push(o)}Ff.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new s_(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;var $c=class extends Vn{constructor(t){super(),this.type="LineBasicMaterial",this.color=new gt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}};$c.prototype.isLineBasicMaterial=!0;var XN=new ee,YN=new ee,JN=new Ct,a_=new I4,Bf=new Ac,o_=class extends w1{constructor(t=new Q1,e=new $c){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){let t=this.geometry;if(t.isBufferGeometry)if(null===t.index){let e=t.attributes.position,n=[0];for(let i=1,r=e.count;i<r;i++)XN.fromBufferAttribute(e,i-1),YN.fromBufferAttribute(e,i),n[i]=n[i-1],n[i]+=XN.distanceTo(YN);t.setAttribute("lineDistance",new Xn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){let n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Bf.copy(n.boundingSphere),Bf.applyMatrix4(i),Bf.radius+=r,!1===t.ray.intersectsSphere(Bf))return;JN.copy(i).invert(),a_.copy(t.ray).applyMatrix4(JN);let a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,c=new ee,l=new ee,u=new ee,f=new ee,d=this.isLineSegments?2:1;if(n.isBufferGeometry){let m=n.index,v=n.attributes.position;if(null!==m)for(let y=Math.max(0,s.start),g=Math.min(m.count,s.start+s.count)-1;y<g;y+=d){let S=m.getX(y),b=m.getX(y+1);if(c.fromBufferAttribute(v,S),l.fromBufferAttribute(v,b),a_.distanceSqToSegment(c,l,f,u)>o)continue;f.applyMatrix4(this.matrixWorld);let E=t.ray.origin.distanceTo(f);E<t.near||E>t.far||e.push({distance:E,point:u.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}else for(let y=Math.max(0,s.start),g=Math.min(v.count,s.start+s.count)-1;y<g;y+=d){if(c.fromBufferAttribute(v,y),l.fromBufferAttribute(v,y+1),a_.distanceSqToSegment(c,l,f,u)>o)continue;f.applyMatrix4(this.matrixWorld);let S=t.ray.origin.distanceTo(f);S<t.near||S>t.far||e.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let t=this.geometry;if(t.isBufferGeometry){let e=t.morphAttributes,n=Object.keys(e);if(n.length>0){let i=e[n[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){let a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}else{let e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}};o_.prototype.isLine=!0;var KN=new ee,QN=new ee,c_=class extends o_{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){let t=this.geometry;if(t.isBufferGeometry)if(null===t.index){let e=t.attributes.position,n=[];for(let i=0,r=e.count;i<r;i+=2)KN.fromBufferAttribute(e,i),QN.fromBufferAttribute(e,i+1),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+KN.distanceTo(QN);t.setAttribute("lineDistance",new Xn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}};c_.prototype.isLineSegments=!0,class extends o_{constructor(t,e){super(t,e),this.type="LineLoop"}}.prototype.isLineLoop=!0;var l_=class extends Vn{constructor(t){super(),this.type="PointsMaterial",this.color=new gt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this}};l_.prototype.isPointsMaterial=!0;var eR=new Ct,h_=new I4,Uf=new Ac,Gf=new ee;function tR(t,e,n,i,r,s,a){let o=h_.distanceSqToPoint(t);if(o<n){let c=new ee;h_.closestPointToPoint(t,c),c.applyMatrix4(i);let l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(o),point:c,index:e,face:null,object:a})}}(class extends w1{constructor(t=new Q1,e=new l_){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){let n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Uf.copy(n.boundingSphere),Uf.applyMatrix4(i),Uf.radius+=r,!1===t.ray.intersectsSphere(Uf))return;eR.copy(i).invert(),h_.copy(t.ray).applyMatrix4(eR);let a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){let c=n.index,l=n.attributes.position;if(null!==c)for(let d=Math.max(0,s.start),m=Math.min(c.count,s.start+s.count);d<m;d++){let v=c.getX(d);Gf.fromBufferAttribute(l,v),tR(Gf,v,o,i,t,e,this)}else for(let d=Math.max(0,s.start),m=Math.min(l.count,s.start+s.count);d<m;d++)Gf.fromBufferAttribute(l,d),tR(Gf,d,o,i,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let t=this.geometry;if(t.isBufferGeometry){let e=t.morphAttributes,n=Object.keys(e);if(n.length>0){let i=e[n[0]];if(void 0!==i){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,s=i.length;r<s;r++){let a=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}else{let e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class extends hi{constructor(t,e,n,i,r,s,a,o,c){super(t,e,n,i,r,s,a,o,c),this.minFilter=void 0!==s?s:Ei,this.magFilter=void 0!==r?r:Ei,this.generateMipmaps=!1;let l=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function u(){l.needsUpdate=!0,t.requestVideoFrameCallback(u)})}clone(){return new this.constructor(this.image).copy(this)}update(){let t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class extends hi{constructor(t,e,n){super({width:t,height:e}),this.format=n,this.magFilter=$n,this.minFilter=$n,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0,class extends hi{constructor(t,e,n,i,r,s,a,o,c,l,u,f){super(null,s,a,o,c,l,i,r,u,f),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isCompressedTexture=!0,class extends hi{constructor(t,e,n,i,r,s,a,o,c){super(t,e,n,i,r,s,a,o,c),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,new ee,new ee,new ee,new In;var Q2=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){let n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){let e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){let e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){let t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let n,e=[],i=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){let s,n=this.getLengths(),i=0,r=n.length;s=e||t*n[r-1];let c,a=0,o=r-1;for(;a<=o;)if(i=Math.floor(a+(o-a)/2),c=n[i]-s,c<0)a=i+1;else{if(!(c>0)){o=i;break}o=i-1}if(i=o,n[i]===s)return i/(r-1);let l=n[i];return(i+(s-l)/(n[i+1]-l))/(r-1)}getTangent(t,e){let n=t-1e-4,i=t+1e-4;n<0&&(n=0),i>1&&(i=1);let r=this.getPoint(n),s=this.getPoint(i),a=e||(r.isVector2?new Ie:new ee);return a.copy(s).sub(r).normalize(),a}getTangentAt(t,e){let n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){let n=new ee,i=[],r=[],s=[],a=new ee,o=new Ct;for(let d=0;d<=t;d++)i[d]=this.getTangentAt(d/t,new ee);r[0]=new ee,s[0]=new ee;let c=Number.MAX_VALUE,l=Math.abs(i[0].x),u=Math.abs(i[0].y),f=Math.abs(i[0].z);l<=c&&(c=l,n.set(1,0,0)),u<=c&&(c=u,n.set(0,1,0)),f<=c&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=t;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();let m=Math.acos(n2(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(o.makeRotationAxis(a,m))}s[d].crossVectors(i[d],r[d])}if(!0===e){let d=Math.acos(n2(r[0].dot(r[t]),-1,1));d/=t,i[0].dot(a.crossVectors(r[0],r[t]))>0&&(d=-d);for(let m=1;m<=t;m++)r[m].applyMatrix4(o.makeRotationAxis(i[m],d*m)),s[m].crossVectors(i[m],r[m])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){let t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}},Wf=class extends Q2{constructor(t=0,e=0,n=1,i=1,r=0,s=2*Math.PI,a=!1,o=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(t,e){let n=e||new Ie,i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),!0===this.aClockwise&&!s&&(r===i?r=-i:r-=i);let a=this.aStartAngle+t*r,o=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){let l=Math.cos(this.aRotation),u=Math.sin(this.aRotation),f=o-this.aX,d=c-this.aY;o=f*l-d*u+this.aX,c=f*u+d*l+this.aY}return n.set(o,c)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){let t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}};Wf.prototype.isEllipseCurve=!0;var nR=class extends Wf{constructor(t,e,n,i,r,s){super(t,e,n,n,i,r,s),this.type="ArcCurve"}};function u_(){let t=0,e=0,n=0,i=0;function r(s,a,o,c){t=s,e=o,n=-3*s+3*a-2*o-c,i=2*s-2*a+o+c}return{initCatmullRom:function(s,a,o,c,l){r(a,o,l*(o-s),l*(c-a))},initNonuniformCatmullRom:function(s,a,o,c,l,u,f){let d=(a-s)/l-(o-s)/(l+u)+(o-a)/u,m=(o-a)/u-(c-a)/(u+f)+(c-o)/f;d*=u,m*=u,r(a,o,d,m)},calc:function(s){let a=s*s;return t+e*s+n*a+i*(a*s)}}}nR.prototype.isArcCurve=!0;var jf=new ee,f_=new u_,d_=new u_,p_=new u_,iR=class extends Q2{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new ee){let c,l,n=e,i=this.points,r=i.length,s=(r-(this.closed?0:1))*t,a=Math.floor(s),o=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/r)+1)*r:0===o&&a===r-1&&(a=r-2,o=1),this.closed||a>0?c=i[(a-1)%r]:(jf.subVectors(i[0],i[1]).add(i[0]),c=jf);let u=i[a%r],f=i[(a+1)%r];if(this.closed||a+2<r?l=i[(a+2)%r]:(jf.subVectors(i[r-1],i[r-2]).add(i[r-1]),l=jf),"centripetal"===this.curveType||"chordal"===this.curveType){let d="chordal"===this.curveType?.5:.25,m=Math.pow(c.distanceToSquared(u),d),v=Math.pow(u.distanceToSquared(f),d),_=Math.pow(f.distanceToSquared(l),d);v<1e-4&&(v=1),m<1e-4&&(m=v),_<1e-4&&(_=v),f_.initNonuniformCatmullRom(c.x,u.x,f.x,l.x,m,v,_),d_.initNonuniformCatmullRom(c.y,u.y,f.y,l.y,m,v,_),p_.initNonuniformCatmullRom(c.z,u.z,f.z,l.z,m,v,_)}else"catmullrom"===this.curveType&&(f_.initCatmullRom(c.x,u.x,f.x,l.x,this.tension),d_.initCatmullRom(c.y,u.y,f.y,l.y,this.tension),p_.initCatmullRom(c.z,u.z,f.z,l.z,this.tension));return n.set(f_.calc(o),d_.calc(o),p_.calc(o)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push((new ee).fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}};function rR(t,e,n,i,r){let s=.5*(i-e),a=.5*(r-n),o=t*t;return(2*n-2*i+s+a)*(t*o)+(-3*n+3*i-2*s-a)*o+s*t+n}function F8(t,e,n,i){return function E4e(t,e){let n=1-t;return n*n*e}(t,e)+function z4e(t,e){return 2*(1-t)*t*e}(t,n)+function T4e(t,e){return t*t*e}(t,i)}function B8(t,e,n,i,r){return function A4e(t,e){let n=1-t;return n*n*n*e}(t,e)+function L4e(t,e){let n=1-t;return 3*n*n*t*e}(t,n)+function D4e(t,e){return 3*(1-t)*t*t*e}(t,i)+function P4e(t,e){return t*t*t*e}(t,r)}iR.prototype.isCatmullRomCurve3=!0;var m_=class extends Q2{constructor(t=new Ie,e=new Ie,n=new Ie,i=new Ie){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new Ie){let n=e,i=this.v0,r=this.v1,s=this.v2,a=this.v3;return n.set(B8(t,i.x,r.x,s.x,a.x),B8(t,i.y,r.y,s.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}};m_.prototype.isCubicBezierCurve=!0;var sR=class extends Q2{constructor(t=new ee,e=new ee,n=new ee,i=new ee){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new ee){let n=e,i=this.v0,r=this.v1,s=this.v2,a=this.v3;return n.set(B8(t,i.x,r.x,s.x,a.x),B8(t,i.y,r.y,s.y,a.y),B8(t,i.z,r.z,s.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}};sR.prototype.isCubicBezierCurve3=!0;var qf=class extends Q2{constructor(t=new Ie,e=new Ie){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Ie){let n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){let n=e||new Ie;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}};qf.prototype.isLineCurve=!0;var g_=class extends Q2{constructor(t=new Ie,e=new Ie,n=new Ie){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Ie){let n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(F8(t,i.x,r.x,s.x),F8(t,i.y,r.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}};g_.prototype.isQuadraticBezierCurve=!0;var aR=class extends Q2{constructor(t=new ee,e=new ee,n=new ee){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new ee){let n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(F8(t,i.x,r.x,s.x),F8(t,i.y,r.y,s.y),F8(t,i.z,r.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}};aR.prototype.isQuadraticBezierCurve3=!0;var v_=class extends Q2{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new Ie){let n=e,i=this.points,r=(i.length-1)*t,s=Math.floor(r),a=r-s,o=i[0===s?s:s-1],c=i[s],l=i[s>i.length-2?i.length-1:s+1],u=i[s>i.length-3?i.length-1:s+2];return n.set(rR(a,o.x,c.x,l.x,u.x),rR(a,o.y,c.y,l.y,u.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push((new Ie).fromArray(i))}return this}};v_.prototype.isSplineCurve=!0;var oR=Object.freeze({__proto__:null,ArcCurve:nR,CatmullRomCurve3:iR,CubicBezierCurve:m_,CubicBezierCurve3:sR,EllipseCurve:Wf,LineCurve:qf,LineCurve3:class extends Q2{constructor(t=new ee,e=new ee){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new ee){let n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},QuadraticBezierCurve:g_,QuadraticBezierCurve3:aR,SplineCurve:v_}),R4e=class extends Q2{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){let t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new qf(e,t))}getPoint(t,e){let n=t*this.getLength(),i=this.getCurveLengths(),r=0;for(;r<i.length;){if(i[r]>=n){let s=i[r]-n,a=this.curves[r],o=a.getLength();return a.getPointAt(0===o?0:1-s/o,e)}r++}return null}getLength(){let t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let t=[],e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){let e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){let n,e=[];for(let i=0,r=this.curves;i<r.length;i++){let s=r[i],o=s.getPoints(s.isEllipseCurve?2*t:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t);for(let c=0;c<o.length;c++){let l=o[c];n&&n.equals(l)||(e.push(l),n=l)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this}toJSON(){let t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++)t.curves.push(this.curves[e].toJSON());return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){let i=t.curves[e];this.curves.push((new oR[i.type]).fromJSON(i))}return this}},y_=class extends R4e{constructor(t){super(),this.type="Path",this.currentPoint=new Ie,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){let n=new qf(this.currentPoint.clone(),new Ie(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){let r=new g_(this.currentPoint.clone(),new Ie(t,e),new Ie(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,s){let a=new m_(this.currentPoint.clone(),new Ie(t,e),new Ie(n,i),new Ie(r,s));return this.curves.push(a),this.currentPoint.set(r,s),this}splineThru(t){let e=[this.currentPoint.clone()].concat(t),n=new v_(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,s){return this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,i,r,s),this}absarc(t,e,n,i,r,s){return this.absellipse(t,e,n,n,i,r,s),this}ellipse(t,e,n,i,r,s,a,o){return this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,i,r,s,a,o),this}absellipse(t,e,n,i,r,s,a,o){let c=new Wf(t,e,n,i,r,s,a,o);if(this.curves.length>0){let u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);let l=c.getPoint(1);return this.currentPoint.copy(l),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){let t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}},U8=class extends y_{constructor(t){super(t),this.uuid=Lr(),this.type="Shape",this.holes=[]}getPointsHoles(t){let e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++)this.holes.push(t.holes[e].clone());return this}toJSON(){let t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++)t.holes.push(this.holes[e].toJSON());return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){let i=t.holes[e];this.holes.push((new y_).fromJSON(i))}return this}};function cR(t,e,n,i,r){let s,a;if(r===function J4e(t,e,n,i){let r=0;for(let s=e,a=n-i;s<n;s+=i)r+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return r}(t,e,n,i)>0)for(s=e;s<n;s+=i)a=uR(s,t[s],t[s+1],a);else for(s=n-i;s>=e;s-=i)a=uR(s,t[s],t[s+1],a);return a&&Zf(a,a.next)&&(j8(a),a=a.next),a}function fo(t,e){if(!t)return t;e||(e=t);let i,n=t;do{if(i=!1,n.steiner||!Zf(n,n.next)&&0!==en(n.prev,n,n.next))n=n.next;else{if(j8(n),n=e=n.prev,n===n.next)break;i=!0}}while(i||n!==e);return e}function G8(t,e,n,i,r,s,a){if(!t)return;!a&&s&&function j4e(t,e,n,i){let r=t;do{null===r.z&&(r.z=__(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function q4e(t){let e,n,i,r,s,a,o,c,l=1;do{for(n=t,t=null,s=null,a=0;n;){for(a++,i=n,o=0,e=0;e<l&&(o++,i=i.nextZ,i);e++);for(c=l;o>0||c>0&&i;)0!==o&&(0===c||!i||n.z<=i.z)?(r=n,n=n.nextZ,o--):(r=i,i=i.nextZ,c--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,l*=2}while(a>1)}(r)}(t,i,r,s);let c,l,o=t;for(;t.prev!==t.next;)if(c=t.prev,l=t.next,s?V4e(t,i,r,s):I4e(t))e.push(c.i/n),e.push(t.i/n),e.push(l.i/n),j8(t),t=l.next,o=l.next;else if((t=l)===o){a?1===a?G8(t=O4e(fo(t),e,n),e,n,i,r,s,2):2===a&&k4e(t,e,n,i,r,s):G8(fo(t),e,n,i,r,s,1);break}}function I4e(t){let e=t.prev,n=t,i=t.next;if(en(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(Xc(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&en(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function V4e(t,e,n,i){let r=t.prev,s=t,a=t.next;if(en(r,s,a)>=0)return!1;let l=r.x>s.x?r.x>a.x?r.x:a.x:s.x>a.x?s.x:a.x,u=r.y>s.y?r.y>a.y?r.y:a.y:s.y>a.y?s.y:a.y,f=__(r.x<s.x?r.x<a.x?r.x:a.x:s.x<a.x?s.x:a.x,r.y<s.y?r.y<a.y?r.y:a.y:s.y<a.y?s.y:a.y,e,n,i),d=__(l,u,e,n,i),m=t.prevZ,v=t.nextZ;for(;m&&m.z>=f&&v&&v.z<=d;){if(m!==t.prev&&m!==t.next&&Xc(r.x,r.y,s.x,s.y,a.x,a.y,m.x,m.y)&&en(m.prev,m,m.next)>=0||(m=m.prevZ,v!==t.prev&&v!==t.next&&Xc(r.x,r.y,s.x,s.y,a.x,a.y,v.x,v.y)&&en(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;m&&m.z>=f;){if(m!==t.prev&&m!==t.next&&Xc(r.x,r.y,s.x,s.y,a.x,a.y,m.x,m.y)&&en(m.prev,m,m.next)>=0)return!1;m=m.prevZ}for(;v&&v.z<=d;){if(v!==t.prev&&v!==t.next&&Xc(r.x,r.y,s.x,s.y,a.x,a.y,v.x,v.y)&&en(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function O4e(t,e,n){let i=t;do{let r=i.prev,s=i.next.next;!Zf(r,s)&&lR(r,i,i.next,s)&&W8(r,s)&&W8(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),j8(i),j8(i.next),i=t=s),i=i.next}while(i!==t);return fo(i)}function k4e(t,e,n,i,r,s){let a=t;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&$4e(a,o)){let c=hR(a,o);return a=fo(a,a.next),c=fo(c,c.next),G8(a,e,n,i,r,s),void G8(c,e,n,i,r,s)}o=o.next}a=a.next}while(a!==t)}function B4e(t,e){return t.x-e.x}function U4e(t,e){if(e=function G4e(t,e){let a,n=e,i=t.x,r=t.y,s=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){let d=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=i&&d>s){if(s=d,d===i){if(r===n.y)return n;if(r===n.next.y)return n.next}a=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!a)return null;if(i===s)return a;let f,o=a,c=a.x,l=a.y,u=1/0;n=a;do{i>=n.x&&n.x>=c&&i!==n.x&&Xc(r<l?i:s,r,c,l,r<l?s:i,r,n.x,n.y)&&(f=Math.abs(r-n.y)/(i-n.x),W8(n,t)&&(f<u||f===u&&(n.x>a.x||n.x===a.x&&W4e(a,n)))&&(a=n,u=f)),n=n.next}while(n!==o);return a}(t,e),e){let n=hR(e,t);fo(e,e.next),fo(n,n.next)}}function W4e(t,e){return en(t.prev,t,e.prev)<0&&en(e.next,t,t.next)<0}function __(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Z4e(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Xc(t,e,n,i,r,s,a,o){return(r-a)*(e-o)-(t-a)*(s-o)>=0&&(t-a)*(i-o)-(n-a)*(e-o)>=0&&(n-a)*(s-o)-(r-a)*(i-o)>=0}function $4e(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function X4e(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&lR(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(W8(t,e)&&W8(e,t)&&function Y4e(t,e){let n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(en(t.prev,t,e.prev)||en(t,e.prev,e))||Zf(t,e)&&en(t.prev,t,t.next)>0&&en(e.prev,e,e.next)>0)}function en(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Zf(t,e){return t.x===e.x&&t.y===e.y}function lR(t,e,n,i){let r=Xf(en(t,e,n)),s=Xf(en(t,e,i)),a=Xf(en(n,i,t)),o=Xf(en(n,i,e));return!!(r!==s&&a!==o||0===r&&$f(t,n,e)||0===s&&$f(t,i,e)||0===a&&$f(n,t,i)||0===o&&$f(n,e,i))}function $f(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Xf(t){return t>0?1:t<0?-1:0}function W8(t,e){return en(t.prev,t,t.next)<0?en(t,e,t.next)>=0&&en(t,t.prev,e)>=0:en(t,e,t.prev)<0||en(t,t.next,e)<0}function hR(t,e){let n=new x_(t.i,t.x,t.y),i=new x_(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function uR(t,e,n,i){let r=new x_(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function j8(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function x_(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var k4=class{static area(t){let e=t.length,n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n}static isClockWise(t){return k4.area(t)<0}static triangulateShape(t,e){let n=[],i=[],r=[];fR(t),dR(n,t);let s=t.length;e.forEach(fR);for(let o=0;o<e.length;o++)i.push(s),s+=e[o].length,dR(n,e[o]);let a=function(t,e,n=2){let o,c,l,u,f,d,m,i=e&&e.length,r=i?e[0]*n:t.length,s=cR(t,0,r,n,!0),a=[];if(!s||s.next===s.prev)return a;if(i&&(s=function F4e(t,e,n,i){let s,a,o,c,l,r=[];for(s=0,a=e.length;s<a;s++)o=e[s]*i,c=s<a-1?e[s+1]*i:t.length,l=cR(t,o,c,i,!1),l===l.next&&(l.steiner=!0),r.push(Z4e(l));for(r.sort(B4e),s=0;s<r.length;s++)U4e(r[s],n),n=fo(n,n.next);return n}(t,e,s,n)),t.length>80*n){o=l=t[0],c=u=t[1];for(let v=n;v<r;v+=n)f=t[v],d=t[v+1],f<o&&(o=f),d<c&&(c=d),f>l&&(l=f),d>u&&(u=d);m=Math.max(l-o,u-c),m=0!==m?1/m:0}return G8(s,a,n,o,c,m),a}(n,i);for(let o=0;o<a.length;o+=3)r.push(a.slice(o,o+3));return r}};function fR(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function dR(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}var q8=class extends Q1{constructor(t=new U8([new Ie(.5,.5),new Ie(-.5,.5),new Ie(-.5,-.5),new Ie(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];let n=this,i=[],r=[];for(let a=0,o=t.length;a<o;a++)s(t[a]);function s(a){let o=[],c=void 0!==e.curveSegments?e.curveSegments:12,l=void 0!==e.steps?e.steps:1,u=void 0!==e.depth?e.depth:1,f=void 0===e.bevelEnabled||e.bevelEnabled,d=void 0!==e.bevelThickness?e.bevelThickness:.2,m=void 0!==e.bevelSize?e.bevelSize:d-.1,v=void 0!==e.bevelOffset?e.bevelOffset:0,_=void 0!==e.bevelSegments?e.bevelSegments:3,M=e.extrudePath,y=void 0!==e.UVGenerator?e.UVGenerator:K4e;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=e.amount);let g,b,E,P,V,S=!1;M&&(g=M.getSpacedPoints(l),S=!0,f=!1,b=M.computeFrenetFrames(l,!1),E=new ee,P=new ee,V=new ee),f||(_=0,d=0,m=0,v=0);let j=a.extractPoints(c),Y=j.shape,G=j.holes;if(!k4.isClockWise(Y)){Y=Y.reverse();for(let oe=0,xe=G.length;oe<xe;oe++){let X=G[oe];k4.isClockWise(X)&&(G[oe]=X.reverse())}}let C=k4.triangulateShape(Y,G),N=Y;for(let oe=0,xe=G.length;oe<xe;oe++)Y=Y.concat(G[oe]);function F(oe,xe,X){return xe||console.error("THREE.ExtrudeGeometry: vec does not exist"),xe.clone().multiplyScalar(X).add(oe)}let U=Y.length,$=C.length;function O(oe,xe,X){let fe,pe,Te,Se=oe.x-xe.x,We=oe.y-xe.y,Fe=X.x-oe.x,rt=X.y-oe.y,Gt=Se*Se+We*We;if(Math.abs(Se*rt-We*Fe)>Number.EPSILON){let z=Math.sqrt(Gt),J=Math.sqrt(Fe*Fe+rt*rt),se=xe.x-We/z,ge=xe.y+Se/z,te=((X.x-rt/J-se)*rt-(X.y+Fe/J-ge)*Fe)/(Se*rt-We*Fe);fe=se+Se*te-oe.x,pe=ge+We*te-oe.y;let Be=fe*fe+pe*pe;if(Be<=2)return new Ie(fe,pe);Te=Math.sqrt(Be/2)}else{let z=!1;Se>Number.EPSILON?Fe>Number.EPSILON&&(z=!0):Se<-Number.EPSILON?Fe<-Number.EPSILON&&(z=!0):Math.sign(We)===Math.sign(rt)&&(z=!0),z?(fe=-We,pe=Se,Te=Math.sqrt(Gt)):(fe=Se,pe=We,Te=Math.sqrt(Gt/2))}return new Ie(fe/Te,pe/Te)}let I=[];for(let oe=0,xe=N.length,X=xe-1,fe=oe+1;oe<xe;oe++,X++,fe++)X===xe&&(X=0),fe===xe&&(fe=0),I[oe]=O(N[oe],N[X],N[fe]);let K,k=[],re=I.concat();for(let oe=0,xe=G.length;oe<xe;oe++){let X=G[oe];K=[];for(let fe=0,pe=X.length,Te=pe-1,Se=fe+1;fe<pe;fe++,Te++,Se++)Te===pe&&(Te=0),Se===pe&&(Se=0),K[fe]=O(X[fe],X[Te],X[Se]);k.push(K),re=re.concat(K)}for(let oe=0;oe<_;oe++){let xe=oe/_,X=d*Math.cos(xe*Math.PI/2),fe=m*Math.sin(xe*Math.PI/2)+v;for(let pe=0,Te=N.length;pe<Te;pe++){let Se=F(N[pe],I[pe],fe);Pe(Se.x,Se.y,-X)}for(let pe=0,Te=G.length;pe<Te;pe++){let Se=G[pe];K=k[pe];for(let We=0,Fe=Se.length;We<Fe;We++){let rt=F(Se[We],K[We],fe);Pe(rt.x,rt.y,-X)}}}let ae=m+v;for(let oe=0;oe<U;oe++){let xe=f?F(Y[oe],re[oe],ae):Y[oe];S?(P.copy(b.normals[0]).multiplyScalar(xe.x),E.copy(b.binormals[0]).multiplyScalar(xe.y),V.copy(g[0]).add(P).add(E),Pe(V.x,V.y,V.z)):Pe(xe.x,xe.y,0)}for(let oe=1;oe<=l;oe++)for(let xe=0;xe<U;xe++){let X=f?F(Y[xe],re[xe],ae):Y[xe];S?(P.copy(b.normals[oe]).multiplyScalar(X.x),E.copy(b.binormals[oe]).multiplyScalar(X.y),V.copy(g[oe]).add(P).add(E),Pe(V.x,V.y,V.z)):Pe(X.x,X.y,u/l*oe)}for(let oe=_-1;oe>=0;oe--){let xe=oe/_,X=d*Math.cos(xe*Math.PI/2),fe=m*Math.sin(xe*Math.PI/2)+v;for(let pe=0,Te=N.length;pe<Te;pe++){let Se=F(N[pe],I[pe],fe);Pe(Se.x,Se.y,u+X)}for(let pe=0,Te=G.length;pe<Te;pe++){let Se=G[pe];K=k[pe];for(let We=0,Fe=Se.length;We<Fe;We++){let rt=F(Se[We],K[We],fe);S?Pe(rt.x,rt.y+g[l-1].y,g[l-1].x+X):Pe(rt.x,rt.y,u+X)}}}function Oe(oe,xe){let X=oe.length;for(;--X>=0;){let fe=X,pe=X-1;pe<0&&(pe=oe.length-1);for(let Te=0,Se=l+2*_;Te<Se;Te++){let We=U*Te,Fe=U*(Te+1);st(xe+fe+We,xe+pe+We,xe+pe+Fe,xe+fe+Fe)}}}function Pe(oe,xe,X){o.push(oe),o.push(xe),o.push(X)}function ie(oe,xe,X){ke(oe),ke(xe),ke(X);let fe=i.length/3,pe=y.generateTopUV(n,i,fe-3,fe-2,fe-1);_e(pe[0]),_e(pe[1]),_e(pe[2])}function st(oe,xe,X,fe){ke(oe),ke(xe),ke(fe),ke(xe),ke(X),ke(fe);let pe=i.length/3,Te=y.generateSideWallUV(n,i,pe-6,pe-3,pe-2,pe-1);_e(Te[0]),_e(Te[1]),_e(Te[3]),_e(Te[1]),_e(Te[2]),_e(Te[3])}function ke(oe){i.push(o[3*oe+0]),i.push(o[3*oe+1]),i.push(o[3*oe+2])}function _e(oe){r.push(oe.x),r.push(oe.y)}(function ue(){let oe=i.length/3;if(f){let xe=0,X=U*xe;for(let fe=0;fe<$;fe++){let pe=C[fe];ie(pe[2]+X,pe[1]+X,pe[0]+X)}xe=l+2*_,X=U*xe;for(let fe=0;fe<$;fe++){let pe=C[fe];ie(pe[0]+X,pe[1]+X,pe[2]+X)}}else{for(let xe=0;xe<$;xe++){let X=C[xe];ie(X[2],X[1],X[0])}for(let xe=0;xe<$;xe++){let X=C[xe];ie(X[0]+U*l,X[1]+U*l,X[2]+U*l)}}n.addGroup(oe,i.length/3-oe,0)})(),function Le(){let oe=i.length/3,xe=0;Oe(N,xe),xe+=N.length;for(let X=0,fe=G.length;X<fe;X++){let pe=G[X];Oe(pe,xe),xe+=pe.length}n.addGroup(oe,i.length/3-oe,1)}()}this.setAttribute("position",new Xn(i,3)),this.setAttribute("uv",new Xn(r,2)),this.computeVertexNormals()}toJSON(){let t=super.toJSON();return function Q4e(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++)n.shapes.push(t[i].uuid);else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){let n=[];for(let r=0,s=t.shapes.length;r<s;r++)n.push(e[t.shapes[r]]);let i=t.options.extrudePath;return void 0!==i&&(t.options.extrudePath=(new oR[i.type]).fromJSON(i)),new q8(n,t.options)}},K4e={generateTopUV:function(t,e,n,i,r){let o=e[3*i],c=e[3*i+1],l=e[3*r],u=e[3*r+1];return[new Ie(e[3*n],e[3*n+1]),new Ie(o,c),new Ie(l,u)]},generateSideWallUV:function(t,e,n,i,r,s){let a=e[3*n],o=e[3*n+1],c=e[3*n+2],l=e[3*i],u=e[3*i+1],f=e[3*i+2],d=e[3*r],m=e[3*r+1],v=e[3*r+2],_=e[3*s],M=e[3*s+1],y=e[3*s+2];return Math.abs(o-u)<Math.abs(a-l)?[new Ie(a,1-c),new Ie(l,1-f),new Ie(d,1-v),new Ie(_,1-y)]:[new Ie(o,1-c),new Ie(u,1-f),new Ie(m,1-v),new Ie(M,1-y)]}},pR=class extends Q1{constructor(t=new U8([new Ie(0,.5),new Ie(-.5,-.5),new Ie(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};let n=[],i=[],r=[],s=[],a=0,o=0;if(!1===Array.isArray(t))c(t);else for(let l=0;l<t.length;l++)c(t[l]),this.addGroup(a,o,l),a+=o,o=0;function c(l){let u=i.length/3,f=l.extractPoints(e),d=f.shape,m=f.holes;!1===k4.isClockWise(d)&&(d=d.reverse());for(let _=0,M=m.length;_<M;_++){let y=m[_];!0===k4.isClockWise(y)&&(m[_]=y.reverse())}let v=k4.triangulateShape(d,m);for(let _=0,M=m.length;_<M;_++)d=d.concat(m[_]);for(let _=0,M=d.length;_<M;_++){let y=d[_];i.push(y.x,y.y,0),r.push(0,0,1),s.push(y.x,y.y)}for(let _=0,M=v.length;_<M;_++){let y=v[_];n.push(y[0]+u,y[1]+u,y[2]+u),o+=3}}this.setIndex(n),this.setAttribute("position",new Xn(i,3)),this.setAttribute("normal",new Xn(r,3)),this.setAttribute("uv",new Xn(s,2))}toJSON(){let t=super.toJSON();return function e3e(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++)e.shapes.push(t[n].uuid);else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){let n=[];for(let i=0,r=t.shapes.length;i<r;i++)n.push(e[t.shapes[i]]);return new pR(n,t.curveSegments)}},mR=class extends Vn{constructor(t){super(),this.type="ShadowMaterial",this.color=new gt(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}};mR.prototype.isShadowMaterial=!0;var gR=class extends Hr{constructor(t){super(t),this.type="RawShaderMaterial"}};gR.prototype.isRawShaderMaterial=!0;var M_=class extends Vn{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new gt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}};M_.prototype.isMeshStandardMaterial=!0;var vR=class extends M_{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ie(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return n2(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new gt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new gt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new gt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}};vR.prototype.isMeshPhysicalMaterial=!0;var yR=class extends Vn{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new gt(16777215),this.specular=new gt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}};yR.prototype.isMeshPhongMaterial=!0;var _R=class extends Vn{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new gt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}};_R.prototype.isMeshToonMaterial=!0;var xR=class extends Vn{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}};xR.prototype.isMeshNormalMaterial=!0;var MR=class extends Vn{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new gt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new gt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}};MR.prototype.isMeshLambertMaterial=!0;var bR=class extends Vn{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new gt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this}};bR.prototype.isMeshMatcapMaterial=!0;var wR=class extends $c{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}};wR.prototype.isLineDashedMaterial=!0;var t3e={ShadowMaterial:mR,SpriteMaterial:i_,RawShaderMaterial:gR,ShaderMaterial:Hr,PointsMaterial:l_,MeshPhysicalMaterial:vR,MeshStandardMaterial:M_,MeshPhongMaterial:yR,MeshToonMaterial:_R,MeshNormalMaterial:xR,MeshLambertMaterial:MR,MeshDepthMaterial:e_,MeshDistanceMaterial:t_,MeshBasicMaterial:xf,MeshMatcapMaterial:bR,LineDashedMaterial:wR,LineBasicMaterial:$c,Material:Vn};Vn.fromType=function(t){return new t3e[t]};var j1={arraySlice:function(t,e,n){return j1.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){let n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(function e(r,s){return t[r]-t[s]}),i},sortedArray:function(t,e,n){let i=t.length,r=new t.constructor(i);for(let s=0,a=0;a!==i;++s){let o=n[s]*e;for(let c=0;c!==e;++c)r[a++]=t[o+c]}return r},flattenJSON:function(t,e,n,i){let r=1,s=t[0];for(;void 0!==s&&void 0===s[i];)s=t[r++];if(void 0===s)return;let a=s[i];if(void 0!==a)if(Array.isArray(a))do{a=s[i],void 0!==a&&(e.push(s.time),n.push.apply(n,a)),s=t[r++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[i],void 0!==a&&(e.push(s.time),a.toArray(n,n.length)),s=t[r++]}while(void 0!==s);else do{a=s[i],void 0!==a&&(e.push(s.time),n.push(a)),s=t[r++]}while(void 0!==s)},subclip:function(t,e,n,i,r=30){let s=t.clone();s.name=e;let a=[];for(let c=0;c<s.tracks.length;++c){let l=s.tracks[c],u=l.getValueSize(),f=[],d=[];for(let m=0;m<l.times.length;++m){let v=l.times[m]*r;if(!(v<n||v>=i)){f.push(l.times[m]);for(let _=0;_<u;++_)d.push(l.values[m*u+_])}}0!==f.length&&(l.times=j1.convertArray(f,l.times.constructor),l.values=j1.convertArray(d,l.values.constructor),a.push(l))}s.tracks=a;let o=1/0;for(let c=0;c<s.tracks.length;++c)o>s.tracks[c].times[0]&&(o=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*o);return s.resetDuration(),s},makeClipAdditive:function(t,e=0,n=t,i=30){i<=0&&(i=30);let r=n.tracks.length,s=e/i;for(let a=0;a<r;++a){let o=n.tracks[a],c=o.ValueTypeName;if("bool"===c||"string"===c)continue;let l=t.tracks.find(function(y){return y.name===o.name&&y.ValueTypeName===c});if(void 0===l)continue;let u=0,f=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=f/3);let d=0,m=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=m/3);let _,v=o.times.length-1;if(s<=o.times[0])_=j1.arraySlice(o.values,u,f-u);else if(s>=o.times[v]){let y=v*f+u;_=j1.arraySlice(o.values,y,y+f-u)}else{let y=o.createInterpolant(),g=u,S=f-u;y.evaluate(s),_=j1.arraySlice(y.resultBuffer,g,S)}"quaternion"===c&&(new r2).fromArray(_).normalize().conjugate().toArray(_);let M=l.times.length;for(let y=0;y<M;++y){let g=y*m+d;if("quaternion"===c)r2.multiplyQuaternionsFlat(l.values,g,_,0,l.values,g);else{let S=m-2*d;for(let b=0;b<S;++b)l.values[g+b]-=_[b]}}}return t.blendMode=2501,t}},po=class{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){let e=this.parameterPositions,n=this._cachedIndex,i=e[n],r=e[n-1];e:{t:{let s;n:{i:if(!(t<i)){for(let a=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===a)break;if(r=i,i=e[++n],t<i)break t}s=e.length;break n}if(t>=r)break e;{let a=e[1];t<a&&(n=2,r=a);for(let o=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===o)break;if(i=r,r=e[--n-1],t>=r)break t}s=n,n=0}}for(;n<s;){let a=n+s>>>1;t<e[a]?s=a:n=a+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){let e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let s=0;s!==i;++s)e[s]=n[r+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};po.prototype.beforeStart_=po.prototype.copySampleValue_,po.prototype.afterEnd_=po.prototype.copySampleValue_;var n3e=class extends po{constructor(t,e,n,i){super(t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Mc,endingEnd:Mc}}intervalChanged_(t,e,n){let i=this.parameterPositions,r=t-2,s=t+1,a=i[r],o=i[s];if(void 0===a)switch(this.getSettings_().endingStart){case bc:r=t,a=2*e-n;break;case 2402:r=i.length-2,a=e+i[r]-i[r+1];break;default:r=t,a=n}if(void 0===o)switch(this.getSettings_().endingEnd){case bc:s=t,o=2*n-e;break;case 2402:s=1,o=n+i[1]-i[0];break;default:s=t-1,o=e}let c=.5*(n-e),l=this.valueSize;this._weightPrev=c/(e-a),this._weightNext=c/(o-n),this._offsetPrev=r*l,this._offsetNext=s*l}interpolate_(t,e,n,i){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,c=o-a,l=this._offsetPrev,u=this._offsetNext,f=this._weightPrev,d=this._weightNext,m=(n-e)/(i-e),v=m*m,_=v*m,M=-f*_+2*f*v-f*m,y=(1+f)*_+(-1.5-2*f)*v+(-.5+f)*m+1,g=(-1-d)*_+(1.5+d)*v+.5*m,S=d*_-d*v;for(let b=0;b!==a;++b)r[b]=M*s[l+b]+y*s[c+b]+g*s[o+b]+S*s[u+b];return r}},SR=class extends po{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=t*a,c=o-a,l=(n-e)/(i-e),u=1-l;for(let f=0;f!==a;++f)r[f]=s[c+f]*u+s[o+f]*l;return r}},i3e=class extends po{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}},fs=class{constructor(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=j1.convertArray(e,this.TimeBufferType),this.values=j1.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){let n,e=t.constructor;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:j1.convertArray(t.times,Array),values:j1.convertArray(t.values,Array)};let i=t.getInterpolation();i!==t.DefaultInterpolation&&(n.interpolation=i)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new i3e(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new SR(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new n3e(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case 2300:e=this.InterpolantFactoryMethodDiscrete;break;case 2301:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){let e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(1!==t){let e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){let n=this.times,i=n.length,r=0,s=i-1;for(;r!==i&&n[r]<t;)++r;for(;-1!==s&&n[s]>e;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);let a=this.getValueSize();this.times=j1.arraySlice(n,r,s),this.values=j1.arraySlice(this.values,r*a,s*a)}return this}validate(){let t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);let n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let a=0;a!==r;a++){let o=n[a];if("number"==typeof o&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),t=!1;break}if(null!==s&&s>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,s),t=!1;break}s=o}if(void 0!==i&&j1.isTypedArray(i))for(let a=0,o=i.length;a!==o;++a){let c=i[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),t=!1;break}}return t}optimize(){let t=j1.arraySlice(this.times),e=j1.arraySlice(this.values),n=this.getValueSize(),i=2302===this.getInterpolation(),r=t.length-1,s=1;for(let a=1;a<r;++a){let o=!1,c=t[a];if(c!==t[a+1]&&(1!==a||c!==t[0]))if(i)o=!0;else{let u=a*n,f=u-n,d=u+n;for(let m=0;m!==n;++m){let v=e[u+m];if(v!==e[f+m]||v!==e[d+m]){o=!0;break}}}if(o){if(a!==s){t[s]=t[a];let u=a*n,f=s*n;for(let d=0;d!==n;++d)e[f+d]=e[u+d]}++s}}if(r>0){t[s]=t[r];for(let a=r*n,o=s*n,c=0;c!==n;++c)e[o+c]=e[a+c];++s}return s!==t.length?(this.times=j1.arraySlice(t,0,s),this.values=j1.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this}clone(){let t=j1.arraySlice(this.times,0),e=j1.arraySlice(this.values,0),i=new(0,this.constructor)(this.name,t,e);return i.createInterpolant=this.createInterpolant,i}};fs.prototype.TimeBufferType=Float32Array,fs.prototype.ValueBufferType=Float32Array,fs.prototype.DefaultInterpolation=2301;var Yc=class extends fs{};Yc.prototype.ValueTypeName="bool",Yc.prototype.ValueBufferType=Array,Yc.prototype.DefaultInterpolation=2300,Yc.prototype.InterpolantFactoryMethodLinear=void 0,Yc.prototype.InterpolantFactoryMethodSmooth=void 0;var CR=class extends fs{};CR.prototype.ValueTypeName="color";var Yf=class extends fs{};Yf.prototype.ValueTypeName="number";var r3e=class extends po{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(n-e)/(i-e),c=t*a;for(let l=c+a;c!==l;c+=4)r2.slerpFlat(r,0,s,c-a,s,c,o);return r}},Z8=class extends fs{InterpolantFactoryMethodLinear(t){return new r3e(this.times,this.values,this.getValueSize(),t)}};Z8.prototype.ValueTypeName="quaternion",Z8.prototype.DefaultInterpolation=2301,Z8.prototype.InterpolantFactoryMethodSmooth=void 0;var Jc=class extends fs{};Jc.prototype.ValueTypeName="string",Jc.prototype.ValueBufferType=Array,Jc.prototype.DefaultInterpolation=2300,Jc.prototype.InterpolantFactoryMethodLinear=void 0,Jc.prototype.InterpolantFactoryMethodSmooth=void 0;var Jf=class extends fs{};Jf.prototype.ValueTypeName="vector";var ER=class{constructor(t,e=-1,n,i=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=i,this.uuid=Lr(),this.duration<0&&this.resetDuration()}static parse(t){let e=[],n=t.tracks,i=1/(t.fps||1);for(let s=0,a=n.length;s!==a;++s)e.push(a3e(n[s]).scale(i));let r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){let e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let r=0,s=n.length;r!==s;++r)e.push(fs.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(t,e,n,i){let r=e.length,s=[];for(let a=0;a<r;a++){let o=[],c=[];o.push((a+r-1)%r,a,(a+1)%r),c.push(0,1,0);let l=j1.getKeyframeOrder(o);o=j1.sortedArray(o,1,l),c=j1.sortedArray(c,1,l),!i&&0===o[0]&&(o.push(r),c.push(c[0])),s.push(new Yf(".morphTargetInfluences["+e[a].name+"]",o,c).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){let i=t;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null}static CreateClipsFromMorphTargetSequences(t,e,n){let i={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,o=t.length;a<o;a++){let c=t[a],l=c.name.match(r);if(l&&l.length>1){let u=l[1],f=i[u];f||(i[u]=f=[]),f.push(c)}}let s=[];for(let a in i)s.push(this.CreateFromMorphTargetSequence(a,i[a],e,n));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let n=function(l,u,f,d,m){if(0!==f.length){let v=[],_=[];j1.flattenJSON(f,v,_,d),0!==v.length&&m.push(new l(u,v,_))}},i=[],r=t.name||"default",s=t.fps||30,a=t.blendMode,o=t.length||-1,c=t.hierarchy||[];for(let l=0;l<c.length;l++){let u=c[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){let d,f={};for(d=0;d<u.length;d++)if(u[d].morphTargets)for(let m=0;m<u[d].morphTargets.length;m++)f[u[d].morphTargets[m]]=-1;for(let m in f){let v=[],_=[];for(let M=0;M!==u[d].morphTargets.length;++M){let y=u[d];v.push(y.time),_.push(y.morphTarget===m?1:0)}i.push(new Yf(".morphTargetInfluence["+m+"]",v,_))}o=f.length*s}else{let f=".bones["+e[l].name+"]";n(Jf,f+".position",u,"pos",i),n(Z8,f+".quaternion",u,"rot",i),n(Jf,f+".scale",u,"scl",i)}}return 0===i.length?null:new this(r,o,i,a)}resetDuration(){let e=0;for(let n=0,i=this.tracks.length;n!==i;++n){let r=this.tracks[n];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){let t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function a3e(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=function s3e(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Yf;case"vector":case"vector2":case"vector3":case"vector4":return Jf;case"color":return CR;case"quaternion":return Z8;case"bool":case"boolean":return Yc;case"string":return Jc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){let n=[],i=[];j1.flattenJSON(t.keys,n,i,"value"),t.times=n,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}var Kc={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},c3e=new class{constructor(t,e,n){let o,i=this,r=!1,s=0,a=0,c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(l){a++,!1===r&&void 0!==i.onStart&&i.onStart(l,s,a),r=!0},this.itemEnd=function(l){s++,void 0!==i.onProgress&&i.onProgress(l,s,a),s===a&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(l){void 0!==i.onError&&i.onError(l)},this.resolveURL=function(l){return o?o(l):l},this.setURLModifier=function(l){return o=l,this},this.addHandler=function(l,u){return c.push(l,u),this},this.removeHandler=function(l){let u=c.indexOf(l);return-1!==u&&c.splice(u,2),this},this.getHandler=function(l){for(let u=0,f=c.length;u<f;u+=2){let d=c[u],m=c[u+1];if(d.global&&(d.lastIndex=0),d.test(l))return m}return null}}},mo=class{constructor(t){this.manager=void 0!==t?t:c3e,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){let n=this;return new Promise(function(i,r){n.load(t,i,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}},sa={},l3e=class extends mo{constructor(t){super(t)}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);let r=Kc.get(t);if(void 0!==r)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(void 0!==sa[t])return void sa[t].push({onLoad:e,onProgress:n,onError:i});sa[t]=[],sa[t].push({onLoad:e,onProgress:n,onError:i});let s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===c.body||void 0===c.body.getReader)return c;let l=sa[t],u=c.body.getReader(),f=c.headers.get("Content-Length"),d=f?parseInt(f):0,m=0!==d,v=0,_=new ReadableStream({start(M){!function y(){u.read().then(({done:g,value:S})=>{if(g)M.close();else{v+=S.byteLength;let b=new ProgressEvent("progress",{lengthComputable:m,loaded:v,total:d});for(let E=0,P=l.length;E<P;E++){let V=l[E];V.onProgress&&V.onProgress(b)}M.enqueue(S),y()}})}()}});return new Response(_)}throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(o){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(l=>(new DOMParser).parseFromString(l,a));case"json":return c.json();default:if(void 0===a)return c.text();{let l=/charset="?([^;"\s]*)"?/i.exec(a),u=l&&l[1]?l[1].toLowerCase():void 0,f=new TextDecoder(u);return c.arrayBuffer().then(d=>f.decode(d))}}}).then(c=>{Kc.add(t,c);let l=sa[t];delete sa[t];for(let u=0,f=l.length;u<f;u++){let d=l[u];d.onLoad&&d.onLoad(c)}}).catch(c=>{let l=sa[t];if(void 0===l)throw this.manager.itemError(t),c;delete sa[t];for(let u=0,f=l.length;u<f;u++){let d=l[u];d.onError&&d.onError(c)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}},zR=class extends mo{constructor(t){super(t)}load(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);let r=this,s=Kc.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;let a=A8("img");function o(){l(),Kc.add(t,this),e&&e(this),r.manager.itemEnd(t)}function c(u){l(),i&&i(u),r.manager.itemError(t),r.manager.itemEnd(t)}function l(){a.removeEventListener("load",o,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",c,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a}},h3e=class extends mo{constructor(t){super(t)}load(t,e,n,i){let r=new Df,s=new zR(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function o(c){s.load(t[c],function(l){r.images[c]=l,a++,6===a&&(r.needsUpdate=!0,e&&e(r))},void 0,i)}for(let c=0;c<t.length;++c)o(c);return r}},u3e=class extends mo{constructor(t){super(t)}load(t,e,n,i){let r=new hi,s=new zR(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(a){r.image=a,r.needsUpdate=!0,void 0!==e&&e(r)},n,i),r}},ds=class extends w1{constructor(t,e=1){super(),this.type="Light",this.color=new gt(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){let e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}};ds.prototype.isLight=!0,class extends ds{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(w1.DefaultUp),this.updateMatrix(),this.groundColor=new gt(e)}copy(t){return ds.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}.prototype.isHemisphereLight=!0;var TR=new Ct,AR=new ee,LR=new ee,b_=class{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ie(512,512),this.map=null,this.mapPass=null,this.matrix=new Ct,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Nf,this._frameExtents=new Ie(1,1),this._viewportCount=1,this._viewports=[new b1(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){let e=this.camera,n=this.matrix;AR.setFromMatrixPosition(t.matrixWorld),e.position.copy(AR),LR.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(LR),e.updateMatrixWorld(),TR.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(TR),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){let t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}},DR=class extends b_{constructor(){super(new a2(50,1,.5,500)),this.focus=1}updateMatrices(t){let e=this.camera,n=2*_y*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;(n!==e.fov||i!==e.aspect||r!==e.far)&&(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}};DR.prototype.isSpotLightShadow=!0,class extends ds{constructor(t,e,n=0,i=Math.PI/3,r=0,s=1){super(t,e),this.type="SpotLight",this.position.copy(w1.DefaultUp),this.updateMatrix(),this.target=new w1,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.shadow=new DR}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}.prototype.isSpotLight=!0;var PR=new Ct,$8=new ee,w_=new ee,NR=class extends b_{constructor(){super(new a2(90,1,.5,500)),this._frameExtents=new Ie(4,2),this._viewportCount=6,this._viewports=[new b1(2,1,1,1),new b1(0,1,1,1),new b1(3,1,1,1),new b1(1,1,1,1),new b1(3,0,1,1),new b1(1,0,1,1)],this._cubeDirections=[new ee(1,0,0),new ee(-1,0,0),new ee(0,0,1),new ee(0,0,-1),new ee(0,1,0),new ee(0,-1,0)],this._cubeUps=[new ee(0,1,0),new ee(0,1,0),new ee(0,1,0),new ee(0,1,0),new ee(0,0,1),new ee(0,0,-1)]}updateMatrices(t,e=0){let n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),$8.setFromMatrixPosition(t.matrixWorld),n.position.copy($8),w_.copy(n.position),w_.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(w_),n.updateMatrixWorld(),i.makeTranslation(-$8.x,-$8.y,-$8.z),PR.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(PR)}};NR.prototype.isPointLightShadow=!0,class extends ds{constructor(t,e,n=0,i=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new NR}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}.prototype.isPointLight=!0;var RR=class extends b_{constructor(){super(new Zy(-5,5,5,-5,.5,500))}};RR.prototype.isDirectionalLightShadow=!0,class extends ds{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(w1.DefaultUp),this.updateMatrix(),this.target=new w1,this.shadow=new RR}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}.prototype.isDirectionalLight=!0,class extends ds{constructor(t,e){super(t,e),this.type="AmbientLight"}}.prototype.isAmbientLight=!0,class extends ds{constructor(t,e,n=10,i=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){let e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}.prototype.isRectAreaLight=!0;var HR=class{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new ee)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){let n=t.x,i=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*i),e.addScaledVector(s[2],.488603*r),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],n*i*1.092548),e.addScaledVector(s[5],i*r*1.092548),e.addScaledVector(s[6],.315392*(3*r*r-1)),e.addScaledVector(s[7],n*r*1.092548),e.addScaledVector(s[8],.546274*(n*n-i*i)),e}getIrradianceAt(t,e){let n=t.x,i=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*i),e.addScaledVector(s[2],1.023328*r),e.addScaledVector(s[3],1.023328*n),e.addScaledVector(s[4],.858086*n*i),e.addScaledVector(s[5],.858086*i*r),e.addScaledVector(s[6],.743125*r*r-.247708),e.addScaledVector(s[7],.858086*n*r),e.addScaledVector(s[8],.429043*(n*n-i*i)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){let n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(t,e+3*i);return this}toArray(t=[],e=0){let n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(t,e+3*i);return t}static getBasisAt(t,e){let n=t.x,i=t.y,r=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*r,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*n*r,e[8]=.546274*(n*n-i*i)}};HR.prototype.isSphericalHarmonics3=!0;var S_=class extends ds{constructor(t=new HR,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){let e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}};S_.prototype.isLightProbe=!0,class extends Q1{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){let t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}.prototype.isInstancedBufferGeometry=!0,class extends mo{constructor(t){super(t),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);let r=this,s=Kc.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;let a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(t,a).then(function(o){return o.blob()}).then(function(o){return createImageBitmap(o,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(o){Kc.add(t,o),e&&e(o),r.manager.itemEnd(t)}).catch(function(o){i&&i(o),r.manager.itemError(t),r.manager.itemEnd(t)}),r.manager.itemStart(t)}}.prototype.isImageBitmapLoader=!0;var Kf,b3e=class extends mo{constructor(t){super(t)}load(t,e,n,i){let r=this,s=new l3e(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(a){try{let o=a.slice(0);(void 0===Kf&&(Kf=new(window.AudioContext||window.webkitAudioContext)),Kf).decodeAudioData(o,function(c){e(c)})}catch(o){i?i(o):console.error(o),r.manager.itemError(t)}},n,i)}};(class extends S_{constructor(t,e,n=1){super(void 0,n);let i=(new gt).set(t),r=(new gt).set(e),s=new ee(i.r,i.g,i.b),a=new ee(r.r,r.g,r.b),o=Math.sqrt(Math.PI),c=o*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(a).multiplyScalar(o),this.sh.coefficients[1].copy(s).sub(a).multiplyScalar(c)}}).prototype.isHemisphereLightProbe=!0,class extends S_{constructor(t,e=1){super(void 0,e);let n=(new gt).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;var z3e=class{constructor(t,e,n){let i,r,s;switch(this.binding=t,this.valueSize=n,e){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){let n=this.buffer,i=this.valueSize,r=t*i+i,s=this.cumulativeWeight;if(0===s){for(let a=0;a!==i;++a)n[r+a]=n[a];s=e}else s+=e,this._mixBufferRegion(n,r,0,e/s,i);this.cumulativeWeight=s}accumulateAdditive(t){let e=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){let e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1&&this._mixBufferRegion(n,i,e*this._origIndex,1-r,e),s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let o=e,c=e+e;o!==c;++o)if(n[o]!==n[o+e]){a.setValue(n,i);break}}saveOriginalState(){let e=this.buffer,n=this.valueSize,i=n*this._origIndex;this.binding.getValue(e,i);for(let r=n,s=i;r!==s;++r)e[r]=e[i+r%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){let t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)t[e+s]=t[n+s]}_slerp(t,e,n,i){r2.slerpFlat(t,e,t,e,t,n,i)}_slerpAdditive(t,e,n,i,r){let s=this._workIndex*r;r2.multiplyQuaternionsFlat(t,s,t,e,t,n),r2.slerpFlat(t,e,t,e,t,s,i)}_lerp(t,e,n,i,r){let s=1-i;for(let a=0;a!==r;++a){let o=e+a;t[o]=t[o]*s+t[n+a]*i}}_lerpAdditive(t,e,n,i,r){for(let s=0;s!==r;++s){let a=e+s;t[a]=t[a]+t[n+s]*i}}},C_="\\[\\]\\.:\\/",T3e=new RegExp("["+C_+"]","g"),E_="[^"+C_+"]",A3e="[^"+C_.replace("\\.","")+"]",L3e=/((?:WC+[\/:])*)/.source.replace("WC",E_),D3e=/(WCOD+)?/.source.replace("WCOD",A3e),P3e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",E_),N3e=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",E_),R3e=new RegExp("^"+L3e+D3e+P3e+N3e+"$"),H3e=["material","materials","bones"],m1=class{constructor(t,e,n){this.path=e,this.parsedPath=n||m1.parseTrackName(e),this.node=m1.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new m1.Composite(t,e,n):new m1(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(T3e,"")}static parseTrackName(t){let e=R3e.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){let r=n.nodeName.substring(i+1);-1!==H3e.indexOf(r)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){let n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){let n=function(r){for(let s=0;s<r.length;s++){let a=r[s];if(a.name===e||a.uuid===e)return a;let o=n(a.children);if(o)return o}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){let n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node,e=this.parsedPath,n=e.objectName,i=e.propertyName,r=e.propertyIndex;if(t||(t=m1.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let c=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let l=0;l<t.length;l++)if(t[l].name===c){c=l;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==c){if(void 0===t[c])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[c]}}let s=t[i];if(void 0===s)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+i+" but it wasn't found.",t);let a=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};m1.Composite=class{constructor(t,e,n){let i=n||m1.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();let i=this._bindings[this._targetGroup.nCachedObjects_];void 0!==i&&i.getValue(t,e)}setValue(t,e){let n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}bind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},m1.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},m1.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},m1.prototype.GetterByBindingType=[m1.prototype._getValue_direct,m1.prototype._getValue_array,m1.prototype._getValue_arrayElement,m1.prototype._getValue_toArray],m1.prototype.SetterByBindingTypeAndVersioning=[[m1.prototype._setValue_direct,m1.prototype._setValue_direct_setNeedsUpdate,m1.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[m1.prototype._setValue_array,m1.prototype._setValue_array_setNeedsUpdate,m1.prototype._setValue_array_setMatrixWorldNeedsUpdate],[m1.prototype._setValue_arrayElement,m1.prototype._setValue_arrayElement_setNeedsUpdate,m1.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[m1.prototype._setValue_fromArray,m1.prototype._setValue_fromArray_setNeedsUpdate,m1.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],class extends D4{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){let n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,s=t._propertyBindings,a=t._interpolants,o=n.uuid,c=this._bindingsByRootAndName,l=c[o];void 0===l&&(l={},c[o]=l);for(let u=0;u!==r;++u){let f=i[u],d=f.name,m=l[d];if(void 0!==m)++m.referenceCount,s[u]=m;else{if(m=s[u],void 0!==m){null===m._cacheIndex&&(++m.referenceCount,this._addInactiveBinding(m,o,d));continue}m=new z3e(m1.create(n,d,e&&e._propertyBindings[u].binding.parsedPath),f.ValueTypeName,f.getValueSize()),++m.referenceCount,this._addInactiveBinding(m,o,d),s[u]=m}a[u].resultBuffer=m.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){let n=(t._localRoot||this._root).uuid,i=t._clip.uuid,r=this._actionsByClip[i];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,i,n)}let e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){let r=e[n];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){let e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){let r=e[n];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){let e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){let i=this._actions,r=this._actionsByClip,s=r[e];if(void 0===s)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=s;else{let a=s.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=i.length,i.push(t),s.actionByRoot[n]=t}_removeInactiveAction(t){let e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;let r=t._clip.uuid,s=this._actionsByClip,a=s[r],o=a.knownActions,c=o[o.length-1],l=t._byClipCacheIndex;c._byClipCacheIndex=l,o[l]=c,o.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===o.length&&delete s[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){let e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){let r=e[n];0==--r.referenceCount&&this._removeInactiveBinding(r)}}_lendAction(t){let e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackAction(t){let e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_addInactiveBinding(t,e,n){let i=this._bindingsByRootAndName,r=this._bindings,s=i[e];void 0===s&&(s={},i[e]=s),s[n]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){let e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,a=s[i],o=e[e.length-1],c=t._cacheIndex;o._cacheIndex=c,e[c]=o,e.pop(),delete a[r],0===Object.keys(a).length&&delete s[i]}_lendBinding(t){let e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackBinding(t){let e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_lendControlInterpolant(){let t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&(n=new SR(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){let e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r}clipAction(t,e,n){let i=e||this._root,r=i.uuid,s="string"==typeof t?ER.findByName(i,t):t,a=null!==s?s.uuid:t,o=this._actionsByClip[a],c=null;if(void 0===n&&(n=null!==s?s.blendMode:2500),void 0!==o){let u=o.actionByRoot[r];if(void 0!==u&&u.blendMode===n)return u;c=o.knownActions[0],null===s&&(s=c._clip)}if(null===s)return null;let l=new class{constructor(t,e,n=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=i;let r=e.tracks,s=r.length,a=new Array(s),o={endingStart:Mc,endingEnd:Mc};for(let c=0;c!==s;++c){let l=r[c].createInterpolant(null);a[c]=l,l.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){let i=this._clip.duration,r=t._clip.duration,a=i/r;t.warp(1,r/i,e),this.warp(a,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){let t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){let i=this._mixer,r=i.time,s=this.timeScale,a=this._timeScaleInterpolant;null===a&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,c=a.sampleValues;return o[0]=r,o[1]=r+n,c[0]=t/s,c[1]=e/s,this}stopWarping(){let t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,i){if(!this.enabled)return void this._updateWeight(t);let r=this._startTime;if(null!==r){let o=(t-r)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);let s=this._updateTime(e),a=this._updateWeight(t);if(a>0){let o=this._interpolants,c=this._propertyBindings;if(2501===this.blendMode)for(let l=0,u=o.length;l!==u;++l)o[l].evaluate(s),c[l].accumulateAdditive(a);else for(let l=0,u=o.length;l!==u;++l)o[l].evaluate(s),c[l].accumulate(i,a)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;let n=this._weightInterpolant;if(null!==n){let i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;let n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){let e=this._clip.duration,n=this.loop,i=this.time+t,r=this._loopCount,s=2202===n;if(0===t)return-1===r?i:s&&1==(1&r)?e-i:i;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=e)i=e;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=e||i<0){let a=Math.floor(i/e);i-=e*a,r+=Math.abs(a);let o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===o){let c=t<0;this._setEndings(c,!c,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(s&&1==(1&r))return e-i}return i}_setEndings(t,e,n){let i=this._interpolantSettings;n?(i.endingStart=bc,i.endingEnd=bc):(i.endingStart=t?this.zeroSlopeAtStart?bc:Mc:2402,i.endingEnd=e?this.zeroSlopeAtEnd?bc:Mc:2402)}_scheduleFading(t,e,n){let i=this._mixer,r=i.time,s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=r,o[0]=e,a[1]=r+t,o[1]=n,this}}(this,s,e,n);return this._bindAction(l,c),this._addInactiveAction(l,a,r),l}existingAction(t,e){let n=e||this._root,i=n.uuid,r="string"==typeof t?ER.findByName(n,t):t,a=this._actionsByClip[r?r.uuid:t];return void 0!==a&&a.actionByRoot[i]||null}stopAllAction(){let t=this._actions;for(let n=this._nActiveActions-1;n>=0;--n)t[n].stop();return this}update(t){let e=this._actions,n=this._nActiveActions,i=this.time+=t*=this.timeScale,r=Math.sign(t),s=this._accuIndex^=1;for(let c=0;c!==n;++c)e[c]._update(i,t,r,s);let a=this._bindings,o=this._nActiveBindings;for(let c=0;c!==o;++c)a[c].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){let e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){let s=r.knownActions;for(let a=0,o=s.length;a!==o;++a){let c=s[a];this._deactivateAction(c);let l=c._cacheIndex,u=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=l,e[l]=u,e.pop(),this._removeInactiveBindingsForAction(c)}delete i[n]}}uncacheRoot(t){let e=t.uuid,n=this._actionsByClip;for(let s in n){let o=n[s].actionByRoot[e];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}let r=this._bindingsByRootAndName[e];if(void 0!==r)for(let s in r){let a=r[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(t,e){let n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var IR=class{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new IR(void 0===this.value.clone?this.value:this.value.clone())}};function VR(t,e){return t.distance-e.distance}function z_(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===i){let r=t.children;for(let s=0,a=r.length;s<a;s++)z_(r[s],e,n,!0)}}(class extends H8{constructor(t,e,n=1){super(t,e),this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){let e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){let e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}).prototype.isInstancedInterleavedBuffer=!0;var OR=new Ie,X8=class{constructor(t=new Ie(1/0,1/0),e=new Ie(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let n=OR.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return OR.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}};X8.prototype.isBox2=!0,new ee,new ee;var go=new ee,e9=new Ct,T_=new Ct;function FR(t){let e=[];!0===t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,FR(t.children[n]));return e}var q3e=new Float32Array(1);new Int32Array(q3e.buffer),Q2.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Q2.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},y_.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)},class extends c_{constructor(t=10,e=10,n=4473924,i=8947848){n=new gt(n),i=new gt(i);let r=e/2,s=t/e,a=t/2,o=[],c=[];for(let f=0,d=0,m=-a;f<=e;f++,m+=s){o.push(-a,0,m,a,0,m),o.push(m,0,-a,m,0,a);let v=f===r?n:i;v.toArray(c,d),d+=3,v.toArray(c,d),d+=3,v.toArray(c,d),d+=3,v.toArray(c,d),d+=3}let l=new Q1;l.setAttribute("position",new Xn(o,3)),l.setAttribute("color",new Xn(c,3)),super(l,new $c({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends c_{constructor(t){let e=FR(t),n=new Q1,i=[],r=[],s=new gt(0,0,1),a=new gt(0,1,0);for(let c=0;c<e.length;c++){let l=e[c];l.parent&&l.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(s.r,s.g,s.b),r.push(a.r,a.g,a.b))}n.setAttribute("position",new Xn(i,3)),n.setAttribute("color",new Xn(r,3)),super(n,new $c({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){let e=this.bones,n=this.geometry,i=n.getAttribute("position");T_.copy(this.root.matrixWorld).invert();for(let r=0,s=0;r<e.length;r++){let a=e[r];a.parent&&a.parent.isBone&&(e9.multiplyMatrices(T_,a.matrixWorld),go.setFromMatrixPosition(e9),i.setXYZ(s,go.x,go.y,go.z),e9.multiplyMatrices(T_,a.parent.matrixWorld),go.setFromMatrixPosition(e9),i.setXYZ(s+1,go.x,go.y,go.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},mo.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class{static decodeText(t){if(typeof TextDecoder<"u")return(new TextDecoder).decode(t);let e="";for(let n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(n){return e}}static extractUrlBase(t){let e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}.extractUrlBase(t)},mo.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},X8.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},X8.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},X8.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},X8.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},Pr.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Pr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Pr.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Pr.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},Pr.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},Dc.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},Ac.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Nf.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},li.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},li.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},li.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},li.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},li.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},li.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Ct.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},Ct.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Ct.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ee).setFromMatrixColumn(this,3)},Ct.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},Ct.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Ct.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Ct.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Ct.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Ct.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},Ct.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Ct.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Ct.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Ct.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Ct.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Ct.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Ct.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Ct.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Ct.prototype.makeFrustum=function(t,e,n,i,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,i,n,r,s)},Ct.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},ra.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},r2.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},r2.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},I4.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},I4.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},I4.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},In.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},In.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},In.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},In.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},In.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},In.barycoordFromPoint=function(t,e,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),In.getBarycoord(t,e,n,i,r)},In.normal=function(t,e,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),In.getNormal(t,e,n,i)},U8.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},U8.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new q8(this,t)},U8.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new pR(this,t)},Ie.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Ie.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},Ie.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ee.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},ee.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},ee.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},ee.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},ee.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},ee.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},ee.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},ee.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},ee.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},b1.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},b1.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},w1.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},w1.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},w1.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},w1.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},w1.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(w1.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),s2.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(s2.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),qN.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},a2.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(ds.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(On.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===hf},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(hf)}}}),On.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?hf:T8),this},On.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},On.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Q1.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},Q1.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new On(arguments[1],arguments[2])))},Q1.prototype.addDrawCall=function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},Q1.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Q1.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Q1.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},Q1.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(Q1.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),H8.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?hf:T8),this},H8.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},q8.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},q8.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},q8.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},ON.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},IR.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Vn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new gt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Hr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),S1.prototype.clearTarget=function(t,e,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,i)},S1.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},S1.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},S1.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},S1.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},S1.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},S1.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},S1.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},S1.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},S1.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},S1.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},S1.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},S1.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},S1.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},S1.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},S1.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},S1.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},S1.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},S1.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},S1.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},S1.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},S1.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},S1.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},S1.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},S1.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(S1.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?W1:io}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(NN.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(T2.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),class extends w1{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;let e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");let e=this;return(new b3e).load(t,function(n){e.setBuffer(n)}),this},jy.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},jy.prototype.clear=function(t,e,n,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,i)},P4.crossOrigin=void 0,P4.loadTexture=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");let r=new u3e;r.setCrossOrigin(this.crossOrigin);let s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s},P4.loadTextureCube=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");let r=new h3e;r.setCrossOrigin(this.crossOrigin);let s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s},P4.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},P4.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"138"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="138");var BR=class{constructor(t,e){e1(this,"target"),e1(this,"name"),e1(this,"intersected"),e1(this,"wasIntersected",!1),e1(this,"distance"),this.target=t,this.name=e,this.intersected=!1,this.distance=0}},Ir=class{constructor(t,e=null){e1(this,"type"),e1(this,"cancelBubble"),e1(this,"originalEvent"),e1(this,"coords",new Ie(0,0)),e1(this,"distance",0),e1(this,"intersected",!1),this.cancelBubble=!1,this.type=t,this.originalEvent=e}stopPropagation(){this.cancelBubble=!0}};const $3e=["canvas"],X3e=["canvasHolder"],Y3e=function(){return["fas","eye"]},J3e=function(t){return["fas",t]};let K3e=(()=>{class t{constructor(){this.configurationChanged=new l1,this.cubeDirections=[],this.loader=new MD,this.geometry=new qa(1,1,1),this.selectionGeometry=new d8(.25,-.5,8),this.material=new X2({color:new it(16777215)}),this.selectedColor=new it(16762288),this._90=1.5707963268,this.textureMap=new Map,this.cubeList=new Array,this.standardMaterial=[],this.selectedMaterial=[]}cubeClicked(n){this.configurationChanged.emit(n)}ngOnInit(){}ngAfterViewInit(){this.loadTextures()}startView(){this.loadTextures()}ngOnChanges(n){n&&n.puzzleInfo&&this.puzzleInfo&&(this.loadBackground(),this.camera&&this.scene&&(this.buildDirectionArray(),this.removeInteraction(),this.reCreateScene(),this.createCamera(),this.createInteractionManager(),this.addInteraction(),this.renderer.render(this.scene,this.camera)))}get canvas(){return this.canvasRef.nativeElement}getTexture(n){return this.textureMap.get(n)}loadBackground(){this.canvasHolderRef&&this.canvasHolderRef.nativeElement.setAttribute("style",this.puzzleInfo&&this.puzzleInfo.type!=E1.BROKEN?"background-size: cover;background-image:url(./assets/backgrounds/"+this.puzzleInfo.id+".jpg)":"background-size: cover;background-image:url(./assets/backgrounds/static.gif)")}buildDirectionArray(){this.cubeDirections=[];for(let n=0;n<this.puzzleInfo.count;n++)this.cubeDirections[n]=this.puzzleInfo.directions[n]}loadTextures(){this.loadBackground(),this.buildDirectionArray(),Promise.all([this.getTexturePromise("assets/cube-at.png"),this.getTexturePromise("assets/cube-bee.png"),this.getTexturePromise("assets/cube-blank.png"),this.getTexturePromise("assets/cube-face.png"),this.getTexturePromise("assets/cube-zero.png"),this.getTexturePromise("assets/cube-one.png"),this.getTexturePromise("assets/cube-two.png"),this.getTexturePromise("assets/cube-three.png"),this.getTexturePromise("assets/cube-down_arrow.png")]).then(()=>{this.createScene(),this.createRenderer(),this.createInteractionManager(),this.addInteraction(),this.update(0)})}getTexturePromise(n){let i=this.loader,r=this.textureMap,s=this.selectedColor;return new Promise(function(a,o){i.load(n,function c(l){r.set(n,new X2({map:l}));let u=new X2({map:l});u.color=s,r.set(n+"_",u),a(l)})})}reCreateScene(){var n;this.standardMaterial=[],this.selectedMaterial=[],this.selectionNode&&(this.selectionNode.visible=!1);for(let i=0;i<this.cubeList.length;i++)this.scene.remove(this.cubeList[i]);switch(this.cubeList=[],this.puzzleInfo.type){case E1.SPIN:this.standardMaterial.push(this.getTexture("assets/cube-bee.png")),this.standardMaterial.push(this.getTexture("assets/cube-at.png")),this.standardMaterial.push(this.getTexture("assets/cube-down_arrow.png")),this.standardMaterial.push(this.getTexture("assets/cube-blank.png")),this.standardMaterial.push(this.getTexture("assets/cube-three.png")),this.standardMaterial.push(this.getTexture("assets/cube-face.png")),this.selectedMaterial.push(this.getTexture("assets/cube-bee.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-at.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-down_arrow.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-blank.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-three.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-face.png_"));break;case E1.LIGHT:this.standardMaterial.push(this.getTexture("assets/cube-one.png")),this.standardMaterial.push(this.getTexture("assets/cube-three.png")),this.standardMaterial.push(this.getTexture("assets/cube-blank.png")),this.standardMaterial.push(this.getTexture("assets/cube-blank.png")),this.standardMaterial.push(this.getTexture("assets/cube-zero.png")),this.standardMaterial.push(this.getTexture("assets/cube-two.png")),this.selectedMaterial.push(this.getTexture("assets/cube-one.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-three.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-blank.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-blank.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-zero.png_")),this.selectedMaterial.push(this.getTexture("assets/cube-two.png_"));break;default:this.standardMaterial.push(this.getTexture("assets/cube-bee.png")),this.standardMaterial.push(this.getTexture("assets/cube-at.png")),this.standardMaterial.push(this.getTexture("assets/cube-blank.png")),this.standardMaterial.push(this.getTexture("assets/cube-blank.png")),this.standardMaterial.push(this.getTexture("assets/cube-three.png")),this.standardMaterial.push(this.getTexture("assets/cube-face.png"))}if((null===(n=this.puzzleInfo)||void 0===n?void 0:n.type)!==E1.BROKEN)for(let i=0;i<this.puzzleInfo.count;i++){let r=new zn(this.geometry,this.standardMaterial);r.name="cube_"+(i+1),this.cubeList.push(r),r.position.set(this.puzzleInfo.position[i][0],this.puzzleInfo.position[i][1],this.puzzleInfo.position[i][2]),this.scene.add(r),this.updateCubeDirection(i)}}createCamera(){if(this.puzzleInfo.type==E1.LIGHT){let i=this.puzzleInfo.orthoWidth/2,r=.75*this.puzzleInfo.orthoWidth/2;this.camera=new o8(-i,i,r,-r,.1,50),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=0}else this.camera=new Zn(90,1.3333333333333333,.1,50),this.camera.position.x=this.puzzleInfo.camera[0],this.camera.position.y=this.puzzleInfo.camera[1],this.camera.position.z=this.puzzleInfo.camera[2],this.camera.lookAt(0,0,0)}createScene(){this.scene=new m7,this.reCreateScene(),this.selectionNode=new zn(this.selectionGeometry,new X2({color:16711680})),this.selectionNode.visible=!1,this.scene.add(this.selectionNode),this.createCamera()}updateDirections(n,i=-1){for(let r=0;r<this.puzzleInfo.count;r++)this.cubeDirections[r]=n[r],r==i?(this.selectionNode.position.x=this.cubeList[r].position.x,this.selectionNode.position.y=this.cubeList[r].position.y+1,this.selectionNode.position.z=this.cubeList[r].position.z,this.cubeList[r].material=this.selectedMaterial):this.cubeList[r].material=this.standardMaterial,this.updateCubeDirection(r);this.selectionNode.visible=i>=0,this.renderer.render(this.scene,this.camera)}updateCubeDirection(n){let i=0;switch(this.cubeDirections[n]){case Ae.NORTH:i=2*this._90;break;case Ae.EAST:i=this._90;break;case Ae.SOUTH:i=0;break;case Ae.WEST:i=-this._90;break;case Ae.TWO:i=2*this._90;break;case Ae.ONE:i=-this._90;break;case Ae.ZERO:i=0;break;case Ae.THREE:i=this._90}if(this.puzzleInfo.type==E1.SPIN)switch(this.puzzleInfo.facing){case Ae.NORTH:break;case Ae.EAST:i+=this._90;break;case Ae.SOUTH:i-=2*this._90;break;case Ae.WEST:i-=this._90}this.cubeList[n].rotation.y=i}createRenderer(){this.renderer=new x1({canvas:this.canvas,antialias:!1,alpha:!0}),this.renderer.setPixelRatio(1),this.renderer.setClearColor(0,0);var n=this.getCanvasSize();this.renderer.setSize(n[0],n[1]),this.renderer.render(this.scene,this.camera)}update(n){this.interactionManager.update(),requestAnimationFrame(this.update.bind(this))}onResize(n){if(null!=this.puzzleInfo){var i=this.getCanvasSize();this.renderer.setSize(i[0],i[1]),this.renderer.render(this.scene,this.camera)}}getFacingDirectionText(){if(this.puzzleInfo)switch(this.puzzleInfo.facing){case Ae.NORTH:return"North";case Ae.EAST:return"East";case Ae.SOUTH:return"South";case Ae.WEST:return"West"}return""}getFacingDirectionClass(){if(this.puzzleInfo)switch(this.puzzleInfo.facing){case Ae.NORTH:return"arrow-alt-circle-up";case Ae.EAST:return"arrow-alt-circle-right";case Ae.SOUTH:return"arrow-alt-circle-down";case Ae.WEST:return"arrow-alt-circle-left"}return"arrow-alt-circle-up"}getCanvasSize(){let n=this.canvasHolderRef.nativeElement.clientWidth;return[n,Math.floor(.75*n)]}getAspectRatio(){return this.canvas.clientWidth/this.canvas.clientHeight}createInteractionManager(){this.interactionManager=new class{constructor(t,e,n,i){e1(this,"renderer"),e1(this,"camera"),e1(this,"domElement"),e1(this,"bindEventsOnBodyElement"),e1(this,"mouse"),e1(this,"supportsPointerEvents"),e1(this,"interactiveObjects"),e1(this,"closestObject"),e1(this,"raycaster"),e1(this,"treatTouchEventsAsMouseEvents"),e1(this,"dispose",()=>{this.domElement.removeEventListener("click",this.onMouseClick),this.supportsPointerEvents?(this.domElement.ownerDocument.removeEventListener("pointermove",this.onDocumentMouseMove),this.domElement.removeEventListener("pointerdown",this.onMouseDown),this.domElement.removeEventListener("pointerup",this.onMouseUp)):(this.domElement.ownerDocument.removeEventListener("mousemove",this.onDocumentMouseMove),this.domElement.removeEventListener("mousedown",this.onMouseDown),this.domElement.removeEventListener("mouseup",this.onMouseUp),this.domElement.removeEventListener("touchstart",this.onTouchStart),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd))}),e1(this,"add",(t,e=[])=>{if(t)if(e.length>0)e.forEach(n=>{let i=t.getObjectByName(n);if(i){let r=new BR(i,n);this.interactiveObjects.push(r)}});else{let n=new BR(t,t.name);this.interactiveObjects.push(n)}}),e1(this,"remove",(t,e=[])=>{if(!t)return;let n=new Set(e.length>0?e:[t.name]);this.interactiveObjects=this.interactiveObjects.filter(i=>!n.has(i.name))}),e1(this,"update",()=>{var i;this.raycaster.setFromCamera(this.mouse,this.camera),this.interactiveObjects.forEach(r=>{r.target&&this.checkIntersection(r)}),this.interactiveObjects.sort(function(r,s){return r.distance-s.distance});let e,n,t=null!=(i=this.interactiveObjects.find(r=>r.intersected))?i:null;if(t!=this.closestObject){if(this.closestObject){let r=new Ir("mouseout");this.dispatch(this.closestObject,r)}if(t){let r=new Ir("mouseover");this.dispatch(t,r)}this.closestObject=t}this.interactiveObjects.forEach(r=>{!r.intersected&&r.wasIntersected&&(e||(e=new Ir("mouseleave")),this.dispatch(r,e))}),this.interactiveObjects.forEach(r=>{r.intersected&&!r.wasIntersected&&(n||(n=new Ir("mouseenter")),this.dispatch(r,n))})}),e1(this,"checkIntersection",t=>{let e=this.raycaster.intersectObjects([t.target],!0);if(t.wasIntersected=t.intersected,e.length>0){let n=e[0].distance;e.forEach(i=>{i.distance<n&&(n=i.distance)}),t.intersected=!0,t.distance=n}else t.intersected=!1}),e1(this,"onDocumentMouseMove",t=>{this.mapPositionToPoint(this.mouse,t.clientX,t.clientY);let e=new Ir("mousemove",t);this.interactiveObjects.forEach(n=>{this.dispatch(n,e)})}),e1(this,"onTouchMove",t=>{this.mapPositionToPoint(this.mouse,t.touches[0].clientX,t.touches[0].clientY);let e=new Ir(this.treatTouchEventsAsMouseEvents?"mousemove":"touchmove",t);this.interactiveObjects.forEach(n=>{this.dispatch(n,e)})}),e1(this,"onMouseClick",t=>{this.update();let e=new Ir("click",t);this.interactiveObjects.forEach(n=>{n.intersected&&this.dispatch(n,e)})}),e1(this,"onMouseDown",t=>{this.mapPositionToPoint(this.mouse,t.clientX,t.clientY),this.update();let e=new Ir("mousedown",t);this.interactiveObjects.forEach(n=>{n.intersected&&this.dispatch(n,e)})}),e1(this,"onTouchStart",t=>{this.mapPositionToPoint(this.mouse,t.touches[0].clientX,t.touches[0].clientY),this.update();let e=new Ir(this.treatTouchEventsAsMouseEvents?"mousedown":"touchstart",t);this.interactiveObjects.forEach(n=>{n.intersected&&this.dispatch(n,e)})}),e1(this,"onMouseUp",t=>{let e=new Ir("mouseup",t);this.interactiveObjects.forEach(n=>{this.dispatch(n,e)})}),e1(this,"onTouchEnd",t=>{this.mapPositionToPoint(this.mouse,t.touches[0].clientX,t.touches[0].clientY),this.update();let e=new Ir(this.treatTouchEventsAsMouseEvents?"mouseup":"touchend",t);this.interactiveObjects.forEach(n=>{this.dispatch(n,e)})}),e1(this,"dispatch",(t,e)=>{t.target&&!e.cancelBubble&&(e.coords=this.mouse,e.distance=t.distance,e.intersected=t.intersected,t.target.dispatchEvent(e))}),e1(this,"mapPositionToPoint",(t,e,n)=>{let i=this.renderer.domElement.getBoundingClientRect();t.x=(e-i.left)/i.width*2-1,t.y=-(n-i.top)/i.height*2+1}),this.renderer=t,this.camera=e,this.domElement=n,this.bindEventsOnBodyElement=!0,typeof i<"u"&&i&&(this.bindEventsOnBodyElement=!1),this.mouse=new Ie(-1,1),this.supportsPointerEvents=!!window.PointerEvent,this.interactiveObjects=[],this.closestObject=null,this.raycaster=new class{constructor(t,e,n=0,i=1/0){this.ray=new I4(t,e),this.near=n,this.far=i,this.camera=null,this.layers=new Ny,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,n=[]){return z_(t,this,n,e),n.sort(VR),n}intersectObjects(t,e=!0,n=[]){for(let i=0,r=t.length;i<r;i++)z_(t[i],this,n,e);return n.sort(VR),n}},n.addEventListener("click",this.onMouseClick),this.supportsPointerEvents?(this.bindEventsOnBodyElement?n.ownerDocument.addEventListener("pointermove",this.onDocumentMouseMove):n.addEventListener("pointermove",this.onDocumentMouseMove),n.addEventListener("pointerdown",this.onMouseDown),n.addEventListener("pointerup",this.onMouseUp)):(this.bindEventsOnBodyElement?n.ownerDocument.addEventListener("mousemove",this.onDocumentMouseMove):n.addEventListener("mousemove",this.onDocumentMouseMove),n.addEventListener("mousedown",this.onMouseDown),n.addEventListener("mouseup",this.onMouseUp),n.addEventListener("touchstart",this.onTouchStart,{passive:!0}),n.addEventListener("touchmove",this.onTouchMove,{passive:!0}),n.addEventListener("touchend",this.onTouchEnd,{passive:!0})),this.treatTouchEventsAsMouseEvents=!0}}(this.renderer,this.camera,this.canvas,!1)}removeInteraction(){for(let n=0;n<this.cubeList.length;n++)this.interactionManager.remove(this.cubeList[n]);this.interactionManager.dispose()}addInteraction(){for(let n=0;n<this.cubeList.length;n++){const i=this.cubeList[n];this.interactionManager.add(i),i.addEventListener("click",r=>{r.stopPropagation(),this.cubeClicked(n)}),i.addEventListener("mouseover",r=>{i.scale.set(1.1,1.1,1.1),this.renderer.render(this.scene,this.camera)}),i.addEventListener("mouseout",r=>{i.scale.set(1,1,1),this.renderer.render(this.scene,this.camera)})}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=O1({type:t,selectors:[["app-three-dview"]],viewQuery:function(n,i){if(1&n&&(s0($3e,5),s0(X3e,5)),2&n){let r;Sa(r=Ca())&&(i.canvasRef=r.first),Sa(r=Ca())&&(i.canvasHolderRef=r.first)}},hostBindings:function(n,i){1&n&&c1("resize",function(s){return i.onResize(s)},!1,xM)},inputs:{puzzleInfo:"puzzleInfo"},outputs:{configurationChanged:"configurationChanged"},features:[ni],decls:9,vars:6,consts:[["id","canvasWrap"],["canvasHolder",""],["id","canvas",2,"height","500px","width","100%"],["canvas",""],[1,"under-bar"],["title","Look in the following direction",1,"direction-icon"],[3,"icon"],[1,"direction-value",3,"title"]],template:function(n,i){1&n&&(le(0,"div",0,1),Vt(2,"canvas",2,3),he(),le(4,"div",4),le(5,"span",5),Vt(6,"fa-icon",6),he(),le(7,"span",7),Vt(8,"fa-icon",6),he(),he()),2&n&&(ht(6),yt("icon",vr(3,Y3e)),ht(1),yt("title",i.getFacingDirectionText()),ht(1),yt("icon",al(4,J3e,i.getFacingDirectionClass())))},directives:[jl],styles:["#canvasWrap[_ngcontent-%COMP%]{border:1px solid black}.under-bar[_ngcontent-%COMP%]{height:24px;background-color:#000;color:#fff}.direction-icon[_ngcontent-%COMP%], .direction-value[_ngcontent-%COMP%]{margin:0 4px;display:inline-block}"]}),t})();const Q3e=function(){return["fas","angle-left"]},e0e=function(){return["fas","angle-right"]};function t0e(t,e){if(1&t){const n=Go();le(0,"div",8),le(1,"button",9),c1("click",function(){Ts(n);const r=y1().index;return y1(2).arrowClicked(r,!0)}),Vt(2,"fa-icon",10),he(),le(3,"button",11),c1("click",function(){Ts(n);const r=y1().index;return y1(2).arrowClicked(r,!1)}),Ge(4),he(),le(5,"button",12),c1("click",function(){Ts(n);const r=y1().index;return y1(2).arrowClicked(r,!1)}),Vt(6,"fa-icon",10),he(),he()}if(2&t){const n=y1().$implicit,i=y1(2);ht(2),yt("icon",vr(3,Q3e)),ht(2),x2(" ",i.getDirectionValue(n)," "),ht(2),yt("icon",vr(4,e0e))}}function n0e(t,e){if(1&t){const n=Go();le(0,"div",3),le(1,"div",4),le(2,"div",5),le(3,"button",6),c1("click",function(){const s=Ts(n).index;return y1(2).cubeClicked(s)}),Ge(4),he(),he(),X1(5,t0e,7,5,"div",7),he(),he()}if(2&t){const n=e.index,i=y1(2);ht(4),x2(" #",n+1," "),ht(1),yt("ngIf",!0===i.puzzleInfo.edit[n])}}function i0e(t,e){if(1&t&&(le(0,"div",1),X1(1,n0e,6,2,"div",2),he()),2&t){const n=y1();ht(1),yt("ngForOf",n.puzzleConfiguration.directions)}}let r0e=(()=>{class t{constructor(){this.brokenType=E1.BROKEN,this.configurationChanged=new l1}ngOnInit(){}getDirectionValue(n){switch(n){case Ae.NORTH:return"N";case Ae.EAST:return"E";case Ae.SOUTH:return"S";case Ae.WEST:return"W";case Ae.ZERO:return"0";case Ae.ONE:return"1";case Ae.TWO:return"2";case Ae.THREE:return"3";default:return"?"}}arrowClicked(n,i){var r;(null===(r=this.puzzleConfiguration)||void 0===r?void 0:r.rotateIndex(n,i))&&this.configurationChanged.emit(n)}cubeClicked(n){this.configurationChanged.emit(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=O1({type:t,selectors:[["app-puzzle-configuration"]],inputs:{puzzleConfiguration:"puzzleConfiguration",puzzleInfo:"puzzleInfo"},outputs:{configurationChanged:"configurationChanged"},decls:1,vars:1,consts:[["class","configuration-component",4,"ngIf"],[1,"configuration-component"],["class","configRow",4,"ngFor","ngForOf"],[1,"configRow"],["role","toolbar","aria-label","Toolbar with button groups",1,"btn-toolbar"],["role","group","aria-label","Highlight Group",1,"btn-group","me-2"],["title","Highlight Cube",1,"icon-click-left","btn","btn-info",3,"click"],["class","btn-group me-2","role","group","aria-label","Modification Group",4,"ngIf"],["role","group","aria-label","Modification Group",1,"btn-group","me-2"],["title","Previous Cube Value",1,"icon-click-left","btn","btn-secondary",3,"click"],[3,"icon"],["title","Next Cube Value",1,"icon-value","btn","btn-light",3,"click"],["title","Next Cube Value",1,"icon-click-right","btn","btn-secondary",3,"click"]],template:function(n,i){1&n&&X1(0,i0e,2,1,"div",0),2&n&&yt("ngIf",i.puzzleConfiguration&&i.puzzleConfiguration.puzzleType!==i.brokenType)},directives:[u0,Ta,jl],styles:[".configuration-component[_ngcontent-%COMP%]{border:1px solid black;border-top:none}.configRow[_ngcontent-%COMP%]{border-top:1px solid black;padding:4px}.icon-click-left[_ngcontent-%COMP%], .icon-click-right[_ngcontent-%COMP%], .icon-value[_ngcontent-%COMP%]{cursor:pointer;border:0px}.icon-value[_ngcontent-%COMP%]{display:inline-block;text-align:center;width:48px}"]}),t})();const UR=function(t){return{selected:t}},s0e=function(){return["fas","play-circle"]};function a0e(t,e){if(1&t){const n=Go();le(0,"div",5),le(1,"button",8),c1("click",function(){const s=Ts(n).index;return y1(3).showStep(s)}),Vt(2,"fa-icon",7),he(),le(3,"span"),Ge(4),he(),he()}if(2&t){const n=e.$implicit,i=e.index,r=y1(3);yt("ngClass",al(3,UR,r.selectedIndex==i)),ht(2),yt("icon",vr(5,s0e)),ht(2),x2(" Touch ",n.touchedCube+1," ")}}const o0e=function(){return["fas","flag-checkered"]};function c0e(t,e){if(1&t){const n=Go();mh(0),X1(1,a0e,5,6,"div",4),le(2,"div",5),le(3,"button",6),c1("click",function(){return Ts(n),y1(2).showFinalAction()}),Vt(4,"fa-icon",7),he(),Ge(5," Finish "),he(),gh()}if(2&t){const n=y1(2);ht(1),yt("ngForOf",n.puzzleSolution),ht(1),yt("ngClass",al(3,UR,-2==n.selectedIndex)),ht(2),yt("icon",vr(5,o0e))}}function l0e(t,e){1&t&&(le(0,"div",9),Ge(1,"No solution"),he())}function h0e(t,e){if(1&t&&(le(0,"div",1),X1(1,c0e,6,6,"ng-container",2),X1(2,l0e,2,0,"ng-template",null,3,ll),he()),2&t){const n=Y3(3),i=y1();ht(1),yt("ngIf",i.puzzleSolution&&i.puzzleSolution.length>0)("ngIfElse",n)}}let u0e=(()=>{class t{constructor(){this.badType=E1.BROKEN,this.selectedIndex=-1,this.showSolution=new l1,this.showFinal=new l1}ngOnInit(){}showStep(n){this.selectedIndex=n,this.showSolution.emit(this.puzzleSolution[n])}showFinalAction(){this.selectedIndex=-2,this.showFinal.emit(this.puzzleSolution[this.puzzleSolution.length-1])}ngOnChanges(n){(n&&n.puzzleSolution||n.puzzleInfo)&&(this.selectedIndex=-1)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=O1({type:t,selectors:[["app-puzzle-solution"]],inputs:{puzzleSolution:"puzzleSolution",puzzleInfo:"puzzleInfo"},outputs:{showSolution:"showSolution",showFinal:"showFinal"},features:[ni],decls:1,vars:1,consts:[["class","solution-component",4,"ngIf"],[1,"solution-component"],[4,"ngIf","ngIfElse"],["noSolutionBlock",""],["class","solutionRow",3,"ngClass",4,"ngFor","ngForOf"],[1,"solutionRow",3,"ngClass"],["title","Show Final",1,"icon-click-left","btn","btn-info",3,"click"],[3,"icon"],["title","Show Move",1,"icon-click-left","btn","btn-info",3,"click"],[1,"solutionRow","alert","alert-warning"]],template:function(n,i){1&n&&X1(0,h0e,4,2,"div",0),2&n&&yt("ngIf",i.puzzleInfo&&i.puzzleInfo.type!==i.badType)},directives:[u0,Ta,pm,jl],styles:[".solution-component[_ngcontent-%COMP%]{border:1px solid black;border-top:none}.solutionRow[_ngcontent-%COMP%]{border-top:1px solid black;padding:4px}.solutionRow.alert.alert-warning[_ngcontent-%COMP%]{margin-bottom:0;border-radius:0}.solutionRow.selected[_ngcontent-%COMP%]{background-color:#e0ffff}"]}),t})();const f0e=["threedview"];function d0e(t,e){if(1&t&&(le(0,"span"),Ge(1),he()),2&t){const n=y1();ht(1),x2("(",n.puzzleInfo.id,")")}}const p0e=function(){return["fas","info-circle"]};function m0e(t,e){if(1&t&&(le(0,"div",17),Vt(1,"fa-icon",18),Ge(2),he()),2&t){const n=y1();ht(1),yt("icon",vr(2,p0e)),ht(1),x2(" ",n.puzzleInfo.description," ")}}const g0e=function(){return["fas","cog"]},v0e=function(){return["fas","sync"]},y0e=function(){return["fas","directions"]},_0e=[{path:"oldchoutreasure",component:wJ},{path:"puzzle/:puzzleId",component:(()=>{class t{constructor(n,i,r){this.route=n,this.dataSource=i,this.router=r,this.puzzleConfiguration=new ql(E1.LIGHT,[]),this.afterInit=!1,this.route.params.subscribe(s=>{let a=s.puzzleId;if(this.dataSource.puzzles.has(a))if(this.puzzleInfo=this.dataSource.puzzles.get(a),this.puzzleInfo.type==E1.BROKEN)this.puzzleConfiguration=new ql(E1.BROKEN,[]);else{let o=new Array;for(let c=0;c<this.puzzleInfo.directions.length;c++)o.push(this.puzzleInfo.directions[c]);this.puzzleConfiguration=new ql(this.puzzleInfo.type,o),this.afterInit&&this.solvePuzzle()}else this.puzzleInfo=void 0,this.puzzleConfiguration=new ql(E1.LIGHT,[])})}ngOnInit(){}ngAfterViewInit(){this.afterInit=!0,this.puzzleInfo&&this.solvePuzzle()}configurationChange(n){this.puzzleConfiguration=this.puzzleConfiguration,this.someElement.updateDirections(this.puzzleConfiguration.directions,n),this.solvePuzzle()}updateConfigurationChange(n){var i;let r=!0===this.puzzleInfo.edit[n];r&&(null===(i=this.puzzleConfiguration)||void 0===i||i.rotateIndex(n,!1)),this.someElement.updateDirections(this.puzzleConfiguration.directions,n),r&&this.solvePuzzle()}solvePuzzle(){let n;if(0==this.puzzleInfo.solution.length){let r=[];for(let c=0;c<this.puzzleConfiguration.directions.length;c++){let l=0;switch(this.puzzleConfiguration.directions[c]){case Ae.NORTH:case Ae.ONE:l=0;break;case Ae.EAST:case Ae.TWO:l=1;break;case Ae.SOUTH:case Ae.THREE:l=2;break;case Ae.WEST:l=3}r.push(l)}let s=[];for(let c=0;c<this.puzzleInfo.connections.length;c++){let l=[],u=!1;for(let f=0;f<this.puzzleInfo.connections[c].length;f++)this.puzzleInfo.connections[c][f]===c&&(u=!0),l.push(this.puzzleInfo.connections[c][f]);!u&&l.length>0&&l.push(c),s.push(l)}let a=TJ;this.puzzleInfo.forced&&this.puzzleInfo.forced.length>0&&(a=function AJ(t){return e=>e.every((n,i)=>t[i]==n)}(this.puzzleInfo.forced)),n=function LJ(t){const e=new Set,n=[];function i(r){const s=r.state.map(a=>a+"").join(",");e.has(s)||(e.add(s),n.push(r))}for(i({previousStep:null,touchedCube:null,state:t.initialState.slice()});;){let r=n.shift();if(void 0===r)break;for(let s=0;s<t.stateTransitions.length;s++){if(0==t.stateTransitions[s].length)continue;const a=r.state.slice();t.stateTransitions[s].forEach(c=>{a[c]=KT(a[c]+1,t.maximumNumber)});const o={previousStep:r,touchedCube:s,state:a};if(t.isFinalState(a))return o;i(o)}}return null}({initialState:r,isFinalState:a,maximumNumber:this.puzzleInfo.type==E1.SPIN?4:3,stateTransitions:s})}else{let r=[];const s=this.puzzleInfo;for(let o=0;o<this.puzzleConfiguration.directions.length;o++){let c=0;switch(this.puzzleConfiguration.directions[o]){case Ae.NORTH:case Ae.ONE:c=0;break;case Ae.EAST:case Ae.TWO:c=1;break;case Ae.SOUTH:case Ae.THREE:c=2;break;case Ae.WEST:c=3}r.push(c)}let a={previousStep:null,touchedCube:null,state:Object.assign([],r)};for(let o=0;o<s.solution.length;o++){let c=s.solution[o];r[c]=KT(r[c]+1,this.puzzleInfo.type==E1.LIGHT?3:4),a={previousStep:a,touchedCube:c,state:Object.assign([],r)}}n=a}let i=[];for(;n;){let r=n;if(n=n.previousStep,null==n)break;i.splice(0,0,r)}this.puzzleSolution=i}showFinalStep(n){let i;i=n.state;let s=this.convertStepToDirections(i);this.someElement.updateDirections(s,-1)}convertStepToDirections(n){let i=[];for(let r=0;r<n.length;r++)switch(n[r]){case 0:i.push(this.puzzleInfo.type==E1.LIGHT?Ae.ONE:Ae.NORTH);break;case 1:i.push(this.puzzleInfo.type==E1.LIGHT?Ae.TWO:Ae.EAST);break;case 2:i.push(this.puzzleInfo.type==E1.LIGHT?Ae.THREE:Ae.SOUTH);break;case 3:i.push(this.puzzleInfo.type==E1.LIGHT?Ae.ZERO:Ae.WEST)}return i}showSolutionStep(n){let i,r=-1;n.previousStep?(i=n.previousStep.state,r=n.touchedCube):i=n.state;let s=this.convertStepToDirections(i);this.someElement.updateDirections(s,r)}resetPuzzle(){let n=new Array;for(let i=0;i<this.puzzleInfo.directions.length;i++)n.push(this.puzzleInfo.directions[i]);this.puzzleConfiguration=new ql(this.puzzleInfo.type,n),this.someElement.updateDirections(this.puzzleConfiguration.directions,-1),this.solvePuzzle()}}return t.\u0275fac=function(n){return new(n||t)(He(Da),He(Ll),He(ki))},t.\u0275cmp=O1({type:t,selectors:[["app-puzzle-view"]],viewQuery:function(n,i){if(1&n&&s0(f0e,5),2&n){let r;Sa(r=Ca())&&(i.someElement=r.first)}},decls:26,vars:15,consts:[[1,"container"],[4,"ngIf"],[1,"row"],[1,"col-xs-12","col-lg-8",3,"puzzleInfo","configurationChanged"],["threedview",""],[1,"col-md-12","col-lg-4"],[1,"col-md-6","col-lg-12"],["class","description-box",4,"ngIf"],[1,"title-wrapper"],["title","Configuration",3,"icon"],["title","Reset Configuration",1,"action-link",2,"color","blue","cursor","pointer",3,"icon","click"],[3,"puzzleInfo","puzzleConfiguration","configurationChanged"],["title","Solution",3,"icon"],[3,"puzzleInfo","puzzleSolution","showSolution","showFinal"],[1,"col-xs-12","col-sm-12","col-md-8"],["id","mapArea",3,"puzzleInfo","fixedHeight"],[1,"col-xs-12","col-sm-12","col-md-4"],[1,"description-box"],[3,"icon"]],template:function(n,i){1&n&&(le(0,"div",0),le(1,"h2"),Ge(2," Puzzle Details "),X1(3,d0e,2,1,"span",1),he(),le(4,"div",2),le(5,"app-three-dview",3,4),c1("configurationChanged",function(s){return i.updateConfigurationChange(s)}),he(),le(7,"div",5),le(8,"div",2),le(9,"div",6),X1(10,m0e,3,3,"div",7),le(11,"div",8),Vt(12,"fa-icon",9),Ge(13," \xa0 Configuration "),le(14,"fa-icon",10),c1("click",function(){return i.resetPuzzle()}),he(),he(),le(15,"app-puzzle-configuration",11),c1("configurationChanged",function(s){return i.configurationChange(s)}),he(),he(),le(16,"div",6),le(17,"div",8),Vt(18,"fa-icon",12),Ge(19," Solution "),he(),le(20,"app-puzzle-solution",13),c1("showSolution",function(s){return i.showSolutionStep(s)})("showFinal",function(s){return i.showFinalStep(s)}),he(),he(),he(),he(),he(),le(21,"div",2),le(22,"div",14),Vt(23,"app-map",15),he(),le(24,"div",16),Vt(25,"app-map-key"),he(),he(),he()),2&n&&(ht(3),yt("ngIf",i.puzzleInfo),ht(2),yt("puzzleInfo",i.puzzleInfo),ht(5),yt("ngIf",i.puzzleInfo&&i.puzzleInfo.description),ht(2),yt("icon",vr(12,g0e)),ht(2),yt("icon",vr(13,v0e)),ht(1),yt("puzzleInfo",i.puzzleInfo)("puzzleConfiguration",i.puzzleConfiguration),ht(3),yt("icon",vr(14,y0e)),ht(2),yt("puzzleInfo",i.puzzleInfo)("puzzleSolution",i.puzzleSolution),ht(3),yt("puzzleInfo",i.puzzleInfo)("fixedHeight",!0))},directives:[u0,K3e,jl,r0e,u0e,Lg,XT],styles:[".description-box[_ngcontent-%COMP%]{background-color:#fff;border:1px solid black;padding:4px;margin:4px 0;border-radius:4px}.title-wrapper[_ngcontent-%COMP%]{text-align:left;border-top:1px solid black;border-left:1px solid black;border-right:1px solid black;border-top-left-radius:4px;border-top-right-radius:4px;margin-top:4px;padding-left:12px;background-color:#d3d3d3;font-weight:700}#mapArea[_ngcontent-%COMP%]{height:400px}.action-link[_ngcontent-%COMP%]{float:right;padding-right:8px}"]}),t})()},{path:"list/:island",component:zJ},{path:"map",component:Lg},{path:"",component:yJ}];let x0e=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({imports:[[Mz.forRoot(_0e)],Mz]}),t})();const GR="400ms cubic-bezier(0.4,0.0,0.2,1)",M0e=[Na({height:0,visibility:"hidden"}),Xm(GR,Na({height:"*",visibility:"visible"}))],b0e=[Na({height:"*",visibility:"visible"}),Xm(GR,Na({height:0,visibility:"hidden"}))];let w0e=(()=>{class t{constructor(n,i,r){this._el=n,this._renderer=i,this.collapsed=new l1,this.collapses=new l1,this.expanded=new l1,this.expands=new l1,this.isExpanded=!0,this.collapseNewValue=!0,this.isCollapsed=!1,this.isCollapse=!0,this.isCollapsing=!1,this.isAnimated=!1,this._display="block",this._stylesLoaded=!1,this._COLLAPSE_ACTION_NAME="collapse",this._EXPAND_ACTION_NAME="expand",this._factoryCollapseAnimation=r.build(b0e),this._factoryExpandAnimation=r.build(M0e)}set display(n){this._display=n,"none"!==n?this.isAnimated?this.toggle():this.show():this.hide()}set collapse(n){this.collapseNewValue=n,(!this._player||this._isAnimationDone)&&(this.isExpanded=n,this.toggle())}get collapse(){return this.isExpanded}ngAfterViewChecked(){this._stylesLoaded=!0,this._player&&this._isAnimationDone&&(this._player.reset(),this._renderer.setStyle(this._el.nativeElement,"height","*"))}toggle(){this.isExpanded?this.hide():this.show()}hide(){this.isCollapsing=!0,this.isExpanded=!1,this.isCollapsed=!0,this.isCollapsing=!1,this.collapses.emit(this),this._isAnimationDone=!1,this.animationRun(this.isAnimated,this._COLLAPSE_ACTION_NAME)(()=>{this._isAnimationDone=!0,this.collapseNewValue!==this.isCollapsed&&this.isAnimated?this.show():(this.collapsed.emit(this),this._renderer.setStyle(this._el.nativeElement,"display","none"))})}show(){this._renderer.setStyle(this._el.nativeElement,"display",this._display),this.isCollapsing=!0,this.isExpanded=!0,this.isCollapsed=!1,this.isCollapsing=!1,this.expands.emit(this),this._isAnimationDone=!1,this.animationRun(this.isAnimated,this._EXPAND_ACTION_NAME)(()=>{this._isAnimationDone=!0,this.collapseNewValue!==this.isCollapsed&&this.isAnimated?this.hide():(this.expanded.emit(this),this._renderer.removeStyle(this._el.nativeElement,"overflow"))})}animationRun(n,i){if(!n||!this._stylesLoaded)return s=>s();this._renderer.setStyle(this._el.nativeElement,"overflow","hidden"),this._renderer.addClass(this._el.nativeElement,"collapse");const r=i===this._EXPAND_ACTION_NAME?this._factoryExpandAnimation:this._factoryCollapseAnimation;return this._player&&this._player.destroy(),this._player=r.create(this._el.nativeElement),this._player.play(),s=>{var a;return null===(a=this._player)||void 0===a?void 0:a.onDone(s)}}}return t.\u0275fac=function(n){return new(n||t)(He(ii),He(ss),He(Pl))},t.\u0275dir=$1({type:t,selectors:[["","collapse",""]],hostVars:9,hostBindings:function(n,i){2&n&&(ba("aria-hidden",i.isCollapsed),jo("collapse",i.isCollapse)("in",i.isExpanded)("show",i.isExpanded)("collapsing",i.isCollapsing))},inputs:{display:"display",isAnimated:"isAnimated",collapse:"collapse"},outputs:{collapsed:"collapsed",collapses:"collapses",expanded:"expanded",expands:"expands"},exportAs:["bs-collapse"]}),t})(),S0e=(()=>{class t{static forRoot(){return{ngModule:t,providers:[]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({}),t})();function C0e(t,e){if(1&t&&(le(0,"a",21),Ge(1),he()),2&t){const n=e.$implicit;Wo("routerLink","/list/",e.index,""),ht(1),wa(n)}}function E0e(t,e){if(1&t&&(le(0,"div",17),le(1,"a",18),Ge(2,"All"),he(),Vt(3,"li",19),X1(4,C0e,2,2,"a",20),he()),2&t){const n=y1();ht(4),yt("ngForOf",n.dataSource.islands)}}function z0e(t,e){1&t&&(le(0,"div",17),le(1,"a",22),Ge(2,"Old Chou's Treasure"),he(),he())}let T0e=(()=>{class t{constructor(n){this.dataSource=n,this.title="JenshinSolver",this.isCollapsed=!0}}return t.\u0275fac=function(n){return new(n||t)(He(Ll))},t.\u0275cmp=O1({type:t,selectors:[["app-root"]],decls:27,vars:1,consts:[["id","nav_header",1,"navbar","navbar-expand-lg","navbar-light","bg-light"],[1,"container-fluid"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler",3,"click"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse",3,"collapse"],[1,"navbar-nav"],[1,"nav-item"],["aria-current","page","routerLink","/",1,"nav-link","active"],["aria-current","page","routerLink","/map",1,"nav-link","active"],["dropdown","",1,"nav-item","dropdown"],["id","navbardrop","data-toggle","dropdown","dropdownToggle","",1,"nav-link","active","dropdown-toggle"],["class","dropdown-menu",4,"dropdownMenu"],["id","navbardrop2","data-toggle","dropdown","dropdownToggle","",1,"nav-link","active","dropdown-toggle"],[1,"nav-item","active"],["href","https://github.com/mgatelabs/GenshinSolvers","target","_blank",1,"nav-link"],["id","route_holder",1,"routeHolder"],[1,"dropdown-menu"],["href","#","routerLink","/list/-1",1,"dropdown-item"],[1,"divider","dropdown-divider"],["class","dropdown-item","href","#",3,"routerLink",4,"ngFor","ngForOf"],["href","#",1,"dropdown-item",3,"routerLink"],["href","#","routerLink","/oldchoutreasure",1,"dropdown-item"]],template:function(n,i){1&n&&(le(0,"nav",0),le(1,"div",1),le(2,"a",2),Ge(3,"Puzzle Solver"),he(),le(4,"button",3),c1("click",function(){return i.isCollapsed=!i.isCollapsed}),Vt(5,"span",4),he(),le(6,"div",5),le(7,"ul",6),le(8,"li",7),le(9,"a",8),Ge(10,"Home"),he(),he(),le(11,"li",7),le(12,"a",9),Ge(13,"Map"),he(),he(),le(14,"li",10),le(15,"span",11),Ge(16," Listing "),he(),X1(17,E0e,5,1,"div",12),he(),le(18,"li",10),le(19,"span",13),Ge(20," Other "),he(),X1(21,z0e,3,0,"div",12),he(),le(22,"li",14),le(23,"a",15),Ge(24,"Source Code"),he(),he(),he(),he(),he(),he(),le(25,"div",16),Vt(26,"router-outlet"),he()),2&n&&(ht(6),yt("collapse",i.isCollapsed))},directives:[w0e,du,rg,Xz,$z,Ta,Fm],styles:[".header-block[_ngcontent-%COMP%]{font-size:18px;font-weight:700;text-align:center}.header-sub[_ngcontent-%COMP%]{border-bottom:1px solid black;text-align:center}.routeHolder[_ngcontent-%COMP%]{position:absolute;top:60px;left:0;right:0;bottom:0}#nav_header[_ngcontent-%COMP%]{z-index:100}#route_holder[_ngcontent-%COMP%]{z-index:50}span.nav-link[_ngcontent-%COMP%]{cursor:pointer}"]}),t})();function WR(){return"undefined"!=typeof window&&void 0!==window.document}function A_(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function vo(t){switch(t.length){case 0:return new g0;case 1:return t[0];default:return new Lz(t)}}function jR(t,e,n,i,r={},s={}){const a=[],o=[];let c=-1,l=null;if(i.forEach(u=>{const f=u.offset,d=f==c,m=d&&l||{};Object.keys(u).forEach(v=>{let _=v,M=u[v];if("offset"!==v)switch(_=e.normalizePropertyName(_,a),M){case"!":M=r[v];break;case Os:M=s[v];break;default:M=e.normalizeStyleValue(v,_,M,a)}m[_]=M}),d||o.push(m),l=m,c=f}),a.length){const u="\n - ";throw new Error(`Unable to animate due to the following errors:${u}${a.join(u)}`)}return o}function L_(t,e,n,i){switch(e){case"start":t.onStart(()=>i(n&&D_(n,"start",t)));break;case"done":t.onDone(()=>i(n&&D_(n,"done",t)));break;case"destroy":t.onDestroy(()=>i(n&&D_(n,"destroy",t)))}}function D_(t,e,n){const i=n.totalTime,s=P_(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==i?t.totalTime:i,!!n.disabled),a=t._data;return null!=a&&(s._data=a),s}function P_(t,e,n,i,r="",s=0,a){return{element:t,triggerName:e,fromState:n,toState:i,phaseName:r,totalTime:s,disabled:!!a}}function D2(t,e,n){let i;return t instanceof Map?(i=t.get(e),i||t.set(e,i=n)):(i=t[e],i||(i=t[e]=n)),i}function qR(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let N_=(t,e)=>!1,ZR=(t,e,n)=>[];(A_()||"undefined"!=typeof Element)&&(N_=WR()?(t,e)=>{for(;e&&e!==document.documentElement;){if(e===t)return!0;e=e.parentNode||e.host}return!1}:(t,e)=>t.contains(e),ZR=(t,e,n)=>{if(n)return Array.from(t.querySelectorAll(e));const i=t.querySelector(e);return i?[i]:[]});let F4=null,$R=!1;function R_(t){F4||(F4=function L0e(){return"undefined"!=typeof document?document.body:null}()||{},$R=!!F4.style&&"WebkitAppearance"in F4.style);let e=!0;return F4.style&&!function A0e(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in F4.style,!e&&$R&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in F4.style)),e}const H_=N_,I_=ZR;function XR(t){const e={};return Object.keys(t).forEach(n=>{const i=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[i]=t[n]}),e}let YR=(()=>{class t{validateStyleProperty(n){return R_(n)}matchesElement(n,i){return!1}containsElement(n,i){return H_(n,i)}query(n,i,r){return I_(n,i,r)}computeStyle(n,i,r){return r||""}animate(n,i,r,s,a,o=[],c){return new g0(r,s)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})(),V_=(()=>{class t{}return t.NOOP=new YR,t})();const O_="ng-enter",t9="ng-leave",n9="ng-trigger",i9=".ng-trigger",KR="ng-animating",k_=".ng-animating";function B4(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:F_(parseFloat(e[1]),e[2])}function F_(t,e){return"s"===e?1e3*t:t}function r9(t,e,n){return t.hasOwnProperty("duration")?t:function N0e(t,e,n){let r,s=0,a="";if("string"==typeof t){const o=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};r=F_(parseFloat(o[1]),o[2]);const c=o[3];null!=c&&(s=F_(parseFloat(c),o[4]));const l=o[5];l&&(a=l)}else r=t;if(!n){let o=!1,c=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),o=!0),s<0&&(e.push("Delay values below 0 are not allowed for this animation step."),o=!0),o&&e.splice(c,0,`The provided timing value "${t}" is invalid.`)}return{duration:r,delay:s,easing:a}}(t,e,n)}function Qc(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function yo(t,e,n={}){if(e)for(let i in t)n[i]=t[i];else Qc(t,n);return n}function eH(t,e,n){return n?e+":"+n+";":""}function tH(t){let e="";for(let n=0;n<t.style.length;n++){const i=t.style.item(n);e+=eH(0,i,t.style.getPropertyValue(i))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=eH(0,I0e(n),t.style[n]));t.setAttribute("style",e)}function ps(t,e,n){t.style&&(Object.keys(e).forEach(i=>{const r=U_(i);n&&!n.hasOwnProperty(i)&&(n[i]=t.style[r]),t.style[r]=e[i]}),A_()&&tH(t))}function U4(t,e){t.style&&(Object.keys(e).forEach(n=>{const i=U_(n);t.style[i]=""}),A_()&&tH(t))}function Y8(t){return Array.isArray(t)?1==t.length?t[0]:Tz(t):t}const B_=new RegExp("{{\\s*(.+?)\\s*}}","g");function nH(t){let e=[];if("string"==typeof t){let n;for(;n=B_.exec(t);)e.push(n[1]);B_.lastIndex=0}return e}function s9(t,e,n){const i=t.toString(),r=i.replace(B_,(s,a)=>{let o=e[a];return e.hasOwnProperty(a)||(n.push(`Please provide a value for the animation param ${a}`),o=""),o.toString()});return r==i?t:r}function a9(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const H0e=/-+([a-z0-9])/g;function U_(t){return t.replace(H0e,(...e)=>e[1].toUpperCase())}function I0e(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function iH(t,e){return 0===t||0===e}function rH(t,e,n){const i=Object.keys(n);if(i.length&&e.length){let s=e[0],a=[];if(i.forEach(o=>{s.hasOwnProperty(o)||a.push(o),s[o]=n[o]}),a.length)for(var r=1;r<e.length;r++){let o=e[r];a.forEach(function(c){o[c]=G_(t,c)})}}return e}function P2(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function G_(t,e){return window.getComputedStyle(t)[e]}function V0e(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function O0e(t,e,n){if(":"==t[0]){const c=function k0e(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,i)=>parseFloat(i)>parseFloat(n);case":decrement":return(n,i)=>parseFloat(i)<parseFloat(n);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof c)return void e.push(c);t=c}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const r=i[1],s=i[2],a=i[3];e.push(sH(r,a));"<"==s[0]&&!("*"==r&&"*"==a)&&e.push(sH(a,r))}(i,n,e)):n.push(t),n}const c9=new Set(["true","1"]),l9=new Set(["false","0"]);function sH(t,e){const n=c9.has(t)||l9.has(t),i=c9.has(e)||l9.has(e);return(r,s)=>{let a="*"==t||t==r,o="*"==e||e==s;return!a&&n&&"boolean"==typeof r&&(a=r?c9.has(t):l9.has(t)),!o&&i&&"boolean"==typeof s&&(o=s?c9.has(e):l9.has(e)),a&&o}}const F0e=new RegExp("s*:selfs*,?","g");function W_(t,e,n){return new B0e(t).build(e,n)}class B0e{constructor(e){this._driver=e}build(e,n){const i=new W0e(n);return this._resetContextStyleTimingState(i),P2(this,Y8(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,n){let i=n.queryCount=0,r=n.depCount=0;const s=[],a=[];return"@"==e.name.charAt(0)&&n.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(o=>{if(this._resetContextStyleTimingState(n),0==o.type){const c=o,l=c.name;l.toString().split(/\s*,\s*/).forEach(u=>{c.name=u,s.push(this.visitState(c,n))}),c.name=l}else if(1==o.type){const c=this.visitTransition(o,n);i+=c.queryCount,r+=c.depCount,a.push(c)}else n.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:s,transitions:a,queryCount:i,depCount:r,options:null}}visitState(e,n){const i=this.visitStyle(e.styles,n),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,a=r||{};if(i.styles.forEach(o=>{if(h9(o)){const c=o;Object.keys(c).forEach(l=>{nH(c[l]).forEach(u=>{a.hasOwnProperty(u)||s.add(u)})})}}),s.size){const o=a9(s.values());n.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${o.join(", ")}`)}}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,n){n.queryCount=0,n.depCount=0;const i=P2(this,Y8(e.animation),n);return{type:1,matchers:V0e(e.expr,n.errors),animation:i,queryCount:n.queryCount,depCount:n.depCount,options:G4(e.options)}}visitSequence(e,n){return{type:2,steps:e.steps.map(i=>P2(this,i,n)),options:G4(e.options)}}visitGroup(e,n){const i=n.currentTime;let r=0;const s=e.steps.map(a=>{n.currentTime=i;const o=P2(this,a,n);return r=Math.max(r,n.currentTime),o});return n.currentTime=r,{type:3,steps:s,options:G4(e.options)}}visitAnimate(e,n){const i=function q0e(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return j_(r9(t,e).duration,0,"");const i=t;if(i.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=j_(0,0,"");return s.dynamic=!0,s.strValue=i,s}return n=n||r9(i,e),j_(n.duration,n.delay,n.easing)}(e.timings,n.errors);n.currentAnimateTimings=i;let r,s=e.styles?e.styles:Na({});if(5==s.type)r=this.visitKeyframes(s,n);else{let a=e.styles,o=!1;if(!a){o=!0;const l={};i.easing&&(l.easing=i.easing),a=Na(l)}n.currentTime+=i.duration+i.delay;const c=this.visitStyle(a,n);c.isEmptyStep=o,r=c}return n.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,n){const i=this._makeStyleAst(e,n);return this._validateStyleAst(i,n),i}_makeStyleAst(e,n){const i=[];Array.isArray(e.styles)?e.styles.forEach(a=>{"string"==typeof a?a==Os?i.push(a):n.errors.push(`The provided style string value ${a} is not allowed.`):i.push(a)}):i.push(e.styles);let r=!1,s=null;return i.forEach(a=>{if(h9(a)){const o=a,c=o.easing;if(c&&(s=c,delete o.easing),!r)for(let l in o)if(o[l].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:s,offset:e.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(e,n){const i=n.currentAnimateTimings;let r=n.currentTime,s=n.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(a=>{"string"!=typeof a&&Object.keys(a).forEach(o=>{if(!this._driver.validateStyleProperty(o))return void n.errors.push(`The provided animation property "${o}" is not a supported CSS property for animations`);const c=n.collectedStyles[n.currentQuerySelector],l=c[o];let u=!0;l&&(s!=r&&s>=l.startTime&&r<=l.endTime&&(n.errors.push(`The CSS property "${o}" that exists between the times of "${l.startTime}ms" and "${l.endTime}ms" is also being animated in a parallel animation between the times of "${s}ms" and "${r}ms"`),u=!1),s=l.startTime),u&&(c[o]={startTime:s,endTime:r}),n.options&&function R0e(t,e,n){const i=e.params||{},r=nH(t);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||n.push(`Unable to resolve the local animation param ${s} in the given list of values`)})}(a[o],n.options,n.errors)})})}visitKeyframes(e,n){const i={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push("keyframes() must be placed inside of a call to animate()"),i;let s=0;const a=[];let o=!1,c=!1,l=0;const u=e.steps.map(y=>{const g=this._makeStyleAst(y,n);let S=null!=g.offset?g.offset:function j0e(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(n=>{if(h9(n)&&n.hasOwnProperty("offset")){const i=n;e=parseFloat(i.offset),delete i.offset}});else if(h9(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(g.styles),b=0;return null!=S&&(s++,b=g.offset=S),c=c||b<0||b>1,o=o||b<l,l=b,a.push(b),g});c&&n.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&n.errors.push("Please ensure that all keyframe offsets are in order");const f=e.steps.length;let d=0;s>0&&s<f?n.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==s&&(d=1/(f-1));const m=f-1,v=n.currentTime,_=n.currentAnimateTimings,M=_.duration;return u.forEach((y,g)=>{const S=d>0?g==m?1:d*g:a[g],b=S*M;n.currentTime=v+_.delay+b,_.duration=b,this._validateStyleAst(y,n),y.offset=S,i.styles.push(y)}),i}visitReference(e,n){return{type:8,animation:P2(this,Y8(e.animation),n),options:G4(e.options)}}visitAnimateChild(e,n){return n.depCount++,{type:9,options:G4(e.options)}}visitAnimateRef(e,n){return{type:10,animation:this.visitReference(e.animation,n),options:G4(e.options)}}visitQuery(e,n){const i=n.currentQuerySelector,r=e.options||{};n.queryCount++,n.currentQuery=e;const[s,a]=function U0e(t){const e=!!t.split(/\s*,\s*/).find(n=>":self"==n);return e&&(t=t.replace(F0e,"")),t=t.replace(/@\*/g,i9).replace(/@\w+/g,n=>i9+"-"+n.substr(1)).replace(/:animating/g,k_),[t,e]}(e.selector);n.currentQuerySelector=i.length?i+" "+s:s,D2(n.collectedStyles,n.currentQuerySelector,{});const o=P2(this,Y8(e.animation),n);return n.currentQuery=null,n.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:a,animation:o,originalSelector:e.selector,options:G4(e.options)}}visitStagger(e,n){n.currentQuery||n.errors.push("stagger() can only be used inside of query()");const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:r9(e.timings,n.errors,!0);return{type:12,animation:P2(this,Y8(e.animation),n),timings:i,options:null}}}class W0e{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function h9(t){return!Array.isArray(t)&&"object"==typeof t}function G4(t){return t?(t=Qc(t)).params&&(t.params=function G0e(t){return t?Qc(t):null}(t.params)):t={},t}function j_(t,e,n){return{duration:t,delay:e,easing:n}}function q_(t,e,n,i,r,s,a=null,o=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:a,subTimeline:o}}class u9{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,n){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...n)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const X0e=new RegExp(":enter","g"),J0e=new RegExp(":leave","g");function Z_(t,e,n,i,r,s={},a={},o,c,l=[]){return(new K0e).buildKeyframes(t,e,n,i,r,s,a,o,c,l)}class K0e{buildKeyframes(e,n,i,r,s,a,o,c,l,u=[]){l=l||new u9;const f=new $_(e,n,l,r,s,u,[]);f.options=c,f.currentTimeline.setStyles([a],null,f.errors,c),P2(this,i,f);const d=f.timelines.filter(m=>m.containsAnimation());if(Object.keys(o).length){let m;for(let v=d.length-1;v>=0;v--){const _=d[v];if(_.element===n){m=_;break}}m&&!m.allowOnlyTimelineStyles()&&m.setStyles([o],null,f.errors,c)}return d.length?d.map(m=>m.buildKeyframes()):[q_(n,[],[],[],0,0,"",!1)]}visitTrigger(e,n){}visitState(e,n){}visitTransition(e,n){}visitAnimateChild(e,n){const i=n.subInstructions.get(n.element);if(i){const r=n.createSubContext(e.options),s=n.currentTimeline.currentTime,a=this._visitSubInstructions(i,r,r.options);s!=a&&n.transformIntoNewTimeline(a)}n.previousNode=e}visitAnimateRef(e,n){const i=n.createSubContext(e.options);i.transformIntoNewTimeline(),this.visitReference(e.animation,i),n.transformIntoNewTimeline(i.currentTimeline.currentTime),n.previousNode=e}_visitSubInstructions(e,n,i){let s=n.currentTimeline.currentTime;const a=null!=i.duration?B4(i.duration):null,o=null!=i.delay?B4(i.delay):null;return 0!==a&&e.forEach(c=>{const l=n.appendInstructionToTimeline(c,a,o);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,n){n.updateOptions(e.options,!0),P2(this,e.animation,n),n.previousNode=e}visitSequence(e,n){const i=n.subContextCount;let r=n;const s=e.options;if(s&&(s.params||s.delay)&&(r=n.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=f9);const a=B4(s.delay);r.delayNextStep(a)}e.steps.length&&(e.steps.forEach(a=>P2(this,a,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),n.previousNode=e}visitGroup(e,n){const i=[];let r=n.currentTimeline.currentTime;const s=e.options&&e.options.delay?B4(e.options.delay):0;e.steps.forEach(a=>{const o=n.createSubContext(e.options);s&&o.delayNextStep(s),P2(this,a,o),r=Math.max(r,o.currentTimeline.currentTime),i.push(o.currentTimeline)}),i.forEach(a=>n.currentTimeline.mergeTimelineCollectedStyles(a)),n.transformIntoNewTimeline(r),n.previousNode=e}_visitTiming(e,n){if(e.dynamic){const i=e.strValue;return r9(n.params?s9(i,n.params,n.errors):i,n.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,n){const i=n.currentAnimateTimings=this._visitTiming(e.timings,n),r=n.currentTimeline;i.delay&&(n.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,n):(n.incrementTime(i.duration),this.visitStyle(s,n),r.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=e}visitStyle(e,n){const i=n.currentTimeline,r=n.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,n.errors,n.options),n.previousNode=e}visitKeyframes(e,n){const i=n.currentAnimateTimings,r=n.currentTimeline.duration,s=i.duration,o=n.createSubContext().currentTimeline;o.easing=i.easing,e.styles.forEach(c=>{o.forwardTime((c.offset||0)*s),o.setStyles(c.styles,c.easing,n.errors,n.options),o.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(o),n.transformIntoNewTimeline(r+s),n.previousNode=e}visitQuery(e,n){const i=n.currentTimeline.currentTime,r=e.options||{},s=r.delay?B4(r.delay):0;s&&(6===n.previousNode.type||0==i&&n.currentTimeline.getCurrentStyleProperties().length)&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=f9);let a=i;const o=n.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,n.errors);n.currentQueryTotal=o.length;let c=null;o.forEach((l,u)=>{n.currentQueryIndex=u;const f=n.createSubContext(e.options,l);s&&f.delayNextStep(s),l===n.element&&(c=f.currentTimeline),P2(this,e.animation,f),f.currentTimeline.applyStylesToKeyframe(),a=Math.max(a,f.currentTimeline.currentTime)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(a),c&&(n.currentTimeline.mergeTimelineCollectedStyles(c),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=e}visitStagger(e,n){const i=n.parentContext,r=n.currentTimeline,s=e.timings,a=Math.abs(s.duration),o=a*(n.currentQueryTotal-1);let c=a*n.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=o-c;break;case"full":c=i.currentStaggerTime}const u=n.currentTimeline;c&&u.delayNextStep(c);const f=u.currentTime;P2(this,e.animation,n),n.previousNode=e,i.currentStaggerTime=r.currentTime-f+(r.startTime-i.currentTimeline.startTime)}}const f9={};class $_{constructor(e,n,i,r,s,a,o,c){this._driver=e,this.element=n,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=a,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=f9,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new d9(this._driver,n,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,n){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=B4(i.duration)),null!=i.delay&&(r.delay=B4(i.delay));const s=i.params;if(s){let a=r.params;a||(a=this.options.params={}),Object.keys(s).forEach(o=>{(!n||!a.hasOwnProperty(o))&&(a[o]=s9(s[o],a,this.errors))})}}_copyOptions(){const e={};if(this.options){const n=this.options.params;if(n){const i=e.params={};Object.keys(n).forEach(r=>{i[r]=n[r]})}}return e}createSubContext(e=null,n,i){const r=n||this.element,s=new $_(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=f9,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,n,i){const r={duration:null!=n?n:e.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+e.delay,easing:""},s=new Q0e(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,n,i,r,s,a){let o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(X0e,"."+this._enterClassName)).replace(J0e,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=i);0!==i&&(l=i<0?l.slice(l.length+i,l.length):l.slice(0,i)),o.push(...l)}return!s&&0==o.length&&a.push(`\`query("${n}")\` returned zero elements. (Use \`query("${n}", { optional: true })\` if you wish to allow this.)`),o}}class d9{constructor(e,n,i,r){this._driver=e,this.element=n,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const n=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||n?(this.forwardTime(this.currentTime+e),n&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,n){return this.applyStylesToKeyframe(),new d9(this._driver,e,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,n){this._localTimelineStyles[e]=n,this._globalTimelineStyles[e]=n,this._styleSummary[e]={time:this.currentTime,value:n}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(n=>{this._backFill[n]=this._globalTimelineStyles[n]||Os,this._currentKeyframe[n]=Os}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,n,i,r){n&&(this._previousKeyframe.easing=n);const s=r&&r.params||{},a=function ece(t,e){const n={};let i;return t.forEach(r=>{"*"===r?(i=i||Object.keys(e),i.forEach(s=>{n[s]=Os})):yo(r,!1,n)}),n}(e,this._globalTimelineStyles);Object.keys(a).forEach(o=>{const c=s9(a[o],s,i);this._pendingStyles[o]=c,this._localTimelineStyles.hasOwnProperty(o)||(this._backFill[o]=this._globalTimelineStyles.hasOwnProperty(o)?this._globalTimelineStyles[o]:Os),this._updateStyle(o,c)})}applyStylesToKeyframe(){const e=this._pendingStyles,n=Object.keys(e);0!=n.length&&(this._pendingStyles={},n.forEach(i=>{this._currentKeyframe[i]=e[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const n=this._localTimelineStyles[e];this._pendingStyles[e]=n,this._updateStyle(e,n)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let n in this._currentKeyframe)e.push(n);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(n=>{const i=this._styleSummary[n],r=e._styleSummary[n];(!i||r.time>i.time)&&this._updateStyle(n,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,n=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((o,c)=>{const l=yo(o,!0);Object.keys(l).forEach(u=>{const f=l[u];"!"==f?e.add(u):f==Os&&n.add(u)}),i||(l.offset=c/this.duration),r.push(l)});const s=e.size?a9(e.values()):[],a=n.size?a9(n.values()):[];if(i){const o=r[0],c=Qc(o);o.offset=0,c.offset=1,r=[o,c]}return q_(this.element,r,s,a,this.duration,this.startTime,this.easing,!1)}}class Q0e extends d9{constructor(e,n,i,r,s,a,o=!1){super(e,n,a.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=o,this.timings={duration:a.duration,delay:a.delay,easing:a.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:n,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&n){const s=[],a=i+n,o=n/a,c=yo(e[0],!1);c.offset=0,s.push(c);const l=yo(e[0],!1);l.offset=cH(o),s.push(l);const u=e.length-1;for(let f=1;f<=u;f++){let d=yo(e[f],!1);d.offset=cH((n+d.offset*i)/a),s.push(d)}i=a,n=0,r="",e=s}return q_(this.element,e,this.preStyleProps,this.postStyleProps,i,n,r,!0)}}function cH(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class X_{}class tce extends X_{normalizePropertyName(e,n){return U_(e)}normalizeStyleValue(e,n,i,r){let s="";const a=i.toString().trim();if(nce[n]&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const o=i.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push(`Please provide a CSS unit value for ${e}:${i}`)}return a+s}}const nce=(()=>function ice(t){const e={};return t.forEach(n=>e[n]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function lH(t,e,n,i,r,s,a,o,c,l,u,f,d){return{type:0,element:t,triggerName:e,isRemovalTransition:r,fromState:n,fromStyles:s,toState:i,toStyles:a,timelines:o,queriedElements:c,preStyleProps:l,postStyleProps:u,totalTime:f,errors:d}}const Y_={};class hH{constructor(e,n,i){this._triggerName=e,this.ast=n,this._stateStyles=i}match(e,n,i,r){return function rce(t,e,n,i,r){return t.some(s=>s(e,n,i,r))}(this.ast.matchers,e,n,i,r)}buildStyles(e,n,i){const r=this._stateStyles["*"],s=this._stateStyles[e],a=r?r.buildStyles(n,i):{};return s?s.buildStyles(n,i):a}build(e,n,i,r,s,a,o,c,l,u){const f=[],d=this.ast.options&&this.ast.options.params||Y_,v=this.buildStyles(i,o&&o.params||Y_,f),_=c&&c.params||Y_,M=this.buildStyles(r,_,f),y=new Set,g=new Map,S=new Map,b="void"===r,E={params:Object.assign(Object.assign({},d),_)},P=u?[]:Z_(e,n,this.ast.animation,s,a,v,M,E,l,f);let V=0;if(P.forEach(Y=>{V=Math.max(Y.duration+Y.delay,V)}),f.length)return lH(n,this._triggerName,i,r,b,v,M,[],[],g,S,V,f);P.forEach(Y=>{const G=Y.element,C=D2(g,G,{});Y.preStyleProps.forEach(F=>C[F]=!0);const N=D2(S,G,{});Y.postStyleProps.forEach(F=>N[F]=!0),G!==n&&y.add(G)});const j=a9(y.values());return lH(n,this._triggerName,i,r,b,v,M,P,j,g,S,V)}}class sce{constructor(e,n,i){this.styles=e,this.defaultParams=n,this.normalizer=i}buildStyles(e,n){const i={},r=Qc(this.defaultParams);return Object.keys(e).forEach(s=>{const a=e[s];null!=a&&(r[s]=a)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const a=s;Object.keys(a).forEach(o=>{let c=a[o];c.length>1&&(c=s9(c,r,n));const l=this.normalizer.normalizePropertyName(o,n);c=this.normalizer.normalizeStyleValue(o,l,c,n),i[l]=c})}}),i}}class oce{constructor(e,n,i){this.name=e,this.ast=n,this._normalizer=i,this.transitionFactories=[],this.states={},n.states.forEach(r=>{this.states[r.name]=new sce(r.style,r.options&&r.options.params||{},i)}),uH(this.states,"true","1"),uH(this.states,"false","0"),n.transitions.forEach(r=>{this.transitionFactories.push(new hH(e,r,this.states))}),this.fallbackTransition=function cce(t,e,n){return new hH(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(a,o)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,n,i,r){return this.transitionFactories.find(a=>a.match(e,n,i,r))||null}matchStyles(e,n,i){return this.fallbackTransition.buildStyles(e,n,i)}}function uH(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const lce=new u9;class hce{constructor(e,n,i){this.bodyNode=e,this._driver=n,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(e,n){const i=[],r=W_(this._driver,n,i);if(i.length)throw new Error(`Unable to build the animation due to the following errors: ${i.join("\n")}`);this._animations[e]=r}_buildPlayer(e,n,i){const r=e.element,s=jR(0,this._normalizer,0,e.keyframes,n,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,n,i={}){const r=[],s=this._animations[e];let a;const o=new Map;if(s?(a=Z_(this._driver,n,s,O_,t9,{},{},i,lce,r),a.forEach(u=>{const f=D2(o,u.element,{});u.postStyleProps.forEach(d=>f[d]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),a=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);o.forEach((u,f)=>{Object.keys(u).forEach(d=>{u[d]=this._driver.computeStyle(f,d,Os)})});const l=vo(a.map(u=>{const f=o.get(u.element);return this._buildPlayer(u,{},f)}));return this._playersById[e]=l,l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const n=this._getPlayer(e);n.destroy(),delete this._playersById[e];const i=this.players.indexOf(n);i>=0&&this.players.splice(i,1)}_getPlayer(e){const n=this._playersById[e];if(!n)throw new Error(`Unable to find the timeline player referenced by ${e}`);return n}listen(e,n,i,r){const s=P_(n,"","","");return L_(this._getPlayer(e),i,s,r),()=>{}}command(e,n,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,n,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const fH="ng-animate-queued",J_="ng-animate-disabled",mce=[],dH={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},gce={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},er="__ng_removed";class K_{constructor(e,n=""){this.namespaceId=n;const i=e&&e.hasOwnProperty("value");if(this.value=function xce(t){return null!=t?t:null}(i?e.value:e),i){const s=Qc(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const n=e.params;if(n){const i=this.options.params;Object.keys(n).forEach(r=>{null==i[r]&&(i[r]=n[r])})}}}const J8="void",Q_=new K_(J8);class vce{constructor(e,n,i){this.id=e,this.hostElement=n,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,tr(n,this._hostClassName)}listen(e,n,i,r){if(!this._triggers.hasOwnProperty(n))throw new Error(`Unable to listen on the animation trigger event "${i}" because the animation trigger "${n}" doesn't exist!`);if(null==i||0==i.length)throw new Error(`Unable to listen on the animation trigger "${n}" because the provided event is undefined!`);if(!function Mce(t){return"start"==t||"done"==t}(i))throw new Error(`The provided animation trigger event "${i}" for the animation trigger "${n}" is not supported!`);const s=D2(this._elementListeners,e,[]),a={name:n,phase:i,callback:r};s.push(a);const o=D2(this._engine.statesByElement,e,{});return o.hasOwnProperty(n)||(tr(e,n9),tr(e,n9+"-"+n),o[n]=Q_),()=>{this._engine.afterFlush(()=>{const c=s.indexOf(a);c>=0&&s.splice(c,1),this._triggers[n]||delete o[n]})}}register(e,n){return!this._triggers[e]&&(this._triggers[e]=n,!0)}_getTrigger(e){const n=this._triggers[e];if(!n)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return n}trigger(e,n,i,r=!0){const s=this._getTrigger(n),a=new ex(this.id,n,e);let o=this._engine.statesByElement.get(e);o||(tr(e,n9),tr(e,n9+"-"+n),this._engine.statesByElement.set(e,o={}));let c=o[n];const l=new K_(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),o[n]=l,c||(c=Q_),l.value!==J8&&c.value===l.value){if(!function Sce(t,e){const n=Object.keys(t),i=Object.keys(e);if(n.length!=i.length)return!1;for(let r=0;r<n.length;r++){const s=n[r];if(!e.hasOwnProperty(s)||t[s]!==e[s])return!1}return!0}(c.params,l.params)){const _=[],M=s.matchStyles(c.value,c.params,_),y=s.matchStyles(l.value,l.params,_);_.length?this._engine.reportError(_):this._engine.afterFlush(()=>{U4(e,M),ps(e,y)})}return}const d=D2(this._engine.playersByElement,e,[]);d.forEach(_=>{_.namespaceId==this.id&&_.triggerName==n&&_.queued&&_.destroy()});let m=s.matchTransition(c.value,l.value,e,l.params),v=!1;if(!m){if(!r)return;m=s.fallbackTransition,v=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:n,transition:m,fromState:c,toState:l,player:a,isFallbackTransition:v}),v||(tr(e,fH),a.onStart(()=>{e6(e,fH)})),a.onDone(()=>{let _=this.players.indexOf(a);_>=0&&this.players.splice(_,1);const M=this._engine.playersByElement.get(e);if(M){let y=M.indexOf(a);y>=0&&M.splice(y,1)}}),this.players.push(a),d.push(a),a}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((n,i)=>{delete n[e]}),this._elementListeners.forEach((n,i)=>{this._elementListeners.set(i,n.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const n=this._engine.playersByElement.get(e);n&&(n.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,n){const i=this._engine.driver.query(e,i9,!0);i.forEach(r=>{if(r[er])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(a=>a.triggerLeaveAnimation(r,n,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,n,i,r){const s=this._engine.statesByElement.get(e),a=new Map;if(s){const o=[];if(Object.keys(s).forEach(c=>{if(a.set(c,s[c].value),this._triggers[c]){const l=this.trigger(e,c,J8,r);l&&o.push(l)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,n,a),i&&vo(o).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const n=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(n&&i){const r=new Set;n.forEach(s=>{const a=s.name;if(r.has(a))return;r.add(a);const c=this._triggers[a].fallbackTransition,l=i[a]||Q_,u=new K_(J8),f=new ex(this.id,a,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:a,transition:c,fromState:l,toState:u,player:f,isFallbackTransition:!0})})}}removeNode(e,n){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,n),this.triggerLeaveAnimation(e,n,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let a=e;for(;a=a.parentNode;)if(i.statesByElement.get(a)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,n);else{const s=e[er];(!s||s===dH)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,n))}}insertNode(e,n){tr(e,this._hostClassName)}drainQueuedTransitions(e){const n=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,a=this._elementListeners.get(s);a&&a.forEach(o=>{if(o.name==i.triggerName){const c=P_(s,i.triggerName,i.fromState.value,i.toState.value);c._data=e,L_(i.player,o.phase,c,o.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):n.push(i)}),this._queue=[],n.sort((i,r)=>{const s=i.transition.ast.depCount,a=r.transition.ast.depCount;return 0==s||0==a?s-a:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let n=!1;return this._elementListeners.has(e)&&(n=!0),n=!!this._queue.find(i=>i.element===e)||n,n}}class yce{constructor(e,n,i){this.bodyNode=e,this.driver=n,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(e,n){this.onRemovalComplete(e,n)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(n=>{n.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,n){const i=new vce(e,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(i,n):(this.newHostElements.set(n,i),this.collectEnterElement(n)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,n){const i=this._namespaceList.length-1;if(i>=0){let r=!1;for(let s=i;s>=0;s--)if(this.driver.containsElement(this._namespaceList[s].hostElement,n)){this._namespaceList.splice(s+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(n,e),e}register(e,n){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,n)),i}registerTrigger(e,n,i){let r=this._namespaceLookup[e];r&&r.register(n,i)&&this.totalAnimations++}destroy(e,n){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(n))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const n=new Set,i=this.statesByElement.get(e);if(i){const r=Object.keys(i);for(let s=0;s<r.length;s++){const a=i[r[s]].namespaceId;if(a){const o=this._fetchNamespace(a);o&&n.add(o)}}}return n}trigger(e,n,i,r){if(p9(n)){const s=this._fetchNamespace(e);if(s)return s.trigger(n,i,r),!0}return!1}insertNode(e,n,i,r){if(!p9(n))return;const s=n[er];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const a=this.collectedLeaveElements.indexOf(n);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){const a=this._fetchNamespace(e);a&&a.insertNode(n,i)}r&&this.collectEnterElement(n)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,n){n?this.disabledNodes.has(e)||(this.disabledNodes.add(e),tr(e,J_)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),e6(e,J_))}removeNode(e,n,i,r){if(p9(n)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(n,r):this.markElementAsRemoved(e,n,!1,r),i){const a=this.namespacesByHostElement.get(n);a&&a.id!==e&&a.removeNode(n,r)}}else this._onRemovalComplete(n,r)}markElementAsRemoved(e,n,i,r,s){this.collectedLeaveElements.push(n),n[er]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,n,i,r,s){return p9(n)?this._fetchNamespace(e).listen(n,i,r,s):()=>{}}_buildInstruction(e,n,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,n,s)}destroyInnerAnimations(e){let n=this.driver.query(e,i9,!0);n.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,k_,!0),n.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const n=this.playersByElement.get(e);n&&n.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const n=this.playersByQueriedElement.get(e);n&&n.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return vo(this.players).onDone(()=>e());e()})}processLeaveNode(e){var n;const i=e[er];if(i&&i.setForRemoval){if(e[er]=dH,i.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,i.setForRemoval)}(null===(n=e.classList)||void 0===n?void 0:n.contains(J_))&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)tr(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{n=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],n.length?vo(n).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${e.join("\n")}`)}_flushAnimations(e,n){const i=new u9,r=[],s=new Map,a=[],o=new Map,c=new Map,l=new Map,u=new Set;this.disabledNodes.forEach(O=>{u.add(O);const I=this.driver.query(O,".ng-animate-queued",!0);for(let k=0;k<I.length;k++)u.add(I[k])});const f=this.bodyNode,d=Array.from(this.statesByElement.keys()),m=gH(d,this.collectedEnterElements),v=new Map;let _=0;m.forEach((O,I)=>{const k=O_+_++;v.set(I,k),O.forEach(K=>tr(K,k))});const M=[],y=new Set,g=new Set;for(let O=0;O<this.collectedLeaveElements.length;O++){const I=this.collectedLeaveElements[O],k=I[er];k&&k.setForRemoval&&(M.push(I),y.add(I),k.hasAnimation?this.driver.query(I,".ng-star-inserted",!0).forEach(K=>y.add(K)):g.add(I))}const S=new Map,b=gH(d,Array.from(y));b.forEach((O,I)=>{const k=t9+_++;S.set(I,k),O.forEach(K=>tr(K,k))}),e.push(()=>{m.forEach((O,I)=>{const k=v.get(I);O.forEach(K=>e6(K,k))}),b.forEach((O,I)=>{const k=S.get(I);O.forEach(K=>e6(K,k))}),M.forEach(O=>{this.processLeaveNode(O)})});const E=[],P=[];for(let O=this._namespaceList.length-1;O>=0;O--)this._namespaceList[O].drainQueuedTransitions(n).forEach(k=>{const K=k.player,re=k.element;if(E.push(K),this.collectedEnterElements.length){const st=re[er];if(st&&st.setForMove){if(st.previousTriggersValues&&st.previousTriggersValues.has(k.triggerName)){const ke=st.previousTriggersValues.get(k.triggerName),_e=this.statesByElement.get(k.element);_e&&_e[k.triggerName]&&(_e[k.triggerName].value=ke)}return void K.destroy()}}const ae=!f||!this.driver.containsElement(f,re),ue=S.get(re),Le=v.get(re),Oe=this._buildInstruction(k,i,Le,ue,ae);if(Oe.errors&&Oe.errors.length)return void P.push(Oe);if(ae)return K.onStart(()=>U4(re,Oe.fromStyles)),K.onDestroy(()=>ps(re,Oe.toStyles)),void r.push(K);if(k.isFallbackTransition)return K.onStart(()=>U4(re,Oe.fromStyles)),K.onDestroy(()=>ps(re,Oe.toStyles)),void r.push(K);const Pe=[];Oe.timelines.forEach(st=>{st.stretchStartingKeyframe=!0,this.disabledNodes.has(st.element)||Pe.push(st)}),Oe.timelines=Pe,i.append(re,Oe.timelines),a.push({instruction:Oe,player:K,element:re}),Oe.queriedElements.forEach(st=>D2(o,st,[]).push(K)),Oe.preStyleProps.forEach((st,ke)=>{const _e=Object.keys(st);if(_e.length){let oe=c.get(ke);oe||c.set(ke,oe=new Set),_e.forEach(xe=>oe.add(xe))}}),Oe.postStyleProps.forEach((st,ke)=>{const _e=Object.keys(st);let oe=l.get(ke);oe||l.set(ke,oe=new Set),_e.forEach(xe=>oe.add(xe))})});if(P.length){const O=[];P.forEach(I=>{O.push(`@${I.triggerName} has failed due to:\n`),I.errors.forEach(k=>O.push(`- ${k}\n`))}),E.forEach(I=>I.destroy()),this.reportError(O)}const V=new Map,j=new Map;a.forEach(O=>{const I=O.element;i.has(I)&&(j.set(I,I),this._beforeAnimationBuild(O.player.namespaceId,O.instruction,V))}),r.forEach(O=>{const I=O.element;this._getPreviousPlayers(I,!1,O.namespaceId,O.triggerName,null).forEach(K=>{D2(V,I,[]).push(K),K.destroy()})});const Y=M.filter(O=>yH(O,c,l)),G=new Map;mH(G,this.driver,g,l,Os).forEach(O=>{yH(O,c,l)&&Y.push(O)});const N=new Map;m.forEach((O,I)=>{mH(N,this.driver,new Set(O),c,"!")}),Y.forEach(O=>{const I=G.get(O),k=N.get(O);G.set(O,Object.assign(Object.assign({},I),k))});const F=[],U=[],$={};a.forEach(O=>{const{element:I,player:k,instruction:K}=O;if(i.has(I)){if(u.has(I))return k.onDestroy(()=>ps(I,K.toStyles)),k.disabled=!0,k.overrideTotalTime(K.totalTime),void r.push(k);let re=$;if(j.size>1){let ue=I;const Le=[];for(;ue=ue.parentNode;){const Oe=j.get(ue);if(Oe){re=Oe;break}Le.push(ue)}Le.forEach(Oe=>j.set(Oe,re))}const ae=this._buildAnimation(k.namespaceId,K,V,s,N,G);if(k.setRealPlayer(ae),re===$)F.push(k);else{const ue=this.playersByElement.get(re);ue&&ue.length&&(k.parentPlayer=vo(ue)),r.push(k)}}else U4(I,K.fromStyles),k.onDestroy(()=>ps(I,K.toStyles)),U.push(k),u.has(I)&&r.push(k)}),U.forEach(O=>{const I=s.get(O.element);if(I&&I.length){const k=vo(I);O.setRealPlayer(k)}}),r.forEach(O=>{O.parentPlayer?O.syncPlayerEvents(O.parentPlayer):O.destroy()});for(let O=0;O<M.length;O++){const I=M[O],k=I[er];if(e6(I,t9),k&&k.hasAnimation)continue;let K=[];if(o.size){let ae=o.get(I);ae&&ae.length&&K.push(...ae);let ue=this.driver.query(I,k_,!0);for(let Le=0;Le<ue.length;Le++){let Oe=o.get(ue[Le]);Oe&&Oe.length&&K.push(...Oe)}}const re=K.filter(ae=>!ae.destroyed);re.length?bce(this,I,re):this.processLeaveNode(I)}return M.length=0,F.forEach(O=>{this.players.push(O),O.onDone(()=>{O.destroy();const I=this.players.indexOf(O);this.players.splice(I,1)}),O.play()}),F}elementContainsData(e,n){let i=!1;const r=n[er];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(n)&&(i=!0),this.playersByQueriedElement.has(n)&&(i=!0),this.statesByElement.has(n)&&(i=!0),this._fetchNamespace(e).elementContainsData(n)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,n,i,r,s){let a=[];if(n){const o=this.playersByQueriedElement.get(e);o&&(a=o)}else{const o=this.playersByElement.get(e);if(o){const c=!s||s==J8;o.forEach(l=>{l.queued||!c&&l.triggerName!=r||a.push(l)})}}return(i||r)&&(a=a.filter(o=>!(i&&i!=o.namespaceId||r&&r!=o.triggerName))),a}_beforeAnimationBuild(e,n,i){const s=n.element,a=n.isRemovalTransition?void 0:e,o=n.isRemovalTransition?void 0:n.triggerName;for(const c of n.timelines){const l=c.element,u=l!==s,f=D2(i,l,[]);this._getPreviousPlayers(l,u,a,o,n.toState).forEach(m=>{const v=m.getRealPlayer();v.beforeDestroy&&v.beforeDestroy(),m.destroy(),f.push(m)})}U4(s,n.fromStyles)}_buildAnimation(e,n,i,r,s,a){const o=n.triggerName,c=n.element,l=[],u=new Set,f=new Set,d=n.timelines.map(v=>{const _=v.element;u.add(_);const M=_[er];if(M&&M.removedBeforeQueried)return new g0(v.duration,v.delay);const y=_!==c,g=function wce(t){const e=[];return vH(t,e),e}((i.get(_)||mce).map(V=>V.getRealPlayer())).filter(V=>!!V.element&&V.element===_),S=s.get(_),b=a.get(_),E=jR(0,this._normalizer,0,v.keyframes,S,b),P=this._buildPlayer(v,E,g);if(v.subTimeline&&r&&f.add(_),y){const V=new ex(e,o,_);V.setRealPlayer(P),l.push(V)}return P});l.forEach(v=>{D2(this.playersByQueriedElement,v.element,[]).push(v),v.onDone(()=>function _ce(t,e,n){let i;if(t instanceof Map){if(i=t.get(e),i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&t.delete(e)}}else if(i=t[e],i){if(i.length){const r=i.indexOf(n);i.splice(r,1)}0==i.length&&delete t[e]}return i}(this.playersByQueriedElement,v.element,v))}),u.forEach(v=>tr(v,KR));const m=vo(d);return m.onDestroy(()=>{u.forEach(v=>e6(v,KR)),ps(c,n.toStyles)}),f.forEach(v=>{D2(r,v,[]).push(m)}),m}_buildPlayer(e,n,i){return n.length>0?this.driver.animate(e.element,n,e.duration,e.delay,e.easing,i):new g0(e.duration,e.delay)}}class ex{constructor(e,n,i){this.namespaceId=e,this.triggerName=n,this.element=i,this._player=new g0,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(n=>{this._queuedCallbacks[n].forEach(i=>L_(e,n,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const n=this._player;n.triggerCallback&&e.onStart(()=>n.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,n){D2(this._queuedCallbacks,e,[]).push(n)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const n=this._player;n.triggerCallback&&n.triggerCallback(e)}}function p9(t){return t&&1===t.nodeType}function pH(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function mH(t,e,n,i,r){const s=[];n.forEach(c=>s.push(pH(c)));const a=[];i.forEach((c,l)=>{const u={};c.forEach(f=>{const d=u[f]=e.computeStyle(l,f,r);(!d||0==d.length)&&(l[er]=gce,a.push(l))}),t.set(l,u)});let o=0;return n.forEach(c=>pH(c,s[o++])),a}function gH(t,e){const n=new Map;if(t.forEach(o=>n.set(o,[])),0==e.length)return n;const r=new Set(e),s=new Map;function a(o){if(!o)return 1;let c=s.get(o);if(c)return c;const l=o.parentNode;return c=n.has(l)?l:r.has(l)?1:a(l),s.set(o,c),c}return e.forEach(o=>{const c=a(o);1!==c&&n.get(c).push(o)}),n}function tr(t,e){var n;null===(n=t.classList)||void 0===n||n.add(e)}function e6(t,e){var n;null===(n=t.classList)||void 0===n||n.remove(e)}function bce(t,e,n){vo(n).onDone(()=>t.processLeaveNode(e))}function vH(t,e){for(let n=0;n<t.length;n++){const i=t[n];i instanceof Lz?vH(i.players,e):e.push(i)}}function yH(t,e,n){const i=n.get(t);if(!i)return!1;let r=e.get(t);return r?i.forEach(s=>r.add(s)):e.set(t,i),n.delete(t),!0}class m9{constructor(e,n,i){this.bodyNode=e,this._driver=n,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new yce(e,n,i),this._timelineEngine=new hce(e,n,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,n,i,r,s){const a=e+"-"+r;let o=this._triggerCache[a];if(!o){const c=[],l=W_(this._driver,s,c);if(c.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${c.join("\n - ")}`);o=function ace(t,e,n){return new oce(t,e,n)}(r,l,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(n,r,o)}register(e,n){this._transitionEngine.register(e,n)}destroy(e,n){this._transitionEngine.destroy(e,n)}onInsert(e,n,i,r){this._transitionEngine.insertNode(e,n,i,r)}onRemove(e,n,i,r){this._transitionEngine.removeNode(e,n,r||!1,i)}disableAnimations(e,n){this._transitionEngine.markElementAsDisabled(e,n)}process(e,n,i,r){if("@"==i.charAt(0)){const[s,a]=qR(i);this._timelineEngine.command(s,n,a,r)}else this._transitionEngine.trigger(e,n,i,r)}listen(e,n,i,r,s){if("@"==i.charAt(0)){const[a,o]=qR(i);return this._timelineEngine.listen(a,n,o,s)}return this._transitionEngine.listen(e,n,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function _H(t,e){let n=null,i=null;return Array.isArray(e)&&e.length?(n=tx(e[0]),e.length>1&&(i=tx(e[e.length-1]))):e&&(n=tx(e)),n||i?new Cce(t,n,i):null}let Cce=(()=>{class t{constructor(n,i,r){this._element=n,this._startStyles=i,this._endStyles=r,this._state=0;let s=t.initialStylesByElement.get(n);s||t.initialStylesByElement.set(n,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&ps(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ps(this._element,this._initialStyles),this._endStyles&&(ps(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(U4(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(U4(this._element,this._endStyles),this._endStyles=null),ps(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function tx(t){let e=null;const n=Object.keys(t);for(let i=0;i<n.length;i++){const r=n[i];Ece(r)&&(e=e||{},e[r]=t[r])}return e}function Ece(t){return"display"===t||"position"===t}const xH="animation",MH="animationend";class Ace{constructor(e,n,i,r,s,a,o){this._element=e,this._name=n,this._duration=i,this._delay=r,this._easing=s,this._fillMode=a,this._onDoneFn=o,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=c=>this._handleCallback(c)}apply(){(function Lce(t,e){const n=ix(t,"").trim();let i=0;n.length&&(i=function Pce(t,e){let n=0;for(let i=0;i<t.length;i++)t.charAt(i)===e&&n++;return n}(n,",")+1,e=`${n}, ${e}`),g9(t,"",e)})(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),SH(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){bH(this._element,this._name,"paused")}resume(){bH(this._element,this._name,"running")}setPosition(e){const n=wH(this._element,this._name);this._position=e*this._duration,g9(this._element,"Delay",`-${this._position}ms`,n)}getPosition(){return this._position}_handleCallback(e){const n=e._ngTestManualTimestamp||Date.now(),i=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(n-this._startTime,0)>=this._delay&&i>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),SH(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function Dce(t,e){const i=ix(t,"").split(","),r=nx(i,e);r>=0&&(i.splice(r,1),g9(t,"",i.join(",")))}(this._element,this._name))}}function bH(t,e,n){g9(t,"PlayState",n,wH(t,e))}function wH(t,e){const n=ix(t,"");return n.indexOf(",")>0?nx(n.split(","),e):nx([n],e)}function nx(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function SH(t,e,n){n?t.removeEventListener(MH,e):t.addEventListener(MH,e)}function g9(t,e,n,i){const r=xH+e;if(null!=i){const s=t.style[r];if(s.length){const a=s.split(",");a[i]=n,n=a.join(",")}}t.style[r]=n}function ix(t,e){return t.style[xH+e]||""}class CH{constructor(e,n,i,r,s,a,o,c){this.element=e,this.keyframes=n,this.animationName=i,this._duration=r,this._delay=s,this._finalStyles=o,this._specialStyles=c,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=a||"linear",this.totalTime=r+s,this._buildStyler()}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}destroy(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(e=>e()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}finish(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(e){this._styler.setPosition(e)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new Ace(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(e){const n="start"==e?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}beforeDestroy(){this.init();const e={};if(this.hasStarted()){const n=this._state>=3;Object.keys(this._finalStyles).forEach(i=>{"offset"!=i&&(e[i]=n?this._finalStyles[i]:G_(this.element,i))})}this.currentSnapshot=e}}class Hce extends g0{constructor(e,n){super(),this.element=e,this._startingStyles={},this.__initialized=!1,this._styles=XR(n)}init(){this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(e=>{this._startingStyles[e]=this.element.style[e]}),super.init())}play(){!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(e=>this.element.style.setProperty(e,this._styles[e])),super.play())}destroy(){!this._startingStyles||(Object.keys(this._startingStyles).forEach(e=>{const n=this._startingStyles[e];n?this.element.style.setProperty(e,n):this.element.style.removeProperty(e)}),this._startingStyles=null,super.destroy())}}class zH{constructor(){this._count=0}validateStyleProperty(e){return R_(e)}matchesElement(e,n){return!1}containsElement(e,n){return H_(e,n)}query(e,n,i){return I_(e,n,i)}computeStyle(e,n,i){return window.getComputedStyle(e)[n]}buildKeyframeElement(e,n,i){i=i.map(o=>XR(o));let r=`@keyframes ${n} {\n`,s="";i.forEach(o=>{s=" ";const c=parseFloat(o.offset);r+=`${s}${100*c}% {\n`,s+=" ",Object.keys(o).forEach(l=>{const u=o[l];switch(l){case"offset":return;case"easing":return void(u&&(r+=`${s}animation-timing-function: ${u};\n`));default:return void(r+=`${s}${l}: ${u};\n`)}}),r+=`${s}}\n`}),r+="}\n";const a=document.createElement("style");return a.textContent=r,a}animate(e,n,i,r,s,a=[],o){const c=a.filter(M=>M instanceof CH),l={};iH(i,r)&&c.forEach(M=>{let y=M.currentSnapshot;Object.keys(y).forEach(g=>l[g]=y[g])});const u=function Oce(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(i=>{Object.keys(i).forEach(r=>{"offset"==r||"easing"==r||(e[r]=i[r])})}),e}(n=rH(e,n,l));if(0==i)return new Hce(e,u);const f="gen_css_kf_"+this._count++,d=this.buildKeyframeElement(e,f,n);(function Vce(t){var e;const n=null===(e=t.getRootNode)||void 0===e?void 0:e.call(t);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(d);const v=_H(e,n),_=new CH(e,n,f,i,r,s,u,v);return _.onDestroy(()=>function kce(t){t.parentNode.removeChild(t)}(d)),_}}class AH{constructor(e,n,i,r){this.element=e,this.keyframes=n,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,n,i){return e.animate(n,i)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};if(this.hasStarted()){const n=this._finalKeyframe;Object.keys(n).forEach(i=>{"offset"!=i&&(e[i]=this._finished?n[i]:G_(this.element,i))})}this.currentSnapshot=e}triggerCallback(e){const n="start"==e?this._onStartFns:this._onDoneFns;n.forEach(i=>i()),n.length=0}}class Fce{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(LH().toString()),this._cssKeyframesDriver=new zH}validateStyleProperty(e){return R_(e)}matchesElement(e,n){return!1}containsElement(e,n){return H_(e,n)}query(e,n,i){return I_(e,n,i)}computeStyle(e,n,i){return window.getComputedStyle(e)[n]}overrideWebAnimationsSupport(e){this._isNativeImpl=e}animate(e,n,i,r,s,a=[],o){if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,n,i,r,s,a);const u={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(u.easing=s);const f={},d=a.filter(v=>v instanceof AH);iH(i,r)&&d.forEach(v=>{let _=v.currentSnapshot;Object.keys(_).forEach(M=>f[M]=_[M])});const m=_H(e,n=rH(e,n=n.map(v=>yo(v,!1)),f));return new AH(e,n,u,m)}}function LH(){return WR()&&Element.prototype.animate||{}}let Uce=(()=>{class t extends Pl{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:p2.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(n)?Tz(n):n;return DH(this._renderer,null,i,"register",[r]),new Gce(i,this._renderer)}}return t.\u0275fac=function(n){return new(n||t)(ot(n0),ot(xi))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();class Gce extends class N${}{constructor(e,n){super(),this._id=e,this._renderer=n}create(e,n){return new Wce(this._id,e,n||{},this._renderer)}}class Wce{constructor(e,n,i,r){this.id=e,this.element=n,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,n){return this._renderer.listen(this.element,`@@${this.id}:${e}`,n)}_command(e,...n){return DH(this._renderer,this.element,this.id,e,n)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,n;return null!==(n=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==n?n:0}}function DH(t,e,n,i,r){return t.setProperty(e,`@@${n}:${i}`,r)}const PH="@.disabled";let jce=(()=>{class t{constructor(n,i,r){this.delegate=n,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,a)=>{const o=null==a?void 0:a.parentNode(s);o&&a.removeChild(o,s)}}createRenderer(n,i){const s=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(s);return u||(u=new NH("",s,this.engine),this._rendererCache.set(s,u)),u}const a=i.id,o=i.id+"-"+this._currentId;this._currentId++,this.engine.register(o,n);const c=u=>{Array.isArray(u)?u.forEach(c):this.engine.registerTrigger(a,o,n,u.name,u)};return i.data.animation.forEach(c),new qce(this,o,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,r){n>=0&&n<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[a,o]=s;a(o)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(n){return new(n||t)(ot(n0),ot(m9),ot(Y1))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();class NH{constructor(e,n,i){this.namespaceId=e,this.delegate=n,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>n.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,n){this.delegate.appendChild(e,n),this.engine.onInsert(this.namespaceId,n,e,!1)}insertBefore(e,n,i,r=!0){this.delegate.insertBefore(e,n,i),this.engine.onInsert(this.namespaceId,n,e,r)}removeChild(e,n,i){this.engine.onRemove(this.namespaceId,n,this.delegate,i)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,i,r){this.delegate.setAttribute(e,n,i,r)}removeAttribute(e,n,i){this.delegate.removeAttribute(e,n,i)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,i,r){this.delegate.setStyle(e,n,i,r)}removeStyle(e,n,i){this.delegate.removeStyle(e,n,i)}setProperty(e,n,i){"@"==n.charAt(0)&&n==PH?this.disableAnimations(e,!!i):this.delegate.setProperty(e,n,i)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,i){return this.delegate.listen(e,n,i)}disableAnimations(e,n){this.engine.disableAnimations(e,n)}}class qce extends NH{constructor(e,n,i,r){super(n,i,r),this.factory=e,this.namespaceId=n}setProperty(e,n,i){"@"==n.charAt(0)?"."==n.charAt(1)&&n==PH?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,n.substr(1),i):this.delegate.setProperty(e,n,i)}listen(e,n,i){if("@"==n.charAt(0)){const r=function Zce(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(e);let s=n.substr(1),a="";return"@"!=s.charAt(0)&&([s,a]=function $ce(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,a,o=>{this.factory.scheduleListenerCallback(o._data||-1,i,o)})}return this.delegate.listen(e,n,i)}}let Xce=(()=>{class t extends m9{constructor(n,i,r){super(n.body,i,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(n){return new(n||t)(ot(xi),ot(V_),ot(X_))},t.\u0275prov=xt({token:t,factory:t.\u0275fac}),t})();const RH=new o1("AnimationModuleType"),HH=[{provide:Pl,useClass:Uce},{provide:X_,useFactory:function Jce(){return new tce}},{provide:m9,useClass:Xce},{provide:n0,useFactory:function Kce(t,e,n){return new jce(t,e,n)},deps:[Xh,m9,Y1]}],IH=[{provide:V_,useFactory:function Yce(){return function Bce(){return"function"==typeof LH()}()?new Fce:new zH}},{provide:RH,useValue:"BrowserAnimations"},...HH],Qce=[{provide:V_,useClass:YR},{provide:RH,useValue:"NoopAnimations"},...HH];let e6e=(()=>{class t{static withConfig(n){return{ngModule:t,providers:n.disableAnimations?Qce:IH}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=Un({type:t}),t.\u0275inj=Qn({providers:IH,imports:[dE]}),t})();var VH={prefix:"fas",iconName:"angle-left",icon:[256,512,[],"f104","M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"]},OH={prefix:"fas",iconName:"angle-right",icon:[256,512,[],"f105","M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"]},kH={prefix:"fas",iconName:"arrow-alt-circle-down",icon:[512,512,[],"f358","M504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zM212 140v116h-70.9c-10.7 0-16.1 13-8.5 20.5l114.9 114.3c4.7 4.7 12.2 4.7 16.9 0l114.9-114.3c7.6-7.6 2.2-20.5-8.5-20.5H300V140c0-6.6-5.4-12-12-12h-64c-6.6 0-12 5.4-12 12z"]},FH={prefix:"fas",iconName:"arrow-alt-circle-left",icon:[512,512,[],"f359","M256 504C119 504 8 393 8 256S119 8 256 8s248 111 248 248-111 248-248 248zm116-292H256v-70.9c0-10.7-13-16.1-20.5-8.5L121.2 247.5c-4.7 4.7-4.7 12.2 0 16.9l114.3 114.9c7.6 7.6 20.5 2.2 20.5-8.5V300h116c6.6 0 12-5.4 12-12v-64c0-6.6-5.4-12-12-12z"]},BH={prefix:"fas",iconName:"arrow-alt-circle-right",icon:[512,512,[],"f35a","M256 8c137 0 248 111 248 248S393 504 256 504 8 393 8 256 119 8 256 8zM140 300h116v70.9c0 10.7 13 16.1 20.5 8.5l114.3-114.9c4.7-4.7 4.7-12.2 0-16.9l-114.3-115c-7.6-7.6-20.5-2.2-20.5 8.5V212H140c-6.6 0-12 5.4-12 12v64c0 6.6 5.4 12 12 12z"]},UH={prefix:"fas",iconName:"arrow-alt-circle-up",icon:[512,512,[],"f35b","M8 256C8 119 119 8 256 8s248 111 248 248-111 248-248 248S8 393 8 256zm292 116V256h70.9c10.7 0 16.1-13 8.5-20.5L264.5 121.2c-4.7-4.7-12.2-4.7-16.9 0l-115 114.3c-7.6 7.6-2.2 20.5 8.5 20.5H212v116c0 6.6 5.4 12 12 12h64c6.6 0 12-5.4 12-12z"]},GH={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},WH={prefix:"fas",iconName:"directions",icon:[512,512,[],"f5eb","M502.61 233.32L278.68 9.39c-12.52-12.52-32.83-12.52-45.36 0L9.39 233.32c-12.52 12.53-12.52 32.83 0 45.36l223.93 223.93c12.52 12.53 32.83 12.53 45.36 0l223.93-223.93c12.52-12.53 12.52-32.83 0-45.36zm-100.98 12.56l-84.21 77.73c-5.12 4.73-13.43 1.1-13.43-5.88V264h-96v64c0 4.42-3.58 8-8 8h-32c-4.42 0-8-3.58-8-8v-80c0-17.67 14.33-32 32-32h112v-53.73c0-6.97 8.3-10.61 13.43-5.88l84.21 77.73c3.43 3.17 3.43 8.59 0 11.76z"]},jH={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},qH={prefix:"fas",iconName:"flag-checkered",icon:[512,512,[],"f11e","M243.2 189.9V258c26.1 5.9 49.3 15.6 73.6 22.3v-68.2c-26-5.8-49.4-15.5-73.6-22.2zm223.3-123c-34.3 15.9-76.5 31.9-117 31.9C296 98.8 251.7 64 184.3 64c-25 0-47.3 4.4-68 12 2.8-7.3 4.1-15.2 3.6-23.6C118.1 24 94.8 1.2 66.3 0 34.3-1.3 8 24.3 8 56c0 19 9.5 35.8 24 45.9V488c0 13.3 10.7 24 24 24h16c13.3 0 24-10.7 24-24v-94.4c28.3-12.1 63.6-22.1 114.4-22.1 53.6 0 97.8 34.8 165.2 34.8 48.2 0 86.7-16.3 122.5-40.9 8.7-6 13.8-15.8 13.8-26.4V95.9c.1-23.3-24.2-38.8-45.4-29zM169.6 325.5c-25.8 2.7-50 8.2-73.6 16.6v-70.5c26.2-9.3 47.5-15 73.6-17.4zM464 191c-23.6 9.8-46.3 19.5-73.6 23.9V286c24.8-3.4 51.4-11.8 73.6-26v70.5c-25.1 16.1-48.5 24.7-73.6 27.1V286c-27 3.7-47.9 1.5-73.6-5.6v67.4c-23.9-7.4-47.3-16.7-73.6-21.3V258c-19.7-4.4-40.8-6.8-73.6-3.8v-70c-22.4 3.1-44.6 10.2-73.6 20.9v-70.5c33.2-12.2 50.1-19.8 73.6-22v71.6c27-3.7 48.4-1.3 73.6 5.7v-67.4c23.7 7.4 47.2 16.7 73.6 21.3v68.4c23.7 5.3 47.6 6.9 73.6 2.7V143c27-4.8 52.3-13.6 73.6-22.5z"]},ZH={prefix:"fas",iconName:"info-circle",icon:[512,512,[],"f05a","M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"]},$H={prefix:"fas",iconName:"map-signs",icon:[512,512,[],"f277","M507.31 84.69L464 41.37c-6-6-14.14-9.37-22.63-9.37H288V16c0-8.84-7.16-16-16-16h-32c-8.84 0-16 7.16-16 16v16H56c-13.25 0-24 10.75-24 24v80c0 13.25 10.75 24 24 24h385.37c8.49 0 16.62-3.37 22.63-9.37l43.31-43.31c6.25-6.26 6.25-16.38 0-22.63zM224 496c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16V384h-64v112zm232-272H288v-32h-64v32H70.63c-8.49 0-16.62 3.37-22.63 9.37L4.69 276.69c-6.25 6.25-6.25 16.38 0 22.63L48 342.63c6 6 14.14 9.37 22.63 9.37H456c13.25 0 24-10.75 24-24v-80c0-13.25-10.75-24-24-24z"]},XH={prefix:"fas",iconName:"play-circle",icon:[512,512,[],"f144","M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm115.7 272l-176 101c-15.8 8.8-35.7-2.5-35.7-21V152c0-18.4 19.8-29.8 35.7-21l176 107c16.4 9.2 16.4 32.9 0 42z"]},YH={prefix:"fas",iconName:"sync",icon:[512,512,[],"f021","M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"]},JH={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]};let BLe=(()=>{class t{constructor(n){this.library=n,n.addIcons(JH,WH,jH,UH,BH,kH,FH,VH,OH,ZH,XH,YH,GH,qH,$H)}}return t.\u0275fac=function(n){return new(n||t)(ot($T))},t.\u0275mod=Un({type:t,bootstrap:[T0e]}),t.\u0275inj=Qn({providers:[],imports:[[dE,x0e,e6e,rJ,S0e.forRoot(),gX.forRoot(),gJ.forRoot()]]}),t})();(function pG(){CC=!1})(),Vj().bootstrapModule(BLe).catch(t=>console.error(t))},407:function(kr,I2){!function(Ve){"use strict";function u1(h){var p,x,w,A;for(x=1,w=arguments.length;x<w;x++)for(p in A=arguments[x])h[p]=A[p];return h}var oa=Object.create||function(){function h(){}return function(p){return h.prototype=p,new h}}();function f1(h,p){var x=Array.prototype.slice;if(h.bind)return h.bind.apply(h,x.call(arguments,1));var w=x.call(arguments,2);return function(){return h.apply(p,w.length?w.concat(x.call(arguments)):arguments)}}var Jn=0;function i1(h){return h._leaflet_id=h._leaflet_id||++Jn,h._leaflet_id}function t6(h,p,x){var w,A,R,Q;return Q=function(){w=!1,A&&(R.apply(x,A),A=!1)},R=function(){w?A=arguments:(h.apply(x,arguments),setTimeout(Q,p),w=!0)},R}function ca(h,p,x){var w=p[1],A=p[0],R=w-A;return h===w&&x?h:((h-A)%R+R)%R+A}function M1(){return!1}function Ai(h,p){var x=Math.pow(10,void 0===p?6:p);return Math.round(h*x)/x}function Z4(h){return h.trim?h.trim():h.replace(/^\s+|\s+$/g,"")}function nr(h){return Z4(h).split(/\s+/)}function R1(h,p){for(var x in Object.prototype.hasOwnProperty.call(h,"options")||(h.options=h.options?oa(h.options):{}),p)h.options[x]=p[x];return h.options}function Q8(h,p,x){var w=[];for(var A in h)w.push(encodeURIComponent(x?A.toUpperCase():A)+"="+encodeURIComponent(h[A]));return(p&&-1!==p.indexOf("?")?"&":"?")+w.join("&")}var y9=/\{ *([\w_-]+) *\}/g;function $4(h,p){return h.replace(y9,function(x,w){var A=p[w];if(void 0===A)throw new Error("No value provided for variable "+x);return"function"==typeof A&&(A=A(p)),A})}var kn=Array.isArray||function(h){return"[object Array]"===Object.prototype.toString.call(h)};function _o(h,p){for(var x=0;x<h.length;x++)if(h[x]===p)return x;return-1}var X4="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function xo(h){return window["webkit"+h]||window["moz"+h]||window["ms"+h]}var Y4=0;function J4(h){var p=+new Date,x=Math.max(0,16-(p-Y4));return Y4=p+x,window.setTimeout(h,x)}var K4=window.requestAnimationFrame||xo("RequestAnimationFrame")||J4,Q4=window.cancelAnimationFrame||xo("CancelAnimationFrame")||xo("CancelRequestAnimationFrame")||function(h){window.clearTimeout(h)};function Fn(h,p,x){if(!x||K4!==J4)return K4.call(window,f1(h,p));h.call(p)}function Bn(h){h&&Q4.call(window,h)}var ms={extend:u1,create:oa,bind:f1,lastId:Jn,stamp:i1,throttle:t6,wrapNum:ca,falseFn:M1,formatNum:Ai,trim:Z4,splitWords:nr,setOptions:R1,getParamString:Q8,template:$4,isArray:kn,indexOf:_o,emptyImageUrl:X4,requestFn:K4,cancelFn:Q4,requestAnimFrame:Fn,cancelAnimFrame:Bn};function Fr(){}Fr.extend=function(h){var p=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},x=p.__super__=this.prototype,w=oa(x);for(var A in w.constructor=p,p.prototype=w,this)Object.prototype.hasOwnProperty.call(this,A)&&"prototype"!==A&&"__super__"!==A&&(p[A]=this[A]);return h.statics&&(u1(p,h.statics),delete h.statics),h.includes&&(function e5(h){if("undefined"!=typeof L&&L&&L.Mixin){h=kn(h)?h:[h];for(var p=0;p<h.length;p++)h[p]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(h.includes),u1.apply(null,[w].concat(h.includes)),delete h.includes),w.options&&(h.options=u1(oa(w.options),h.options)),u1(w,h),w._initHooks=[],w.callInitHooks=function(){if(!this._initHooksCalled){x.callInitHooks&&x.callInitHooks.call(this),this._initHooksCalled=!0;for(var R=0,Q=w._initHooks.length;R<Q;R++)w._initHooks[R].call(this)}},p},Fr.include=function(h){return u1(this.prototype,h),this},Fr.mergeOptions=function(h){return u1(this.prototype.options,h),this},Fr.addInitHook=function(h){var p=Array.prototype.slice.call(arguments,1),x="function"==typeof h?h:function(){this[h].apply(this,p)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(x),this};var qt={on:function(h,p,x){if("object"==typeof h)for(var w in h)this._on(w,h[w],p);else for(var A=0,R=(h=nr(h)).length;A<R;A++)this._on(h[A],p,x);return this},off:function(h,p,x){if(h)if("object"==typeof h)for(var w in h)this._off(w,h[w],p);else for(var A=0,R=(h=nr(h)).length;A<R;A++)this._off(h[A],p,x);else delete this._events;return this},_on:function(h,p,x){this._events=this._events||{};var w=this._events[h];w||(this._events[h]=w=[]),x===this&&(x=void 0);for(var A={fn:p,ctx:x},R=w,Q=0,de=R.length;Q<de;Q++)if(R[Q].fn===p&&R[Q].ctx===x)return;R.push(A)},_off:function(h,p,x){var w,A,R;if(this._events&&(w=this._events[h])){if(!p){for(A=0,R=w.length;A<R;A++)w[A].fn=M1;return void delete this._events[h]}if(x===this&&(x=void 0),w)for(A=0,R=w.length;A<R;A++){var Q=w[A];if(Q.ctx===x&&Q.fn===p)return Q.fn=M1,this._firingCount&&(this._events[h]=w=w.slice()),void w.splice(A,1)}}},fire:function(h,p,x){if(!this.listens(h,x))return this;var w=u1({},p,{type:h,target:this,sourceTarget:p&&p.sourceTarget||this});if(this._events){var A=this._events[h];if(A){this._firingCount=this._firingCount+1||1;for(var R=0,Q=A.length;R<Q;R++){var de=A[R];de.fn.call(de.ctx||this,w)}this._firingCount--}}return x&&this._propagateEvent(w),this},listens:function(h,p){var x=this._events&&this._events[h];if(x&&x.length)return!0;if(p)for(var w in this._eventParents)if(this._eventParents[w].listens(h,p))return!0;return!1},once:function(h,p,x){if("object"==typeof h){for(var w in h)this.once(w,h[w],p);return this}var A=f1(function(){this.off(h,p,x).off(h,A,x)},this);return this.on(h,p,x).on(h,A,x)},addEventParent:function(h){return this._eventParents=this._eventParents||{},this._eventParents[i1(h)]=h,this},removeEventParent:function(h){return this._eventParents&&delete this._eventParents[i1(h)],this},_propagateEvent:function(h){for(var p in this._eventParents)this._eventParents[p].fire(h.type,u1({layer:h.target,propagatedFrom:h.target},h),!0)}};qt.addEventListener=qt.on,qt.removeEventListener=qt.clearAllEventListeners=qt.off,qt.addOneTimeEventListener=qt.once,qt.fireEvent=qt.fire,qt.hasEventListeners=qt.listens;var la=Fr.extend(qt);function At(h,p,x){this.x=x?Math.round(h):h,this.y=x?Math.round(p):p}var t5=Math.trunc||function(h){return h>0?Math.floor(h):Math.ceil(h)};function n1(h,p,x){return h instanceof At?h:kn(h)?new At(h[0],h[1]):null==h?h:"object"==typeof h&&"x"in h&&"y"in h?new At(h.x,h.y):new At(h,p,x)}function r1(h,p){if(h)for(var x=p?[h,p]:h,w=0,A=x.length;w<A;w++)this.extend(x[w])}function Wi(h,p){return!h||h instanceof r1?h:new r1(h,p)}function Kn(h,p){if(h)for(var x=p?[h,p]:h,w=0,A=x.length;w<A;w++)this.extend(x[w])}function Yt(h,p){return h instanceof Kn?h:new Kn(h,p)}function Dt(h,p,x){if(isNaN(h)||isNaN(p))throw new Error("Invalid LatLng object: ("+h+", "+p+")");this.lat=+h,this.lng=+p,void 0!==x&&(this.alt=+x)}function Et(h,p,x){return h instanceof Dt?h:kn(h)&&"object"!=typeof h[0]?3===h.length?new Dt(h[0],h[1],h[2]):2===h.length?new Dt(h[0],h[1]):null:null==h?h:"object"==typeof h&&"lat"in h?new Dt(h.lat,"lng"in h?h.lng:h.lon,h.alt):void 0===p?null:new Dt(h,p,x)}At.prototype={clone:function(){return new At(this.x,this.y)},add:function(h){return this.clone()._add(n1(h))},_add:function(h){return this.x+=h.x,this.y+=h.y,this},subtract:function(h){return this.clone()._subtract(n1(h))},_subtract:function(h){return this.x-=h.x,this.y-=h.y,this},divideBy:function(h){return this.clone()._divideBy(h)},_divideBy:function(h){return this.x/=h,this.y/=h,this},multiplyBy:function(h){return this.clone()._multiplyBy(h)},_multiplyBy:function(h){return this.x*=h,this.y*=h,this},scaleBy:function(h){return new At(this.x*h.x,this.y*h.y)},unscaleBy:function(h){return new At(this.x/h.x,this.y/h.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=t5(this.x),this.y=t5(this.y),this},distanceTo:function(h){var p=(h=n1(h)).x-this.x,x=h.y-this.y;return Math.sqrt(p*p+x*x)},equals:function(h){return(h=n1(h)).x===this.x&&h.y===this.y},contains:function(h){return h=n1(h),Math.abs(h.x)<=Math.abs(this.x)&&Math.abs(h.y)<=Math.abs(this.y)},toString:function(){return"Point("+Ai(this.x)+", "+Ai(this.y)+")"}},r1.prototype={extend:function(h){return h=n1(h),this.min||this.max?(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)):(this.min=h.clone(),this.max=h.clone()),this},getCenter:function(h){return new At((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,h)},getBottomLeft:function(){return new At(this.min.x,this.max.y)},getTopRight:function(){return new At(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(h){var p,x;return(h="number"==typeof h[0]||h instanceof At?n1(h):Wi(h))instanceof r1?(p=h.min,x=h.max):p=x=h,p.x>=this.min.x&&x.x<=this.max.x&&p.y>=this.min.y&&x.y<=this.max.y},intersects:function(h){h=Wi(h);var p=this.min,x=this.max,w=h.min,A=h.max;return A.x>=p.x&&w.x<=x.x&&A.y>=p.y&&w.y<=x.y},overlaps:function(h){h=Wi(h);var p=this.min,x=this.max,w=h.min,A=h.max;return A.x>p.x&&w.x<x.x&&A.y>p.y&&w.y<x.y},isValid:function(){return!(!this.min||!this.max)}},Kn.prototype={extend:function(h){var w,A,p=this._southWest,x=this._northEast;if(h instanceof Dt)w=h,A=h;else{if(!(h instanceof Kn))return h?this.extend(Et(h)||Yt(h)):this;if(A=h._northEast,!(w=h._southWest)||!A)return this}return p||x?(p.lat=Math.min(w.lat,p.lat),p.lng=Math.min(w.lng,p.lng),x.lat=Math.max(A.lat,x.lat),x.lng=Math.max(A.lng,x.lng)):(this._southWest=new Dt(w.lat,w.lng),this._northEast=new Dt(A.lat,A.lng)),this},pad:function(h){var p=this._southWest,x=this._northEast,w=Math.abs(p.lat-x.lat)*h,A=Math.abs(p.lng-x.lng)*h;return new Kn(new Dt(p.lat-w,p.lng-A),new Dt(x.lat+w,x.lng+A))},getCenter:function(){return new Dt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Dt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Dt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(h){h="number"==typeof h[0]||h instanceof Dt||"lat"in h?Et(h):Yt(h);var w,A,p=this._southWest,x=this._northEast;return h instanceof Kn?(w=h.getSouthWest(),A=h.getNorthEast()):w=A=h,w.lat>=p.lat&&A.lat<=x.lat&&w.lng>=p.lng&&A.lng<=x.lng},intersects:function(h){h=Yt(h);var p=this._southWest,x=this._northEast,w=h.getSouthWest(),A=h.getNorthEast();return A.lat>=p.lat&&w.lat<=x.lat&&A.lng>=p.lng&&w.lng<=x.lng},overlaps:function(h){h=Yt(h);var p=this._southWest,x=this._northEast,w=h.getSouthWest(),A=h.getNorthEast();return A.lat>p.lat&&w.lat<x.lat&&A.lng>p.lng&&w.lng<x.lng},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(h,p){return!!h&&(h=Yt(h),this._southWest.equals(h.getSouthWest(),p)&&this._northEast.equals(h.getNorthEast(),p))},isValid:function(){return!(!this._southWest||!this._northEast)}},Dt.prototype={equals:function(h,p){return!!h&&(h=Et(h),Math.max(Math.abs(this.lat-h.lat),Math.abs(this.lng-h.lng))<=(void 0===p?1e-9:p))},toString:function(h){return"LatLng("+Ai(this.lat,h)+", "+Ai(this.lng,h)+")"},distanceTo:function(h){return gs.distance(this,Et(h))},wrap:function(){return gs.wrapLatLng(this)},toBounds:function(h){var p=180*h/40075017,x=p/Math.cos(Math.PI/180*this.lat);return Yt([this.lat-p,this.lng-x],[this.lat+p,this.lng+x])},clone:function(){return new Dt(this.lat,this.lng,this.alt)}};var h,o2={latLngToPoint:function(h,p){var x=this.projection.project(h),w=this.scale(p);return this.transformation._transform(x,w)},pointToLatLng:function(h,p){var x=this.scale(p),w=this.transformation.untransform(h,x);return this.projection.unproject(w)},project:function(h){return this.projection.project(h)},unproject:function(h){return this.projection.unproject(h)},scale:function(h){return 256*Math.pow(2,h)},zoom:function(h){return Math.log(h/256)/Math.LN2},getProjectedBounds:function(h){if(this.infinite)return null;var p=this.projection.bounds,x=this.scale(h);return new r1(this.transformation.transform(p.min,x),this.transformation.transform(p.max,x))},infinite:!1,wrapLatLng:function(h){var p=this.wrapLng?ca(h.lng,this.wrapLng,!0):h.lng;return new Dt(this.wrapLat?ca(h.lat,this.wrapLat,!0):h.lat,p,h.alt)},wrapLatLngBounds:function(h){var p=h.getCenter(),x=this.wrapLatLng(p),w=p.lat-x.lat,A=p.lng-x.lng;if(0===w&&0===A)return h;var R=h.getSouthWest(),Q=h.getNorthEast();return new Kn(new Dt(R.lat-w,R.lng-A),new Dt(Q.lat-w,Q.lng-A))}},gs=u1({},o2,{wrapLng:[-180,180],R:6371e3,distance:function(h,p){var x=Math.PI/180,w=h.lat*x,A=p.lat*x,R=Math.sin((p.lat-h.lat)*x/2),Q=Math.sin((p.lng-h.lng)*x/2),de=R*R+Math.cos(w)*Math.cos(A)*Q*Q,me=2*Math.atan2(Math.sqrt(de),Math.sqrt(1-de));return this.R*me}}),n5={R:6378137,MAX_LATITUDE:85.0511287798,project:function(h){var p=Math.PI/180,x=this.MAX_LATITUDE,w=Math.max(Math.min(x,h.lat),-x),A=Math.sin(w*p);return new At(this.R*h.lng*p,this.R*Math.log((1+A)/(1-A))/2)},unproject:function(h){var p=180/Math.PI;return new Dt((2*Math.atan(Math.exp(h.y/this.R))-Math.PI/2)*p,h.x*p/this.R)},bounds:(h=6378137*Math.PI,new r1([-h,-h],[h,h]))};function i5(h,p,x,w){if(kn(h))return this._a=h[0],this._b=h[1],this._c=h[2],void(this._d=h[3]);this._a=h,this._b=p,this._c=x,this._d=w}function e3(h,p,x,w){return new i5(h,p,x,w)}i5.prototype={transform:function(h,p){return this._transform(h.clone(),p)},_transform:function(h,p){return h.x=(p=p||1)*(this._a*h.x+this._b),h.y=p*(this._c*h.y+this._d),h},untransform:function(h,p){return new At((h.x/(p=p||1)-this._b)/this._a,(h.y/p-this._d)/this._c)}};var r5=u1({},gs,{code:"EPSG:3857",projection:n5,transformation:function(){var h=.5/(Math.PI*n5.R);return e3(h,.5,-h,.5)}()}),_9=u1({},r5,{code:"EPSG:900913"});function x9(h){return document.createElementNS("http://www.w3.org/2000/svg",h)}function i6(h,p){var w,A,R,Q,de,me,x="";for(w=0,R=h.length;w<R;w++){for(A=0,Q=(de=h[w]).length;A<Q;A++)x+=(A?"L":"M")+(me=de[A]).x+" "+me.y;x+=p?wo?"z":"x":""}return x||"M0 0"}var s5=document.documentElement.style,Mo="ActiveXObject"in window,ha=Mo&&!document.addEventListener,r6="msLaunchUri"in navigator&&!("documentMode"in document),a5=V2("webkit"),t3=V2("android"),c2=V2("android 2")||V2("android 3"),M9=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),b9=t3&&V2("Google")&&M9<537&&!("AudioNode"in window),s6=!!window.opera,o5=!r6&&V2("chrome"),a6=V2("gecko")&&!a5&&!s6&&!Mo,o6=!o5&&V2("safari"),w9=V2("phantom"),S9="OTransition"in s5,C9=0===navigator.platform.indexOf("Win"),bo=Mo&&"transition"in s5,n3="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!c2,c6="MozPerspective"in s5,Li=!window.L_DISABLE_3D&&(bo||n3||c6)&&!S9&&!w9,vs="undefined"!=typeof orientation||V2("mobile"),E9=vs&&a5,c5=vs&&n3,ir=!window.PointerEvent&&window.MSPointerEvent,l2=!(!window.PointerEvent&&!ir),h2=!window.L_NO_TOUCH&&(l2||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),u2=vs&&s6,z9=vs&&a6,Br=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ua=function(){var h=!1;try{var p=Object.defineProperty({},"passive",{get:function(){h=!0}});window.addEventListener("testPassiveEventSupport",M1,p),window.removeEventListener("testPassiveEventSupport",M1,p)}catch(x){}return h}(),l5=!!document.createElement("canvas").getContext,wo=!(!document.createElementNS||!x9("svg").createSVGRect),i3=!wo&&function(){try{var h=document.createElement("div");h.innerHTML='<v:shape adj="1"/>';var p=h.firstChild;return p.style.behavior="url(#default#VML)",p&&"object"==typeof p.adj}catch(x){return!1}}();function V2(h){return navigator.userAgent.toLowerCase().indexOf(h)>=0}var rr={ie:Mo,ielt9:ha,edge:r6,webkit:a5,android:t3,android23:c2,androidStock:b9,opera:s6,chrome:o5,gecko:a6,safari:o6,phantom:w9,opera12:S9,win:C9,ie3d:bo,webkit3d:n3,gecko3d:c6,any3d:Li,mobile:vs,mobileWebkit:E9,mobileWebkit3d:c5,msPointer:ir,pointer:l2,touch:h2,mobileOpera:u2,mobileGecko:z9,retina:Br,passiveEvents:ua,canvas:l5,svg:wo,vml:i3},l6=ir?"MSPointerDown":"pointerdown",Z1=ir?"MSPointerMove":"pointermove",ys=ir?"MSPointerUp":"pointerup",f2=ir?"MSPointerCancel":"pointercancel",So={},h5=!1;function T9(h,p,x,w){return"touchstart"===p?function A9(h,p,x){var w=f1(function(A){A.MSPOINTER_TYPE_TOUCH&&A.pointerType===A.MSPOINTER_TYPE_TOUCH&&Di(A),r3(A,p)});h["_leaflet_touchstart"+x]=w,h.addEventListener(l6,w,!1),h5||(document.addEventListener(l6,Co,!0),document.addEventListener(Z1,L9,!0),document.addEventListener(ys,u6,!0),document.addEventListener(f2,u6,!0),h5=!0)}(h,x,w):"touchmove"===p?function D9(h,p,x){var w=function(A){A.pointerType===(A.MSPOINTER_TYPE_MOUSE||"mouse")&&0===A.buttons||r3(A,p)};h["_leaflet_touchmove"+x]=w,h.addEventListener(Z1,w,!1)}(h,x,w):"touchend"===p&&function P9(h,p,x){var w=function(A){r3(A,p)};h["_leaflet_touchend"+x]=w,h.addEventListener(ys,w,!1),h.addEventListener(f2,w,!1)}(h,x,w),this}function Co(h){So[h.pointerId]=h}function L9(h){So[h.pointerId]&&(So[h.pointerId]=h)}function u6(h){delete So[h.pointerId]}function r3(h,p){for(var x in h.touches=[],So)h.touches.push(So[x]);h.changedTouches=[h],p(h)}var s3=ir?"MSPointerDown":l2?"pointerdown":"touchstart",a3=ir?"MSPointerUp":l2?"pointerup":"touchend",_s="_leaflet_";var Gr,Tn,d5,f6,m5,cn=_n(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),fa=_n(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Eo="webkitTransition"===fa||"OTransition"===fa?fa+"End":"transitionend";function u5(h){return"string"==typeof h?document.getElementById(h):h}function xs(h,p){var x=h.style[p]||h.currentStyle&&h.currentStyle[p];if((!x||"auto"===x)&&document.defaultView){var w=document.defaultView.getComputedStyle(h,null);x=w?w[p]:null}return"auto"===x?null:x}function dt(h,p,x){var w=document.createElement(h);return w.className=p||"",x&&x.appendChild(w),w}function C1(h){var p=h.parentNode;p&&p.removeChild(h)}function s1(h){for(;h.firstChild;)h.removeChild(h.firstChild)}function Ur(h){var p=h.parentNode;p&&p.lastChild!==h&&p.appendChild(h)}function da(h){var p=h.parentNode;p&&p.firstChild!==h&&p.insertBefore(h,p.firstChild)}function zo(h,p){if(void 0!==h.classList)return h.classList.contains(p);var x=Jt(h);return x.length>0&&new RegExp("(^|\\s)"+p+"(\\s|$)").test(x)}function qe(h,p){if(void 0!==h.classList)for(var x=nr(p),w=0,A=x.length;w<A;w++)h.classList.add(x[w]);else if(!zo(h,p)){var R=Jt(h);f5(h,(R?R+" ":"")+p)}}function H1(h,p){void 0!==h.classList?h.classList.remove(p):f5(h,Z4((" "+Jt(h)+" ").replace(" "+p+" "," ")))}function f5(h,p){void 0===h.className.baseVal?h.className=p:h.className.baseVal=p}function Jt(h){return h.correspondingElement&&(h=h.correspondingElement),void 0===h.className.baseVal?h.className:h.className.baseVal}function fi(h,p){"opacity"in h.style?h.style.opacity=p:"filter"in h.style&&function Lt(h,p){var x=!1,w="DXImageTransform.Microsoft.Alpha";try{x=h.filters.item(w)}catch(A){if(1===p)return}p=Math.round(100*p),x?(x.Enabled=100!==p,x.Opacity=p):h.style.filter+=" progid:"+w+"(opacity="+p+")"}(h,p)}function _n(h){for(var p=document.documentElement.style,x=0;x<h.length;x++)if(h[x]in p)return h[x];return!1}function Ms(h,p,x){var w=p||new At(0,0);h.style[cn]=(bo?"translate("+w.x+"px,"+w.y+"px)":"translate3d("+w.x+"px,"+w.y+"px,0)")+(x?" scale("+x+")":"")}function ln(h,p){h._leaflet_pos=p,Li?Ms(h,p):(h.style.left=p.x+"px",h.style.top=p.y+"px")}function bs(h){return h._leaflet_pos||new At(0,0)}if("onselectstart"in document)Gr=function(){Wt(window,"selectstart",Di)},Tn=function(){Tt(window,"selectstart",Di)};else{var To=_n(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Gr=function(){if(To){var h=document.documentElement.style;d5=h[To],h[To]="none"}},Tn=function(){To&&(document.documentElement.style[To]=d5,d5=void 0)}}function p5(){Wt(window,"dragstart",Di)}function d2(){Tt(window,"dragstart",Di)}function g5(h){for(;-1===h.tabIndex;)h=h.parentNode;!h.style||(d6(),f6=h,m5=h.style.outline,h.style.outline="none",Wt(window,"keydown",d6))}function d6(){!f6||(f6.style.outline=m5,f6=void 0,m5=void 0,Tt(window,"keydown",d6))}function v5(h){do{h=h.parentNode}while(!(h.offsetWidth&&h.offsetHeight||h===document.body));return h}function y5(h){var p=h.getBoundingClientRect();return{x:p.width/h.offsetWidth||1,y:p.height/h.offsetHeight||1,boundingClientRect:p}}var H9={TRANSFORM:cn,TRANSITION:fa,TRANSITION_END:Eo,get:u5,getStyle:xs,create:dt,remove:C1,empty:s1,toFront:Ur,toBack:da,hasClass:zo,addClass:qe,removeClass:H1,setClass:f5,getClass:Jt,setOpacity:fi,testProp:_n,setTransform:Ms,setPosition:ln,getPosition:bs,disableTextSelection:Gr,enableTextSelection:Tn,disableImageDrag:p5,enableImageDrag:d2,preventOutline:g5,restoreOutline:d6,getSizedParentNode:v5,getScale:y5};function Wt(h,p,x,w){if("object"==typeof p)for(var A in p)p6(h,A,p[A],x);else for(var R=0,Q=(p=nr(p)).length;R<Q;R++)p6(h,p[R],x,w);return this}var I1="_leaflet_events";function Tt(h,p,x,w){if("object"==typeof p)for(var A in p)xt(h,A,p[A],x);else if(p)for(var R=0,Q=(p=nr(p)).length;R<Q;R++)xt(h,p[R],x,w);else{for(var de in h[I1])xt(h,de,h[I1][de]);delete h[I1]}return this}function I9(){if(l2)return!(r6||o6)}var _5={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function p6(h,p,x,w){var A=p+i1(x)+(w?"_"+i1(w):"");if(h[I1]&&h[I1][A])return this;var R=function(de){return x.call(w||h,de||window.event)},Q=R;l2&&0===p.indexOf("touch")?T9(h,p,R,A):h2&&"dblclick"===p&&!I9()?function N9(h,p,x){var w,A,R=!1;function de(Ce){if(l2){if(!Ce.isPrimary||"mouse"===Ce.pointerType)return}else if(Ce.touches.length>1)return;var tt=Date.now(),pt=tt-(w||tt);A=Ce.touches?Ce.touches[0]:Ce,R=pt>0&&pt<=250,w=tt}function me(Ce){if(R&&!A.cancelBubble){if(l2){if("mouse"===Ce.pointerType)return;var pt,Pt,tt={};for(Pt in A)tt[Pt]=(pt=A[Pt])&&pt.bind?pt.bind(A):pt;A=tt}A.type="dblclick",A.button=0,p(A),w=null}}return h[_s+s3+x]=de,h[_s+a3+x]=me,h[_s+"dblclick"+x]=p,h.addEventListener(s3,de,!!ua&&{passive:!1}),h.addEventListener(a3,me,!!ua&&{passive:!1}),h.addEventListener("dblclick",p,!1),this}(h,R,A):"addEventListener"in h?"touchstart"===p||"touchmove"===p||"wheel"===p||"mousewheel"===p?h.addEventListener(_5[p]||p,R,!!ua&&{passive:!1}):"mouseenter"===p||"mouseleave"===p?h.addEventListener(_5[p],R=function(de){de=de||window.event,zt(h,de)&&Q(de)},!1):h.addEventListener(p,Q,!1):"attachEvent"in h&&h.attachEvent("on"+p,R),h[I1]=h[I1]||{},h[I1][A]=R}function xt(h,p,x,w){var A=p+i1(x)+(w?"_"+i1(w):""),R=h[I1]&&h[I1][A];if(!R)return this;l2&&0===p.indexOf("touch")?function h6(h,p,x){var w=h["_leaflet_"+p+x];return"touchstart"===p?h.removeEventListener(l6,w,!1):"touchmove"===p?h.removeEventListener(Z1,w,!1):"touchend"===p&&(h.removeEventListener(ys,w,!1),h.removeEventListener(f2,w,!1)),this}(h,p,A):h2&&"dblclick"===p&&!I9()?function R9(h,p){var w=h[_s+a3+p],A=h[_s+"dblclick"+p];return h.removeEventListener(s3,h[_s+s3+p],!!ua&&{passive:!1}),h.removeEventListener(a3,w,!!ua&&{passive:!1}),h.removeEventListener("dblclick",A,!1),this}(h,A):"removeEventListener"in h?h.removeEventListener(_5[p]||p,R,!1):"detachEvent"in h&&h.detachEvent("on"+p,R),h[I1][A]=null}function pa(h){return h.stopPropagation?h.stopPropagation():h.originalEvent?h.originalEvent._stopped=!0:h.cancelBubble=!0,m6(h),this}function Qn(h){return p6(h,"wheel",pa),this}function ws(h){return Wt(h,"mousedown touchstart dblclick",pa),p6(h,"click",o3),this}function Di(h){return h.preventDefault?h.preventDefault():h.returnValue=!1,this}function sr(h){return Di(h),pa(h),this}function x5(h,p){if(!p)return new At(h.clientX,h.clientY);var x=y5(p),w=x.boundingClientRect;return new At((h.clientX-w.left)/x.x-p.clientLeft,(h.clientY-w.top)/x.y-p.clientTop)}var M5=C9&&o5?2*window.devicePixelRatio:a6?window.devicePixelRatio:1;function Ao(h){return r6?h.wheelDeltaY/2:h.deltaY&&0===h.deltaMode?-h.deltaY/M5:h.deltaY&&1===h.deltaMode?20*-h.deltaY:h.deltaY&&2===h.deltaMode?60*-h.deltaY:h.deltaX||h.deltaZ?0:h.wheelDelta?(h.wheelDeltaY||h.wheelDelta)/2:h.detail&&Math.abs(h.detail)<32765?20*-h.detail:h.detail?h.detail/-32765*60:0}var Lo={};function o3(h){Lo[h.type]=!0}function m6(h){var p=Lo[h.type];return Lo[h.type]=!1,p}function zt(h,p){var x=p.relatedTarget;if(!x)return!0;try{for(;x&&x!==h;)x=x.parentNode}catch(w){return!1}return x!==h}var g6={on:Wt,off:Tt,stopPropagation:pa,disableScrollPropagation:Qn,disableClickPropagation:ws,preventDefault:Di,stop:sr,getMousePosition:x5,getWheelDelta:Ao,fakeStop:o3,skipped:m6,isExternalTarget:zt,addListener:Wt,removeListener:Tt},b5=la.extend({run:function(h,p,x,w){this.stop(),this._el=h,this._inProgress=!0,this._duration=x||.25,this._easeOutPower=1/Math.max(w||.5,.2),this._startPos=bs(h),this._offset=p.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=Fn(this._animate,this),this._step()},_step:function(h){var p=+new Date-this._startTime,x=1e3*this._duration;p<x?this._runFrame(this._easeOut(p/x),h):(this._runFrame(1),this._complete())},_runFrame:function(h,p){var x=this._startPos.add(this._offset.multiplyBy(h));p&&x._round(),ln(this._el,x),this.fire("step")},_complete:function(){Bn(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(h){return 1-Math.pow(1-h,this._easeOutPower)}}),It=la.extend({options:{crs:r5,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(h,p){p=R1(this,p),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(h),this._initLayout(),this._onResize=f1(this._onResize,this),this._initEvents(),p.maxBounds&&this.setMaxBounds(p.maxBounds),void 0!==p.zoom&&(this._zoom=this._limitZoom(p.zoom)),p.center&&void 0!==p.zoom&&this.setView(Et(p.center),p.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=fa&&Li&&!u2&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Wt(this._proxy,Eo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(h,p,x){return p=void 0===p?this._zoom:this._limitZoom(p),h=this._limitCenter(Et(h),p,this.options.maxBounds),x=x||{},this._stop(),this._loaded&&!x.reset&&!0!==x&&(void 0!==x.animate&&(x.zoom=u1({animate:x.animate},x.zoom),x.pan=u1({animate:x.animate,duration:x.duration},x.pan)),this._zoom!==p?this._tryAnimatedZoom&&this._tryAnimatedZoom(h,p,x.zoom):this._tryAnimatedPan(h,x.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(h,p),this)},setZoom:function(h,p){return this._loaded?this.setView(this.getCenter(),h,{zoom:p}):(this._zoom=h,this)},zoomIn:function(h,p){return this.setZoom(this._zoom+(h=h||(Li?this.options.zoomDelta:1)),p)},zoomOut:function(h,p){return this.setZoom(this._zoom-(h=h||(Li?this.options.zoomDelta:1)),p)},setZoomAround:function(h,p,x){var w=this.getZoomScale(p),A=this.getSize().divideBy(2),Q=(h instanceof At?h:this.latLngToContainerPoint(h)).subtract(A).multiplyBy(1-1/w),de=this.containerPointToLatLng(A.add(Q));return this.setView(de,p,{zoom:x})},_getBoundsCenterZoom:function(h,p){p=p||{},h=h.getBounds?h.getBounds():Yt(h);var x=n1(p.paddingTopLeft||p.padding||[0,0]),w=n1(p.paddingBottomRight||p.padding||[0,0]),A=this.getBoundsZoom(h,!1,x.add(w));if((A="number"==typeof p.maxZoom?Math.min(p.maxZoom,A):A)===1/0)return{center:h.getCenter(),zoom:A};var R=w.subtract(x).divideBy(2),Q=this.project(h.getSouthWest(),A),de=this.project(h.getNorthEast(),A);return{center:this.unproject(Q.add(de).divideBy(2).add(R),A),zoom:A}},fitBounds:function(h,p){if(!(h=Yt(h)).isValid())throw new Error("Bounds are not valid.");var x=this._getBoundsCenterZoom(h,p);return this.setView(x.center,x.zoom,p)},fitWorld:function(h){return this.fitBounds([[-90,-180],[90,180]],h)},panTo:function(h,p){return this.setView(h,this._zoom,{pan:p})},panBy:function(h,p){if(p=p||{},!(h=n1(h).round()).x&&!h.y)return this.fire("moveend");if(!0!==p.animate&&!this.getSize().contains(h))return this._resetView(this.unproject(this.project(this.getCenter()).add(h)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new b5,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),p.noMoveStart||this.fire("movestart"),!1!==p.animate){qe(this._mapPane,"leaflet-pan-anim");var x=this._getMapPanePos().subtract(h).round();this._panAnim.run(this._mapPane,x,p.duration||.25,p.easeLinearity)}else this._rawPanBy(h),this.fire("move").fire("moveend");return this},flyTo:function(h,p,x){if(!1===(x=x||{}).animate||!Li)return this.setView(h,p,x);this._stop();var w=this.project(this.getCenter()),A=this.project(h),R=this.getSize(),Q=this._zoom;h=Et(h),p=void 0===p?Q:p;var de=Math.max(R.x,R.y),me=de*this.getZoomScale(Q,p),Ce=A.distanceTo(w)||1,tt=1.42,pt=tt*tt;function Pt(hn){var E6=(me*me-de*de+(hn?-1:1)*pt*pt*Ce*Ce)/(2*(hn?me:de)*pt*Ce),H5=Math.sqrt(E6*E6+1)-E6;return H5<1e-9?-18:Math.log(H5)}function lr(hn){return(Math.exp(hn)-Math.exp(-hn))/2}function hr(hn){return(Math.exp(hn)+Math.exp(-hn))/2}var nn=Pt(0);function w6(hn){return de*(hr(nn)*function ur(hn){return lr(hn)/hr(hn)}(nn+tt*hn)-lr(nn))/pt}var $r=Date.now(),S6=(Pt(1)-nn)/tt,C6=x.duration?1e3*x.duration:1e3*S6*.8;return this._moveStart(!0,x.noMoveStart),function bt(){var hn=(Date.now()-$r)/C6,_3=function $9(hn){return 1-Math.pow(1-hn,1.5)}(hn)*S6;hn<=1?(this._flyToFrame=Fn(bt,this),this._move(this.unproject(w.add(A.subtract(w).multiplyBy(w6(_3)/Ce)),Q),this.getScaleZoom(de/function y3(hn){return de*(hr(nn)/hr(nn+tt*hn))}(_3),Q),{flyTo:!0})):this._move(h,p)._moveEnd(!0)}.call(this),this},flyToBounds:function(h,p){var x=this._getBoundsCenterZoom(h,p);return this.flyTo(x.center,x.zoom,p)},setMaxBounds:function(h){return(h=Yt(h)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=h,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(h){var p=this.options.minZoom;return this.options.minZoom=h,this._loaded&&p!==h&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(h):this},setMaxZoom:function(h){var p=this.options.maxZoom;return this.options.maxZoom=h,this._loaded&&p!==h&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(h):this},panInsideBounds:function(h,p){this._enforcingBounds=!0;var x=this.getCenter(),w=this._limitCenter(x,this._zoom,Yt(h));return x.equals(w)||this.panTo(w,p),this._enforcingBounds=!1,this},panInside:function(h,p){var x=n1((p=p||{}).paddingTopLeft||p.padding||[0,0]),w=n1(p.paddingBottomRight||p.padding||[0,0]),A=this.getCenter(),R=this.project(A),Q=this.project(h),de=this.getPixelBounds(),me=de.getSize().divideBy(2),Ce=Wi([de.min.add(x),de.max.subtract(w)]);if(!Ce.contains(Q)){this._enforcingBounds=!0;var tt=R.subtract(Q),pt=n1(Q.x+tt.x,Q.y+tt.y);(Q.x<Ce.min.x||Q.x>Ce.max.x)&&(pt.x=R.x-tt.x,tt.x>0?pt.x+=me.x-x.x:pt.x-=me.x-w.x),(Q.y<Ce.min.y||Q.y>Ce.max.y)&&(pt.y=R.y-tt.y,tt.y>0?pt.y+=me.y-x.y:pt.y-=me.y-w.y),this.panTo(this.unproject(pt),p),this._enforcingBounds=!1}return this},invalidateSize:function(h){if(!this._loaded)return this;h=u1({animate:!1,pan:!0},!0===h?{animate:!0}:h);var p=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var x=this.getSize(),w=p.divideBy(2).round(),A=x.divideBy(2).round(),R=w.subtract(A);return R.x||R.y?(h.animate&&h.pan?this.panBy(R):(h.pan&&this._rawPanBy(R),this.fire("move"),h.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(f1(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:p,newSize:x})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(h){if(h=this._locateOptions=u1({timeout:1e4,watch:!1},h),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var p=f1(this._handleGeolocationResponse,this),x=f1(this._handleGeolocationError,this);return h.watch?this._locationWatchId=navigator.geolocation.watchPosition(p,x,h):navigator.geolocation.getCurrentPosition(p,x,h),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(h){var p=h.code,x=h.message||(1===p?"permission denied":2===p?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:p,message:"Geolocation error: "+x+"."})},_handleGeolocationResponse:function(h){var w=new Dt(h.coords.latitude,h.coords.longitude),A=w.toBounds(2*h.coords.accuracy),R=this._locateOptions;if(R.setView){var Q=this.getBoundsZoom(A);this.setView(w,R.maxZoom?Math.min(Q,R.maxZoom):Q)}var de={latlng:w,bounds:A,timestamp:h.timestamp};for(var me in h.coords)"number"==typeof h.coords[me]&&(de[me]=h.coords[me]);this.fire("locationfound",de)},addHandler:function(h,p){if(!p)return this;var x=this[h]=new p(this);return this._handlers.push(x),this.options[h]&&x.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(p){this._container._leaflet_id=void 0,this._containerId=void 0}var h;for(h in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),C1(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Bn(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[h].remove();for(h in this._panes)C1(this._panes[h]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(h,p){var w=dt("div","leaflet-pane"+(h?" leaflet-"+h.replace("Pane","")+"-pane":""),p||this._mapPane);return h&&(this._panes[h]=w),w},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var h=this.getPixelBounds();return new Kn(this.unproject(h.getBottomLeft()),this.unproject(h.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(h,p,x){h=Yt(h),x=n1(x||[0,0]);var w=this.getZoom()||0,A=this.getMinZoom(),R=this.getMaxZoom(),Q=h.getNorthWest(),de=h.getSouthEast(),me=this.getSize().subtract(x),Ce=Wi(this.project(de,w),this.project(Q,w)).getSize(),tt=Li?this.options.zoomSnap:1,pt=me.x/Ce.x,Pt=me.y/Ce.y,lr=p?Math.max(pt,Pt):Math.min(pt,Pt);return w=this.getScaleZoom(lr,w),tt&&(w=Math.round(w/(tt/100))*(tt/100),w=p?Math.ceil(w/tt)*tt:Math.floor(w/tt)*tt),Math.max(A,Math.min(R,w))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new At(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(h,p){var x=this._getTopLeftPoint(h,p);return new r1(x,x.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(h){return this.options.crs.getProjectedBounds(void 0===h?this.getZoom():h)},getPane:function(h){return"string"==typeof h?this._panes[h]:h},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(h,p){var x=this.options.crs;return p=void 0===p?this._zoom:p,x.scale(h)/x.scale(p)},getScaleZoom:function(h,p){var x=this.options.crs,w=x.zoom(h*x.scale(p=void 0===p?this._zoom:p));return isNaN(w)?1/0:w},project:function(h,p){return p=void 0===p?this._zoom:p,this.options.crs.latLngToPoint(Et(h),p)},unproject:function(h,p){return p=void 0===p?this._zoom:p,this.options.crs.pointToLatLng(n1(h),p)},layerPointToLatLng:function(h){var p=n1(h).add(this.getPixelOrigin());return this.unproject(p)},latLngToLayerPoint:function(h){return this.project(Et(h))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(h){return this.options.crs.wrapLatLng(Et(h))},wrapLatLngBounds:function(h){return this.options.crs.wrapLatLngBounds(Yt(h))},distance:function(h,p){return this.options.crs.distance(Et(h),Et(p))},containerPointToLayerPoint:function(h){return n1(h).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(h){return n1(h).add(this._getMapPanePos())},containerPointToLatLng:function(h){var p=this.containerPointToLayerPoint(n1(h));return this.layerPointToLatLng(p)},latLngToContainerPoint:function(h){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Et(h)))},mouseEventToContainerPoint:function(h){return x5(h,this._container)},mouseEventToLayerPoint:function(h){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(h))},mouseEventToLatLng:function(h){return this.layerPointToLatLng(this.mouseEventToLayerPoint(h))},_initContainer:function(h){var p=this._container=u5(h);if(!p)throw new Error("Map container not found.");if(p._leaflet_id)throw new Error("Map container is already initialized.");Wt(p,"scroll",this._onScroll,this),this._containerId=i1(p)},_initLayout:function(){var h=this._container;this._fadeAnimated=this.options.fadeAnimation&&Li,qe(h,"leaflet-container"+(h2?" leaflet-touch":"")+(Br?" leaflet-retina":"")+(ha?" leaflet-oldie":"")+(o6?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var p=xs(h,"position");"absolute"!==p&&"relative"!==p&&"fixed"!==p&&(h.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var h=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ln(this._mapPane,new At(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(qe(h.markerPane,"leaflet-zoom-hide"),qe(h.shadowPane,"leaflet-zoom-hide"))},_resetView:function(h,p){ln(this._mapPane,new At(0,0));var x=!this._loaded;this._loaded=!0,p=this._limitZoom(p),this.fire("viewprereset");var w=this._zoom!==p;this._moveStart(w,!1)._move(h,p)._moveEnd(w),this.fire("viewreset"),x&&this.fire("load")},_moveStart:function(h,p){return h&&this.fire("zoomstart"),p||this.fire("movestart"),this},_move:function(h,p,x){void 0===p&&(p=this._zoom);var w=this._zoom!==p;return this._zoom=p,this._lastCenter=h,this._pixelOrigin=this._getNewPixelOrigin(h),(w||x&&x.pinch)&&this.fire("zoom",x),this.fire("move",x)},_moveEnd:function(h){return h&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Bn(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(h){ln(this._mapPane,this._getMapPanePos().subtract(h))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(h){this._targets={},this._targets[i1(this._container)]=this;var p=h?Tt:Wt;p(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&p(window,"resize",this._onResize,this),Li&&this.options.transform3DLimit&&(h?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Bn(this._resizeRequest),this._resizeRequest=Fn(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var h=this._getMapPanePos();Math.max(Math.abs(h.x),Math.abs(h.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(h,p){for(var w,x=[],A="mouseout"===p||"mouseover"===p,R=h.target||h.srcElement,Q=!1;R;){if((w=this._targets[i1(R)])&&("click"===p||"preclick"===p)&&!h._simulated&&this._draggableMoved(w)){Q=!0;break}if(w&&w.listens(p,!0)&&(A&&!zt(R,h)||(x.push(w),A))||R===this._container)break;R=R.parentNode}return!x.length&&!Q&&!A&&zt(R,h)&&(x=[this]),x},_handleDOMEvent:function(h){if(this._loaded&&!m6(h)){var p=h.type;("mousedown"===p||"keypress"===p||"keyup"===p||"keydown"===p)&&g5(h.target||h.srcElement),this._fireDOMEvent(h,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(h,p,x){if("click"===h.type){var w=u1({},h);w.type="preclick",this._fireDOMEvent(w,w.type,x)}if(!h._stopped&&(x=(x||[]).concat(this._findEventTargets(h,p))).length){var A=x[0];"contextmenu"===p&&A.listens(p,!0)&&Di(h);var R={originalEvent:h};if("keypress"!==h.type&&"keydown"!==h.type&&"keyup"!==h.type){var Q=A.getLatLng&&(!A._radius||A._radius<=10);R.containerPoint=Q?this.latLngToContainerPoint(A.getLatLng()):this.mouseEventToContainerPoint(h),R.layerPoint=this.containerPointToLayerPoint(R.containerPoint),R.latlng=Q?A.getLatLng():this.layerPointToLatLng(R.layerPoint)}for(var de=0;de<x.length;de++)if(x[de].fire(p,R,!0),R.originalEvent._stopped||!1===x[de].options.bubblingMouseEvents&&-1!==_o(this._mouseEvents,p))return}},_draggableMoved:function(h){return(h=h.dragging&&h.dragging.enabled()?h:this).dragging&&h.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var h=0,p=this._handlers.length;h<p;h++)this._handlers[h].disable()},whenReady:function(h,p){return this._loaded?h.call(p||this,{target:this}):this.on("load",h,p),this},_getMapPanePos:function(){return bs(this._mapPane)||new At(0,0)},_moved:function(){var h=this._getMapPanePos();return h&&!h.equals([0,0])},_getTopLeftPoint:function(h,p){return(h&&void 0!==p?this._getNewPixelOrigin(h,p):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(h,p){var x=this.getSize()._divideBy(2);return this.project(h,p)._subtract(x)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(h,p,x){var w=this._getNewPixelOrigin(x,p);return this.project(h,p)._subtract(w)},_latLngBoundsToNewLayerBounds:function(h,p,x){var w=this._getNewPixelOrigin(x,p);return Wi([this.project(h.getSouthWest(),p)._subtract(w),this.project(h.getNorthWest(),p)._subtract(w),this.project(h.getSouthEast(),p)._subtract(w),this.project(h.getNorthEast(),p)._subtract(w)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(h){return this.latLngToLayerPoint(h).subtract(this._getCenterLayerPoint())},_limitCenter:function(h,p,x){if(!x)return h;var w=this.project(h,p),A=this.getSize().divideBy(2),R=new r1(w.subtract(A),w.add(A)),Q=this._getBoundsOffset(R,x,p);return Q.round().equals([0,0])?h:this.unproject(w.add(Q),p)},_limitOffset:function(h,p){if(!p)return h;var x=this.getPixelBounds(),w=new r1(x.min.add(h),x.max.add(h));return h.add(this._getBoundsOffset(w,p))},_getBoundsOffset:function(h,p,x){var w=Wi(this.project(p.getNorthEast(),x),this.project(p.getSouthWest(),x)),A=w.min.subtract(h.min),R=w.max.subtract(h.max);return new At(this._rebound(A.x,-R.x),this._rebound(A.y,-R.y))},_rebound:function(h,p){return h+p>0?Math.round(h-p)/2:Math.max(0,Math.ceil(h))-Math.max(0,Math.floor(p))},_limitZoom:function(h){var p=this.getMinZoom(),x=this.getMaxZoom(),w=Li?this.options.zoomSnap:1;return w&&(h=Math.round(h/w)*w),Math.max(p,Math.min(x,h))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){H1(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(h,p){var x=this._getCenterOffset(h)._trunc();return!(!0!==(p&&p.animate)&&!this.getSize().contains(x)||(this.panBy(x,p),0))},_createAnimProxy:function(){var h=this._proxy=dt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(h),this.on("zoomanim",function(p){var x=cn,w=this._proxy.style[x];Ms(this._proxy,this.project(p.center,p.zoom),this.getZoomScale(p.zoom,1)),w===this._proxy.style[x]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){C1(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var h=this.getCenter(),p=this.getZoom();Ms(this._proxy,this.project(h,p),this.getZoomScale(p,1))},_catchTransitionEnd:function(h){this._animatingZoom&&h.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(h,p,x){if(this._animatingZoom)return!0;if(x=x||{},!this._zoomAnimated||!1===x.animate||this._nothingToAnimate()||Math.abs(p-this._zoom)>this.options.zoomAnimationThreshold)return!1;var w=this.getZoomScale(p),A=this._getCenterOffset(h)._divideBy(1-1/w);return!(!0!==x.animate&&!this.getSize().contains(A)||(Fn(function(){this._moveStart(!0,!1)._animateZoom(h,p,!0)},this),0))},_animateZoom:function(h,p,x,w){!this._mapPane||(x&&(this._animatingZoom=!0,this._animateToCenter=h,this._animateToZoom=p,qe(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:h,zoom:p,noUpdate:w}),setTimeout(f1(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&H1(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),Fn(function(){this._moveEnd(!0)},this))}});var O2=Fr.extend({options:{position:"topright"},initialize:function(h){R1(this,h)},getPosition:function(){return this.options.position},setPosition:function(h){var p=this._map;return p&&p.removeControl(this),this.options.position=h,p&&p.addControl(this),this},getContainer:function(){return this._container},addTo:function(h){this.remove(),this._map=h;var p=this._container=this.onAdd(h),x=this.getPosition(),w=h._controlCorners[x];return qe(p,"leaflet-control"),-1!==x.indexOf("bottom")?w.insertBefore(p,w.firstChild):w.appendChild(p),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(C1(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(h){this._map&&h&&h.screenX>0&&h.screenY>0&&this._map.getContainer().focus()}}),ji=function(h){return new O2(h)};It.include({addControl:function(h){return h.addTo(this),this},removeControl:function(h){return h.remove(),this},_initControlPos:function(){var h=this._controlCorners={},p="leaflet-",x=this._controlContainer=dt("div",p+"control-container",this._container);function w(A,R){h[A+R]=dt("div",p+A+" "+p+R,x)}w("top","left"),w("top","right"),w("bottom","left"),w("bottom","right")},_clearControlPos:function(){for(var h in this._controlCorners)C1(this._controlCorners[h]);C1(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var qi=O2.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(h,p,x,w){return x<w?-1:w<x?1:0}},initialize:function(h,p,x){for(var w in R1(this,x),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,h)this._addLayer(h[w],w);for(w in p)this._addLayer(p[w],w,!0)},onAdd:function(h){this._initLayout(),this._update(),this._map=h,h.on("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(h){return O2.prototype.addTo.call(this,h),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(h,p){return this._addLayer(h,p),this._map?this._update():this},addOverlay:function(h,p){return this._addLayer(h,p,!0),this._map?this._update():this},removeLayer:function(h){h.off("add remove",this._onLayerChange,this);var p=this._getLayer(i1(h));return p&&this._layers.splice(this._layers.indexOf(p),1),this._map?this._update():this},expand:function(){qe(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var h=this._map.getSize().y-(this._container.offsetTop+50);return h<this._section.clientHeight?(qe(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=h+"px"):H1(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return H1(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var h="leaflet-control-layers",p=this._container=dt("div",h),x=this.options.collapsed;p.setAttribute("aria-haspopup",!0),ws(p),Qn(p);var w=this._section=dt("section",h+"-list");x&&(this._map.on("click",this.collapse,this),t3||Wt(p,{mouseenter:this.expand,mouseleave:this.collapse},this));var A=this._layersLink=dt("a",h+"-toggle",p);A.href="#",A.title="Layers",h2?(Wt(A,"click",sr),Wt(A,"click",this.expand,this)):Wt(A,"focus",this.expand,this),x||this.expand(),this._baseLayersList=dt("div",h+"-base",w),this._separator=dt("div",h+"-separator",w),this._overlaysList=dt("div",h+"-overlays",w),p.appendChild(w)},_getLayer:function(h){for(var p=0;p<this._layers.length;p++)if(this._layers[p]&&i1(this._layers[p].layer)===h)return this._layers[p]},_addLayer:function(h,p,x){this._map&&h.on("add remove",this._onLayerChange,this),this._layers.push({layer:h,name:p,overlay:x}),this.options.sortLayers&&this._layers.sort(f1(function(w,A){return this.options.sortFunction(w.layer,A.layer,w.name,A.name)},this)),this.options.autoZIndex&&h.setZIndex&&(this._lastZIndex++,h.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;s1(this._baseLayersList),s1(this._overlaysList),this._layerControlInputs=[];var h,p,x,w,A=0;for(x=0;x<this._layers.length;x++)this._addItem(w=this._layers[x]),p=p||w.overlay,h=h||!w.overlay,A+=w.overlay?0:1;return this.options.hideSingleBase&&(this._baseLayersList.style.display=(h=h&&A>1)?"":"none"),this._separator.style.display=p&&h?"":"none",this},_onLayerChange:function(h){this._handlingClick||this._update();var p=this._getLayer(i1(h.target)),x=p.overlay?"add"===h.type?"overlayadd":"overlayremove":"add"===h.type?"baselayerchange":null;x&&this._map.fire(x,p)},_createRadioElement:function(h,p){var x='<input type="radio" class="leaflet-control-layers-selector" name="'+h+'"'+(p?' checked="checked"':"")+"/>",w=document.createElement("div");return w.innerHTML=x,w.firstChild},_addItem:function(h){var w,p=document.createElement("label"),x=this._map.hasLayer(h.layer);h.overlay?((w=document.createElement("input")).type="checkbox",w.className="leaflet-control-layers-selector",w.defaultChecked=x):w=this._createRadioElement("leaflet-base-layers_"+i1(this),x),this._layerControlInputs.push(w),w.layerId=i1(h.layer),Wt(w,"click",this._onInputClick,this);var A=document.createElement("span");A.innerHTML=" "+h.name;var R=document.createElement("div");return p.appendChild(R),R.appendChild(w),R.appendChild(A),(h.overlay?this._overlaysList:this._baseLayersList).appendChild(p),this._checkDisabledLayers(),p},_onInputClick:function(){var p,x,h=this._layerControlInputs,w=[],A=[];this._handlingClick=!0;for(var R=h.length-1;R>=0;R--)x=this._getLayer((p=h[R]).layerId).layer,p.checked?w.push(x):p.checked||A.push(x);for(R=0;R<A.length;R++)this._map.hasLayer(A[R])&&this._map.removeLayer(A[R]);for(R=0;R<w.length;R++)this._map.hasLayer(w[R])||this._map.addLayer(w[R]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var p,x,h=this._layerControlInputs,w=this._map.getZoom(),A=h.length-1;A>=0;A--)x=this._getLayer((p=h[A]).layerId).layer,p.disabled=void 0!==x.options.minZoom&&w<x.options.minZoom||void 0!==x.options.maxZoom&&w>x.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),S5=O2.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(h){var p="leaflet-control-zoom",x=dt("div",p+" leaflet-bar"),w=this.options;return this._zoomInButton=this._createButton(w.zoomInText,w.zoomInTitle,p+"-in",x,this._zoomIn),this._zoomOutButton=this._createButton(w.zoomOutText,w.zoomOutTitle,p+"-out",x,this._zoomOut),this._updateDisabled(),h.on("zoomend zoomlevelschange",this._updateDisabled,this),x},onRemove:function(h){h.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(h){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(h.shiftKey?3:1))},_zoomOut:function(h){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(h.shiftKey?3:1))},_createButton:function(h,p,x,w,A){var R=dt("a",x,w);return R.innerHTML=h,R.href="#",R.title=p,R.setAttribute("role","button"),R.setAttribute("aria-label",p),ws(R),Wt(R,"click",sr),Wt(R,"click",A,this),Wt(R,"click",this._refocusOnMap,this),R},_updateDisabled:function(){var h=this._map,p="leaflet-disabled";H1(this._zoomInButton,p),H1(this._zoomOutButton,p),(this._disabled||h._zoom===h.getMinZoom())&&qe(this._zoomOutButton,p),(this._disabled||h._zoom===h.getMaxZoom())&&qe(this._zoomInButton,p)}});It.mergeOptions({zoomControl:!0}),It.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new S5,this.addControl(this.zoomControl))});var C5=O2.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(h){var p="leaflet-control-scale",x=dt("div",p),w=this.options;return this._addScales(w,p+"-line",x),h.on(w.updateWhenIdle?"moveend":"move",this._update,this),h.whenReady(this._update,this),x},onRemove:function(h){h.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(h,p,x){h.metric&&(this._mScale=dt("div",p,x)),h.imperial&&(this._iScale=dt("div",p,x))},_update:function(){var h=this._map,p=h.getSize().y/2,x=h.distance(h.containerPointToLatLng([0,p]),h.containerPointToLatLng([this.options.maxWidth,p]));this._updateScales(x)},_updateScales:function(h){this.options.metric&&h&&this._updateMetric(h),this.options.imperial&&h&&this._updateImperial(h)},_updateMetric:function(h){var p=this._getRoundNum(h);this._updateScale(this._mScale,p<1e3?p+" m":p/1e3+" km",p/h)},_updateImperial:function(h){var x,w,A,p=3.2808399*h;p>5280?(w=this._getRoundNum(x=p/5280),this._updateScale(this._iScale,w+" mi",w/x)):(A=this._getRoundNum(p),this._updateScale(this._iScale,A+" ft",A/p))},_updateScale:function(h,p,x){h.style.width=Math.round(this.options.maxWidth*x)+"px",h.innerHTML=p},_getRoundNum:function(h){var p=Math.pow(10,(Math.floor(h)+"").length-1),x=h/p;return p*(x>=10?10:x>=5?5:x>=3?3:x>=2?2:1)}}),v6=O2.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(h){R1(this,h),this._attributions={}},onAdd:function(h){for(var p in h.attributionControl=this,this._container=dt("div","leaflet-control-attribution"),ws(this._container),h._layers)h._layers[p].getAttribution&&this.addAttribution(h._layers[p].getAttribution());return this._update(),this._container},setPrefix:function(h){return this.options.prefix=h,this._update(),this},addAttribution:function(h){return h?(this._attributions[h]||(this._attributions[h]=0),this._attributions[h]++,this._update(),this):this},removeAttribution:function(h){return h?(this._attributions[h]&&(this._attributions[h]--,this._update()),this):this},_update:function(){if(this._map){var h=[];for(var p in this._attributions)this._attributions[p]&&h.push(p);var x=[];this.options.prefix&&x.push(this.options.prefix),h.length&&x.push(h.join(", ")),this._container.innerHTML=x.join(" | ")}}});It.mergeOptions({attributionControl:!0}),It.addInitHook(function(){this.options.attributionControl&&(new v6).addTo(this)});O2.Layers=qi,O2.Zoom=S5,O2.Scale=C5,O2.Attribution=v6,ji.layers=function(h,p,x){return new qi(h,p,x)},ji.zoom=function(h){return new S5(h)},ji.scale=function(h){return new C5(h)},ji.attribution=function(h){return new v6(h)};var Ut=Fr.extend({initialize:function(h){this._map=h},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ut.addTo=function(h,p){return h.addHandler(p,this),this};var O1,ux={Events:qt},O9=h2?"touchstart mousedown":"mousedown",Ss={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},d1={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},k2=la.extend({options:{clickTolerance:3},initialize:function(h,p,x,w){R1(this,w),this._element=h,this._dragStartTarget=p||h,this._preventOutline=x},enable:function(){this._enabled||(Wt(this._dragStartTarget,O9,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(k2._dragging===this&&this.finishDrag(),Tt(this._dragStartTarget,O9,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(h){if(!h._simulated&&this._enabled&&(this._moved=!1,!zo(this._element,"leaflet-zoom-anim")&&!(k2._dragging||h.shiftKey||1!==h.which&&1!==h.button&&!h.touches)&&(k2._dragging=this,this._preventOutline&&g5(this._element),p5(),Gr(),!this._moving))){this.fire("down");var p=h.touches?h.touches[0]:h,x=v5(this._element);this._startPoint=new At(p.clientX,p.clientY),this._parentScale=y5(x),Wt(document,d1[h.type],this._onMove,this),Wt(document,Ss[h.type],this._onUp,this)}},_onMove:function(h){if(!h._simulated&&this._enabled){if(h.touches&&h.touches.length>1)return void(this._moved=!0);var p=h.touches&&1===h.touches.length?h.touches[0]:h,x=new At(p.clientX,p.clientY)._subtract(this._startPoint);!x.x&&!x.y||Math.abs(x.x)+Math.abs(x.y)<this.options.clickTolerance||(x.x/=this._parentScale.x,x.y/=this._parentScale.y,Di(h),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=bs(this._element).subtract(x),qe(document.body,"leaflet-dragging"),this._lastTarget=h.target||h.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),qe(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(x),this._moving=!0,Bn(this._animRequest),this._lastEvent=h,this._animRequest=Fn(this._updatePosition,this,!0))}},_updatePosition:function(){var h={originalEvent:this._lastEvent};this.fire("predrag",h),ln(this._element,this._newPos),this.fire("drag",h)},_onUp:function(h){h._simulated||!this._enabled||this.finishDrag()},finishDrag:function(){for(var h in H1(document.body,"leaflet-dragging"),this._lastTarget&&(H1(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),d1)Tt(document,d1[h],this._onMove,this),Tt(document,Ss[h],this._onUp,this);d2(),Tn(),this._moved&&this._moving&&(Bn(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,k2._dragging=!1}});function c3(h,p){if(!p||!h.length)return h.slice();var x=p*p;return function ar(h,p){var x=h.length,A=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(x);A[0]=A[x-1]=1,Cs(h,A,p,0,x-1);var R,Q=[];for(R=0;R<x;R++)A[R]&&Q.push(h[R]);return Q}(h=function k9(h,p){for(var x=[h[0]],w=1,A=0,R=h.length;w<R;w++)T5(h[w],h[A])>p&&(x.push(h[w]),A=w);return A<R-1&&x.push(h[R-1]),x}(h,x),x)}function l3(h,p,x){return Math.sqrt(Un(h,p,x,!0))}function Cs(h,p,x,w,A){var Q,de,me,R=0;for(de=w+1;de<=A-1;de++)(me=Un(h[de],h[w],h[A],!0))>R&&(Q=de,R=me);R>x&&(p[Q]=1,Cs(h,p,x,w,Q),Cs(h,p,x,Q,A))}function z5(h,p,x,w,A){var de,me,Ce,R=w?O1:Wr(h,x),Q=Wr(p,x);for(O1=Q;;){if(!(R|Q))return[h,p];if(R&Q)return!1;Ce=Wr(me=Do(h,p,de=R||Q,x,A),x),de===R?(h=me,R=Ce):(p=me,Q=Ce)}}function Do(h,p,x,w,A){var Ce,tt,R=p.x-h.x,Q=p.y-h.y,de=w.min,me=w.max;return 8&x?(Ce=h.x+R*(me.y-h.y)/Q,tt=me.y):4&x?(Ce=h.x+R*(de.y-h.y)/Q,tt=de.y):2&x?(Ce=me.x,tt=h.y+Q*(me.x-h.x)/R):1&x&&(Ce=de.x,tt=h.y+Q*(de.x-h.x)/R),new At(Ce,tt,A)}function Wr(h,p){var x=0;return h.x<p.min.x?x|=1:h.x>p.max.x&&(x|=2),h.y<p.min.y?x|=4:h.y>p.max.y&&(x|=8),x}function T5(h,p){var x=p.x-h.x,w=p.y-h.y;return x*x+w*w}function Un(h,p,x,w){var Ce,A=p.x,R=p.y,Q=x.x-A,de=x.y-R,me=Q*Q+de*de;return me>0&&((Ce=((h.x-A)*Q+(h.y-R)*de)/me)>1?(A=x.x,R=x.y):Ce>0&&(A+=Q*Ce,R+=de*Ce)),Q=h.x-A,de=h.y-R,w?Q*Q+de*de:new At(A,R)}function or(h){return!kn(h[0])||"object"!=typeof h[0][0]&&void 0!==h[0][0]}function y6(h){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),or(h)}var $1={simplify:c3,pointToSegmentDistance:l3,closestPointOnSegment:function E5(h,p,x){return Un(h,p,x)},clipSegment:z5,_getEdgeIntersection:Do,_getBitCode:Wr,_sqClosestPointOnSegment:Un,isFlat:or,_flat:y6};function ei(h,p,x){var w,R,Q,de,me,Ce,tt,pt,Pt,A=[1,4,2,8];for(R=0,tt=h.length;R<tt;R++)h[R]._code=Wr(h[R],p);for(de=0;de<4;de++){for(pt=A[de],w=[],R=0,Q=(tt=h.length)-1;R<tt;Q=R++)Ce=h[Q],(me=h[R])._code&pt?Ce._code&pt||((Pt=Do(Ce,me,pt,p,x))._code=Wr(Pt,p),w.push(Pt)):(Ce._code&pt&&((Pt=Do(Ce,me,pt,p,x))._code=Wr(Pt,p),w.push(Pt)),w.push(me));h=w}return h}var Gn={clipPolygon:ei},F2={project:function(h){return new At(h.lng,h.lat)},unproject:function(h){return new Dt(h.y,h.x)},bounds:new r1([-180,-90],[180,90])},cr={R:6378137,R_MINOR:6356752.314245179,bounds:new r1([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(h){var p=Math.PI/180,x=this.R,w=h.lat*p,A=this.R_MINOR/x,R=Math.sqrt(1-A*A),Q=R*Math.sin(w),de=Math.tan(Math.PI/4-w/2)/Math.pow((1-Q)/(1+Q),R/2);return w=-x*Math.log(Math.max(de,1e-10)),new At(h.lng*p*x,w)},unproject:function(h){for(var Ce,p=180/Math.PI,x=this.R,w=this.R_MINOR/x,A=Math.sqrt(1-w*w),R=Math.exp(-h.y/x),Q=Math.PI/2-2*Math.atan(R),de=0,me=.1;de<15&&Math.abs(me)>1e-7;de++)Ce=A*Math.sin(Q),Ce=Math.pow((1-Ce)/(1+Ce),A/2),Q+=me=Math.PI/2-2*Math.atan(R*Ce)-Q;return new Dt(Q*p,h.x*p/x)}},Zi={LonLat:F2,Mercator:cr,SphericalMercator:n5},h3=u1({},gs,{code:"EPSG:3395",projection:cr,transformation:function(){var h=.5/(Math.PI*cr.R);return e3(h,.5,-h,.5)}()}),u3=u1({},gs,{code:"EPSG:4326",projection:F2,transformation:e3(1/180,1,-1/180,.5)}),Po=u1({},o2,{projection:F2,transformation:e3(1,0,-1,0),scale:function(h){return Math.pow(2,h)},zoom:function(h){return Math.log(h)/Math.LN2},distance:function(h,p){var x=p.lng-h.lng,w=p.lat-h.lat;return Math.sqrt(x*x+w*w)},infinite:!0});o2.Earth=gs,o2.EPSG3395=h3,o2.EPSG3857=r5,o2.EPSG900913=_9,o2.EPSG4326=u3,o2.Simple=Po;var di=la.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(h){return h.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(h){return h&&h.removeLayer(this),this},getPane:function(h){return this._map.getPane(h?this.options[h]||h:this.options.pane)},addInteractiveTarget:function(h){return this._map._targets[i1(h)]=this,this},removeInteractiveTarget:function(h){return delete this._map._targets[i1(h)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(h){var p=h.target;if(p.hasLayer(this)){if(this._map=p,this._zoomAnimated=p._zoomAnimated,this.getEvents){var x=this.getEvents();p.on(x,this),this.once("remove",function(){p.off(x,this)},this)}this.onAdd(p),this.getAttribution&&p.attributionControl&&p.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),p.fire("layeradd",{layer:this})}}});It.include({addLayer:function(h){if(!h._layerAdd)throw new Error("The provided object is not a Layer.");var p=i1(h);return this._layers[p]||(this._layers[p]=h,h._mapToAdd=this,h.beforeAdd&&h.beforeAdd(this),this.whenReady(h._layerAdd,h)),this},removeLayer:function(h){var p=i1(h);return this._layers[p]?(this._loaded&&h.onRemove(this),h.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(h.getAttribution()),delete this._layers[p],this._loaded&&(this.fire("layerremove",{layer:h}),h.fire("remove")),h._map=h._mapToAdd=null,this):this},hasLayer:function(h){return!!h&&i1(h)in this._layers},eachLayer:function(h,p){for(var x in this._layers)h.call(p,this._layers[x]);return this},_addLayers:function(h){for(var p=0,x=(h=h?kn(h)?h:[h]:[]).length;p<x;p++)this.addLayer(h[p])},_addZoomLimit:function(h){(isNaN(h.options.maxZoom)||!isNaN(h.options.minZoom))&&(this._zoomBoundLayers[i1(h)]=h,this._updateZoomLevels())},_removeZoomLimit:function(h){var p=i1(h);this._zoomBoundLayers[p]&&(delete this._zoomBoundLayers[p],this._updateZoomLevels())},_updateZoomLevels:function(){var h=1/0,p=-1/0,x=this._getZoomSpan();for(var w in this._zoomBoundLayers){var A=this._zoomBoundLayers[w].options;h=void 0===A.minZoom?h:Math.min(h,A.minZoom),p=void 0===A.maxZoom?p:Math.max(p,A.maxZoom)}this._layersMaxZoom=p===-1/0?void 0:p,this._layersMinZoom=h===1/0?void 0:h,x!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var $i=di.extend({initialize:function(h,p){var x,w;if(R1(this,p),this._layers={},h)for(x=0,w=h.length;x<w;x++)this.addLayer(h[x])},addLayer:function(h){var p=this.getLayerId(h);return this._layers[p]=h,this._map&&this._map.addLayer(h),this},removeLayer:function(h){var p=h in this._layers?h:this.getLayerId(h);return this._map&&this._layers[p]&&this._map.removeLayer(this._layers[p]),delete this._layers[p],this},hasLayer:function(h){return!!h&&("number"==typeof h?h:this.getLayerId(h))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(h){var x,w,p=Array.prototype.slice.call(arguments,1);for(x in this._layers)(w=this._layers[x])[h]&&w[h].apply(w,p);return this},onAdd:function(h){this.eachLayer(h.addLayer,h)},onRemove:function(h){this.eachLayer(h.removeLayer,h)},eachLayer:function(h,p){for(var x in this._layers)h.call(p,this._layers[x]);return this},getLayer:function(h){return this._layers[h]},getLayers:function(){var h=[];return this.eachLayer(h.push,h),h},setZIndex:function(h){return this.invoke("setZIndex",h)},getLayerId:function(h){return i1(h)}}),ma=$i.extend({addLayer:function(h){return this.hasLayer(h)?this:(h.addEventParent(this),$i.prototype.addLayer.call(this,h),this.fire("layeradd",{layer:h}))},removeLayer:function(h){return this.hasLayer(h)?(h in this._layers&&(h=this._layers[h]),h.removeEventParent(this),$i.prototype.removeLayer.call(this,h),this.fire("layerremove",{layer:h})):this},setStyle:function(h){return this.invoke("setStyle",h)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var h=new Kn;for(var p in this._layers){var x=this._layers[p];h.extend(x.getBounds?x.getBounds():x.getLatLng())}return h}}),Xe=Fr.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(h){R1(this,h)},createIcon:function(h){return this._createIcon("icon",h)},createShadow:function(h){return this._createIcon("shadow",h)},_createIcon:function(h,p){var x=this._getIconUrl(h);if(!x){if("icon"===h)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var w=this._createImg(x,p&&"IMG"===p.tagName?p:null);return this._setIconStyles(w,h),w},_setIconStyles:function(h,p){var x=this.options,w=x[p+"Size"];"number"==typeof w&&(w=[w,w]);var A=n1(w),R=n1("shadow"===p&&x.shadowAnchor||x.iconAnchor||A&&A.divideBy(2,!0));h.className="leaflet-marker-"+p+" "+(x.className||""),R&&(h.style.marginLeft=-R.x+"px",h.style.marginTop=-R.y+"px"),A&&(h.style.width=A.x+"px",h.style.height=A.y+"px")},_createImg:function(h,p){return(p=p||document.createElement("img")).src=h,p},_getIconUrl:function(h){return Br&&this.options[h+"RetinaUrl"]||this.options[h+"Url"]}});var g1=Xe.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(h){return g1.imagePath||(g1.imagePath=this._detectIconPath()),(this.options.imagePath||g1.imagePath)+Xe.prototype._getIconUrl.call(this,h)},_detectIconPath:function(){var h=dt("div","leaflet-default-icon-path",document.body),p=xs(h,"background-image")||xs(h,"backgroundImage");return document.body.removeChild(h),null===p||0!==p.indexOf("url")?"":p.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),pi=Ut.extend({initialize:function(h){this._marker=h},addHooks:function(){var h=this._marker._icon;this._draggable||(this._draggable=new k2(h,h,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),qe(h,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&H1(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(h){var p=this._marker,x=p._map,w=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,R=bs(p._icon),Q=x.getPixelBounds(),de=x.getPixelOrigin(),me=Wi(Q.min._subtract(de).add(A),Q.max._subtract(de).subtract(A));if(!me.contains(R)){var Ce=n1((Math.max(me.max.x,R.x)-me.max.x)/(Q.max.x-me.max.x)-(Math.min(me.min.x,R.x)-me.min.x)/(Q.min.x-me.min.x),(Math.max(me.max.y,R.y)-me.max.y)/(Q.max.y-me.max.y)-(Math.min(me.min.y,R.y)-me.min.y)/(Q.min.y-me.min.y)).multiplyBy(w);x.panBy(Ce,{animate:!1}),this._draggable._newPos._add(Ce),this._draggable._startPos._add(Ce),ln(p._icon,this._draggable._newPos),this._onDrag(h),this._panRequest=Fn(this._adjustPan.bind(this,h))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(h){this._marker.options.autoPan&&(Bn(this._panRequest),this._panRequest=Fn(this._adjustPan.bind(this,h)))},_onDrag:function(h){var p=this._marker,x=p._shadow,w=bs(p._icon),A=p._map.layerPointToLatLng(w);x&&ln(x,w),p._latlng=A,h.latlng=A,h.oldLatLng=this._oldLatLng,p.fire("move",h).fire("drag",h)},_onDragEnd:function(h){Bn(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",h)}}),B2=di.extend({options:{icon:new g1,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(h,p){R1(this,p),this._latlng=Et(h)},onAdd:function(h){this._zoomAnimated=this._zoomAnimated&&h.options.markerZoomAnimation,this._zoomAnimated&&h.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(h){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&h.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(h){var p=this._latlng;return this._latlng=Et(h),this.update(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},setZIndexOffset:function(h){return this.options.zIndexOffset=h,this.update()},getIcon:function(){return this.options.icon},setIcon:function(h){return this.options.icon=h,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var h=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(h)}return this},_initIcon:function(){var h=this.options,p="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),x=h.icon.createIcon(this._icon),w=!1;x!==this._icon&&(this._icon&&this._removeIcon(),w=!0,h.title&&(x.title=h.title),"IMG"===x.tagName&&(x.alt=h.alt||"")),qe(x,p),h.keyboard&&(x.tabIndex="0"),this._icon=x,h.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var A=h.icon.createShadow(this._shadow),R=!1;A!==this._shadow&&(this._removeShadow(),R=!0),A&&(qe(A,p),A.alt=""),this._shadow=A,h.opacity<1&&this._updateOpacity(),w&&this.getPane().appendChild(this._icon),this._initInteraction(),A&&R&&this.getPane(h.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),C1(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&C1(this._shadow),this._shadow=null},_setPos:function(h){this._icon&&ln(this._icon,h),this._shadow&&ln(this._shadow,h),this._zIndex=h.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(h){this._icon&&(this._icon.style.zIndex=this._zIndex+h)},_animateZoom:function(h){var p=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center).round();this._setPos(p)},_initInteraction:function(){if(this.options.interactive&&(qe(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),pi)){var h=this.options.draggable;this.dragging&&(h=this.dragging.enabled(),this.dragging.disable()),this.dragging=new pi(this),h&&this.dragging.enable()}},setOpacity:function(h){return this.options.opacity=h,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var h=this.options.opacity;this._icon&&fi(this._icon,h),this._shadow&&fi(this._shadow,h)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var mi=di.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(h){this._renderer=h.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(h){return R1(this,h),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&h&&Object.prototype.hasOwnProperty.call(h,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),T1=mi.extend({options:{fill:!0,radius:10},initialize:function(h,p){R1(this,p),this._latlng=Et(h),this._radius=this.options.radius},setLatLng:function(h){var p=this._latlng;return this._latlng=Et(h),this.redraw(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(h){return this.options.radius=this._radius=h,this.redraw()},getRadius:function(){return this._radius},setStyle:function(h){var p=h&&h.radius||this._radius;return mi.prototype.setStyle.call(this,h),this.setRadius(p),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var h=this._radius,p=this._radiusY||h,x=this._clickTolerance(),w=[h+x,p+x];this._pxBounds=new r1(this._point.subtract(w),this._point.add(w))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(h){return h.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var jr=T1.extend({initialize:function(h,p,x){if("number"==typeof p&&(p=u1({},x,{radius:p})),R1(this,p),this._latlng=Et(h),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(h){return this._mRadius=h,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var h=[this._radius,this._radiusY||this._radius];return new Kn(this._map.layerPointToLatLng(this._point.subtract(h)),this._map.layerPointToLatLng(this._point.add(h)))},setStyle:mi.prototype.setStyle,_project:function(){var h=this._latlng.lng,p=this._latlng.lat,x=this._map,w=x.options.crs;if(w.distance===gs.distance){var A=Math.PI/180,R=this._mRadius/gs.R/A,Q=x.project([p+R,h]),de=x.project([p-R,h]),me=Q.add(de).divideBy(2),Ce=x.unproject(me).lat,tt=Math.acos((Math.cos(R*A)-Math.sin(p*A)*Math.sin(Ce*A))/(Math.cos(p*A)*Math.cos(Ce*A)))/A;(isNaN(tt)||0===tt)&&(tt=R/Math.cos(Math.PI/180*p)),this._point=me.subtract(x.getPixelOrigin()),this._radius=isNaN(tt)?0:me.x-x.project([Ce,h-tt]).x,this._radiusY=me.y-Q.y}else{var pt=w.unproject(w.project(this._latlng).subtract([this._mRadius,0]));this._point=x.latLngToLayerPoint(this._latlng),this._radius=this._point.x-x.latLngToLayerPoint(pt).x}this._updateBounds()}});var Yi=mi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(h,p){R1(this,p),this._setLatLngs(h)},getLatLngs:function(){return this._latlngs},setLatLngs:function(h){return this._setLatLngs(h),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(h){for(var A,R,p=1/0,x=null,w=Un,Q=0,de=this._parts.length;Q<de;Q++)for(var me=this._parts[Q],Ce=1,tt=me.length;Ce<tt;Ce++){var pt=w(h,A=me[Ce-1],R=me[Ce],!0);pt<p&&(p=pt,x=w(h,A,R))}return x&&(x.distance=Math.sqrt(p)),x},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var h,p,x,w,A,R,Q,de=this._rings[0],me=de.length;if(!me)return null;for(h=0,p=0;h<me-1;h++)p+=de[h].distanceTo(de[h+1])/2;if(0===p)return this._map.layerPointToLatLng(de[0]);for(h=0,w=0;h<me-1;h++)if((w+=x=(A=de[h]).distanceTo(R=de[h+1]))>p)return this._map.layerPointToLatLng([R.x-(Q=(w-p)/x)*(R.x-A.x),R.y-Q*(R.y-A.y)])},getBounds:function(){return this._bounds},addLatLng:function(h,p){return p=p||this._defaultShape(),h=Et(h),p.push(h),this._bounds.extend(h),this.redraw()},_setLatLngs:function(h){this._bounds=new Kn,this._latlngs=this._convertLatLngs(h)},_defaultShape:function(){return or(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(h){for(var p=[],x=or(h),w=0,A=h.length;w<A;w++)x?(p[w]=Et(h[w]),this._bounds.extend(p[w])):p[w]=this._convertLatLngs(h[w]);return p},_project:function(){var h=new r1;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,h),this._bounds.isValid()&&h.isValid()&&(this._rawPxBounds=h,this._updateBounds())},_updateBounds:function(){var h=this._clickTolerance(),p=new At(h,h);this._pxBounds=new r1([this._rawPxBounds.min.subtract(p),this._rawPxBounds.max.add(p)])},_projectLatlngs:function(h,p,x){var R,Q,A=h.length;if(h[0]instanceof Dt){for(Q=[],R=0;R<A;R++)Q[R]=this._map.latLngToLayerPoint(h[R]),x.extend(Q[R]);p.push(Q)}else for(R=0;R<A;R++)this._projectLatlngs(h[R],p,x)},_clipPoints:function(){var h=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(h)){if(this.options.noClip)return void(this._parts=this._rings);var x,w,A,R,Q,de,me,p=this._parts;for(x=0,A=0,R=this._rings.length;x<R;x++)for(w=0,Q=(me=this._rings[x]).length;w<Q-1;w++)(de=z5(me[w],me[w+1],h,w,!0))&&(p[A]=p[A]||[],p[A].push(de[0]),(de[1]!==me[w+1]||w===Q-2)&&(p[A].push(de[1]),A++))}},_simplifyPoints:function(){for(var h=this._parts,p=this.options.smoothFactor,x=0,w=h.length;x<w;x++)h[x]=c3(h[x],p)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(h,p){var x,w,A,R,Q,de,me=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(h))return!1;for(x=0,R=this._parts.length;x<R;x++)for(w=0,A=(Q=(de=this._parts[x]).length)-1;w<Q;A=w++)if((p||0!==w)&&l3(h,de[A],de[w])<=me)return!0;return!1}});Yi._flat=y6;var qr=Yi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var h,p,x,w,A,R,Q,de,Ce=this._rings[0],tt=Ce.length;if(!tt)return null;for(R=Q=de=0,h=0,p=tt-1;h<tt;p=h++)Q+=((x=Ce[h]).x+(w=Ce[p]).x)*(A=x.y*w.x-w.y*x.x),de+=(x.y+w.y)*A,R+=3*A;return this._map.layerPointToLatLng(0===R?Ce[0]:[Q/R,de/R])},_convertLatLngs:function(h){var p=Yi.prototype._convertLatLngs.call(this,h),x=p.length;return x>=2&&p[0]instanceof Dt&&p[0].equals(p[x-1])&&p.pop(),p},_setLatLngs:function(h){Yi.prototype._setLatLngs.call(this,h),or(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return or(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var h=this._renderer._bounds,p=this.options.weight,x=new At(p,p);if(h=new r1(h.min.subtract(x),h.max.add(x)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(h)){if(this.options.noClip)return void(this._parts=this._rings);for(var R,w=0,A=this._rings.length;w<A;w++)(R=ei(this._rings[w],h,!0)).length&&this._parts.push(R)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(h){var x,w,A,R,Q,de,me,Ce,p=!1;if(!this._pxBounds||!this._pxBounds.contains(h))return!1;for(R=0,me=this._parts.length;R<me;R++)for(Q=0,de=(Ce=(x=this._parts[R]).length)-1;Q<Ce;de=Q++)(w=x[Q]).y>h.y!=(A=x[de]).y>h.y&&h.x<(A.x-w.x)*(h.y-w.y)/(A.y-w.y)+w.x&&(p=!p);return p||Yi.prototype._containsPoint.call(this,h,!0)}});var k1=ma.extend({initialize:function(h,p){R1(this,p),this._layers={},h&&this.addData(h)},addData:function(h){var x,w,A,p=kn(h)?h:h.features;if(p){for(x=0,w=p.length;x<w;x++)((A=p[x]).geometries||A.geometry||A.features||A.coordinates)&&this.addData(A);return this}var R=this.options;if(R.filter&&!R.filter(h))return this;var Q=Es(h,R);return Q?(Q.feature=gi(h),Q.defaultOptions=Q.options,this.resetStyle(Q),R.onEachFeature&&R.onEachFeature(h,Q),this.addLayer(Q)):this},resetStyle:function(h){return void 0===h?this.eachLayer(this.resetStyle,this):(h.options=u1({},h.defaultOptions),this._setLayerStyle(h,this.options.style),this)},setStyle:function(h){return this.eachLayer(function(p){this._setLayerStyle(p,h)},this)},_setLayerStyle:function(h,p){h.setStyle&&("function"==typeof p&&(p=p(h.feature)),h.setStyle(p))}});function Es(h,p){var de,me,Ce,tt,x="Feature"===h.type?h.geometry:h,w=x?x.coordinates:null,A=[],R=p&&p.pointToLayer,Q=p&&p.coordsToLatLng||Pi;if(!w&&!x)return null;switch(x.type){case"Point":return zs(R,h,de=Q(w),p);case"MultiPoint":for(Ce=0,tt=w.length;Ce<tt;Ce++)de=Q(w[Ce]),A.push(zs(R,h,de,p));return new ma(A);case"LineString":case"MultiLineString":return me=p1(w,"LineString"===x.type?0:1,Q),new Yi(me,p);case"Polygon":case"MultiPolygon":return me=p1(w,"Polygon"===x.type?1:2,Q),new qr(me,p);case"GeometryCollection":for(Ce=0,tt=x.geometries.length;Ce<tt;Ce++){var pt=Es({geometry:x.geometries[Ce],type:"Feature",properties:h.properties},p);pt&&A.push(pt)}return new ma(A);default:throw new Error("Invalid GeoJSON object.")}}function zs(h,p,x,w){return h?h(p,x):new B2(x,w&&w.markersInheritOptions&&w)}function Pi(h){return new Dt(h[1],h[0],h[2])}function p1(h,p,x){for(var Q,w=[],A=0,R=h.length;A<R;A++)Q=p?p1(h[A],p-1,x):(x||Pi)(h[A]),w.push(Q);return w}function _6(h,p){return p="number"==typeof p?p:6,void 0!==h.alt?[Ai(h.lng,p),Ai(h.lat,p),Ai(h.alt,p)]:[Ai(h.lng,p),Ai(h.lat,p)]}function f3(h,p,x,w){for(var A=[],R=0,Q=h.length;R<Q;R++)A.push(p?f3(h[R],p-1,x,w):_6(h[R],w));return!p&&x&&A.push(A[0]),A}function ti(h,p){return h.feature?u1({},h.feature,{geometry:p}):gi(p)}function gi(h){return"Feature"===h.type||"FeatureCollection"===h.type?h:{type:"Feature",properties:{},geometry:h}}var Ro={toGeoJSON:function(h){return ti(this,{type:"Point",coordinates:_6(this.getLatLng(),h)})}};function Ho(h,p){return new k1(h,p)}B2.include(Ro),jr.include(Ro),T1.include(Ro),Yi.include({toGeoJSON:function(h){var p=!or(this._latlngs);return ti(this,{type:(p?"Multi":"")+"LineString",coordinates:f3(this._latlngs,p?1:0,!1,h)})}}),qr.include({toGeoJSON:function(h){var p=!or(this._latlngs),x=p&&!or(this._latlngs[0]),w=f3(this._latlngs,x?2:p?1:0,!0,h);return p||(w=[w]),ti(this,{type:(x?"Multi":"")+"Polygon",coordinates:w})}}),$i.include({toMultiPoint:function(h){var p=[];return this.eachLayer(function(x){p.push(x.toGeoJSON(h).geometry.coordinates)}),ti(this,{type:"MultiPoint",coordinates:p})},toGeoJSON:function(h){var p=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===p)return this.toMultiPoint(h);var x="GeometryCollection"===p,w=[];return this.eachLayer(function(A){if(A.toGeoJSON){var R=A.toGeoJSON(h);if(x)w.push(R.geometry);else{var Q=gi(R);"FeatureCollection"===Q.type?w.push.apply(w,Q.features):w.push(Q)}}}),x?ti(this,{geometries:w,type:"GeometryCollection"}):{type:"FeatureCollection",features:w}}});var d3=Ho,vi=di.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(h,p,x){this._url=h,this._bounds=Yt(p),R1(this,x)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(qe(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){C1(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(h){return this.options.opacity=h,this._image&&this._updateOpacity(),this},setStyle:function(h){return h.opacity&&this.setOpacity(h.opacity),this},bringToFront:function(){return this._map&&Ur(this._image),this},bringToBack:function(){return this._map&&da(this._image),this},setUrl:function(h){return this._url=h,this._image&&(this._image.src=h),this},setBounds:function(h){return this._bounds=Yt(h),this._map&&this._reset(),this},getEvents:function(){var h={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},setZIndex:function(h){return this.options.zIndex=h,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var h="IMG"===this._url.tagName,p=this._image=h?this._url:dt("img");qe(p,"leaflet-image-layer"),this._zoomAnimated&&qe(p,"leaflet-zoom-animated"),this.options.className&&qe(p,this.options.className),p.onselectstart=M1,p.onmousemove=M1,p.onload=f1(this.fire,this,"load"),p.onerror=f1(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(p.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),h?this._url=p.src:(p.src=this._url,p.alt=this.options.alt)},_animateZoom:function(h){var p=this._map.getZoomScale(h.zoom),x=this._map._latLngBoundsToNewLayerBounds(this._bounds,h.zoom,h.center).min;Ms(this._image,x,p)},_reset:function(){var h=this._image,p=new r1(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),x=p.getSize();ln(h,p.min),h.style.width=x.x+"px",h.style.height=x.y+"px"},_updateOpacity:function(){fi(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&null!=this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var h=this.options.errorOverlayUrl;h&&this._url!==h&&(this._url=h,this._image.src=h)}}),B9=vi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var h="VIDEO"===this._url.tagName,p=this._image=h?this._url:dt("video");if(qe(p,"leaflet-image-layer"),this._zoomAnimated&&qe(p,"leaflet-zoom-animated"),this.options.className&&qe(p,this.options.className),p.onselectstart=M1,p.onmousemove=M1,p.onloadeddata=f1(this.fire,this,"load"),h){for(var x=p.getElementsByTagName("source"),w=[],A=0;A<x.length;A++)w.push(x[A].src);this._url=x.length>0?w:[p.src]}else{kn(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(p.style,"objectFit")&&(p.style.objectFit="fill"),p.autoplay=!!this.options.autoplay,p.loop=!!this.options.loop,p.muted=!!this.options.muted;for(var R=0;R<this._url.length;R++){var Q=dt("source");Q.src=this._url[R],p.appendChild(Q)}}}});var A5=vi.extend({_initImage:function(){var h=this._image=this._url;qe(h,"leaflet-image-layer"),this._zoomAnimated&&qe(h,"leaflet-zoom-animated"),this.options.className&&qe(h,this.options.className),h.onselectstart=M1,h.onmousemove=M1}});var Zr=di.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(h,p){R1(this,h),this._source=p},onAdd:function(h){this._zoomAnimated=h._zoomAnimated,this._container||this._initLayout(),h._fadeAnimated&&fi(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),h._fadeAnimated&&fi(this._container,1),this.bringToFront()},onRemove:function(h){h._fadeAnimated?(fi(this._container,0),this._removeTimeout=setTimeout(f1(C1,void 0,this._container),200)):C1(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(h){return this._latlng=Et(h),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(h){return this._content=h,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var h={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ur(this._container),this},bringToBack:function(){return this._map&&da(this._container),this},_prepareOpen:function(h,p,x){if(p instanceof di||(x=p,p=h),p instanceof ma)for(var w in h._layers){p=h._layers[w];break}if(!x)if(p.getCenter)x=p.getCenter();else{if(!p.getLatLng)throw new Error("Unable to get source layer LatLng.");x=p.getLatLng()}return this._source=p,this.update(),x},_updateContent:function(){if(this._content){var h=this._contentNode,p="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof p)h.innerHTML=p;else{for(;h.hasChildNodes();)h.removeChild(h.firstChild);h.appendChild(p)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var h=this._map.latLngToLayerPoint(this._latlng),p=n1(this.options.offset),x=this._getAnchor();this._zoomAnimated?ln(this._container,h.add(x)):p=p.add(h).add(x);var w=this._containerBottom=-p.y,A=this._containerLeft=-Math.round(this._containerWidth/2)+p.x;this._container.style.bottom=w+"px",this._container.style.left=A+"px"}},_getAnchor:function(){return[0,0]}}),Io=Zr.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(h){return h.openPopup(this),this},onAdd:function(h){Zr.prototype.onAdd.call(this,h),h.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof mi||this._source.on("preclick",pa))},onRemove:function(h){Zr.prototype.onRemove.call(this,h),h.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof mi||this._source.off("preclick",pa))},getEvents:function(){var h=Zr.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(h.preclick=this._close),this.options.keepInView&&(h.moveend=this._adjustPan),h},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var h="leaflet-popup",p=this._container=dt("div",h+" "+(this.options.className||"")+" leaflet-zoom-animated"),x=this._wrapper=dt("div",h+"-content-wrapper",p);if(this._contentNode=dt("div",h+"-content",x),ws(p),Qn(this._contentNode),Wt(p,"contextmenu",pa),this._tipContainer=dt("div",h+"-tip-container",p),this._tip=dt("div",h+"-tip",this._tipContainer),this.options.closeButton){var w=this._closeButton=dt("a",h+"-close-button",p);w.href="#close",w.innerHTML="&#215;",Wt(w,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var h=this._contentNode,p=h.style;p.width="",p.whiteSpace="nowrap";var x=h.offsetWidth;x=Math.min(x,this.options.maxWidth),x=Math.max(x,this.options.minWidth),p.width=x+1+"px",p.whiteSpace="",p.height="";var A=this.options.maxHeight,R="leaflet-popup-scrolled";A&&h.offsetHeight>A?(p.height=A+"px",qe(h,R)):H1(h,R),this._containerWidth=this._container.offsetWidth},_animateZoom:function(h){var p=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center),x=this._getAnchor();ln(this._container,p.add(x))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var h=this._map,p=parseInt(xs(this._container,"marginBottom"),10)||0,x=this._container.offsetHeight+p,w=this._containerWidth,A=new At(this._containerLeft,-x-this._containerBottom);A._add(bs(this._container));var R=h.layerPointToContainerPoint(A),Q=n1(this.options.autoPanPadding),de=n1(this.options.autoPanPaddingTopLeft||Q),me=n1(this.options.autoPanPaddingBottomRight||Q),Ce=h.getSize(),tt=0,pt=0;R.x+w+me.x>Ce.x&&(tt=R.x+w-Ce.x+me.x),R.x-tt-de.x<0&&(tt=R.x-de.x),R.y+x+me.y>Ce.y&&(pt=R.y+x-Ce.y+me.y),R.y-pt-de.y<0&&(pt=R.y-de.y),(tt||pt)&&h.fire("autopanstart").panBy([tt,pt])}},_onCloseButtonClick:function(h){this._close(),sr(h)},_getAnchor:function(){return n1(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});It.mergeOptions({closePopupOnClick:!0}),It.include({openPopup:function(h,p,x){return h instanceof Io||(h=new Io(x).setContent(h)),p&&h.setLatLng(p),this.hasLayer(h)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=h,this.addLayer(h))},closePopup:function(h){return(!h||h===this._popup)&&(h=this._popup,this._popup=null),h&&this.removeLayer(h),this}}),di.include({bindPopup:function(h,p){return h instanceof Io?(R1(h,p),this._popup=h,h._source=this):((!this._popup||p)&&(this._popup=new Io(p,this)),this._popup.setContent(h)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(h,p){return this._popup&&this._map&&(p=this._popup._prepareOpen(this,h,p),this._map.openPopup(this._popup,p)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(h){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(h)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(h){return this._popup&&this._popup.setContent(h),this},getPopup:function(){return this._popup},_openPopup:function(h){var p=h.layer||h.target;if(this._popup&&this._map){if(sr(h),p instanceof mi)return void this.openPopup(h.layer||h.target,h.latlng);this._map.hasLayer(this._popup)&&this._popup._source===p?this.closePopup():this.openPopup(p,h.latlng)}},_movePopup:function(h){this._popup.setLatLng(h.latlng)},_onKeyPress:function(h){13===h.originalEvent.keyCode&&this._openPopup(h)}});var Vo=Zr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(h){Zr.prototype.onAdd.call(this,h),this.setOpacity(this.options.opacity),h.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(h){Zr.prototype.onRemove.call(this,h),h.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var h=Zr.prototype.getEvents.call(this);return h2&&!this.options.permanent&&(h.preclick=this._close),h},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=dt("div","leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(h){var p,x,w=this._map,A=this._container,R=w.latLngToContainerPoint(w.getCenter()),Q=w.layerPointToContainerPoint(h),de=this.options.direction,me=A.offsetWidth,Ce=A.offsetHeight,tt=n1(this.options.offset),pt=this._getAnchor();"top"===de?(p=me/2,x=Ce):"bottom"===de?(p=me/2,x=0):"center"===de?(p=me/2,x=Ce/2):"right"===de?(p=0,x=Ce/2):"left"===de?(p=me,x=Ce/2):Q.x<R.x?(de="right",p=0,x=Ce/2):(de="left",p=me+2*(tt.x+pt.x),x=Ce/2),h=h.subtract(n1(p,x,!0)).add(tt).add(pt),H1(A,"leaflet-tooltip-right"),H1(A,"leaflet-tooltip-left"),H1(A,"leaflet-tooltip-top"),H1(A,"leaflet-tooltip-bottom"),qe(A,"leaflet-tooltip-"+de),ln(A,h)},_updatePosition:function(){var h=this._map.latLngToLayerPoint(this._latlng);this._setPosition(h)},setOpacity:function(h){this.options.opacity=h,this._container&&fi(this._container,h)},_animateZoom:function(h){var p=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center);this._setPosition(p)},_getAnchor:function(){return n1(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});It.include({openTooltip:function(h,p,x){return h instanceof Vo||(h=new Vo(x).setContent(h)),p&&h.setLatLng(p),this.hasLayer(h)?this:this.addLayer(h)},closeTooltip:function(h){return h&&this.removeLayer(h),this}}),di.include({bindTooltip:function(h,p){return h instanceof Vo?(R1(h,p),this._tooltip=h,h._source=this):((!this._tooltip||p)&&(this._tooltip=new Vo(p,this)),this._tooltip.setContent(h)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(h){if(h||!this._tooltipHandlersAdded){var p=h?"off":"on",x={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?x.add=this._openTooltip:(x.mouseover=this._openTooltip,x.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(x.mousemove=this._moveTooltip),h2&&(x.click=this._openTooltip)),this[p](x),this._tooltipHandlersAdded=!h}},openTooltip:function(h,p){return this._tooltip&&this._map&&(p=this._tooltip._prepareOpen(this,h,p),this._map.openTooltip(this._tooltip,p),this._tooltip.options.interactive&&this._tooltip._container&&(qe(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(H1(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(h){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(h)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(h){return this._tooltip&&this._tooltip.setContent(h),this},getTooltip:function(){return this._tooltip},_openTooltip:function(h){!this._tooltip||!this._map||this.openTooltip(h.layer||h.target,this._tooltip.options.sticky?h.latlng:void 0)},_moveTooltip:function(h){var x,w,p=h.latlng;this._tooltip.options.sticky&&h.originalEvent&&(x=this._map.mouseEventToContainerPoint(h.originalEvent),w=this._map.containerPointToLayerPoint(x),p=this._map.layerPointToLatLng(w)),this._tooltip.setLatLng(p)}});var G9=Xe.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(h){var p=h&&"DIV"===h.tagName?h:document.createElement("div"),x=this.options;if(x.html instanceof Element?(s1(p),p.appendChild(x.html)):p.innerHTML=!1!==x.html?x.html:"",x.bgPos){var w=n1(x.bgPos);p.style.backgroundPosition=-w.x+"px "+-w.y+"px"}return this._setIconStyles(p,"icon"),p},createShadow:function(){return null}});Xe.Default=g1;var p3=di.extend({options:{tileSize:256,opacity:1,updateWhenIdle:vs,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(h){R1(this,h)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(h){h._addZoomLimit(this)},onRemove:function(h){this._removeAllTiles(),C1(this._container),h._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ur(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(da(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(h){return this.options.opacity=h,this._updateOpacity(),this},setZIndex:function(h){return this.options.zIndex=h,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var h={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=t6(this._onMoveEnd,this.options.updateInterval,this)),h.move=this._onMove),this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},createTile:function(){return document.createElement("div")},getTileSize:function(){var h=this.options.tileSize;return h instanceof At?h:new At(h,h)},_updateZIndex:function(){this._container&&null!=this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(h){for(var R,p=this.getPane().children,x=-h(-1/0,1/0),w=0,A=p.length;w<A;w++)R=p[w].style.zIndex,p[w]!==this._container&&R&&(x=h(x,+R));isFinite(x)&&(this.options.zIndex=x+h(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!ha){fi(this._container,this.options.opacity);var h=+new Date,p=!1,x=!1;for(var w in this._tiles){var A=this._tiles[w];if(A.current&&A.loaded){var R=Math.min(1,(h-A.loaded)/200);fi(A.el,R),R<1?p=!0:(A.active?x=!0:this._onOpaqueTile(A),A.active=!0)}}x&&!this._noPrune&&this._pruneTiles(),p&&(Bn(this._fadeFrame),this._fadeFrame=Fn(this._updateOpacity,this))}},_onOpaqueTile:M1,_initContainer:function(){this._container||(this._container=dt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var h=this._tileZoom,p=this.options.maxZoom;if(void 0!==h){for(var x in this._levels)x=Number(x),this._levels[x].el.children.length||x===h?(this._levels[x].el.style.zIndex=p-Math.abs(h-x),this._onUpdateLevel(x)):(C1(this._levels[x].el),this._removeTilesAtZoom(x),this._onRemoveLevel(x),delete this._levels[x]);var w=this._levels[h],A=this._map;return w||((w=this._levels[h]={}).el=dt("div","leaflet-tile-container leaflet-zoom-animated",this._container),w.el.style.zIndex=p,w.origin=A.project(A.unproject(A.getPixelOrigin()),h).round(),w.zoom=h,this._setZoomTransform(w,A.getCenter(),A.getZoom()),this._onCreateLevel(w)),this._level=w,w}},_onUpdateLevel:M1,_onRemoveLevel:M1,_onCreateLevel:M1,_pruneTiles:function(){if(this._map){var h,p,x=this._map.getZoom();if(x>this.options.maxZoom||x<this.options.minZoom)return void this._removeAllTiles();for(h in this._tiles)(p=this._tiles[h]).retain=p.current;for(h in this._tiles)if((p=this._tiles[h]).current&&!p.active){var w=p.coords;this._retainParent(w.x,w.y,w.z,w.z-5)||this._retainChildren(w.x,w.y,w.z,w.z+2)}for(h in this._tiles)this._tiles[h].retain||this._removeTile(h)}},_removeTilesAtZoom:function(h){for(var p in this._tiles)this._tiles[p].coords.z===h&&this._removeTile(p)},_removeAllTiles:function(){for(var h in this._tiles)this._removeTile(h)},_invalidateAll:function(){for(var h in this._levels)C1(this._levels[h].el),this._onRemoveLevel(Number(h)),delete this._levels[h];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(h,p,x,w){var A=Math.floor(h/2),R=Math.floor(p/2),Q=x-1,de=new At(+A,+R);de.z=+Q;var me=this._tileCoordsToKey(de),Ce=this._tiles[me];return Ce&&Ce.active?(Ce.retain=!0,!0):(Ce&&Ce.loaded&&(Ce.retain=!0),Q>w&&this._retainParent(A,R,Q,w))},_retainChildren:function(h,p,x,w){for(var A=2*h;A<2*h+2;A++)for(var R=2*p;R<2*p+2;R++){var Q=new At(A,R);Q.z=x+1;var de=this._tileCoordsToKey(Q),me=this._tiles[de];me&&me.active?me.retain=!0:(me&&me.loaded&&(me.retain=!0),x+1<w&&this._retainChildren(A,R,x+1,w))}},_resetView:function(h){var p=h&&(h.pinch||h.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),p,p)},_animateZoom:function(h){this._setView(h.center,h.zoom,!0,h.noUpdate)},_clampZoom:function(h){var p=this.options;return void 0!==p.minNativeZoom&&h<p.minNativeZoom?p.minNativeZoom:void 0!==p.maxNativeZoom&&p.maxNativeZoom<h?p.maxNativeZoom:h},_setView:function(h,p,x,w){var A=Math.round(p);A=void 0!==this.options.maxZoom&&A>this.options.maxZoom||void 0!==this.options.minZoom&&A<this.options.minZoom?void 0:this._clampZoom(A),(!w||this.options.updateWhenZooming&&A!==this._tileZoom)&&(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==A&&this._update(h),x||this._pruneTiles(),this._noPrune=!!x),this._setZoomTransforms(h,p)},_setZoomTransforms:function(h,p){for(var x in this._levels)this._setZoomTransform(this._levels[x],h,p)},_setZoomTransform:function(h,p,x){var w=this._map.getZoomScale(x,h.zoom),A=h.origin.multiplyBy(w).subtract(this._map._getNewPixelOrigin(p,x)).round();Li?Ms(h.el,A,w):ln(h.el,A)},_resetGrid:function(){var h=this._map,p=h.options.crs,x=this._tileSize=this.getTileSize(),w=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=p.wrapLng&&!this.options.noWrap&&[Math.floor(h.project([0,p.wrapLng[0]],w).x/x.x),Math.ceil(h.project([0,p.wrapLng[1]],w).x/x.y)],this._wrapY=p.wrapLat&&!this.options.noWrap&&[Math.floor(h.project([p.wrapLat[0],0],w).y/x.x),Math.ceil(h.project([p.wrapLat[1],0],w).y/x.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(h){var p=this._map,x=p._animatingZoom?Math.max(p._animateToZoom,p.getZoom()):p.getZoom(),w=p.getZoomScale(x,this._tileZoom),A=p.project(h,this._tileZoom).floor(),R=p.getSize().divideBy(2*w);return new r1(A.subtract(R),A.add(R))},_update:function(h){var p=this._map;if(p){var x=this._clampZoom(p.getZoom());if(void 0===h&&(h=p.getCenter()),void 0!==this._tileZoom){var w=this._getTiledPixelBounds(h),A=this._pxBoundsToTileRange(w),R=A.getCenter(),Q=[],de=this.options.keepBuffer,me=new r1(A.getBottomLeft().subtract([de,-de]),A.getTopRight().add([de,-de]));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ce in this._tiles){var tt=this._tiles[Ce].coords;(tt.z!==this._tileZoom||!me.contains(new At(tt.x,tt.y)))&&(this._tiles[Ce].current=!1)}if(Math.abs(x-this._tileZoom)>1)return void this._setView(h,x);for(var pt=A.min.y;pt<=A.max.y;pt++)for(var Pt=A.min.x;Pt<=A.max.x;Pt++){var lr=new At(Pt,pt);if(lr.z=this._tileZoom,this._isValidTile(lr)){var hr=this._tiles[this._tileCoordsToKey(lr)];hr?hr.current=!0:Q.push(lr)}}if(Q.sort(function(nn,y3){return nn.distanceTo(R)-y3.distanceTo(R)}),0!==Q.length){this._loading||(this._loading=!0,this.fire("loading"));var ur=document.createDocumentFragment();for(Pt=0;Pt<Q.length;Pt++)this._addTile(Q[Pt],ur);this._level.el.appendChild(ur)}}}},_isValidTile:function(h){var p=this._map.options.crs;if(!p.infinite){var x=this._globalTileRange;if(!p.wrapLng&&(h.x<x.min.x||h.x>x.max.x)||!p.wrapLat&&(h.y<x.min.y||h.y>x.max.y))return!1}if(!this.options.bounds)return!0;var w=this._tileCoordsToBounds(h);return Yt(this.options.bounds).overlaps(w)},_keyToBounds:function(h){return this._tileCoordsToBounds(this._keyToTileCoords(h))},_tileCoordsToNwSe:function(h){var p=this._map,x=this.getTileSize(),w=h.scaleBy(x),A=w.add(x);return[p.unproject(w,h.z),p.unproject(A,h.z)]},_tileCoordsToBounds:function(h){var p=this._tileCoordsToNwSe(h),x=new Kn(p[0],p[1]);return this.options.noWrap||(x=this._map.wrapLatLngBounds(x)),x},_tileCoordsToKey:function(h){return h.x+":"+h.y+":"+h.z},_keyToTileCoords:function(h){var p=h.split(":"),x=new At(+p[0],+p[1]);return x.z=+p[2],x},_removeTile:function(h){var p=this._tiles[h];!p||(C1(p.el),delete this._tiles[h],this.fire("tileunload",{tile:p.el,coords:this._keyToTileCoords(h)}))},_initTile:function(h){qe(h,"leaflet-tile");var p=this.getTileSize();h.style.width=p.x+"px",h.style.height=p.y+"px",h.onselectstart=M1,h.onmousemove=M1,ha&&this.options.opacity<1&&fi(h,this.options.opacity),t3&&!c2&&(h.style.WebkitBackfaceVisibility="hidden")},_addTile:function(h,p){var x=this._getTilePos(h),w=this._tileCoordsToKey(h),A=this.createTile(this._wrapCoords(h),f1(this._tileReady,this,h));this._initTile(A),this.createTile.length<2&&Fn(f1(this._tileReady,this,h,null,A)),ln(A,x),this._tiles[w]={el:A,coords:h,current:!0},p.appendChild(A),this.fire("tileloadstart",{tile:A,coords:h})},_tileReady:function(h,p,x){p&&this.fire("tileerror",{error:p,tile:x,coords:h});var w=this._tileCoordsToKey(h);(x=this._tiles[w])&&(x.loaded=+new Date,this._map._fadeAnimated?(fi(x.el,0),Bn(this._fadeFrame),this._fadeFrame=Fn(this._updateOpacity,this)):(x.active=!0,this._pruneTiles()),p||(qe(x.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:x.el,coords:h})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),ha||!this._map._fadeAnimated?Fn(this._pruneTiles,this):setTimeout(f1(this._pruneTiles,this),250)))},_getTilePos:function(h){return h.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(h){var p=new At(this._wrapX?ca(h.x,this._wrapX):h.x,this._wrapY?ca(h.y,this._wrapY):h.y);return p.z=h.z,p},_pxBoundsToTileRange:function(h){var p=this.getTileSize();return new r1(h.min.unscaleBy(p).floor(),h.max.unscaleBy(p).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var h in this._tiles)if(!this._tiles[h].loaded)return!1;return!0}});var Oo=p3.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(h,p){this._url=h,(p=R1(this,p)).detectRetina&&Br&&p.maxZoom>0&&(p.tileSize=Math.floor(p.tileSize/2),p.zoomReverse?(p.zoomOffset--,p.minZoom++):(p.zoomOffset++,p.maxZoom--),p.minZoom=Math.max(0,p.minZoom)),"string"==typeof p.subdomains&&(p.subdomains=p.subdomains.split("")),t3||this.on("tileunload",this._onTileRemove)},setUrl:function(h,p){return this._url===h&&void 0===p&&(p=!0),this._url=h,p||this.redraw(),this},createTile:function(h,p){var x=document.createElement("img");return Wt(x,"load",f1(this._tileOnLoad,this,p,x)),Wt(x,"error",f1(this._tileOnError,this,p,x)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(x.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),x.alt="",x.setAttribute("role","presentation"),x.src=this.getTileUrl(h),x},getTileUrl:function(h){var p={r:Br?"@2x":"",s:this._getSubdomain(h),x:h.x,y:h.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var x=this._globalTileRange.max.y-h.y;this.options.tms&&(p.y=x),p["-y"]=x}return $4(this._url,u1(p,this.options))},_tileOnLoad:function(h,p){ha?setTimeout(f1(h,this,null,p),0):h(null,p)},_tileOnError:function(h,p,x){var w=this.options.errorTileUrl;w&&p.getAttribute("src")!==w&&(p.src=w),h(x,p)},_onTileRemove:function(h){h.tile.onload=null},_getZoomForUrl:function(){var h=this._tileZoom;return this.options.zoomReverse&&(h=this.options.maxZoom-h),h+this.options.zoomOffset},_getSubdomain:function(h){var p=Math.abs(h.x+h.y)%this.options.subdomains.length;return this.options.subdomains[p]},_abortLoading:function(){var h,p;for(h in this._tiles)this._tiles[h].coords.z!==this._tileZoom&&((p=this._tiles[h].el).onload=M1,p.onerror=M1,p.complete||(p.src=X4,C1(p),delete this._tiles[h]))},_removeTile:function(h){var p=this._tiles[h];if(p)return b9||p.el.setAttribute("src",X4),p3.prototype._removeTile.call(this,h)},_tileReady:function(h,p,x){if(this._map&&(!x||x.getAttribute("src")!==X4))return p3.prototype._tileReady.call(this,h,p,x)}});function W9(h,p){return new Oo(h,p)}var j9=Oo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(h,p){this._url=h;var x=u1({},this.defaultWmsParams);for(var w in p)w in this.options||(x[w]=p[w]);var A=(p=R1(this,p)).detectRetina&&Br?2:1,R=this.getTileSize();x.width=R.x*A,x.height=R.y*A,this.wmsParams=x},onAdd:function(h){this._crs=this.options.crs||h.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version),this.wmsParams[this._wmsVersion>=1.3?"crs":"srs"]=this._crs.code,Oo.prototype.onAdd.call(this,h)},getTileUrl:function(h){var p=this._tileCoordsToNwSe(h),x=this._crs,w=Wi(x.project(p[0]),x.project(p[1])),A=w.min,R=w.max,Q=(this._wmsVersion>=1.3&&this._crs===u3?[A.y,A.x,R.y,R.x]:[A.x,A.y,R.x,R.y]).join(","),de=Oo.prototype.getTileUrl.call(this,h);return de+Q8(this.wmsParams,de,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Q},setParams:function(h,p){return u1(this.wmsParams,h),p||this.redraw(),this}});Oo.WMS=j9,W9.wms=function vx(h,p){return new j9(h,p)};var m2=di.extend({options:{padding:.1,tolerance:0},initialize:function(h){R1(this,h),i1(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&qe(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var h={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(h.zoomanim=this._onAnimZoom),h},_onAnimZoom:function(h){this._updateTransform(h.center,h.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(h,p){var x=this._map.getZoomScale(p,this._zoom),w=bs(this._container),A=this._map.getSize().multiplyBy(.5+this.options.padding),R=this._map.project(this._center,p),de=this._map.project(h,p).subtract(R),me=A.multiplyBy(-x).add(w).add(A).subtract(de);Li?Ms(this._container,me,x):ln(this._container,me)},_reset:function(){for(var h in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[h]._reset()},_onZoomEnd:function(){for(var h in this._layers)this._layers[h]._project()},_updatePaths:function(){for(var h in this._layers)this._layers[h]._update()},_update:function(){var h=this.options.padding,p=this._map.getSize(),x=this._map.containerPointToLayerPoint(p.multiplyBy(-h)).round();this._bounds=new r1(x,x.add(p.multiplyBy(1+2*h)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),m3=m2.extend({getEvents:function(){var h=m2.prototype.getEvents.call(this);return h.viewprereset=this._onViewPreReset,h},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){m2.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var h=this._container=document.createElement("canvas");Wt(h,"mousemove",this._onMouseMove,this),Wt(h,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Wt(h,"mouseout",this._handleMouseOut,this),this._ctx=h.getContext("2d")},_destroyContainer:function(){Bn(this._redrawRequest),delete this._ctx,C1(this._container),Tt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var p in this._redrawBounds=null,this._layers)this._layers[p]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){m2.prototype._update.call(this);var h=this._bounds,p=this._container,x=h.getSize(),w=Br?2:1;ln(p,h.min),p.width=w*x.x,p.height=w*x.y,p.style.width=x.x+"px",p.style.height=x.y+"px",Br&&this._ctx.scale(2,2),this._ctx.translate(-h.min.x,-h.min.y),this.fire("update")}},_reset:function(){m2.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(h){this._updateDashArray(h),this._layers[i1(h)]=h;var p=h._order={layer:h,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=p),this._drawLast=p,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(h){this._requestRedraw(h)},_removePath:function(h){var p=h._order,x=p.next,w=p.prev;x?x.prev=w:this._drawLast=w,w?w.next=x:this._drawFirst=x,delete h._order,delete this._layers[i1(h)],this._requestRedraw(h)},_updatePath:function(h){this._extendRedrawBounds(h),h._project(),h._update(),this._requestRedraw(h)},_updateStyle:function(h){this._updateDashArray(h),this._requestRedraw(h)},_updateDashArray:function(h){if("string"==typeof h.options.dashArray){var w,A,p=h.options.dashArray.split(/[, ]+/),x=[];for(A=0;A<p.length;A++){if(w=Number(p[A]),isNaN(w))return;x.push(w)}h.options._dashArray=x}else h.options._dashArray=h.options.dashArray},_requestRedraw:function(h){!this._map||(this._extendRedrawBounds(h),this._redrawRequest=this._redrawRequest||Fn(this._redraw,this))},_extendRedrawBounds:function(h){if(h._pxBounds){var p=(h.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new r1,this._redrawBounds.extend(h._pxBounds.min.subtract([p,p])),this._redrawBounds.extend(h._pxBounds.max.add([p,p]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var h=this._redrawBounds;if(h){var p=h.getSize();this._ctx.clearRect(h.min.x,h.min.y,p.x,p.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var h,p=this._redrawBounds;if(this._ctx.save(),p){var x=p.getSize();this._ctx.beginPath(),this._ctx.rect(p.min.x,p.min.y,x.x,x.y),this._ctx.clip()}this._drawing=!0;for(var w=this._drawFirst;w;w=w.next)h=w.layer,(!p||h._pxBounds&&h._pxBounds.intersects(p))&&h._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(h,p){if(this._drawing){var x,w,A,R,Q=h._parts,de=Q.length,me=this._ctx;if(de){for(me.beginPath(),x=0;x<de;x++){for(w=0,A=Q[x].length;w<A;w++)me[w?"lineTo":"moveTo"]((R=Q[x][w]).x,R.y);p&&me.closePath()}this._fillStroke(me,h)}}},_updateCircle:function(h){if(this._drawing&&!h._empty()){var p=h._point,x=this._ctx,w=Math.max(Math.round(h._radius),1),A=(Math.max(Math.round(h._radiusY),1)||w)/w;1!==A&&(x.save(),x.scale(1,A)),x.beginPath(),x.arc(p.x,p.y/A,w,0,2*Math.PI,!1),1!==A&&x.restore(),this._fillStroke(x,h)}},_fillStroke:function(h,p){var x=p.options;x.fill&&(h.globalAlpha=x.fillOpacity,h.fillStyle=x.fillColor||x.color,h.fill(x.fillRule||"evenodd")),x.stroke&&0!==x.weight&&(h.setLineDash&&h.setLineDash(p.options&&p.options._dashArray||[]),h.globalAlpha=x.opacity,h.lineWidth=x.weight,h.strokeStyle=x.color,h.lineCap=x.lineCap,h.lineJoin=x.lineJoin,h.stroke())},_onClick:function(h){for(var x,w,p=this._map.mouseEventToLayerPoint(h),A=this._drawFirst;A;A=A.next)(x=A.layer).options.interactive&&x._containsPoint(p)&&("click"!==h.type&&"preclick"===h.type||!this._map._draggableMoved(x))&&(w=x);w&&(o3(h),this._fireEvent([w],h))},_onMouseMove:function(h){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var p=this._map.mouseEventToLayerPoint(h);this._handleMouseHover(h,p)}},_handleMouseOut:function(h){var p=this._hoveredLayer;p&&(H1(this._container,"leaflet-interactive"),this._fireEvent([p],h,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(h,p){if(!this._mouseHoverThrottled){for(var x,w,A=this._drawFirst;A;A=A.next)(x=A.layer).options.interactive&&x._containsPoint(p)&&(w=x);w!==this._hoveredLayer&&(this._handleMouseOut(h),w&&(qe(this._container,"leaflet-interactive"),this._fireEvent([w],h,"mouseover"),this._hoveredLayer=w)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],h),this._mouseHoverThrottled=!0,setTimeout(f1(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(h,p,x){this._map._fireDOMEvent(p,x||p.type,h)},_bringToFront:function(h){var p=h._order;if(p){var x=p.next,w=p.prev;if(!x)return;x.prev=w,w?w.next=x:x&&(this._drawFirst=x),p.prev=this._drawLast,this._drawLast.next=p,p.next=null,this._drawLast=p,this._requestRedraw(h)}},_bringToBack:function(h){var p=h._order;if(p){var x=p.next,w=p.prev;if(!w)return;w.next=x,x?x.prev=w:w&&(this._drawLast=w),p.prev=null,p.next=this._drawFirst,this._drawFirst.prev=p,this._drawFirst=p,this._requestRedraw(h)}}});function q9(h){return l5?new m3(h):null}var g3=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(h){return document.createElement("<lvml:"+h+' class="lvml">')}}catch(h){return function(p){return document.createElement("<"+p+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),yx={_initContainer:function(){this._container=dt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(m2.prototype._update.call(this),this.fire("update"))},_initPath:function(h){var p=h._container=g3("shape");qe(p,"leaflet-vml-shape "+(this.options.className||"")),p.coordsize="1 1",h._path=g3("path"),p.appendChild(h._path),this._updateStyle(h),this._layers[i1(h)]=h},_addPath:function(h){var p=h._container;this._container.appendChild(p),h.options.interactive&&h.addInteractiveTarget(p)},_removePath:function(h){var p=h._container;C1(p),h.removeInteractiveTarget(p),delete this._layers[i1(h)]},_updateStyle:function(h){var p=h._stroke,x=h._fill,w=h.options,A=h._container;A.stroked=!!w.stroke,A.filled=!!w.fill,w.stroke?(p||(p=h._stroke=g3("stroke")),A.appendChild(p),p.weight=w.weight+"px",p.color=w.color,p.opacity=w.opacity,p.dashStyle=w.dashArray?kn(w.dashArray)?w.dashArray.join(" "):w.dashArray.replace(/( *, *)/g," "):"",p.endcap=w.lineCap.replace("butt","flat"),p.joinstyle=w.lineJoin):p&&(A.removeChild(p),h._stroke=null),w.fill?(x||(x=h._fill=g3("fill")),A.appendChild(x),x.color=w.fillColor||w.color,x.opacity=w.fillOpacity):x&&(A.removeChild(x),h._fill=null)},_updateCircle:function(h){var p=h._point.round(),x=Math.round(h._radius),w=Math.round(h._radiusY||x);this._setPath(h,h._empty()?"M0 0":"AL "+p.x+","+p.y+" "+x+","+w+" 0,23592600")},_setPath:function(h,p){h._path.v=p},_bringToFront:function(h){Ur(h._container)},_bringToBack:function(h){da(h._container)}},U2=i3?g3:x9,ko=m2.extend({getEvents:function(){var h=m2.prototype.getEvents.call(this);return h.zoomstart=this._onZoomStart,h},_initContainer:function(){this._container=U2("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=U2("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){C1(this._container),Tt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){m2.prototype._update.call(this);var h=this._bounds,p=h.getSize(),x=this._container;(!this._svgSize||!this._svgSize.equals(p))&&(this._svgSize=p,x.setAttribute("width",p.x),x.setAttribute("height",p.y)),ln(x,h.min),x.setAttribute("viewBox",[h.min.x,h.min.y,p.x,p.y].join(" ")),this.fire("update")}},_initPath:function(h){var p=h._path=U2("path");h.options.className&&qe(p,h.options.className),h.options.interactive&&qe(p,"leaflet-interactive"),this._updateStyle(h),this._layers[i1(h)]=h},_addPath:function(h){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(h._path),h.addInteractiveTarget(h._path)},_removePath:function(h){C1(h._path),h.removeInteractiveTarget(h._path),delete this._layers[i1(h)]},_updatePath:function(h){h._project(),h._update()},_updateStyle:function(h){var p=h._path,x=h.options;!p||(x.stroke?(p.setAttribute("stroke",x.color),p.setAttribute("stroke-opacity",x.opacity),p.setAttribute("stroke-width",x.weight),p.setAttribute("stroke-linecap",x.lineCap),p.setAttribute("stroke-linejoin",x.lineJoin),x.dashArray?p.setAttribute("stroke-dasharray",x.dashArray):p.removeAttribute("stroke-dasharray"),x.dashOffset?p.setAttribute("stroke-dashoffset",x.dashOffset):p.removeAttribute("stroke-dashoffset")):p.setAttribute("stroke","none"),x.fill?(p.setAttribute("fill",x.fillColor||x.color),p.setAttribute("fill-opacity",x.fillOpacity),p.setAttribute("fill-rule",x.fillRule||"evenodd")):p.setAttribute("fill","none"))},_updatePoly:function(h,p){this._setPath(h,i6(h._parts,p))},_updateCircle:function(h){var p=h._point,x=Math.max(Math.round(h._radius),1),A="a"+x+","+(Math.max(Math.round(h._radiusY),1)||x)+" 0 1,0 ",R=h._empty()?"M0 0":"M"+(p.x-x)+","+p.y+A+2*x+",0 "+A+2*-x+",0 ";this._setPath(h,R)},_setPath:function(h,p){h._path.setAttribute("d",p)},_bringToFront:function(h){Ur(h._path)},_bringToBack:function(h){da(h._path)}});function ni(h){return wo||i3?new ko(h):null}i3&&ko.include(yx),It.include({getRenderer:function(h){var p=h.options.renderer||this._getPaneRenderer(h.options.pane)||this.options.renderer||this._renderer;return p||(p=this._renderer=this._createRenderer()),this.hasLayer(p)||this.addLayer(p),p},_getPaneRenderer:function(h){if("overlayPane"===h||void 0===h)return!1;var p=this._paneRenderers[h];return void 0===p&&(p=this._createRenderer({pane:h}),this._paneRenderers[h]=p),p},_createRenderer:function(h){return this.options.preferCanvas&&q9(h)||ni(h)}});var x6=qr.extend({initialize:function(h,p){qr.prototype.initialize.call(this,this._boundsToLatLngs(h),p)},setBounds:function(h){return this.setLatLngs(this._boundsToLatLngs(h))},_boundsToLatLngs:function(h){return[(h=Yt(h)).getSouthWest(),h.getNorthWest(),h.getNorthEast(),h.getSouthEast()]}});ko.create=U2,ko.pointsToPath=i6,k1.geometryToLayer=Es,k1.coordsToLatLng=Pi,k1.coordsToLatLngs=p1,k1.latLngToCoords=_6,k1.latLngsToCoords=f3,k1.getFeature=ti,k1.asFeature=gi,It.mergeOptions({boxZoom:!0});var L5=Ut.extend({initialize:function(h){this._map=h,this._container=h._container,this._pane=h._panes.overlayPane,this._resetStateTimeout=0,h.on("unload",this._destroy,this)},addHooks:function(){Wt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Tt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){C1(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(h){if(!h.shiftKey||1!==h.which&&1!==h.button)return!1;this._clearDeferredResetState(),this._resetState(),Gr(),p5(),this._startPoint=this._map.mouseEventToContainerPoint(h),Wt(document,{contextmenu:sr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(h){this._moved||(this._moved=!0,this._box=dt("div","leaflet-zoom-box",this._container),qe(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(h);var p=new r1(this._point,this._startPoint),x=p.getSize();ln(this._box,p.min),this._box.style.width=x.x+"px",this._box.style.height=x.y+"px"},_finish:function(){this._moved&&(C1(this._box),H1(this._container,"leaflet-crosshair")),Tn(),d2(),Tt(document,{contextmenu:sr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(h){if((1===h.which||1===h.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(f1(this._resetState,this),0);var p=new Kn(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(p).fire("boxzoomend",{boxZoomBounds:p})}},_onKeyDown:function(h){27===h.keyCode&&this._finish()}});It.addInitHook("addHandler","boxZoom",L5),It.mergeOptions({doubleClickZoom:!0});var M6=Ut.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(h){var p=this._map,x=p.getZoom(),w=p.options.zoomDelta,A=h.originalEvent.shiftKey?x-w:x+w;"center"===p.options.doubleClickZoom?p.setZoom(A):p.setZoomAround(h.containerPoint,A)}});It.addInitHook("addHandler","doubleClickZoom",M6),It.mergeOptions({dragging:!0,inertia:!c2,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var b6=Ut.extend({addHooks:function(){if(!this._draggable){var h=this._map;this._draggable=new k2(h._mapPane,h._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),h.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),h.on("zoomend",this._onZoomEnd,this),h.whenReady(this._onZoomEnd,this))}qe(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){H1(this._map._container,"leaflet-grab"),H1(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var h=this._map;if(h._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var p=Yt(this._map.options.maxBounds);this._offsetLimit=Wi(this._map.latLngToContainerPoint(p.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(p.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;h.fire("movestart").fire("dragstart"),h.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(h){if(this._map.options.inertia){var p=this._lastTime=+new Date,x=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(x),this._times.push(p),this._prunePositions(p)}this._map.fire("move",h).fire("drag",h)},_prunePositions:function(h){for(;this._positions.length>1&&h-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var h=this._map.getSize().divideBy(2),p=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=p.subtract(h).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(h,p){return h-(h-p)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var h=this._draggable._newPos.subtract(this._draggable._startPos),p=this._offsetLimit;h.x<p.min.x&&(h.x=this._viscousLimit(h.x,p.min.x)),h.y<p.min.y&&(h.y=this._viscousLimit(h.y,p.min.y)),h.x>p.max.x&&(h.x=this._viscousLimit(h.x,p.max.x)),h.y>p.max.y&&(h.y=this._viscousLimit(h.y,p.max.y)),this._draggable._newPos=this._draggable._startPos.add(h)}},_onPreDragWrap:function(){var h=this._worldWidth,p=Math.round(h/2),x=this._initialWorldOffset,w=this._draggable._newPos.x,A=(w-p+x)%h+p-x,R=(w+p+x)%h-p-x,Q=Math.abs(A+x)<Math.abs(R+x)?A:R;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Q},_onDragEnd:function(h){var p=this._map,x=p.options,w=!x.inertia||this._times.length<2;if(p.fire("dragend",h),w)p.fire("moveend");else{this._prunePositions(+new Date);var A=this._lastPos.subtract(this._positions[0]),Q=x.easeLinearity,de=A.multiplyBy(Q/((this._lastTime-this._times[0])/1e3)),me=de.distanceTo([0,0]),Ce=Math.min(x.inertiaMaxSpeed,me),tt=de.multiplyBy(Ce/me),pt=Ce/(x.inertiaDeceleration*Q),Pt=tt.multiplyBy(-pt/2).round();Pt.x||Pt.y?(Pt=p._limitOffset(Pt,p.options.maxBounds),Fn(function(){p.panBy(Pt,{duration:pt,easeLinearity:Q,noMoveStart:!0,animate:!0})})):p.fire("moveend")}}});It.addInitHook("addHandler","dragging",b6),It.mergeOptions({keyboard:!0,keyboardPanDelta:80});var D5=Ut.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(h){this._map=h,this._setPanDelta(h.options.keyboardPanDelta),this._setZoomDelta(h.options.zoomDelta)},addHooks:function(){var h=this._map._container;h.tabIndex<=0&&(h.tabIndex="0"),Wt(h,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Tt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var h=document.body,p=document.documentElement,x=h.scrollTop||p.scrollTop,w=h.scrollLeft||p.scrollLeft;this._map._container.focus(),window.scrollTo(w,x)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(h){var w,A,p=this._panKeys={},x=this.keyCodes;for(w=0,A=x.left.length;w<A;w++)p[x.left[w]]=[-1*h,0];for(w=0,A=x.right.length;w<A;w++)p[x.right[w]]=[h,0];for(w=0,A=x.down.length;w<A;w++)p[x.down[w]]=[0,h];for(w=0,A=x.up.length;w<A;w++)p[x.up[w]]=[0,-1*h]},_setZoomDelta:function(h){var w,A,p=this._zoomKeys={},x=this.keyCodes;for(w=0,A=x.zoomIn.length;w<A;w++)p[x.zoomIn[w]]=h;for(w=0,A=x.zoomOut.length;w<A;w++)p[x.zoomOut[w]]=-h},_addHooks:function(){Wt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Tt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(h){if(!(h.altKey||h.ctrlKey||h.metaKey)){var w,p=h.keyCode,x=this._map;if(p in this._panKeys)(!x._panAnim||!x._panAnim._inProgress)&&(w=this._panKeys[p],h.shiftKey&&(w=n1(w).multiplyBy(3)),x.panBy(w),x.options.maxBounds&&x.panInsideBounds(x.options.maxBounds));else if(p in this._zoomKeys)x.setZoom(x.getZoom()+(h.shiftKey?3:1)*this._zoomKeys[p]);else{if(27!==p||!x._popup||!x._popup.options.closeOnEscapeKey)return;x.closePopup()}sr(h)}}});It.addInitHook("addHandler","keyboard",D5),It.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var v3=Ut.extend({addHooks:function(){Wt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Tt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(h){var p=Ao(h),x=this._map.options.wheelDebounceTime;this._delta+=p,this._lastMousePos=this._map.mouseEventToContainerPoint(h),this._startTime||(this._startTime=+new Date);var w=Math.max(x-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(f1(this._performZoom,this),w),sr(h)},_performZoom:function(){var h=this._map,p=h.getZoom(),x=this._map.options.zoomSnap||0;h._stop();var A=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,R=x?Math.ceil(A/x)*x:A,Q=h._limitZoom(p+(this._delta>0?R:-R))-p;this._delta=0,this._startTime=null,Q&&("center"===h.options.scrollWheelZoom?h.setZoom(p+Q):h.setZoomAround(this._lastMousePos,p+Q))}});It.addInitHook("addHandler","scrollWheelZoom",v3),It.mergeOptions({tap:!0,tapTolerance:15});var P5=Ut.extend({addHooks:function(){Wt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Tt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(h){if(h.touches){if(Di(h),this._fireClick=!0,h.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var p=h.touches[0],x=p.target;this._startPos=this._newPos=new At(p.clientX,p.clientY),x.tagName&&"a"===x.tagName.toLowerCase()&&qe(x,"leaflet-active"),this._holdTimeout=setTimeout(f1(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",p))},this),1e3),this._simulateEvent("mousedown",p),Wt(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(h){if(clearTimeout(this._holdTimeout),Tt(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&h&&h.changedTouches){var p=h.changedTouches[0],x=p.target;x&&x.tagName&&"a"===x.tagName.toLowerCase()&&H1(x,"leaflet-active"),this._simulateEvent("mouseup",p),this._isTapValid()&&this._simulateEvent("click",p)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(h){var p=h.touches[0];this._newPos=new At(p.clientX,p.clientY),this._simulateEvent("mousemove",p)},_simulateEvent:function(h,p){var x=document.createEvent("MouseEvents");x._simulated=!0,p.target._simulatedClick=!0,x.initMouseEvent(h,!0,!0,window,1,p.screenX,p.screenY,p.clientX,p.clientY,!1,!1,!1,!1,0,null),p.target.dispatchEvent(x)}});h2&&(!l2||o6)&&It.addInitHook("addHandler","tap",P5),It.mergeOptions({touchZoom:h2&&!c2,bounceAtZoomLimits:!0});var Ni=Ut.extend({addHooks:function(){qe(this._map._container,"leaflet-touch-zoom"),Wt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){H1(this._map._container,"leaflet-touch-zoom"),Tt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(h){var p=this._map;if(h.touches&&2===h.touches.length&&!p._animatingZoom&&!this._zooming){var x=p.mouseEventToContainerPoint(h.touches[0]),w=p.mouseEventToContainerPoint(h.touches[1]);this._centerPoint=p.getSize()._divideBy(2),this._startLatLng=p.containerPointToLatLng(this._centerPoint),"center"!==p.options.touchZoom&&(this._pinchStartLatLng=p.containerPointToLatLng(x.add(w)._divideBy(2))),this._startDist=x.distanceTo(w),this._startZoom=p.getZoom(),this._moved=!1,this._zooming=!0,p._stop(),Wt(document,"touchmove",this._onTouchMove,this),Wt(document,"touchend",this._onTouchEnd,this),Di(h)}},_onTouchMove:function(h){if(h.touches&&2===h.touches.length&&this._zooming){var p=this._map,x=p.mouseEventToContainerPoint(h.touches[0]),w=p.mouseEventToContainerPoint(h.touches[1]),A=x.distanceTo(w)/this._startDist;if(this._zoom=p.getScaleZoom(A,this._startZoom),!p.options.bounceAtZoomLimits&&(this._zoom<p.getMinZoom()&&A<1||this._zoom>p.getMaxZoom()&&A>1)&&(this._zoom=p._limitZoom(this._zoom)),"center"===p.options.touchZoom){if(this._center=this._startLatLng,1===A)return}else{var R=x._add(w)._divideBy(2)._subtract(this._centerPoint);if(1===A&&0===R.x&&0===R.y)return;this._center=p.unproject(p.project(this._pinchStartLatLng,this._zoom).subtract(R),this._zoom)}this._moved||(p._moveStart(!0,!1),this._moved=!0),Bn(this._animRequest);var Q=f1(p._move,p,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=Fn(Q,this,!0),Di(h)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,Bn(this._animRequest),Tt(document,"touchmove",this._onTouchMove,this),Tt(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});It.addInitHook("addHandler","touchZoom",Ni),It.BoxZoom=L5,It.DoubleClickZoom=M6,It.Drag=b6,It.Keyboard=D5,It.ScrollWheelZoom=v3,It.Tap=P5,It.TouchZoom=Ni,Ve.version="1.7.1",Ve.Control=O2,Ve.control=ji,Ve.Browser=rr,Ve.Evented=la,Ve.Mixin=ux,Ve.Util=ms,Ve.Class=Fr,Ve.Handler=Ut,Ve.extend=u1,Ve.bind=f1,Ve.stamp=i1,Ve.setOptions=R1,Ve.DomEvent=g6,Ve.DomUtil=H9,Ve.PosAnimation=b5,Ve.Draggable=k2,Ve.LineUtil=$1,Ve.PolyUtil=Gn,Ve.Point=At,Ve.point=n1,Ve.Bounds=r1,Ve.bounds=Wi,Ve.Transformation=i5,Ve.transformation=e3,Ve.Projection=Zi,Ve.LatLng=Dt,Ve.latLng=Et,Ve.LatLngBounds=Kn,Ve.latLngBounds=Yt,Ve.CRS=o2,Ve.GeoJSON=k1,Ve.geoJSON=Ho,Ve.geoJson=d3,Ve.Layer=di,Ve.LayerGroup=$i,Ve.layerGroup=function(h,p){return new $i(h,p)},Ve.FeatureGroup=ma,Ve.featureGroup=function(h,p){return new ma(h,p)},Ve.ImageOverlay=vi,Ve.imageOverlay=function(h,p,x){return new vi(h,p,x)},Ve.VideoOverlay=B9,Ve.videoOverlay=function U9(h,p,x){return new B9(h,p,x)},Ve.SVGOverlay=A5,Ve.svgOverlay=function fx(h,p,x){return new A5(h,p,x)},Ve.DivOverlay=Zr,Ve.Popup=Io,Ve.popup=function(h,p){return new Io(h,p)},Ve.Tooltip=Vo,Ve.tooltip=function(h,p){return new Vo(h,p)},Ve.Icon=Xe,Ve.icon=function Bt(h){return new Xe(h)},Ve.DivIcon=G9,Ve.divIcon=function mx(h){return new G9(h)},Ve.Marker=B2,Ve.marker=function xn(h,p){return new B2(h,p)},Ve.TileLayer=Oo,Ve.tileLayer=W9,Ve.GridLayer=p3,Ve.gridLayer=function gx(h){return new p3(h)},Ve.SVG=ko,Ve.svg=ni,Ve.Renderer=m2,Ve.Canvas=m3,Ve.canvas=q9,Ve.Path=mi,Ve.CircleMarker=T1,Ve.circleMarker=function No(h,p){return new T1(h,p)},Ve.Circle=jr,Ve.circle=function Rt(h,p,x){return new jr(h,p,x)},Ve.Polyline=Yi,Ve.polyline=function ga(h,p){return new Yi(h,p)},Ve.Polygon=qr,Ve.polygon=function va(h,p){return new qr(h,p)},Ve.Rectangle=x6,Ve.rectangle=function Z9(h,p){return new x6(h,p)},Ve.Map=It,Ve.map=function w5(h,p){return new It(h,p)};var N5=window.L;Ve.noConflict=function(){return window.L=N5,this},window.L=Ve}(I2)}},kr=>{kr(kr.s=439)}]);